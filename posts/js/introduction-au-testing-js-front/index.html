<!doctype html><html lang="en"><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="stylesheet" href="/statinamic-client.css" /><meta data-react-helmet="true" property="og:site_name" content="putaindecode.fr"/><meta data-react-helmet="true" name="twitter:site" content="@putaindecode"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Introduction au testing js front"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Introduction au testing js front"/><meta data-react-helmet="true" name="twitter:creator" content="@bloodyowl"/><title data-react-helmet="true">Introduction au testing js front</title></head><body><div id="statinamic"><div id="statinamic-container" data-reactid=".8pl0c1pw5c" data-react-checksum="-1538161414"><div class="r-VerticalRhythm" data-reactid=".8pl0c1pw5c.0"><div data-reactid=".8pl0c1pw5c.0.0"><noscript data-reactid=".8pl0c1pw5c.0.0.0:0"></noscript><div class="putainde-Header" data-reactid=".8pl0c1pw5c.0.0.0:1"><div class="r-Grid" data-reactid=".8pl0c1pw5c.0.0.0:1.0"><div class="r-Grid-cell r-minM--1of3" data-reactid=".8pl0c1pw5c.0.0.0:1.0.0"><a class="putainde-SiteTitle" href="/" data-reactid=".8pl0c1pw5c.0.0.0:1.0.0.0"><span class="SVGIcon SVGIcon--cleaned putainde-Logo" data-reactid=".8pl0c1pw5c.0.0.0:1.0.0.0.0"><?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Logo-svg" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="-49.5 652.5 512 512" enable-background="new -49.5 652.5 512 512" xml:space="preserve">
<g id="shadow-group">
	
		<radialGradient id="shadow_1_" cx="206.4546" cy="-395.0098" r="243.7911" gradientTransform="matrix(0.9784 0 0 -0.9765 4.504 505.6038)" gradientUnits="userSpaceOnUse">
		<stop  offset="0.8" style="stop-color:#000000"/>
		<stop  offset="0.95" style="stop-color:#333333"/>
	</radialGradient>
	
		<linearGradient id="shadow_2_" gradientUnits="userSpaceOnUse" x1="-34" y1="-376.3311" x2="447" y2="-376.3311" gradientTransform="matrix(1 0 0 -1 0 515)">
		<stop  offset="0" style="stop-color:#333333"/>
		<stop  offset="1" style="stop-color:#000000"/>
	</linearGradient>
	
		<path id="shadow" vector-effect="non-scaling-stroke" opacity="0.4" fill="url(#shadow_1_)" stroke="url(#shadow_2_)" stroke-miterlimit="10" enable-background="new    " d="
		M-33.5,891.331c0-130.655,107.456-236.581,240.01-236.581c132.535,0,239.99,105.927,239.99,236.581
		c0,130.653-107.455,236.581-239.99,236.581C73.956,1127.911-33.5,1021.984-33.5,891.331z"/>
	
		<linearGradient id="shadow--stroke_1_" gradientUnits="userSpaceOnUse" x1="-34.5" y1="-377.1689" x2="447.5" y2="-377.1689" gradientTransform="matrix(1 0 0 -1 0 515)">
		<stop  offset="0" style="stop-color:#333333"/>
		<stop  offset="1" style="stop-color:#000000"/>
	</linearGradient>
	
		<path id="shadow--stroke" opacity="0.2" fill="none" stroke="url(#shadow--stroke_1_)" stroke-width="2" stroke-miterlimit="10" enable-background="new    " d="
		M-33.5,892.169c0-130.655,107.456-236.581,240.01-236.581c132.535,0,239.99,105.928,239.99,236.581
		c0,130.654-107.455,236.581-239.99,236.581C73.956,1128.75-33.5,1022.824-33.5,892.169z"/>
</g>
<g id="bubble-group">
	
		<linearGradient id="bubble_2_" gradientUnits="userSpaceOnUse" x1="30.2466" y1="427.8506" x2="30.2465" y2="228.3193" gradientTransform="matrix(2.3906 0 0 -2.3906 134.1921 1708.0696)">
		<stop  offset="0" style="stop-color:#FFFFFF"/>
		<stop  offset="1" style="stop-color:#EEEEEE"/>
	</linearGradient>
	<path id="bubble_1_" vector-effect="non-scaling-stroke" fill="url(#bubble_2_)" stroke="#7A7A7A" stroke-miterlimit="10" d="
		M1,889.671c0,112.916,92.003,204.444,205.51,204.444c1.283,0,2.565-0.019,3.828-0.04c19.795,40.379,61.281,68.175,109.258,68.175
		c3.686,0,7.334-0.157,10.941-0.481c-20.401-23.875-33.307-54.348-35.07-87.771C364.424,1041.018,412,970.873,412,889.673
		c0-112.894-92.004-204.423-205.49-204.423C93.004,685.247,1,776.777,1,889.671z"/>
	<path id="bubble--stroke" fill="none" stroke="#7A7A7A" stroke-width="2" stroke-miterlimit="10" d="M1,889.671
		c0,112.916,92.003,204.444,205.51,204.444c1.283,0,2.565-0.019,3.828-0.04c19.795,40.379,61.281,68.175,109.258,68.175
		c3.686,0,7.334-0.157,10.941-0.481c-20.401-23.875-33.307-54.348-35.07-87.771C364.424,1041.018,412,970.873,412,889.673
		c0-112.894-92.004-204.423-205.49-204.423C93.004,685.247,1,776.777,1,889.671z"/>
</g>
<g id="p_x21_">
	<g id="P-group">
		
			<path id="P" vector-effect="non-scaling-stroke" fill="#444444" stroke="#333333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="
			M187.747,832.25H132.5v123h27.551v-45.188h28.086c7.596,0,14.055-1.102,19.378-3.302c5.323-2.196,9.656-5.138,13.019-8.745
			c3.364-3.605,5.801-7.795,7.327-12.498c1.527-4.707,2.312-9.494,2.312-14.363c0-4.978-0.785-9.807-2.312-14.428
			c-1.567-4.625-4.024-8.789-7.387-12.396c-3.363-3.605-7.765-6.551-13.168-8.747C201.924,833.391,195.421,832.25,187.747,832.25z
			 M181.225,889.979h-21.173v-37.641h21.173c3.096,0,6.107,0.227,8.996,0.704c2.891,0.478,5.428,1.411,7.635,2.738
			c2.187,1.346,3.941,3.274,5.285,5.698c1.319,2.463,1.979,5.679,1.979,9.682s-0.66,7.253-1.979,9.68
			c-1.344,2.486-3.1,4.395-5.285,5.742c-2.207,1.327-4.744,2.236-7.635,2.695C187.334,889.753,184.32,889.979,181.225,889.979z"/>
		
			<path id="P--stroke" fill="none" stroke="#333333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="
			M187.747,832.25H132.5v123h27.551v-45.188h28.086c7.596,0,14.055-1.102,19.378-3.302c5.323-2.196,9.656-5.138,13.019-8.745
			c3.364-3.605,5.801-7.795,7.327-12.498c1.527-4.707,2.312-9.494,2.312-14.363c0-4.978-0.785-9.807-2.312-14.428
			c-1.567-4.625-4.024-8.789-7.387-12.396c-3.363-3.605-7.765-6.551-13.168-8.747C201.924,833.391,195.421,832.25,187.747,832.25z
			 M181.225,889.979h-21.173v-37.641h21.173c3.096,0,6.107,0.227,8.996,0.704c2.891,0.478,5.428,1.411,7.635,2.738
			c2.187,1.346,3.941,3.274,5.285,5.698c1.319,2.463,1.979,5.679,1.979,9.682s-0.66,7.253-1.979,9.68
			c-1.344,2.486-3.1,4.395-5.285,5.742c-2.207,1.327-4.744,2.236-7.635,2.695C187.334,889.753,184.32,889.979,181.225,889.979z"/>
	</g>
	<g id="exclamation-group">
		
			<path id="exclamation-mark" vector-effect="non-scaling-stroke" fill="#444444" stroke="#333333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="
			M247.616,944.686c0,9.709,7.241,17.064,17.44,17.064c10.202,0,17.442-7.357,17.442-17.064c0-9.25-7.24-16.328-17.441-16.328
			C254.855,927.592,247.616,934.95,247.616,944.686z M280.201,881.346V831.75h-30.292v49.596l6.886,37.639h16.521L280.201,881.346z"
			/>
		
			<path id="exclamation-mark--stroke" fill="none" stroke="#333333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="
			M247.616,944.686c0,9.709,7.241,17.064,17.44,17.064c10.202,0,17.442-7.357,17.442-17.064c0-9.25-7.24-16.328-17.441-16.328
			C254.855,927.592,247.616,934.95,247.616,944.686z M280.201,881.346V831.75h-30.292v49.596l6.886,37.639h16.521L280.201,881.346z"
			/>
	</g>
</g>
<g id="braces">
	<g id="Layer_6_2_">
		
			<linearGradient id="brace-left_1_" gradientUnits="userSpaceOnUse" x1="87.1362" y1="385.3936" x2="87.1362" y2="297.5488" gradientTransform="matrix(2.3906 0 0 -2.3906 134.1921 1708.0696)">
			<stop  offset="0" style="stop-color:#C5372F"/>
			<stop  offset="1" style="stop-color:#990000"/>
		</linearGradient>
		
			<path id="brace-left_2_" vector-effect="non-scaling-stroke" fill="url(#brace-left_1_)" stroke="#8B2721" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="
			M314.164,970.195c2.755,0,4.955-0.561,6.592-1.577c1.639-1.095,2.916-2.451,3.854-4.009c0.923-1.614,1.519-3.43,1.758-5.362
			c0.22-1.996,0.382-3.806,0.382-5.465v-36.5c0-4.823,0.895-8.829,2.715-11.96c1.818-3.09,3.978-5.622,6.469-7.516
			c2.48-1.873,5.058-3.27,7.773-4.106c2.733-0.818,4.952-1.354,6.706-1.496v-0.697c-1.756-0.139-3.973-0.598-6.706-1.356
			c-2.718-0.735-5.293-2.111-7.773-3.984c-2.491-1.895-4.648-4.564-6.469-7.994c-1.82-3.408-2.715-7.936-2.715-13.574v-34.669
			c0-1.812-0.162-3.706-0.382-5.661c-0.239-1.955-0.837-3.769-1.758-5.363c-0.938-1.574-2.218-2.93-3.854-3.986
			s-3.837-1.613-6.592-1.613H302.5V786.75h28.781c2.694,0,5.753,0.676,9.169,1.953c3.414,1.316,6.632,3.25,9.591,5.762
			c2.953,2.532,5.449,5.741,7.53,9.669c2.036,3.927,3.112,8.472,3.112,13.695v43.299c0,3.849,0.742,7.118,2.299,9.788
			c1.56,2.691,3.417,4.844,5.614,6.459c2.157,1.615,4.875,2.751,7.392,3.43c2.496,0.678,4.652,1.016,6.512,1.016v20.076
			c-1.857,0-4.016,0.379-6.512,1.058c-2.517,0.677-5.232,1.772-7.394,3.209c-2.195,1.455-4.055,3.429-5.612,5.88
			c-1.557,2.453-2.299,5.423-2.299,8.932v44.697c0,5.2-1.076,9.771-3.112,13.696c-2.079,3.927-4.577,7.116-7.532,9.688
			c-2.955,2.487-6.175,4.402-9.589,5.74c-3.416,1.275-6.475,1.954-9.169,1.954H302.5v-26.554L314.164,970.195L314.164,970.195
			L314.164,970.195z"/>
		
			<path id="brace-left--stroke_2_" fill="none" stroke="#8B2721" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="
			M314.164,970.195c2.755,0,4.955-0.561,6.592-1.577c1.639-1.095,2.916-2.451,3.854-4.009c0.923-1.614,1.519-3.43,1.758-5.362
			c0.22-1.996,0.382-3.806,0.382-5.465v-36.5c0-4.823,0.895-8.829,2.715-11.96c1.818-3.09,3.978-5.622,6.469-7.516
			c2.48-1.873,5.058-3.27,7.773-4.106c2.733-0.818,4.952-1.354,6.706-1.496v-0.697c-1.756-0.139-3.973-0.598-6.706-1.356
			c-2.718-0.735-5.293-2.111-7.773-3.984c-2.491-1.895-4.648-4.564-6.469-7.994c-1.82-3.408-2.715-7.936-2.715-13.574v-34.669
			c0-1.812-0.162-3.706-0.382-5.661c-0.239-1.955-0.837-3.769-1.758-5.363c-0.938-1.574-2.218-2.93-3.854-3.986
			s-3.837-1.613-6.592-1.613H302.5V786.75h28.781c2.694,0,5.753,0.676,9.169,1.953c3.414,1.316,6.632,3.25,9.591,5.762
			c2.953,2.532,5.449,5.741,7.53,9.669c2.036,3.927,3.112,8.472,3.112,13.695v43.299c0,3.849,0.742,7.118,2.299,9.788
			c1.56,2.691,3.417,4.844,5.614,6.459c2.157,1.615,4.875,2.751,7.392,3.43c2.496,0.678,4.652,1.016,6.512,1.016v20.076
			c-1.857,0-4.016,0.379-6.512,1.058c-2.517,0.677-5.232,1.772-7.394,3.209c-2.195,1.455-4.055,3.429-5.612,5.88
			c-1.557,2.453-2.299,5.423-2.299,8.932v44.697c0,5.2-1.076,9.771-3.112,13.696c-2.079,3.927-4.577,7.116-7.532,9.688
			c-2.955,2.487-6.175,4.402-9.589,5.74c-3.416,1.275-6.475,1.954-9.169,1.954H302.5v-26.554L314.164,970.195L314.164,970.195
			L314.164,970.195z"/>
	</g>
	<g id="brace-l_2_">
		
			<linearGradient id="brace-right_1_" gradientUnits="userSpaceOnUse" x1="-26.6421" y1="385.3936" x2="-26.6421" y2="297.5498" gradientTransform="matrix(2.3906 0 0 -2.3906 134.1921 1708.0696)">
			<stop  offset="0" style="stop-color:#C5372F"/>
			<stop  offset="1" style="stop-color:#990000"/>
		</linearGradient>
		
			<path id="brace-right_2_" vector-effect="non-scaling-stroke" fill="url(#brace-right_1_)" stroke="#8B2721" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="
			M98.835,813.305c-2.797,0-4.995,0.56-6.632,1.615c-1.618,1.057-2.916,2.413-3.815,3.987c-0.958,1.596-1.559,3.409-1.778,5.362
			c-0.24,1.955-0.339,3.848-0.339,5.664V864.6c0,5.642-0.958,10.166-2.776,13.576c-1.818,3.43-3.975,6.1-6.432,7.993
			c-2.496,1.874-5.073,3.25-7.811,3.985c-2.716,0.759-4.914,1.217-6.671,1.355v0.697c1.758,0.141,3.955,0.678,6.671,1.495
			c2.737,0.838,5.314,2.233,7.811,4.106c2.456,1.895,4.614,4.426,6.432,7.517c1.817,3.13,2.776,7.136,2.776,11.96v36.501
			c0,1.651,0.101,3.466,0.339,5.463c0.22,1.931,0.818,3.748,1.778,5.362c0.899,1.555,2.197,2.908,3.815,4.006
			c1.637,1.021,3.835,1.58,6.632,1.58H110.5v26.552H81.716c-2.716,0-5.792-0.676-9.208-1.954c-3.396-1.337-6.592-3.251-9.548-5.74
			c-2.937-2.574-5.493-5.762-7.531-9.688c-2.077-3.929-3.097-8.496-3.097-13.701v-44.692c0-3.51-0.798-6.479-2.357-8.933
			c-1.558-2.449-3.415-4.424-5.573-5.879c-2.198-1.437-5.154-2.531-7.65-3.209c-2.497-0.679-4.534-1.058-6.252-1.058V881.82
			c1.718,0,3.755-0.338,6.252-1.016c2.497-0.68,5.453-1.813,7.65-3.431c2.158-1.615,4.015-3.769,5.573-6.459
			c1.559-2.671,2.357-5.938,2.357-9.788v-43.299c0-5.225,1.019-9.77,3.097-13.695c2.038-3.927,4.595-7.137,7.531-9.669
			c2.956-2.511,6.151-4.444,9.548-5.761c3.416-1.276,6.492-1.954,9.208-1.954H110.5v26.553L98.835,813.305L98.835,813.305z"/>
		
			<path id="brace-right--stroke_2_" fill="none" stroke="#8B2721" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="
			M98.835,813.305c-2.797,0-4.995,0.56-6.632,1.615c-1.618,1.057-2.916,2.413-3.815,3.987c-0.958,1.596-1.559,3.409-1.778,5.362
			c-0.24,1.955-0.339,3.848-0.339,5.664V864.6c0,5.642-0.958,10.166-2.776,13.576c-1.818,3.43-3.975,6.1-6.432,7.993
			c-2.496,1.874-5.073,3.25-7.811,3.985c-2.716,0.759-4.914,1.217-6.671,1.355v0.697c1.758,0.141,3.955,0.678,6.671,1.495
			c2.737,0.838,5.314,2.233,7.811,4.106c2.456,1.895,4.614,4.426,6.432,7.517c1.817,3.13,2.776,7.136,2.776,11.96v36.501
			c0,1.651,0.101,3.466,0.339,5.463c0.22,1.931,0.818,3.748,1.778,5.362c0.899,1.555,2.197,2.908,3.815,4.006
			c1.637,1.021,3.835,1.58,6.632,1.58H110.5v26.552H81.716c-2.716,0-5.792-0.676-9.208-1.954c-3.396-1.337-6.592-3.251-9.548-5.74
			c-2.937-2.574-5.493-5.762-7.531-9.688c-2.077-3.929-3.097-8.496-3.097-13.701v-44.692c0-3.51-0.798-6.479-2.357-8.933
			c-1.558-2.449-3.415-4.424-5.573-5.879c-2.198-1.437-5.154-2.531-7.65-3.209c-2.497-0.679-4.534-1.058-6.252-1.058V881.82
			c1.718,0,3.755-0.338,6.252-1.016c2.497-0.68,5.453-1.813,7.65-3.431c2.158-1.615,4.015-3.769,5.573-6.459
			c1.559-2.671,2.357-5.938,2.357-9.788v-43.299c0-5.225,1.019-9.77,3.097-13.695c2.038-3.927,4.595-7.137,7.531-9.669
			c2.956-2.511,6.151-4.444,9.548-5.761c3.416-1.276,6.492-1.954,9.208-1.954H110.5v26.553L98.835,813.305L98.835,813.305z"/>
	</g>
</g>
</svg></span><span data-reactid=".8pl0c1pw5c.0.0.0:1.0.0.0.1">Putain de code !</span></a></div><div class="r-Grid-cell r-minM--2of3" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1"><nav class="putainde-Nav" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0"><a class="putainde-Nav-item" href="/posts" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.0:$/posts"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.0:$/posts.0"><?xml version="1.0" encoding="utf-8"?>



<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">
<path id="bookmark-2-icon" d="M318.275,90v283.23L256,318.16l-62.275,55.07V90H318.275 M358.275,50H153.725v412L256,371.557
	L358.275,462V50L358.275,50z"/>
</svg></span><span data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.0:$/posts.1">Articles</span></a><a class="putainde-Nav-item" href="/c-est-quoi-putaindecode" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.0:$/c-est-quoi-putaindecode"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.0:$/c-est-quoi-putaindecode.0"><?xml version="1.0" encoding="utf-8"?>


<!-- The icon can be used freely in both personal and commercial projects with no attribution required, but always appreciated. 
You may NOT sub-license, resell, rent, redistribute or otherwise transfer the icon without express written permission from iconmonstr.com -->


<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

<path id="text-file-3-icon" d="M256,370.312h-84.495v-30H256V370.312z M339.495,314.896h-167.99v-30h167.99V314.896z

	 M339.495,259.562h-167.99v-30h167.99V259.562z M297.818,90v85.75h85.864V422H128.317V90H297.818 M322.818,50H88.317v412h335.365

	V150.75L322.818,50z"/>

</svg></span><span data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.0:$/c-est-quoi-putaindecode.1">Readme</span></a><a class="putainde-Nav-item" href="/posts/comment-contribuer" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.0:$/posts/comment-contribuer"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.0:$/posts/comment-contribuer.0"><?xml version="1.0" encoding="utf-8"?>


<!-- The icon can be used freely in both personal and commercial projects with no attribution required, but always appreciated. 
You may NOT sub-license, resell, rent, redistribute or otherwise transfer the icon without express written permission from iconmonstr.com -->


<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

<path id="pencil-2-icon" d="M74.686,340.686L50,460.949l122.365-22.584L379.52,231.211l-97.68-97.68L74.686,340.686z

	 M303.088,205.032l-181.891,181.89l-21.213-21.213l181.891-181.89L303.088,205.032z M462,148.731l-52.662,52.662l-97.682-97.68

	l52.662-52.663L462,148.731z"/>

</svg></span><span data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.0:$/posts/comment-contribuer.1">Participer</span></a><a href="https://github.com/putaindecode/" class="putainde-Nav-item putainde-Nav-item--icon r-Tooltip r-Tooltip r-Tooltip--bottom" data-r-tooltip="GitHub" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.1:$https=2//github=1com/putaindecode/"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.1:$https=2//github=1com/putaindecode/.0"><?xml version="1.0" encoding="utf-8"?>


<!-- The icon can be used freely in both personal and commercial projects with no attribution required, but always appreciated. 
You may NOT sub-license, resell, rent, redistribute or otherwise transfer the icon without express written permission from iconmonstr.com -->


<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

<path id="github-2-icon" d="M461.633,250.645l0.367-3.819c-22.896-2.221-45.667-2.419-67.79-0.73

	c3.557-11.347,5.43-24.164,5.295-38.739c-0.292-30.965-10.616-55.081-26.843-75.096c3.116-18.852,0.769-37.702-5.111-56.561

	c-23.187,1.898-44.053,9.493-62.634,22.686c-34.725-7.044-69.447-7.493-104.172,0c-21.673-14.627-42.956-21.802-63.909-22.686

	c-6.21,20.765-7.169,41.233-1.917,61.357c-18.28,19.397-25.268,42.944-24.925,69.019c0.196,14.927,2.496,28.209,6.738,39.952

	c-21.796-1.599-44.201-1.386-66.732,0.798l0.367,3.819c22.947-2.228,45.76-2.411,67.919-0.678c0.814,1.974,1.633,3.939,2.567,5.815

	c-24.009-0.633-45.618,1.453-65.854,6.43l0.914,3.723c20.538-5.048,42.54-7.081,67.107-6.254

	c16.246,28.864,47.52,45.824,93.063,51.205c-10.581,8.594-16.269,18.731-17.735,30.201c0,0-4.787,0-24.121,0

	c-32.394,0-41.226-41.304-74.779-37.229C132,320,125.5,371.599,177.587,371.599c17.506,0,21.226,0,21.881,0v47.296

	c0.234,7.643-3.093,12.754-8.469,16.297c18.654,1.884,32.674-7.43,32.674-18.854s0-56.948,0-62.518s5.833-6,5.833-6v72.992

	c0.245,7.265-3.284,11.392-7.031,15.339c16.434,0.654,31.892-2.629,32.592-16.615c0,0,0-66.345,0-69.857s5.756-3.599,5.756,0

	s0,66.58,0,66.58c0.169,11.8,10.361,21.367,31.953,19.893c-5.776-4.65-7.549-9.35-7.549-16.15s0-72.181,0-72.181s5.95-0.306,5.95,6

	s0,50.331,0,60.881c0,13.55,16.267,19.14,34.829,18.615c-6.081-4.558-10.196-9.991-10.223-17.256v-73.217

	c-0.629-10.762-5.003-20.906-13.582-30.358c41.63-6.392,71.637-23.011,86.578-52.796c24.647-0.847,46.715,1.183,67.307,6.246

	l0.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415c0.839-1.891,1.67-3.789,2.389-5.785

	C415.363,248.215,438.431,248.391,461.633,250.645z M114,310.023c-1.023,0-1.853-0.588-1.853-1.313c0-0.728,0.83-1.315,1.853-1.315

	c1.024,0,1.854,0.588,1.854,1.315C115.854,309.436,115.024,310.023,114,310.023z M119.833,314.003c-1.137,0-2.06-0.653-2.06-1.46

	s0.923-1.462,2.06-1.462s2.059,0.655,2.059,1.462S120.97,314.003,119.833,314.003z M125.75,319.172

	c-1.333,0-2.415-0.766-2.415-1.712s1.082-1.714,2.415-1.714c1.333,0,2.416,0.768,2.416,1.714S127.083,319.172,125.75,319.172z

	 M131.5,325.379c-1.56,0-2.825-0.896-2.825-2.003s1.265-2.005,2.825-2.005s2.825,0.898,2.825,2.005S133.06,325.379,131.5,325.379z

	 M137.833,332.394c-1.733,0-3.139-0.996-3.139-2.226s1.406-2.228,3.139-2.228s3.139,0.998,3.139,2.228

	S139.566,332.394,137.833,332.394z M145.167,339.517c-1.926,0-3.488-1.107-3.488-2.474s1.562-2.476,3.488-2.476

	c1.925,0,3.487,1.109,3.487,2.476S147.092,339.517,145.167,339.517z M155.083,346.291c-2.14,0-3.875-1.231-3.875-2.749

	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C158.958,345.06,157.223,346.291,155.083,346.291z M167.375,349.916

	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751

	C171.25,348.685,169.515,349.916,167.375,349.916z M180.333,350.333c-2.14,0-3.875-1.231-3.875-2.749

	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C184.208,349.102,182.473,350.333,180.333,350.333z M193.125,350.583

	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751

	C197,349.352,195.265,350.583,193.125,350.583z"/>

</svg></span></a><a href="https://twitter.com/putaindecode/" class="putainde-Nav-item putainde-Nav-item--icon r-Tooltip r-Tooltip r-Tooltip--bottom" data-r-tooltip="Twitter" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.1:$https=2//twitter=1com/putaindecode/"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.1:$https=2//twitter=1com/putaindecode/.0"><?xml version="1.0" encoding="utf-8"?>


<!-- The icon can be used freely in both personal and commercial projects with no attribution required, but always appreciated. 
You may NOT sub-license, resell, rent, redistribute or otherwise transfer the icon without express written permission from iconmonstr.com -->


<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

<path id="twitter-icon" d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764

	c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787

	c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574

	c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699

	C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435

	C436.339,160.061,450.668,145.174,462,128.223z"/>

</svg></span></a><a href="https://putaindecode-slack.herokuapp.com/" class="putainde-Nav-item putainde-Nav-item--icon r-Tooltip r-Tooltip r-Tooltip--bottom" data-r-tooltip="Slack" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.1:$https=2//putaindecode-slack=1herokuapp=1com/"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:1.0.1.0.1:$https=2//putaindecode-slack=1herokuapp=1com/.0"><?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">
<path d="M435.099,242.134c10.233,0,18.776,3.344,25.627,10.029c6.85,6.685,10.274,15.062,10.274,25.13
	c0,16.012-7.676,26.74-23.026,32.188l-42.587,14.608l13.865,41.349c1.155,3.467,1.734,7.345,1.734,11.637
	c0,9.739-3.467,18.157-10.399,25.256c-6.933,7.097-15.269,10.646-25.007,10.646c-7.759,0-14.815-2.228-21.17-6.686
	c-6.354-4.455-10.771-10.397-13.247-17.826l-13.618-40.853l-76.755,26.244l13.618,40.606c1.32,3.962,1.98,7.84,1.98,11.637
	c0,9.738-3.465,18.157-10.397,25.254C259.058,458.451,250.639,462,240.736,462c-7.759,0-14.773-2.228-21.046-6.686
	c-6.272-4.457-10.646-10.399-13.123-17.826l-13.618-40.358l-37.882,13.122c-4.786,1.486-8.913,2.229-12.379,2.229
	c-10.069,0-18.446-3.301-25.131-9.904c-6.686-6.602-10.028-14.938-10.028-25.007c0-7.758,2.27-14.772,6.809-21.045
	c4.539-6.273,10.44-10.647,17.703-13.123l38.625-13.122l-25.998-77.498l-38.625,13.37c-4.291,1.32-8.253,1.98-11.884,1.98
	c-9.904,0-18.24-3.342-25.007-10.027C62.384,251.42,59,243.125,59,233.221c0-7.758,2.27-14.772,6.809-21.045
	c4.54-6.272,10.441-10.646,17.703-13.122l38.873-13.123l-13.123-39.368c-1.32-3.962-1.98-7.84-1.98-11.637
	c0-9.904,3.466-18.364,10.399-25.379c6.933-7.015,15.351-10.522,25.255-10.522c7.758,0,14.773,2.228,21.045,6.685
	c6.272,4.457,10.647,10.399,13.123,17.827l13.37,39.616l76.754-25.998l-13.37-39.616c-1.32-3.961-1.981-7.84-1.981-11.636
	c0-9.739,3.508-18.158,10.522-25.255C269.415,53.549,277.793,50,287.531,50c7.758,0,14.814,2.27,21.17,6.809
	c6.354,4.54,10.77,10.441,13.245,17.703l13.123,39.863l40.111-13.618c3.467-0.99,7.016-1.485,10.646-1.485
	c9.904,0,18.364,3.26,25.379,9.78c7.016,6.521,10.522,14.65,10.522,24.389c0,7.428-2.476,14.154-7.427,20.179
	c-4.952,6.024-11.06,10.275-18.323,12.751l-38.872,13.37l25.997,78.24l40.607-13.864
	C427.67,242.795,431.468,242.134,435.099,242.134z M238.507,307.005l76.755-25.998l-25.998-77.993l-76.754,26.493L238.507,307.005z"
	/>
</svg></span></a></nav></div></div></div><div data-reactid=".8pl0c1pw5c.0.0.0:2"><div class="putainde-Main" data-reactid=".8pl0c1pw5c.0.0.0:2.3"><noscript data-reactid=".8pl0c1pw5c.0.0.0:2.3.0"></noscript><article class="putainde-Post" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1"><header data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0"><div class="putainde-Post-header" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.0"><h1 class="putainde-Title" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.0.2">Introduction au testing js front</h1></div><div class="putainde-Post-metas" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1"><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.0"><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.0.0">Écrit par </span><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.0.1"><a href="http://bloodyowl.github.io" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.0.1.0:$[object Object]">bloodyowl</a><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.0.1.0:$[object Object]-glue"></span></span></span><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.1">, </span><span class="putainde-Date" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.2"> le 1 mai 2014</span><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.3">. </span><span class="r-Tooltip r-Tooltip--top putainde-Post-readingTime" data-r-tooltip="Temps de lecture approximatif, sur une base de 250 mots par minute" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.4"><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.4.0">Temps de lecture : </span><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.1.4.2">environ 5 minutes</span></span></div><ul class="putainde-Tags putainde-Post-tags" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.2"><li class="putainde-Tag" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.2.$javascript">javascript</li><li class="putainde-Tag" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.2.$tape">tape</li><li class="putainde-Tag" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.2.$unit-test">unit-test</li><li class="putainde-Tag" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.0.2.$browserify">browserify</li></ul></header><div class="r-Grid" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1"><div class="r-Grid-cell r-all--8of12 putainde-Post-contents" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0"><div class="putainde-Post-md" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.0"><div data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.0.0"><p>Les tests automatisés en front-end ont longtemps été ignorés,
et le sont encore trop.</p>
<p>Écrire des tests peut paraître chiant, mais le temps qu’ils rapportent
compense largement celui que l’on passe à les écrire.</p>
<h2 id="crire-du-js-testable"><a class="markdownIt-Anchor" href="#crire-du-js-testable">#</a> Écrire du js testable</h2>
<p>Prenons un exemple simple et moche :</p>
<pre><code class="language-javascript"><span class="hljs-comment">//app.js</span>
;(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{

  <span class="hljs-keyword">var</span> cart = $(<span class="hljs-string">"#cart"</span>)
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addToCart</span>(<span class="hljs-params">id</span>)</span>{
    <span class="hljs-keyword">var</span> element = $(<span class="hljs-string">"&lt;li&gt;&lt;/li&gt;"</span>)
    element.html(catalog[id])
    cart.append(element)
  }

  $(<span class="hljs-string">".js-updateCart"</span>)
    .on(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">eventObject</span>)</span>{
      addToCart($(<span class="hljs-keyword">this</span>).data(<span class="hljs-string">"id"</span>))
    })

})()</code></pre>
<p>Tester ce code est particulièrement lourd, pour plusieurs raisons :</p>
<ul>
<li>les functions à tester ne sont pas accessibles</li>
<li>on doit simuler un <code>click</code> pour tester un comportement logique.</li>
<li>on doit créer un element et modifier son <code>data-id</code> à chaque cas souhaité.</li>
<li>pour tester <code>addToCart</code> on doit aller regarder dans le DOM.</li>
</ul>
<h3 id="1-rendez-accessibles-vos-m-thodes-au-test-runner"><a class="markdownIt-Anchor" href="#1-rendez-accessibles-vos-m-thodes-au-test-runner">#</a> 1. Rendez accessibles vos méthodes au test runner</h3>
<p>Vous pouvez utiliser un namespace adéquat.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> app = <span class="hljs-built_in">window</span>.app = {}
app.cart = {}
app.cart.addToCart = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ <span class="hljs-comment">/* … */</span> }</code></pre>
<p>Mais ne souhaitez probablement pas rendre vos méthodes accessibles à la console.</p>
<p>Utilisez un module-system : <a href="http://browserify.org">browserify</a> ou
<a href="http://requirejs.org">requirejs</a> (si vous n’avez pas besoin de chargement
conditionnel et souhaitez créer un bundle par build, utilisez browserify qui
possède une syntaxe beaucoup plus sympathique et une codebase réduite, vous
pourrez même <code>require</code> depuis un module npm
<a href="/posts/js/browserify-all-the-things/">comme on vous l’explique dans un article dédié</a>).</p>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> $ = <span class="hljs-built_in">require</span>(<span class="hljs-string">"jquery"</span>) <span class="hljs-comment">// oh, un module npm</span>

<span class="hljs-built_in">module</span>.exports = {
  element : $(<span class="hljs-string">"#cart"</span>),
  addToCart : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-comment">/* … */</span>
  }
}</code></pre>
<p>Vous pourrez ainsi séparer proprement votre application en modules et les tester individuellement.</p>
<h3 id="2-oui-mais-les-modules-interd-pendants-alors"><a class="markdownIt-Anchor" href="#2-oui-mais-les-modules-interd-pendants-alors">#</a> 2. Oui, mais les modules interdépendants alors ?</h3>
<p>Là, ça devient un peu plus tricky.
Ce que je conseille à titre personnel c’est d’utiliser des events
pour faire communiquer les différentes parties de l’application.</p>
<p>Cela permet d’éviter d’utiliser des mocks d’autres parties de l’application partout.</p>
<p>Par exemple, si je souhaite tester le fait qu’un click sur <code>.js-updateCart</code>
déclanchera bien <code>updateCart</code> :</p>
<pre><code class="language-javascript"><span class="hljs-comment">//view.js</span>

<span class="hljs-comment">// view est une petite class qui route les events</span>
<span class="hljs-comment">// en rendant les listeners accessibles aux tests</span>
<span class="hljs-comment">// vous pouvez très facilement en concevoir une</span>
<span class="hljs-comment">// à votre goût en quelques lignes de code</span>
<span class="hljs-keyword">var</span> view = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../lib/view"</span>)

<span class="hljs-comment">// eventbus est l'event bus de l'application, il orchestre</span>
<span class="hljs-comment">// la communication entre les différents modules</span>
<span class="hljs-keyword">var</span> eventbus = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../eventbus"</span>)

<span class="hljs-keyword">var</span> $ = <span class="hljs-built_in">require</span>(<span class="hljs-string">"jquery"</span>)

<span class="hljs-built_in">module</span>.exports = view.extend({
  element : <span class="hljs-built_in">document</span>.body,
  events : [
    {
      type : <span class="hljs-string">"click"</span>,
      selector : <span class="hljs-string">".js-addToCart"</span>,
      listener : <span class="hljs-string">"addToCart"</span>
    }
  ],
  addToCart : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">eventObject</span>)</span>{
    <span class="hljs-keyword">var</span> target = eventObject.currentTarget
    <span class="hljs-keyword">var</span> id = $(target).data(<span class="hljs-string">"id"</span>)
    eventbus.fire(<span class="hljs-string">"addToCart"</span>, {
      id : id
    })
  }
})</code></pre>
<p>et je n’aurais qu’à écouter cet event depuis <code>cart</code> :</p>
<pre><code class="language-javascript"><span class="hljs-comment">// cart.js</span>
<span class="hljs-keyword">var</span> eventbus = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../eventbus"</span>)
<span class="hljs-keyword">var</span> catalog = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../catalog"</span>)

<span class="hljs-built_in">module</span>.exports = {
  initialize : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">this</span>._addToCart = <span class="hljs-keyword">this</span>.addToCart.bind(<span class="hljs-keyword">this</span>)
    eventbus.listen(<span class="hljs-string">"addToCart"</span>, <span class="hljs-keyword">this</span>._addToCart)
  },
  release : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    eventbus.stopListening(<span class="hljs-string">"addToCart"</span>, <span class="hljs-keyword">this</span>._addToCart)
  },
  addToCart : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">eventObject</span>)</span>{
    <span class="hljs-comment">// et on a eventObject.id</span>
    <span class="hljs-keyword">this</span>.products.push(catalog[eventObject.currentTarget.data(<span class="hljs-string">"id"</span>)])
  }
}</code></pre>
<p>Grâce à cette architecture, je vais pouvoir tester individuellement
les deux modules.</p>
<pre><code class="language-javascript"><span class="hljs-comment">// view.test.js</span>

<span class="hljs-keyword">var</span> tape = <span class="hljs-built_in">require</span>(<span class="hljs-string">"tape"</span>)
<span class="hljs-keyword">var</span> view = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../app/view"</span>)
<span class="hljs-keyword">var</span> eventbus = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../eventbus"</span>)
<span class="hljs-keyword">var</span> $ = <span class="hljs-built_in">require</span>(<span class="hljs-string">"jquery"</span>)

tape(<span class="hljs-string">"view"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">test</span>)</span>{
  test.plan(<span class="hljs-number">1</span>)
  <span class="hljs-keyword">var</span> element = $(<span class="hljs-string">"&lt;div&gt;&lt;/div&gt;"</span>)
  element.data(<span class="hljs-string">"id"</span>, <span class="hljs-number">1</span>)
  <span class="hljs-comment">// on teste facilement l'envoi</span>
  eventbus.listen(<span class="hljs-string">"addToCart"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">eventObject</span>)</span>{
    test.equal(eventObject.id, <span class="hljs-number">1</span>)
  })
  view.addToCart({
    currentTarget : element
  })
})</code></pre>
<pre><code class="language-javascript"><span class="hljs-comment">// cart.test.js</span>

<span class="hljs-keyword">var</span> tape = <span class="hljs-built_in">require</span>(<span class="hljs-string">"tape"</span>)
<span class="hljs-keyword">var</span> cart = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../app/cart"</span>)
<span class="hljs-keyword">var</span> eventbus = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../eventbus"</span>)
<span class="hljs-keyword">var</span> catalog = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../catalog"</span>)

tape(<span class="hljs-string">"cart"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">test</span>)</span>{
  cart.initialize()
  eventbus.fireSync(<span class="hljs-string">"addToCart"</span>, {id:<span class="hljs-number">1</span>})
  test.deepEqual(
    cart[<span class="hljs-number">0</span>],
    catalog[<span class="hljs-number">1</span>],
    <span class="hljs-string">"receives addToCart event"</span>
  )
  test.end()
})</code></pre>
<h2 id="tester-tous-les-cas-possibles"><a class="markdownIt-Anchor" href="#tester-tous-les-cas-possibles">#</a> Tester tous les cas possibles</h2>
<p>Ce sont souvent les edge-cases qui nous font nous arracher les cheveux.
Pour pallier ces soucis, tester en profondeur est essentiel.</p>
<p>Prenons un exemple, une méthode qui teste si la valeur qu’on lui passe est
une <code>string</code>.</p>
<p>On serait tenté de simplement tester les résultats positifs de cette façon :</p>
<pre><code class="language-javascript">tape(<span class="hljs-string">"type.isString on strings"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">test</span>)</span>{
  test.equal(type.isString(<span class="hljs-string">""</span>), <span class="hljs-literal">true</span>)
  test.end()
})</code></pre>
<p>Or, si par mégarde ma méthode <code>isString</code> se révèle être :</p>
<pre><code class="language-javascript">type.isString = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value == <span class="hljs-string">"string"</span>
}</code></pre>
<p>on ne vérifie pas le cas <code>type.isString(new String(&quot;&quot;))</code>.</p>
<p>Du coup, des tests complets :</p>
<pre><code class="language-javascript">tape(<span class="hljs-string">"type.isString on strings"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">test</span>)</span>{
  test.equal(type.isString(<span class="hljs-string">""</span>), <span class="hljs-literal">true</span>)
  test.equal(type.isString(<span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(<span class="hljs-string">""</span>)), <span class="hljs-literal">false</span>)
  test.end()
})</code></pre>
<p>permettent ici d’identifier qu’en réalité on a besoin de :</p>
<pre><code class="language-javascript">type.isString = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.prototype.toString.call(value) == <span class="hljs-string">"[object String]"</span>
}</code></pre>
<p>Et c’est à la force des résultats de tests que vous identifierez rapidement
vous familiariserez à tous ces edge-cases.</p>
<p>À chaque correctif de bug, ajoutez des tests (mais ça, vous le saviez déjà).</p>
<h2 id="cross-browser-testing"><a class="markdownIt-Anchor" href="#cross-browser-testing">#</a> Cross-browser testing</h2>
<p>À l’heure actuelle, où l’on se trouve notamment très souvent avec du
feature testing.
Pour le tester complètement, on doit se servir de vrais navigateurs :
un headless (certes, très pratique) comme <a href="http://phantomjs.org">phantomjs</a>
ne permettra pas d’obtenir 100% de coverage.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> supportsAnimationFrame =
  !!(
    win.requestAnimationFrame ||
    win.webkitRequestAnimationFrame ||
    win.mozRequestAnimationFrame ||
    win.ORequestAnimationFrame ||
    <span class="hljs-comment">// vous avez fait une faute de frappe,</span>
    <span class="hljs-comment">// et mis un `O` majuscule, seul un</span>
    <span class="hljs-comment">// test sur les version concernées d'Opera</span>
    <span class="hljs-comment">// vous permettront de l'identifier</span>
    win.msRequestAnimationFrame
  )</code></pre>
<p>De plus, vous pouvez par habitude être tenté d’utiliser un
<code>Array.prototype.forEach</code> alors que votre scope navigateur inclut
IE8; seuls des tests sur un vrai browser vous permettront d’identifier le souci.</p>
<p>Je vous conseille fortement testling, très simple à intégrer dans vos
modules, et gratuit pour tout projet open-source.</p>
<p>Dans le <code>package.json</code> :</p>
<pre><code class="language-json">{
  "<span class="hljs-attribute">testling</span>": <span class="hljs-value">{
    "<span class="hljs-attribute">files</span>": <span class="hljs-value"><span class="hljs-string">"test/**/*.js"</span></span>,
    "<span class="hljs-attribute">browsers</span>": <span class="hljs-value">[
      <span class="hljs-string">"ie/9..latest"</span>,
      <span class="hljs-string">"chrome/22..latest"</span>,
      <span class="hljs-string">"firefox/16..latest"</span>,
      <span class="hljs-string">"safari/6..latest"</span>,
      <span class="hljs-string">"opera/11.0..latest"</span>,
      <span class="hljs-string">"iphone/6..latest"</span>,
      <span class="hljs-string">"ipad/6..latest"</span>,
      <span class="hljs-string">"android-browser/latest"</span>
    ]
  </span>}
</span>}</code></pre>
<p>Et ajouter un webhook dans l’admin de votre repository GitHub pointant vers</p>
<blockquote>
<p><a href="http://git.testling.com">http://git.testling.com</a></p>
</blockquote>
<p>Vous pouvez l’utiliser avec tape (son test harness par défaut)
Mocha, QUnit et n’importe quelle bibliothèque
de test supportant <code>TAP</code> comme indiqué sur
<a href="https://ci.testling.com/guide/custom_libraries">le site de testling</a>.</p>
<p>Vous trouverez aussi des alternatives populaires
<a href="http://www.browserstack.com">similaires</a>,
ou ayant <a href="http://karma-runner.github.io">une approche différente</a>.</p>
<p>Par ailleurs, si dans votre code il existe des variations entre les navigateurs,
vous pouvez utiliser du test conditionnel :</p>
<pre><code class="language-javascript"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> {}.__proto__ == <span class="hljs-string">"object"</span>){
  test.equal(list.__proto__ === <span class="hljs-built_in">Array</span>.prototype, <span class="hljs-literal">false</span>, <span class="hljs-string">"__proto__ isn't Array.prototype"</span>)
} <span class="hljs-keyword">else</span> {
  test.equal(list <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>, <span class="hljs-literal">false</span>, <span class="hljs-string">"Isn't a window Array"</span>)
}</code></pre>
<p>Happy testing!</p>
<pre><code class="language-console">$ testling

TAP version <span class="hljs-number">13</span>
<span class="hljs-preprocessor"># tests</span>
ok <span class="hljs-number">1</span> bisous

<span class="hljs-number">1.</span><span class="hljs-number">.1</span>
<span class="hljs-preprocessor"># tests <span class="hljs-number">1</span></span>
<span class="hljs-preprocessor"># pass  <span class="hljs-number">1</span></span>

<span class="hljs-preprocessor"># ok</span></code></pre>
</div></div><footer class="putainde-Post-footer" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1"><div data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0"><div class="putainde-Author undefined" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0"><a href="http://bloodyowl.github.io" class="putainde-Avatar putainde-Author-picture" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/1688645?v=3&amp;s=128" alt="" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.0.0"/></a><div class="putainde-Author-description" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1"><div class="putainde-Author-title" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0"><h3 class="putainde-Author-name" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.0"><span class="putainde-WrittenBy" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.0.0">Écrit par </span><a class="putainde-Link" href="http://bloodyowl.github.io" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.0.1">bloodyowl</a></h3><div class="putainde-Author-social" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.1"><a href="http://bloodyowl.github.io" class="r-Tooltip r-Tooltip--top" data-r-tooltip="Website" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.1.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.1.0.0"><?xml version="1.0" encoding="utf-8"?>


<!-- The icon can be used freely in both personal and commercial projects with no attribution required, but always appreciated. 
You may NOT sub-license, resell, rent, redistribute or otherwise transfer the icon without express written permission from iconmonstr.com -->


<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

<path id="home-5-icon" d="M394.072,174.805l-47.916-48.023V88.472h47.916V174.805z M462,275.815h-42.508v166.213H92.508V275.815H50

	L256,69.972L462,275.815z M296.847,271.972c-15.811-3.316-29.021,4.086-38.792,19.387c-9.771-15.301-22.98-22.703-38.789-19.387

	c-36.746,10.876-36.336,69.543,38.582,113.047C332.908,341.761,333.59,282.848,296.847,271.972z"/>

</svg></span></a><a href="https://twitter.com/bloodyowl" class="r-Tooltip r-Tooltip--top" data-r-tooltip="Twitter" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.1.1"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.1.1.0"><?xml version="1.0" encoding="utf-8"?>


<!-- The icon can be used freely in both personal and commercial projects with no attribution required, but always appreciated. 
You may NOT sub-license, resell, rent, redistribute or otherwise transfer the icon without express written permission from iconmonstr.com -->


<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

<path id="twitter-icon" d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764

	c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787

	c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574

	c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699

	C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435

	C436.339,160.061,450.668,145.174,462,128.223z"/>

</svg></span></a><a href="https://github.com/bloodyowl" class="r-Tooltip r-Tooltip--top" data-r-tooltip="Github" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.1.2"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.0.1.2.0"><?xml version="1.0" encoding="utf-8"?>


<!-- The icon can be used freely in both personal and commercial projects with no attribution required, but always appreciated. 
You may NOT sub-license, resell, rent, redistribute or otherwise transfer the icon without express written permission from iconmonstr.com -->


<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

<path id="github-2-icon" d="M461.633,250.645l0.367-3.819c-22.896-2.221-45.667-2.419-67.79-0.73

	c3.557-11.347,5.43-24.164,5.295-38.739c-0.292-30.965-10.616-55.081-26.843-75.096c3.116-18.852,0.769-37.702-5.111-56.561

	c-23.187,1.898-44.053,9.493-62.634,22.686c-34.725-7.044-69.447-7.493-104.172,0c-21.673-14.627-42.956-21.802-63.909-22.686

	c-6.21,20.765-7.169,41.233-1.917,61.357c-18.28,19.397-25.268,42.944-24.925,69.019c0.196,14.927,2.496,28.209,6.738,39.952

	c-21.796-1.599-44.201-1.386-66.732,0.798l0.367,3.819c22.947-2.228,45.76-2.411,67.919-0.678c0.814,1.974,1.633,3.939,2.567,5.815

	c-24.009-0.633-45.618,1.453-65.854,6.43l0.914,3.723c20.538-5.048,42.54-7.081,67.107-6.254

	c16.246,28.864,47.52,45.824,93.063,51.205c-10.581,8.594-16.269,18.731-17.735,30.201c0,0-4.787,0-24.121,0

	c-32.394,0-41.226-41.304-74.779-37.229C132,320,125.5,371.599,177.587,371.599c17.506,0,21.226,0,21.881,0v47.296

	c0.234,7.643-3.093,12.754-8.469,16.297c18.654,1.884,32.674-7.43,32.674-18.854s0-56.948,0-62.518s5.833-6,5.833-6v72.992

	c0.245,7.265-3.284,11.392-7.031,15.339c16.434,0.654,31.892-2.629,32.592-16.615c0,0,0-66.345,0-69.857s5.756-3.599,5.756,0

	s0,66.58,0,66.58c0.169,11.8,10.361,21.367,31.953,19.893c-5.776-4.65-7.549-9.35-7.549-16.15s0-72.181,0-72.181s5.95-0.306,5.95,6

	s0,50.331,0,60.881c0,13.55,16.267,19.14,34.829,18.615c-6.081-4.558-10.196-9.991-10.223-17.256v-73.217

	c-0.629-10.762-5.003-20.906-13.582-30.358c41.63-6.392,71.637-23.011,86.578-52.796c24.647-0.847,46.715,1.183,67.307,6.246

	l0.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415c0.839-1.891,1.67-3.789,2.389-5.785

	C415.363,248.215,438.431,248.391,461.633,250.645z M114,310.023c-1.023,0-1.853-0.588-1.853-1.313c0-0.728,0.83-1.315,1.853-1.315

	c1.024,0,1.854,0.588,1.854,1.315C115.854,309.436,115.024,310.023,114,310.023z M119.833,314.003c-1.137,0-2.06-0.653-2.06-1.46

	s0.923-1.462,2.06-1.462s2.059,0.655,2.059,1.462S120.97,314.003,119.833,314.003z M125.75,319.172

	c-1.333,0-2.415-0.766-2.415-1.712s1.082-1.714,2.415-1.714c1.333,0,2.416,0.768,2.416,1.714S127.083,319.172,125.75,319.172z

	 M131.5,325.379c-1.56,0-2.825-0.896-2.825-2.003s1.265-2.005,2.825-2.005s2.825,0.898,2.825,2.005S133.06,325.379,131.5,325.379z

	 M137.833,332.394c-1.733,0-3.139-0.996-3.139-2.226s1.406-2.228,3.139-2.228s3.139,0.998,3.139,2.228

	S139.566,332.394,137.833,332.394z M145.167,339.517c-1.926,0-3.488-1.107-3.488-2.474s1.562-2.476,3.488-2.476

	c1.925,0,3.487,1.109,3.487,2.476S147.092,339.517,145.167,339.517z M155.083,346.291c-2.14,0-3.875-1.231-3.875-2.749

	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C158.958,345.06,157.223,346.291,155.083,346.291z M167.375,349.916

	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751

	C171.25,348.685,169.515,349.916,167.375,349.916z M180.333,350.333c-2.14,0-3.875-1.231-3.875-2.749

	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C184.208,349.102,182.473,350.333,180.333,350.333z M193.125,350.583

	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751

	C197,349.352,195.265,350.583,193.125,350.583z"/>

</svg></span></a></div></div><p class="putainde-Author-bio" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.1"><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.0.0.1.1.0">Développeur front-end, aime la bonne bière artisanale, la musique, et JavaScript; n&#x27;aime ni les points virgules, ni les gens.</span></p></div></div></div><div class="putainde-Contributors" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2"><strong class="putainde-Contributors-label" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.0"><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.0.1">5 contributeurs sur cette page</span></strong><div class="r-Grid putainde-Contributors-actions" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.1"><div class="r-Grid-cell r-all--1of3" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.1.0"><a class="putainde-Contributors-action" href="https://github.com/putaindecode/putaindecode.fr/edit/master/content/posts/js/introduction-au-testing-js-front/index.md" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.1.0.0">Modifier</a></div><div class="r-Grid-cell r-all--1of3" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.1.1"><a class="putainde-Contributors-action" href="https://github.com/putaindecode/putaindecode.fr/blame/master/content/posts/js/introduction-au-testing-js-front/index.md" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.1.1.0">Tracer les changements</a></div><div class="r-Grid-cell r-all--1of3" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.1.2"><a class="putainde-Contributors-action" href="https://github.com/putaindecode/putaindecode.fr/commits/master/content/posts/js/introduction-au-testing-js-front/index.md" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.1.2.0">Historique</a></div></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="MoOx
(7 commits)" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$MoOx"><a href="http://moox.io/" class="putainde-Avatar putainde-Contributor-avatar" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$MoOx.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/157534?v=3&amp;s=128" alt="" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$MoOx.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="bloodyowl
(2 commits)" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$bloodyowl"><a href="http://bloodyowl.github.io" class="putainde-Avatar putainde-Contributor-avatar" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$bloodyowl.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/1688645?v=3&amp;s=128" alt="" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$bloodyowl.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="lionelB
(1 commit)" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$lionelB"><a href="http://lumographe.fr/" class="putainde-Avatar putainde-Contributor-avatar" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$lionelB.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/160320?v=3&amp;s=128" alt="" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$lionelB.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="Macxim
(1 commit)" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$Macxim"><a href="http://macx.im" class="putainde-Avatar putainde-Contributor-avatar" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$Macxim.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/1909957?v=3&amp;s=128" alt="" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$Macxim.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="gostbuster
(1 commit)" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$gostbuster"><a href="https://github.com/gostbuster" class="putainde-Avatar putainde-Contributor-avatar" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$gostbuster.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/1633593?v=3&amp;s=128" alt="" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.2.2:$gostbuster.0.0"/></a></div></div><div data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.3"><div id="disqus_thread" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.3.0"></div><noscript data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.3.1"><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.3.1.0"><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.3.1.0.0">Please enable JavaScript to view the</span><a href="http://disqus.com/?ref_noscript" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.3.1.0.1">comments powered by Disqus.</a></span></noscript><a href="http://disqus.com" class="dsq-brlink" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.3.2"><span data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.3.2.0">blog comments powered by</span><span class="logo-disqus" data-reactid=".8pl0c1pw5c.0.0.0:2.3.1.1.0.1.3.2.1">Disqus</span></a></div></footer></div></div></article></div></div><div class="putainde-Footer" data-reactid=".8pl0c1pw5c.0.0.0:3"><div class="r-Grid" data-reactid=".8pl0c1pw5c.0.0.0:3.0"><div class="r-Grid-cell r-minM--1of4" data-reactid=".8pl0c1pw5c.0.0.0:3.0.0"><p class="putainde-Footer-text" data-reactid=".8pl0c1pw5c.0.0.0:3.0.0.0">© 1970 - 2015 Putain de code !</p></div><div class="r-Grid-cell r-minM--2of4" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1"><ul class="putainde-Footer-list" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0"><li data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.0:$/feed=1xml"><a class="" href="/feed.xml" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.0:$/feed=1xml.0">Flux RSS</a></li><li data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.0:$/projets"><a class="" href="/projets" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.0:$/projets.0">Projets</a></li><li data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/forum/issues"><a class="" href="https://github.com/putaindecode/forum/issues" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/forum/issues.0">Forum</a></li><li data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/"><a href="https://github.com/putaindecode/" data-r-tooltip="GitHub" class="r-Tooltip r-Tooltip--top" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/.0.0"><?xml version="1.0" encoding="utf-8"?>


<!-- The icon can be used freely in both personal and commercial projects with no attribution required, but always appreciated. 
You may NOT sub-license, resell, rent, redistribute or otherwise transfer the icon without express written permission from iconmonstr.com -->


<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

<path id="github-2-icon" d="M461.633,250.645l0.367-3.819c-22.896-2.221-45.667-2.419-67.79-0.73

	c3.557-11.347,5.43-24.164,5.295-38.739c-0.292-30.965-10.616-55.081-26.843-75.096c3.116-18.852,0.769-37.702-5.111-56.561

	c-23.187,1.898-44.053,9.493-62.634,22.686c-34.725-7.044-69.447-7.493-104.172,0c-21.673-14.627-42.956-21.802-63.909-22.686

	c-6.21,20.765-7.169,41.233-1.917,61.357c-18.28,19.397-25.268,42.944-24.925,69.019c0.196,14.927,2.496,28.209,6.738,39.952

	c-21.796-1.599-44.201-1.386-66.732,0.798l0.367,3.819c22.947-2.228,45.76-2.411,67.919-0.678c0.814,1.974,1.633,3.939,2.567,5.815

	c-24.009-0.633-45.618,1.453-65.854,6.43l0.914,3.723c20.538-5.048,42.54-7.081,67.107-6.254

	c16.246,28.864,47.52,45.824,93.063,51.205c-10.581,8.594-16.269,18.731-17.735,30.201c0,0-4.787,0-24.121,0

	c-32.394,0-41.226-41.304-74.779-37.229C132,320,125.5,371.599,177.587,371.599c17.506,0,21.226,0,21.881,0v47.296

	c0.234,7.643-3.093,12.754-8.469,16.297c18.654,1.884,32.674-7.43,32.674-18.854s0-56.948,0-62.518s5.833-6,5.833-6v72.992

	c0.245,7.265-3.284,11.392-7.031,15.339c16.434,0.654,31.892-2.629,32.592-16.615c0,0,0-66.345,0-69.857s5.756-3.599,5.756,0

	s0,66.58,0,66.58c0.169,11.8,10.361,21.367,31.953,19.893c-5.776-4.65-7.549-9.35-7.549-16.15s0-72.181,0-72.181s5.95-0.306,5.95,6

	s0,50.331,0,60.881c0,13.55,16.267,19.14,34.829,18.615c-6.081-4.558-10.196-9.991-10.223-17.256v-73.217

	c-0.629-10.762-5.003-20.906-13.582-30.358c41.63-6.392,71.637-23.011,86.578-52.796c24.647-0.847,46.715,1.183,67.307,6.246

	l0.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415c0.839-1.891,1.67-3.789,2.389-5.785

	C415.363,248.215,438.431,248.391,461.633,250.645z M114,310.023c-1.023,0-1.853-0.588-1.853-1.313c0-0.728,0.83-1.315,1.853-1.315

	c1.024,0,1.854,0.588,1.854,1.315C115.854,309.436,115.024,310.023,114,310.023z M119.833,314.003c-1.137,0-2.06-0.653-2.06-1.46

	s0.923-1.462,2.06-1.462s2.059,0.655,2.059,1.462S120.97,314.003,119.833,314.003z M125.75,319.172

	c-1.333,0-2.415-0.766-2.415-1.712s1.082-1.714,2.415-1.714c1.333,0,2.416,0.768,2.416,1.714S127.083,319.172,125.75,319.172z

	 M131.5,325.379c-1.56,0-2.825-0.896-2.825-2.003s1.265-2.005,2.825-2.005s2.825,0.898,2.825,2.005S133.06,325.379,131.5,325.379z

	 M137.833,332.394c-1.733,0-3.139-0.996-3.139-2.226s1.406-2.228,3.139-2.228s3.139,0.998,3.139,2.228

	S139.566,332.394,137.833,332.394z M145.167,339.517c-1.926,0-3.488-1.107-3.488-2.474s1.562-2.476,3.488-2.476

	c1.925,0,3.487,1.109,3.487,2.476S147.092,339.517,145.167,339.517z M155.083,346.291c-2.14,0-3.875-1.231-3.875-2.749

	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C158.958,345.06,157.223,346.291,155.083,346.291z M167.375,349.916

	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751

	C171.25,348.685,169.515,349.916,167.375,349.916z M180.333,350.333c-2.14,0-3.875-1.231-3.875-2.749

	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C184.208,349.102,182.473,350.333,180.333,350.333z M193.125,350.583

	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751

	C197,349.352,195.265,350.583,193.125,350.583z"/>

</svg></span></a></li><li data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//twitter=1com/putaindecode/"><a href="https://twitter.com/putaindecode/" data-r-tooltip="Twitter" class="r-Tooltip r-Tooltip--top" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//twitter=1com/putaindecode/.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//twitter=1com/putaindecode/.0.0"><?xml version="1.0" encoding="utf-8"?>


<!-- The icon can be used freely in both personal and commercial projects with no attribution required, but always appreciated. 
You may NOT sub-license, resell, rent, redistribute or otherwise transfer the icon without express written permission from iconmonstr.com -->


<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"

	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">

<path id="twitter-icon" d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764

	c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787

	c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574

	c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699

	C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435

	C436.339,160.061,450.668,145.174,462,128.223z"/>

</svg></span></a></li><li data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//putaindecode-slack=1herokuapp=1com/"><a href="https://putaindecode-slack.herokuapp.com/" data-r-tooltip="Slack" class="r-Tooltip r-Tooltip--top" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//putaindecode-slack=1herokuapp=1com/.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".8pl0c1pw5c.0.0.0:3.0.1.0.$https=2//putaindecode-slack=1herokuapp=1com/.0.0"><?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve">
<path d="M435.099,242.134c10.233,0,18.776,3.344,25.627,10.029c6.85,6.685,10.274,15.062,10.274,25.13
	c0,16.012-7.676,26.74-23.026,32.188l-42.587,14.608l13.865,41.349c1.155,3.467,1.734,7.345,1.734,11.637
	c0,9.739-3.467,18.157-10.399,25.256c-6.933,7.097-15.269,10.646-25.007,10.646c-7.759,0-14.815-2.228-21.17-6.686
	c-6.354-4.455-10.771-10.397-13.247-17.826l-13.618-40.853l-76.755,26.244l13.618,40.606c1.32,3.962,1.98,7.84,1.98,11.637
	c0,9.738-3.465,18.157-10.397,25.254C259.058,458.451,250.639,462,240.736,462c-7.759,0-14.773-2.228-21.046-6.686
	c-6.272-4.457-10.646-10.399-13.123-17.826l-13.618-40.358l-37.882,13.122c-4.786,1.486-8.913,2.229-12.379,2.229
	c-10.069,0-18.446-3.301-25.131-9.904c-6.686-6.602-10.028-14.938-10.028-25.007c0-7.758,2.27-14.772,6.809-21.045
	c4.539-6.273,10.44-10.647,17.703-13.123l38.625-13.122l-25.998-77.498l-38.625,13.37c-4.291,1.32-8.253,1.98-11.884,1.98
	c-9.904,0-18.24-3.342-25.007-10.027C62.384,251.42,59,243.125,59,233.221c0-7.758,2.27-14.772,6.809-21.045
	c4.54-6.272,10.441-10.646,17.703-13.122l38.873-13.123l-13.123-39.368c-1.32-3.962-1.98-7.84-1.98-11.637
	c0-9.904,3.466-18.364,10.399-25.379c6.933-7.015,15.351-10.522,25.255-10.522c7.758,0,14.773,2.228,21.045,6.685
	c6.272,4.457,10.647,10.399,13.123,17.827l13.37,39.616l76.754-25.998l-13.37-39.616c-1.32-3.961-1.981-7.84-1.981-11.636
	c0-9.739,3.508-18.158,10.522-25.255C269.415,53.549,277.793,50,287.531,50c7.758,0,14.814,2.27,21.17,6.809
	c6.354,4.54,10.77,10.441,13.245,17.703l13.123,39.863l40.111-13.618c3.467-0.99,7.016-1.485,10.646-1.485
	c9.904,0,18.364,3.26,25.379,9.78c7.016,6.521,10.522,14.65,10.522,24.389c0,7.428-2.476,14.154-7.427,20.179
	c-4.952,6.024-11.06,10.275-18.323,12.751l-38.872,13.37l25.997,78.24l40.607-13.864
	C427.67,242.795,431.468,242.134,435.099,242.134z M238.507,307.005l76.755-25.998l-25.998-77.993l-76.754,26.493L238.507,307.005z"
	/>
</svg></span></a></li></ul></div><div class="r-Grid-cell r-minM--1of4 putainde-Footer-text--right" data-reactid=".8pl0c1pw5c.0.0.0:3.0.2"><span class="putainde-Footer-text putainde-Footer-text--small" data-reactid=".8pl0c1pw5c.0.0.0:3.0.2.0">Made with ♥︎</span></div></div></div><script data-reactid=".8pl0c1pw5c.0.0.1"></script></div></div></div></div><script>window.__INITIAL_STATE__ = {"pages":{"posts/js/introduction-au-testing-js-front":{"head":{"layout":"Post","comments":true,"date":"2014-05-01","title":"Introduction au testing js front","tags":["javascript","tape","unit-test","browserify"],"authors":["bloodyowl"]},"body":"<p>Les tests automatisés en front-end ont longtemps été ignorés,\net le sont encore trop.</p>\n<p>Écrire des tests peut paraître chiant, mais le temps qu’ils rapportent\ncompense largement celui que l’on passe à les écrire.</p>\n<h2 id=\"crire-du-js-testable\"><a class=\"markdownIt-Anchor\" href=\"#crire-du-js-testable\">#</a> Écrire du js testable</h2>\n<p>Prenons un exemple simple et moche :</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-comment\">//app.js</span>\n;(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>{\n\n  <span class=\"hljs-keyword\">var</span> cart = $(<span class=\"hljs-string\">\"#cart\"</span>)\n  <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">addToCart</span>(<span class=\"hljs-params\">id</span>)</span>{\n    <span class=\"hljs-keyword\">var</span> element = $(<span class=\"hljs-string\">\"&lt;li&gt;&lt;/li&gt;\"</span>)\n    element.html(catalog[id])\n    cart.append(element)\n  }\n\n  $(<span class=\"hljs-string\">\".js-updateCart\"</span>)\n    .on(<span class=\"hljs-string\">\"click\"</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">eventObject</span>)</span>{\n      addToCart($(<span class=\"hljs-keyword\">this</span>).data(<span class=\"hljs-string\">\"id\"</span>))\n    })\n\n})()</code></pre>\n<p>Tester ce code est particulièrement lourd, pour plusieurs raisons :</p>\n<ul>\n<li>les functions à tester ne sont pas accessibles</li>\n<li>on doit simuler un <code>click</code> pour tester un comportement logique.</li>\n<li>on doit créer un element et modifier son <code>data-id</code> à chaque cas souhaité.</li>\n<li>pour tester <code>addToCart</code> on doit aller regarder dans le DOM.</li>\n</ul>\n<h3 id=\"1-rendez-accessibles-vos-m-thodes-au-test-runner\"><a class=\"markdownIt-Anchor\" href=\"#1-rendez-accessibles-vos-m-thodes-au-test-runner\">#</a> 1. Rendez accessibles vos méthodes au test runner</h3>\n<p>Vous pouvez utiliser un namespace adéquat.</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-built_in\">window</span>.app = {}\napp.cart = {}\napp.cart.addToCart = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>{ <span class=\"hljs-comment\">/* … */</span> }</code></pre>\n<p>Mais ne souhaitez probablement pas rendre vos méthodes accessibles à la console.</p>\n<p>Utilisez un module-system : <a href=\"http://browserify.org\">browserify</a> ou\n<a href=\"http://requirejs.org\">requirejs</a> (si vous n’avez pas besoin de chargement\nconditionnel et souhaitez créer un bundle par build, utilisez browserify qui\npossède une syntaxe beaucoup plus sympathique et une codebase réduite, vous\npourrez même <code>require</code> depuis un module npm\n<a href=\"/posts/js/browserify-all-the-things/\">comme on vous l’explique dans un article dédié</a>).</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> $ = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"jquery\"</span>) <span class=\"hljs-comment\">// oh, un module npm</span>\n\n<span class=\"hljs-built_in\">module</span>.exports = {\n  element : $(<span class=\"hljs-string\">\"#cart\"</span>),\n  addToCart : <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>{\n    <span class=\"hljs-comment\">/* … */</span>\n  }\n}</code></pre>\n<p>Vous pourrez ainsi séparer proprement votre application en modules et les tester individuellement.</p>\n<h3 id=\"2-oui-mais-les-modules-interd-pendants-alors\"><a class=\"markdownIt-Anchor\" href=\"#2-oui-mais-les-modules-interd-pendants-alors\">#</a> 2. Oui, mais les modules interdépendants alors ?</h3>\n<p>Là, ça devient un peu plus tricky.\nCe que je conseille à titre personnel c’est d’utiliser des events\npour faire communiquer les différentes parties de l’application.</p>\n<p>Cela permet d’éviter d’utiliser des mocks d’autres parties de l’application partout.</p>\n<p>Par exemple, si je souhaite tester le fait qu’un click sur <code>.js-updateCart</code>\ndéclanchera bien <code>updateCart</code> :</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-comment\">//view.js</span>\n\n<span class=\"hljs-comment\">// view est une petite class qui route les events</span>\n<span class=\"hljs-comment\">// en rendant les listeners accessibles aux tests</span>\n<span class=\"hljs-comment\">// vous pouvez très facilement en concevoir une</span>\n<span class=\"hljs-comment\">// à votre goût en quelques lignes de code</span>\n<span class=\"hljs-keyword\">var</span> view = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"../lib/view\"</span>)\n\n<span class=\"hljs-comment\">// eventbus est l'event bus de l'application, il orchestre</span>\n<span class=\"hljs-comment\">// la communication entre les différents modules</span>\n<span class=\"hljs-keyword\">var</span> eventbus = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"../eventbus\"</span>)\n\n<span class=\"hljs-keyword\">var</span> $ = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"jquery\"</span>)\n\n<span class=\"hljs-built_in\">module</span>.exports = view.extend({\n  element : <span class=\"hljs-built_in\">document</span>.body,\n  events : [\n    {\n      type : <span class=\"hljs-string\">\"click\"</span>,\n      selector : <span class=\"hljs-string\">\".js-addToCart\"</span>,\n      listener : <span class=\"hljs-string\">\"addToCart\"</span>\n    }\n  ],\n  addToCart : <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">eventObject</span>)</span>{\n    <span class=\"hljs-keyword\">var</span> target = eventObject.currentTarget\n    <span class=\"hljs-keyword\">var</span> id = $(target).data(<span class=\"hljs-string\">\"id\"</span>)\n    eventbus.fire(<span class=\"hljs-string\">\"addToCart\"</span>, {\n      id : id\n    })\n  }\n})</code></pre>\n<p>et je n’aurais qu’à écouter cet event depuis <code>cart</code> :</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-comment\">// cart.js</span>\n<span class=\"hljs-keyword\">var</span> eventbus = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"../eventbus\"</span>)\n<span class=\"hljs-keyword\">var</span> catalog = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"../catalog\"</span>)\n\n<span class=\"hljs-built_in\">module</span>.exports = {\n  initialize : <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>{\n    <span class=\"hljs-keyword\">this</span>._addToCart = <span class=\"hljs-keyword\">this</span>.addToCart.bind(<span class=\"hljs-keyword\">this</span>)\n    eventbus.listen(<span class=\"hljs-string\">\"addToCart\"</span>, <span class=\"hljs-keyword\">this</span>._addToCart)\n  },\n  release : <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>{\n    eventbus.stopListening(<span class=\"hljs-string\">\"addToCart\"</span>, <span class=\"hljs-keyword\">this</span>._addToCart)\n  },\n  addToCart : <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">eventObject</span>)</span>{\n    <span class=\"hljs-comment\">// et on a eventObject.id</span>\n    <span class=\"hljs-keyword\">this</span>.products.push(catalog[eventObject.currentTarget.data(<span class=\"hljs-string\">\"id\"</span>)])\n  }\n}</code></pre>\n<p>Grâce à cette architecture, je vais pouvoir tester individuellement\nles deux modules.</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-comment\">// view.test.js</span>\n\n<span class=\"hljs-keyword\">var</span> tape = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"tape\"</span>)\n<span class=\"hljs-keyword\">var</span> view = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"../app/view\"</span>)\n<span class=\"hljs-keyword\">var</span> eventbus = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"../eventbus\"</span>)\n<span class=\"hljs-keyword\">var</span> $ = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"jquery\"</span>)\n\ntape(<span class=\"hljs-string\">\"view\"</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">test</span>)</span>{\n  test.plan(<span class=\"hljs-number\">1</span>)\n  <span class=\"hljs-keyword\">var</span> element = $(<span class=\"hljs-string\">\"&lt;div&gt;&lt;/div&gt;\"</span>)\n  element.data(<span class=\"hljs-string\">\"id\"</span>, <span class=\"hljs-number\">1</span>)\n  <span class=\"hljs-comment\">// on teste facilement l'envoi</span>\n  eventbus.listen(<span class=\"hljs-string\">\"addToCart\"</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">eventObject</span>)</span>{\n    test.equal(eventObject.id, <span class=\"hljs-number\">1</span>)\n  })\n  view.addToCart({\n    currentTarget : element\n  })\n})</code></pre>\n<pre><code class=\"language-javascript\"><span class=\"hljs-comment\">// cart.test.js</span>\n\n<span class=\"hljs-keyword\">var</span> tape = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"tape\"</span>)\n<span class=\"hljs-keyword\">var</span> cart = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"../app/cart\"</span>)\n<span class=\"hljs-keyword\">var</span> eventbus = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"../eventbus\"</span>)\n<span class=\"hljs-keyword\">var</span> catalog = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"../catalog\"</span>)\n\ntape(<span class=\"hljs-string\">\"cart\"</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">test</span>)</span>{\n  cart.initialize()\n  eventbus.fireSync(<span class=\"hljs-string\">\"addToCart\"</span>, {id:<span class=\"hljs-number\">1</span>})\n  test.deepEqual(\n    cart[<span class=\"hljs-number\">0</span>],\n    catalog[<span class=\"hljs-number\">1</span>],\n    <span class=\"hljs-string\">\"receives addToCart event\"</span>\n  )\n  test.end()\n})</code></pre>\n<h2 id=\"tester-tous-les-cas-possibles\"><a class=\"markdownIt-Anchor\" href=\"#tester-tous-les-cas-possibles\">#</a> Tester tous les cas possibles</h2>\n<p>Ce sont souvent les edge-cases qui nous font nous arracher les cheveux.\nPour pallier ces soucis, tester en profondeur est essentiel.</p>\n<p>Prenons un exemple, une méthode qui teste si la valeur qu’on lui passe est\nune <code>string</code>.</p>\n<p>On serait tenté de simplement tester les résultats positifs de cette façon :</p>\n<pre><code class=\"language-javascript\">tape(<span class=\"hljs-string\">\"type.isString on strings\"</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">test</span>)</span>{\n  test.equal(type.isString(<span class=\"hljs-string\">\"\"</span>), <span class=\"hljs-literal\">true</span>)\n  test.end()\n})</code></pre>\n<p>Or, si par mégarde ma méthode <code>isString</code> se révèle être :</p>\n<pre><code class=\"language-javascript\">type.isString = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">value</span>) </span>{\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">typeof</span> value == <span class=\"hljs-string\">\"string\"</span>\n}</code></pre>\n<p>on ne vérifie pas le cas <code>type.isString(new String(&quot;&quot;))</code>.</p>\n<p>Du coup, des tests complets :</p>\n<pre><code class=\"language-javascript\">tape(<span class=\"hljs-string\">\"type.isString on strings\"</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">test</span>)</span>{\n  test.equal(type.isString(<span class=\"hljs-string\">\"\"</span>), <span class=\"hljs-literal\">true</span>)\n  test.equal(type.isString(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">String</span>(<span class=\"hljs-string\">\"\"</span>)), <span class=\"hljs-literal\">false</span>)\n  test.end()\n})</code></pre>\n<p>permettent ici d’identifier qu’en réalité on a besoin de :</p>\n<pre><code class=\"language-javascript\">type.isString = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">value</span>) </span>{\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">Object</span>.prototype.toString.call(value) == <span class=\"hljs-string\">\"[object String]\"</span>\n}</code></pre>\n<p>Et c’est à la force des résultats de tests que vous identifierez rapidement\nvous familiariserez à tous ces edge-cases.</p>\n<p>À chaque correctif de bug, ajoutez des tests (mais ça, vous le saviez déjà).</p>\n<h2 id=\"cross-browser-testing\"><a class=\"markdownIt-Anchor\" href=\"#cross-browser-testing\">#</a> Cross-browser testing</h2>\n<p>À l’heure actuelle, où l’on se trouve notamment très souvent avec du\nfeature testing.\nPour le tester complètement, on doit se servir de vrais navigateurs :\nun headless (certes, très pratique) comme <a href=\"http://phantomjs.org\">phantomjs</a>\nne permettra pas d’obtenir 100% de coverage.</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> supportsAnimationFrame =\n  !!(\n    win.requestAnimationFrame ||\n    win.webkitRequestAnimationFrame ||\n    win.mozRequestAnimationFrame ||\n    win.ORequestAnimationFrame ||\n    <span class=\"hljs-comment\">// vous avez fait une faute de frappe,</span>\n    <span class=\"hljs-comment\">// et mis un `O` majuscule, seul un</span>\n    <span class=\"hljs-comment\">// test sur les version concernées d'Opera</span>\n    <span class=\"hljs-comment\">// vous permettront de l'identifier</span>\n    win.msRequestAnimationFrame\n  )</code></pre>\n<p>De plus, vous pouvez par habitude être tenté d’utiliser un\n<code>Array.prototype.forEach</code> alors que votre scope navigateur inclut\nIE8; seuls des tests sur un vrai browser vous permettront d’identifier le souci.</p>\n<p>Je vous conseille fortement testling, très simple à intégrer dans vos\nmodules, et gratuit pour tout projet open-source.</p>\n<p>Dans le <code>package.json</code> :</p>\n<pre><code class=\"language-json\">{\n  \"<span class=\"hljs-attribute\">testling</span>\": <span class=\"hljs-value\">{\n    \"<span class=\"hljs-attribute\">files</span>\": <span class=\"hljs-value\"><span class=\"hljs-string\">\"test/**/*.js\"</span></span>,\n    \"<span class=\"hljs-attribute\">browsers</span>\": <span class=\"hljs-value\">[\n      <span class=\"hljs-string\">\"ie/9..latest\"</span>,\n      <span class=\"hljs-string\">\"chrome/22..latest\"</span>,\n      <span class=\"hljs-string\">\"firefox/16..latest\"</span>,\n      <span class=\"hljs-string\">\"safari/6..latest\"</span>,\n      <span class=\"hljs-string\">\"opera/11.0..latest\"</span>,\n      <span class=\"hljs-string\">\"iphone/6..latest\"</span>,\n      <span class=\"hljs-string\">\"ipad/6..latest\"</span>,\n      <span class=\"hljs-string\">\"android-browser/latest\"</span>\n    ]\n  </span>}\n</span>}</code></pre>\n<p>Et ajouter un webhook dans l’admin de votre repository GitHub pointant vers</p>\n<blockquote>\n<p><a href=\"http://git.testling.com\">http://git.testling.com</a></p>\n</blockquote>\n<p>Vous pouvez l’utiliser avec tape (son test harness par défaut)\nMocha, QUnit et n’importe quelle bibliothèque\nde test supportant <code>TAP</code> comme indiqué sur\n<a href=\"https://ci.testling.com/guide/custom_libraries\">le site de testling</a>.</p>\n<p>Vous trouverez aussi des alternatives populaires\n<a href=\"http://www.browserstack.com\">similaires</a>,\nou ayant <a href=\"http://karma-runner.github.io\">une approche différente</a>.</p>\n<p>Par ailleurs, si dans votre code il existe des variations entre les navigateurs,\nvous pouvez utiliser du test conditionnel :</p>\n<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">typeof</span> {}.__proto__ == <span class=\"hljs-string\">\"object\"</span>){\n  test.equal(list.__proto__ === <span class=\"hljs-built_in\">Array</span>.prototype, <span class=\"hljs-literal\">false</span>, <span class=\"hljs-string\">\"__proto__ isn't Array.prototype\"</span>)\n} <span class=\"hljs-keyword\">else</span> {\n  test.equal(list <span class=\"hljs-keyword\">instanceof</span> <span class=\"hljs-built_in\">Array</span>, <span class=\"hljs-literal\">false</span>, <span class=\"hljs-string\">\"Isn't a window Array\"</span>)\n}</code></pre>\n<p>Happy testing!</p>\n<pre><code class=\"language-console\">$ testling\n\nTAP version <span class=\"hljs-number\">13</span>\n<span class=\"hljs-preprocessor\"># tests</span>\nok <span class=\"hljs-number\">1</span> bisous\n\n<span class=\"hljs-number\">1.</span><span class=\"hljs-number\">.1</span>\n<span class=\"hljs-preprocessor\"># tests <span class=\"hljs-number\">1</span></span>\n<span class=\"hljs-preprocessor\"># pass  <span class=\"hljs-number\">1</span></span>\n\n<span class=\"hljs-preprocessor\"># ok</span></code></pre>\n","rawBody":"\nLes tests automatisés en front-end ont longtemps été ignorés,\net le sont encore trop.\n\nÉcrire des tests peut paraître chiant, mais le temps qu'ils rapportent\ncompense largement celui que l'on passe à les écrire.\n\n## Écrire du js testable\n\nPrenons un exemple simple et moche :\n\n```javascript\n//app.js\n;(function(){\n\n  var cart = $(\"#cart\")\n  function addToCart(id){\n    var element = $(\"<li></li>\")\n    element.html(catalog[id])\n    cart.append(element)\n  }\n\n  $(\".js-updateCart\")\n    .on(\"click\", function(eventObject){\n      addToCart($(this).data(\"id\"))\n    })\n\n})()\n```\n\nTester ce code est particulièrement lourd, pour plusieurs raisons :\n\n- les functions à tester ne sont pas accessibles\n- on doit simuler un `click` pour tester un comportement logique.\n- on doit créer un element et modifier son `data-id` à chaque cas souhaité.\n- pour tester `addToCart` on doit aller regarder dans le DOM.\n\n### 1. Rendez accessibles vos méthodes au test runner\n\nVous pouvez utiliser un namespace adéquat.\n\n```javascript\nvar app = window.app = {}\napp.cart = {}\napp.cart.addToCart = function(){ /* … */ }\n```\n\nMais ne souhaitez probablement pas rendre vos méthodes accessibles à la console.\n\nUtilisez un module-system : [browserify](http://browserify.org) ou\n[requirejs](http://requirejs.org) (si vous n'avez pas besoin de chargement\nconditionnel et souhaitez créer un bundle par build, utilisez browserify qui\npossède une syntaxe beaucoup plus sympathique et une codebase réduite, vous\npourrez même `require` depuis un module npm\n[comme on vous l'explique dans un article dédié](/posts/js/browserify-all-the-things/)).\n\n```javascript\nvar $ = require(\"jquery\") // oh, un module npm\n\nmodule.exports = {\n  element : $(\"#cart\"),\n  addToCart : function(){\n    /* … */\n  }\n}\n```\n\nVous pourrez ainsi séparer proprement votre application en modules et les tester individuellement.\n\n### 2. Oui, mais les modules interdépendants alors ?\n\nLà, ça devient un peu plus tricky.\nCe que je conseille à titre personnel c'est d'utiliser des events\npour faire communiquer les différentes parties de l'application.\n\nCela permet d'éviter d'utiliser des mocks d'autres parties de l'application partout.\n\nPar exemple, si je souhaite tester le fait qu'un click sur `.js-updateCart`\ndéclanchera bien `updateCart` :\n\n```javascript\n//view.js\n\n// view est une petite class qui route les events\n// en rendant les listeners accessibles aux tests\n// vous pouvez très facilement en concevoir une\n// à votre goût en quelques lignes de code\nvar view = require(\"../lib/view\")\n\n// eventbus est l'event bus de l'application, il orchestre\n// la communication entre les différents modules\nvar eventbus = require(\"../eventbus\")\n\nvar $ = require(\"jquery\")\n\nmodule.exports = view.extend({\n  element : document.body,\n  events : [\n    {\n      type : \"click\",\n      selector : \".js-addToCart\",\n      listener : \"addToCart\"\n    }\n  ],\n  addToCart : function(eventObject){\n    var target = eventObject.currentTarget\n    var id = $(target).data(\"id\")\n    eventbus.fire(\"addToCart\", {\n      id : id\n    })\n  }\n})\n```\n\net je n'aurais qu'à écouter cet event depuis `cart` :\n\n```javascript\n// cart.js\nvar eventbus = require(\"../eventbus\")\nvar catalog = require(\"../catalog\")\n\nmodule.exports = {\n  initialize : function(){\n    this._addToCart = this.addToCart.bind(this)\n    eventbus.listen(\"addToCart\", this._addToCart)\n  },\n  release : function(){\n    eventbus.stopListening(\"addToCart\", this._addToCart)\n  },\n  addToCart : function(eventObject){\n    // et on a eventObject.id\n    this.products.push(catalog[eventObject.currentTarget.data(\"id\")])\n  }\n}\n```\n\nGrâce à cette architecture, je vais pouvoir tester individuellement\nles deux modules.\n\n```javascript\n// view.test.js\n\nvar tape = require(\"tape\")\nvar view = require(\"../app/view\")\nvar eventbus = require(\"../eventbus\")\nvar $ = require(\"jquery\")\n\ntape(\"view\", function(test){\n  test.plan(1)\n  var element = $(\"<div></div>\")\n  element.data(\"id\", 1)\n  // on teste facilement l'envoi\n  eventbus.listen(\"addToCart\", function(eventObject){\n    test.equal(eventObject.id, 1)\n  })\n  view.addToCart({\n    currentTarget : element\n  })\n})\n```\n\n```javascript\n// cart.test.js\n\nvar tape = require(\"tape\")\nvar cart = require(\"../app/cart\")\nvar eventbus = require(\"../eventbus\")\nvar catalog = require(\"../catalog\")\n\ntape(\"cart\", function(test){\n  cart.initialize()\n  eventbus.fireSync(\"addToCart\", {id:1})\n  test.deepEqual(\n    cart[0],\n    catalog[1],\n    \"receives addToCart event\"\n  )\n  test.end()\n})\n```\n\n## Tester tous les cas possibles\n\nCe sont souvent les edge-cases qui nous font nous arracher les cheveux.\nPour pallier ces soucis, tester en profondeur est essentiel.\n\nPrenons un exemple, une méthode qui teste si la valeur qu'on lui passe est\nune `string`.\n\nOn serait tenté de simplement tester les résultats positifs de cette façon :\n\n```javascript\ntape(\"type.isString on strings\", function(test){\n  test.equal(type.isString(\"\"), true)\n  test.end()\n})\n```\n\nOr, si par mégarde ma méthode `isString` se révèle être :\n\n```javascript\ntype.isString = function(value) {\n  return typeof value == \"string\"\n}\n```\n\non ne vérifie pas le cas `type.isString(new String(\"\"))`.\n\nDu coup, des tests complets :\n\n```javascript\ntape(\"type.isString on strings\", function(test){\n  test.equal(type.isString(\"\"), true)\n  test.equal(type.isString(new String(\"\")), false)\n  test.end()\n})\n```\n\npermettent ici d'identifier qu'en réalité on a besoin de :\n\n```javascript\ntype.isString = function(value) {\n  return Object.prototype.toString.call(value) == \"[object String]\"\n}\n```\n\nEt c'est à la force des résultats de tests que vous identifierez rapidement\nvous familiariserez à tous ces edge-cases.\n\nÀ chaque correctif de bug, ajoutez des tests (mais ça, vous le saviez déjà).\n\n## Cross-browser testing\n\nÀ l'heure actuelle, où l'on se trouve notamment très souvent avec du\nfeature testing.\nPour le tester complètement, on doit se servir de vrais navigateurs :\nun headless (certes, très pratique) comme [phantomjs](http://phantomjs.org)\nne permettra pas d'obtenir 100% de coverage.\n\n```javascript\nvar supportsAnimationFrame =\n  !!(\n    win.requestAnimationFrame ||\n    win.webkitRequestAnimationFrame ||\n    win.mozRequestAnimationFrame ||\n    win.ORequestAnimationFrame ||\n    // vous avez fait une faute de frappe,\n    // et mis un `O` majuscule, seul un\n    // test sur les version concernées d'Opera\n    // vous permettront de l'identifier\n    win.msRequestAnimationFrame\n  )\n```\n\nDe plus, vous pouvez par habitude être tenté d'utiliser un\n`Array.prototype.forEach` alors que votre scope navigateur inclut\nIE8; seuls des tests sur un vrai browser vous permettront d'identifier le souci.\n\nJe vous conseille fortement testling, très simple à intégrer dans vos\nmodules, et gratuit pour tout projet open-source.\n\nDans le `package.json` :\n\n```json\n{\n  \"testling\": {\n    \"files\": \"test/**/*.js\",\n    \"browsers\": [\n      \"ie/9..latest\",\n      \"chrome/22..latest\",\n      \"firefox/16..latest\",\n      \"safari/6..latest\",\n      \"opera/11.0..latest\",\n      \"iphone/6..latest\",\n      \"ipad/6..latest\",\n      \"android-browser/latest\"\n    ]\n  }\n}\n```\n\nEt ajouter un webhook dans l'admin de votre repository GitHub pointant vers\n\n> http://git.testling.com\n\nVous pouvez l'utiliser avec tape (son test harness par défaut)\nMocha, QUnit et n'importe quelle bibliothèque\nde test supportant `TAP` comme indiqué sur\n[le site de testling](https://ci.testling.com/guide/custom_libraries).\n\nVous trouverez aussi des alternatives populaires\n[similaires](http://www.browserstack.com),\nou ayant [une approche différente](http://karma-runner.github.io).\n\nPar ailleurs, si dans votre code il existe des variations entre les navigateurs,\nvous pouvez utiliser du test conditionnel :\n\n```javascript\nif(typeof {}.__proto__ == \"object\"){\n  test.equal(list.__proto__ === Array.prototype, false, \"__proto__ isn't Array.prototype\")\n} else {\n  test.equal(list instanceof Array, false, \"Isn't a window Array\")\n}\n```\n\nHappy testing!\n\n```console\n$ testling\n\nTAP version 13\n# tests\nok 1 bisous\n\n1..1\n# tests 1\n# pass  1\n\n# ok\n```\n","raw":"---\ndate: \"2014-05-01\"\ntitle: Introduction au testing js front\ntags:\n  - javascript\n  - tape\n  - unit-test\n  - browserify\nauthors:\n  - bloodyowl\n---\n\nLes tests automatisés en front-end ont longtemps été ignorés,\net le sont encore trop.\n\nÉcrire des tests peut paraître chiant, mais le temps qu'ils rapportent\ncompense largement celui que l'on passe à les écrire.\n\n## Écrire du js testable\n\nPrenons un exemple simple et moche :\n\n```javascript\n//app.js\n;(function(){\n\n  var cart = $(\"#cart\")\n  function addToCart(id){\n    var element = $(\"<li></li>\")\n    element.html(catalog[id])\n    cart.append(element)\n  }\n\n  $(\".js-updateCart\")\n    .on(\"click\", function(eventObject){\n      addToCart($(this).data(\"id\"))\n    })\n\n})()\n```\n\nTester ce code est particulièrement lourd, pour plusieurs raisons :\n\n- les functions à tester ne sont pas accessibles\n- on doit simuler un `click` pour tester un comportement logique.\n- on doit créer un element et modifier son `data-id` à chaque cas souhaité.\n- pour tester `addToCart` on doit aller regarder dans le DOM.\n\n### 1. Rendez accessibles vos méthodes au test runner\n\nVous pouvez utiliser un namespace adéquat.\n\n```javascript\nvar app = window.app = {}\napp.cart = {}\napp.cart.addToCart = function(){ /* … */ }\n```\n\nMais ne souhaitez probablement pas rendre vos méthodes accessibles à la console.\n\nUtilisez un module-system : [browserify](http://browserify.org) ou\n[requirejs](http://requirejs.org) (si vous n'avez pas besoin de chargement\nconditionnel et souhaitez créer un bundle par build, utilisez browserify qui\npossède une syntaxe beaucoup plus sympathique et une codebase réduite, vous\npourrez même `require` depuis un module npm\n[comme on vous l'explique dans un article dédié](/posts/js/browserify-all-the-things/)).\n\n```javascript\nvar $ = require(\"jquery\") // oh, un module npm\n\nmodule.exports = {\n  element : $(\"#cart\"),\n  addToCart : function(){\n    /* … */\n  }\n}\n```\n\nVous pourrez ainsi séparer proprement votre application en modules et les tester individuellement.\n\n### 2. Oui, mais les modules interdépendants alors ?\n\nLà, ça devient un peu plus tricky.\nCe que je conseille à titre personnel c'est d'utiliser des events\npour faire communiquer les différentes parties de l'application.\n\nCela permet d'éviter d'utiliser des mocks d'autres parties de l'application partout.\n\nPar exemple, si je souhaite tester le fait qu'un click sur `.js-updateCart`\ndéclanchera bien `updateCart` :\n\n```javascript\n//view.js\n\n// view est une petite class qui route les events\n// en rendant les listeners accessibles aux tests\n// vous pouvez très facilement en concevoir une\n// à votre goût en quelques lignes de code\nvar view = require(\"../lib/view\")\n\n// eventbus est l'event bus de l'application, il orchestre\n// la communication entre les différents modules\nvar eventbus = require(\"../eventbus\")\n\nvar $ = require(\"jquery\")\n\nmodule.exports = view.extend({\n  element : document.body,\n  events : [\n    {\n      type : \"click\",\n      selector : \".js-addToCart\",\n      listener : \"addToCart\"\n    }\n  ],\n  addToCart : function(eventObject){\n    var target = eventObject.currentTarget\n    var id = $(target).data(\"id\")\n    eventbus.fire(\"addToCart\", {\n      id : id\n    })\n  }\n})\n```\n\net je n'aurais qu'à écouter cet event depuis `cart` :\n\n```javascript\n// cart.js\nvar eventbus = require(\"../eventbus\")\nvar catalog = require(\"../catalog\")\n\nmodule.exports = {\n  initialize : function(){\n    this._addToCart = this.addToCart.bind(this)\n    eventbus.listen(\"addToCart\", this._addToCart)\n  },\n  release : function(){\n    eventbus.stopListening(\"addToCart\", this._addToCart)\n  },\n  addToCart : function(eventObject){\n    // et on a eventObject.id\n    this.products.push(catalog[eventObject.currentTarget.data(\"id\")])\n  }\n}\n```\n\nGrâce à cette architecture, je vais pouvoir tester individuellement\nles deux modules.\n\n```javascript\n// view.test.js\n\nvar tape = require(\"tape\")\nvar view = require(\"../app/view\")\nvar eventbus = require(\"../eventbus\")\nvar $ = require(\"jquery\")\n\ntape(\"view\", function(test){\n  test.plan(1)\n  var element = $(\"<div></div>\")\n  element.data(\"id\", 1)\n  // on teste facilement l'envoi\n  eventbus.listen(\"addToCart\", function(eventObject){\n    test.equal(eventObject.id, 1)\n  })\n  view.addToCart({\n    currentTarget : element\n  })\n})\n```\n\n```javascript\n// cart.test.js\n\nvar tape = require(\"tape\")\nvar cart = require(\"../app/cart\")\nvar eventbus = require(\"../eventbus\")\nvar catalog = require(\"../catalog\")\n\ntape(\"cart\", function(test){\n  cart.initialize()\n  eventbus.fireSync(\"addToCart\", {id:1})\n  test.deepEqual(\n    cart[0],\n    catalog[1],\n    \"receives addToCart event\"\n  )\n  test.end()\n})\n```\n\n## Tester tous les cas possibles\n\nCe sont souvent les edge-cases qui nous font nous arracher les cheveux.\nPour pallier ces soucis, tester en profondeur est essentiel.\n\nPrenons un exemple, une méthode qui teste si la valeur qu'on lui passe est\nune `string`.\n\nOn serait tenté de simplement tester les résultats positifs de cette façon :\n\n```javascript\ntape(\"type.isString on strings\", function(test){\n  test.equal(type.isString(\"\"), true)\n  test.end()\n})\n```\n\nOr, si par mégarde ma méthode `isString` se révèle être :\n\n```javascript\ntype.isString = function(value) {\n  return typeof value == \"string\"\n}\n```\n\non ne vérifie pas le cas `type.isString(new String(\"\"))`.\n\nDu coup, des tests complets :\n\n```javascript\ntape(\"type.isString on strings\", function(test){\n  test.equal(type.isString(\"\"), true)\n  test.equal(type.isString(new String(\"\")), false)\n  test.end()\n})\n```\n\npermettent ici d'identifier qu'en réalité on a besoin de :\n\n```javascript\ntype.isString = function(value) {\n  return Object.prototype.toString.call(value) == \"[object String]\"\n}\n```\n\nEt c'est à la force des résultats de tests que vous identifierez rapidement\nvous familiariserez à tous ces edge-cases.\n\nÀ chaque correctif de bug, ajoutez des tests (mais ça, vous le saviez déjà).\n\n## Cross-browser testing\n\nÀ l'heure actuelle, où l'on se trouve notamment très souvent avec du\nfeature testing.\nPour le tester complètement, on doit se servir de vrais navigateurs :\nun headless (certes, très pratique) comme [phantomjs](http://phantomjs.org)\nne permettra pas d'obtenir 100% de coverage.\n\n```javascript\nvar supportsAnimationFrame =\n  !!(\n    win.requestAnimationFrame ||\n    win.webkitRequestAnimationFrame ||\n    win.mozRequestAnimationFrame ||\n    win.ORequestAnimationFrame ||\n    // vous avez fait une faute de frappe,\n    // et mis un `O` majuscule, seul un\n    // test sur les version concernées d'Opera\n    // vous permettront de l'identifier\n    win.msRequestAnimationFrame\n  )\n```\n\nDe plus, vous pouvez par habitude être tenté d'utiliser un\n`Array.prototype.forEach` alors que votre scope navigateur inclut\nIE8; seuls des tests sur un vrai browser vous permettront d'identifier le souci.\n\nJe vous conseille fortement testling, très simple à intégrer dans vos\nmodules, et gratuit pour tout projet open-source.\n\nDans le `package.json` :\n\n```json\n{\n  \"testling\": {\n    \"files\": \"test/**/*.js\",\n    \"browsers\": [\n      \"ie/9..latest\",\n      \"chrome/22..latest\",\n      \"firefox/16..latest\",\n      \"safari/6..latest\",\n      \"opera/11.0..latest\",\n      \"iphone/6..latest\",\n      \"ipad/6..latest\",\n      \"android-browser/latest\"\n    ]\n  }\n}\n```\n\nEt ajouter un webhook dans l'admin de votre repository GitHub pointant vers\n\n> http://git.testling.com\n\nVous pouvez l'utiliser avec tape (son test harness par défaut)\nMocha, QUnit et n'importe quelle bibliothèque\nde test supportant `TAP` comme indiqué sur\n[le site de testling](https://ci.testling.com/guide/custom_libraries).\n\nVous trouverez aussi des alternatives populaires\n[similaires](http://www.browserstack.com),\nou ayant [une approche différente](http://karma-runner.github.io).\n\nPar ailleurs, si dans votre code il existe des variations entre les navigateurs,\nvous pouvez utiliser du test conditionnel :\n\n```javascript\nif(typeof {}.__proto__ == \"object\"){\n  test.equal(list.__proto__ === Array.prototype, false, \"__proto__ isn't Array.prototype\")\n} else {\n  test.equal(list instanceof Array, false, \"Isn't a window Array\")\n}\n```\n\nHappy testing!\n\n```console\n$ testling\n\nTAP version 13\n# tests\nok 1 bisous\n\n1..1\n# tests 1\n# pass  1\n\n# ok\n```\n","__filename":"posts/js/introduction-au-testing-js-front/index.md","__url":"/posts/js/introduction-au-testing-js-front/","type":"Post"}}}</script><script src="/statinamic-client.js"></script></body></html>
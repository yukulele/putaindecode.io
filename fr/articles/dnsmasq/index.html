<!doctype html><html lang="en"><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="stylesheet" href="/statinamic-client.css" /><meta data-react-helmet="true" property="og:site_name" content="Putain de code !"/><meta data-react-helmet="true" name="twitter:site" content="@putaindecode_fr"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="La puissance de dnsmasq"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="La puissance de dnsmasq"/><meta data-react-helmet="true" name="twitter:creator" content="@_kud"/><title data-react-helmet="true">La puissance de dnsmasq</title></head><body><div id="statinamic"><div id="statinamic-container" data-reactid=".1zql6jxhhj4" data-react-checksum="1166151945"><div class="r-VerticalRhythm" lang="fr" data-reactid=".1zql6jxhhj4.0"><div data-reactid=".1zql6jxhhj4.0.0"><noscript data-reactid=".1zql6jxhhj4.0.0.0:0"></noscript><div class="putainde-Header" data-reactid=".1zql6jxhhj4.0.0.0:1"><div class="r-Grid" data-reactid=".1zql6jxhhj4.0.0.0:1.0"><div class="r-Grid-cell r-minM--1of3" data-reactid=".1zql6jxhhj4.0.0.0:1.0.0"><a class="putainde-SiteTitle" href="/" data-reactid=".1zql6jxhhj4.0.0.0:1.0.0.0"><span class="SVGIcon SVGIcon--cleaned putainde-Logo" data-reactid=".1zql6jxhhj4.0.0.0:1.0.0.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="-49.5 652.5 512 512"><radialGradient id="a" cx="206.455" cy="-395.01" r="243.791" gradientTransform="matrix(.9784 0 0 -.9765 4.504 505.604)" gradientUnits="userSpaceOnUse"><stop offset=".8"/><stop offset=".95" stop-color="#333"/></radialGradient><linearGradient id="b" gradientUnits="userSpaceOnUse" x1="-34" y1="-376.331" x2="447" y2="-376.331" gradientTransform="matrix(1 0 0 -1 0 515)"><stop offset="0" stop-color="#333"/><stop offset="1"/></linearGradient><path vector-effect="non-scaling-stroke" opacity=".4" fill="url(#a)" stroke="url(#b)" stroke-miterlimit="10" d="M-33.5,891.331c0-130.655,107.456-236.581,240.01-236.581c132.535,0,239.99,105.927,239.99,236.581 c0,130.653-107.455,236.581-239.99,236.581C73.956,1127.911-33.5,1021.984-33.5,891.331z"/><linearGradient id="c" gradientUnits="userSpaceOnUse" x1="-34.5" y1="-377.169" x2="447.5" y2="-377.169" gradientTransform="matrix(1 0 0 -1 0 515)"><stop offset="0" stop-color="#333"/><stop offset="1"/></linearGradient><path opacity=".2" fill="none" stroke="url(#c)" stroke-width="2" stroke-miterlimit="10" d="M-33.5,892.169c0-130.655,107.456-236.581,240.01-236.581c132.535,0,239.99,105.928,239.99,236.581 c0,130.654-107.455,236.581-239.99,236.581C73.956,1128.75-33.5,1022.824-33.5,892.169z"/><g><linearGradient id="d" gradientUnits="userSpaceOnUse" x1="30.247" y1="427.851" x2="30.247" y2="228.319" gradientTransform="matrix(2.3906 0 0 -2.3906 134.192 1708.07)"><stop offset="0" stop-color="#FFF"/><stop offset="1" stop-color="#EEE"/></linearGradient><path vector-effect="non-scaling-stroke" fill="url(#d)" stroke="#7A7A7A" stroke-miterlimit="10" d="M1,889.671c0,112.916,92.003,204.444,205.51,204.444c1.283,0,2.565-0.019,3.828-0.04c19.795,40.379,61.281,68.175,109.258,68.175 c3.686,0,7.334-0.157,10.941-0.481c-20.401-23.875-33.307-54.348-35.07-87.771C364.424,1041.018,412,970.873,412,889.673 c0-112.894-92.004-204.423-205.49-204.423C93.004,685.247,1,776.777,1,889.671z"/><path fill="none" stroke="#7A7A7A" stroke-width="2" stroke-miterlimit="10" d="M1,889.671 c0,112.916,92.003,204.444,205.51,204.444c1.283,0,2.565-0.019,3.828-0.04c19.795,40.379,61.281,68.175,109.258,68.175 c3.686,0,7.334-0.157,10.941-0.481c-20.401-23.875-33.307-54.348-35.07-87.771C364.424,1041.018,412,970.873,412,889.673 c0-112.894-92.004-204.423-205.49-204.423C93.004,685.247,1,776.777,1,889.671z"/></g><g stroke="#333333" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"><path vector-effect="non-scaling-stroke" fill="#444444" d="M187.747,832.25H132.5v123h27.551v-45.188h28.086c7.596,0,14.055-1.102,19.378-3.302c5.323-2.196,9.656-5.138,13.019-8.745 c3.364-3.605,5.801-7.795,7.327-12.498c1.527-4.707,2.312-9.494,2.312-14.363c0-4.978-0.785-9.807-2.312-14.428 c-1.567-4.625-4.024-8.789-7.387-12.396c-3.363-3.605-7.765-6.551-13.168-8.747C201.924,833.391,195.421,832.25,187.747,832.25z M181.225,889.979h-21.173v-37.641h21.173c3.096,0,6.107,0.227,8.996,0.704c2.891,0.478,5.428,1.411,7.635,2.738 c2.187,1.346,3.941,3.274,5.285,5.698c1.319,2.463,1.979,5.679,1.979,9.682s-0.66,7.253-1.979,9.68 c-1.344,2.486-3.1,4.395-5.285,5.742c-2.207,1.327-4.744,2.236-7.635,2.695C187.334,889.753,184.32,889.979,181.225,889.979z"/><path fill="none" stroke-width="2" d="M187.747,832.25H132.5v123h27.551v-45.188h28.086c7.596,0,14.055-1.102,19.378-3.302c5.323-2.196,9.656-5.138,13.019-8.745 c3.364-3.605,5.801-7.795,7.327-12.498c1.527-4.707,2.312-9.494,2.312-14.363c0-4.978-0.785-9.807-2.312-14.428 c-1.567-4.625-4.024-8.789-7.387-12.396c-3.363-3.605-7.765-6.551-13.168-8.747C201.924,833.391,195.421,832.25,187.747,832.25z M181.225,889.979h-21.173v-37.641h21.173c3.096,0,6.107,0.227,8.996,0.704c2.891,0.478,5.428,1.411,7.635,2.738 c2.187,1.346,3.941,3.274,5.285,5.698c1.319,2.463,1.979,5.679,1.979,9.682s-0.66,7.253-1.979,9.68 c-1.344,2.486-3.1,4.395-5.285,5.742c-2.207,1.327-4.744,2.236-7.635,2.695C187.334,889.753,184.32,889.979,181.225,889.979z"/><g><path vector-effect="non-scaling-stroke" fill="#444444" d="M247.616,944.686c0,9.709,7.241,17.064,17.44,17.064c10.202,0,17.442-7.357,17.442-17.064c0-9.25-7.24-16.328-17.441-16.328 C254.855,927.592,247.616,934.95,247.616,944.686z M280.201,881.346V831.75h-30.292v49.596l6.886,37.639h16.521L280.201,881.346z"/><path fill="none" stroke-width="2" d="M247.616,944.686c0,9.709,7.241,17.064,17.44,17.064c10.202,0,17.442-7.357,17.442-17.064c0-9.25-7.24-16.328-17.441-16.328 C254.855,927.592,247.616,934.95,247.616,944.686z M280.201,881.346V831.75h-30.292v49.596l6.886,37.639h16.521L280.201,881.346z"/></g></g><g><linearGradient id="e" gradientUnits="userSpaceOnUse" x1="87.136" y1="385.394" x2="87.136" y2="297.549" gradientTransform="matrix(2.3906 0 0 -2.3906 134.192 1708.07)"><stop offset="0" stop-color="#c5372f"/><stop offset="1" stop-color="#900"/></linearGradient><path vector-effect="non-scaling-stroke" fill="url(#e)" stroke="#8B2721" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M314.164,970.195c2.755,0,4.955-0.561,6.592-1.577c1.639-1.095,2.916-2.451,3.854-4.009c0.923-1.614,1.519-3.43,1.758-5.362 c0.22-1.996,0.382-3.806,0.382-5.465v-36.5c0-4.823,0.895-8.829,2.715-11.96c1.818-3.09,3.978-5.622,6.469-7.516 c2.48-1.873,5.058-3.27,7.773-4.106c2.733-0.818,4.952-1.354,6.706-1.496v-0.697c-1.756-0.139-3.973-0.598-6.706-1.356 c-2.718-0.735-5.293-2.111-7.773-3.984c-2.491-1.895-4.648-4.564-6.469-7.994c-1.82-3.408-2.715-7.936-2.715-13.574v-34.669 c0-1.812-0.162-3.706-0.382-5.661c-0.239-1.955-0.837-3.769-1.758-5.363c-0.938-1.574-2.218-2.93-3.854-3.986 s-3.837-1.613-6.592-1.613H302.5V786.75h28.781c2.694,0,5.753,0.676,9.169,1.953c3.414,1.316,6.632,3.25,9.591,5.762 c2.953,2.532,5.449,5.741,7.53,9.669c2.036,3.927,3.112,8.472,3.112,13.695v43.299c0,3.849,0.742,7.118,2.299,9.788 c1.56,2.691,3.417,4.844,5.614,6.459c2.157,1.615,4.875,2.751,7.392,3.43c2.496,0.678,4.652,1.016,6.512,1.016v20.076 c-1.857,0-4.016,0.379-6.512,1.058c-2.517,0.677-5.232,1.772-7.394,3.209c-2.195,1.455-4.055,3.429-5.612,5.88 c-1.557,2.453-2.299,5.423-2.299,8.932v44.697c0,5.2-1.076,9.771-3.112,13.696c-2.079,3.927-4.577,7.116-7.532,9.688 c-2.955,2.487-6.175,4.402-9.589,5.74c-3.416,1.275-6.475,1.954-9.169,1.954H302.5v-26.554L314.164,970.195L314.164,970.195 L314.164,970.195z"/><path fill="none" stroke="#8B2721" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M314.164,970.195c2.755,0,4.955-0.561,6.592-1.577c1.639-1.095,2.916-2.451,3.854-4.009c0.923-1.614,1.519-3.43,1.758-5.362 c0.22-1.996,0.382-3.806,0.382-5.465v-36.5c0-4.823,0.895-8.829,2.715-11.96c1.818-3.09,3.978-5.622,6.469-7.516 c2.48-1.873,5.058-3.27,7.773-4.106c2.733-0.818,4.952-1.354,6.706-1.496v-0.697c-1.756-0.139-3.973-0.598-6.706-1.356 c-2.718-0.735-5.293-2.111-7.773-3.984c-2.491-1.895-4.648-4.564-6.469-7.994c-1.82-3.408-2.715-7.936-2.715-13.574v-34.669 c0-1.812-0.162-3.706-0.382-5.661c-0.239-1.955-0.837-3.769-1.758-5.363c-0.938-1.574-2.218-2.93-3.854-3.986 s-3.837-1.613-6.592-1.613H302.5V786.75h28.781c2.694,0,5.753,0.676,9.169,1.953c3.414,1.316,6.632,3.25,9.591,5.762 c2.953,2.532,5.449,5.741,7.53,9.669c2.036,3.927,3.112,8.472,3.112,13.695v43.299c0,3.849,0.742,7.118,2.299,9.788 c1.56,2.691,3.417,4.844,5.614,6.459c2.157,1.615,4.875,2.751,7.392,3.43c2.496,0.678,4.652,1.016,6.512,1.016v20.076 c-1.857,0-4.016,0.379-6.512,1.058c-2.517,0.677-5.232,1.772-7.394,3.209c-2.195,1.455-4.055,3.429-5.612,5.88 c-1.557,2.453-2.299,5.423-2.299,8.932v44.697c0,5.2-1.076,9.771-3.112,13.696c-2.079,3.927-4.577,7.116-7.532,9.688 c-2.955,2.487-6.175,4.402-9.589,5.74c-3.416,1.275-6.475,1.954-9.169,1.954H302.5v-26.554L314.164,970.195L314.164,970.195 L314.164,970.195z"/><g><linearGradient id="f" gradientUnits="userSpaceOnUse" x1="-26.642" y1="385.394" x2="-26.642" y2="297.55" gradientTransform="matrix(2.3906 0 0 -2.3906 134.192 1708.07)"><stop offset="0" stop-color="#c5372f"/><stop offset="1" stop-color="#900"/></linearGradient><path vector-effect="non-scaling-stroke" fill="url(#f)" stroke="#8B2721" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M98.835,813.305c-2.797,0-4.995,0.56-6.632,1.615c-1.618,1.057-2.916,2.413-3.815,3.987c-0.958,1.596-1.559,3.409-1.778,5.362 c-0.24,1.955-0.339,3.848-0.339,5.664V864.6c0,5.642-0.958,10.166-2.776,13.576c-1.818,3.43-3.975,6.1-6.432,7.993 c-2.496,1.874-5.073,3.25-7.811,3.985c-2.716,0.759-4.914,1.217-6.671,1.355v0.697c1.758,0.141,3.955,0.678,6.671,1.495 c2.737,0.838,5.314,2.233,7.811,4.106c2.456,1.895,4.614,4.426,6.432,7.517c1.817,3.13,2.776,7.136,2.776,11.96v36.501 c0,1.651,0.101,3.466,0.339,5.463c0.22,1.931,0.818,3.748,1.778,5.362c0.899,1.555,2.197,2.908,3.815,4.006 c1.637,1.021,3.835,1.58,6.632,1.58H110.5v26.552H81.716c-2.716,0-5.792-0.676-9.208-1.954c-3.396-1.337-6.592-3.251-9.548-5.74 c-2.937-2.574-5.493-5.762-7.531-9.688c-2.077-3.929-3.097-8.496-3.097-13.701v-44.692c0-3.51-0.798-6.479-2.357-8.933 c-1.558-2.449-3.415-4.424-5.573-5.879c-2.198-1.437-5.154-2.531-7.65-3.209c-2.497-0.679-4.534-1.058-6.252-1.058V881.82 c1.718,0,3.755-0.338,6.252-1.016c2.497-0.68,5.453-1.813,7.65-3.431c2.158-1.615,4.015-3.769,5.573-6.459 c1.559-2.671,2.357-5.938,2.357-9.788v-43.299c0-5.225,1.019-9.77,3.097-13.695c2.038-3.927,4.595-7.137,7.531-9.669 c2.956-2.511,6.151-4.444,9.548-5.761c3.416-1.276,6.492-1.954,9.208-1.954H110.5v26.553L98.835,813.305L98.835,813.305z"/><path fill="none" stroke="#8B2721" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M98.835,813.305c-2.797,0-4.995,0.56-6.632,1.615c-1.618,1.057-2.916,2.413-3.815,3.987c-0.958,1.596-1.559,3.409-1.778,5.362 c-0.24,1.955-0.339,3.848-0.339,5.664V864.6c0,5.642-0.958,10.166-2.776,13.576c-1.818,3.43-3.975,6.1-6.432,7.993 c-2.496,1.874-5.073,3.25-7.811,3.985c-2.716,0.759-4.914,1.217-6.671,1.355v0.697c1.758,0.141,3.955,0.678,6.671,1.495 c2.737,0.838,5.314,2.233,7.811,4.106c2.456,1.895,4.614,4.426,6.432,7.517c1.817,3.13,2.776,7.136,2.776,11.96v36.501 c0,1.651,0.101,3.466,0.339,5.463c0.22,1.931,0.818,3.748,1.778,5.362c0.899,1.555,2.197,2.908,3.815,4.006 c1.637,1.021,3.835,1.58,6.632,1.58H110.5v26.552H81.716c-2.716,0-5.792-0.676-9.208-1.954c-3.396-1.337-6.592-3.251-9.548-5.74 c-2.937-2.574-5.493-5.762-7.531-9.688c-2.077-3.929-3.097-8.496-3.097-13.701v-44.692c0-3.51-0.798-6.479-2.357-8.933 c-1.558-2.449-3.415-4.424-5.573-5.879c-2.198-1.437-5.154-2.531-7.65-3.209c-2.497-0.679-4.534-1.058-6.252-1.058V881.82 c1.718,0,3.755-0.338,6.252-1.016c2.497-0.68,5.453-1.813,7.65-3.431c2.158-1.615,4.015-3.769,5.573-6.459 c1.559-2.671,2.357-5.938,2.357-9.788v-43.299c0-5.225,1.019-9.77,3.097-13.695c2.038-3.927,4.595-7.137,7.531-9.669 c2.956-2.511,6.151-4.444,9.548-5.761c3.416-1.276,6.492-1.954,9.208-1.954H110.5v26.553L98.835,813.305L98.835,813.305z"/></g></g></svg></span><span data-reactid=".1zql6jxhhj4.0.0.0:1.0.0.0.1">Putain de code !</span></a></div><div class="r-Grid-cell r-minM--2of3" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1"><nav class="putainde-Nav" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0"><a class="putainde-Nav-item" href="/fr/articles" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.0:$/fr/articles"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.0:$/fr/articles.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M318.275,90v283.23L256,318.16l-62.275,55.07V90H318.275 M358.275,50H153.725v412L256,371.557	L358.275,462V50L358.275,50z"/></svg></span><span data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.0:$/fr/articles.1">Articles</span></a><a class="putainde-Nav-item" href="/fr/contribuer" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.0:$/fr/contribuer"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.0:$/fr/contribuer.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M74.686,340.686L50,460.949l122.365-22.584L379.52,231.211l-97.68-97.68L74.686,340.686z M303.088,205.032l-181.891,181.89l-21.213-21.213l181.891-181.89L303.088,205.032z M462,148.731l-52.662,52.662l-97.682-97.68	l52.662-52.663L462,148.731z"/></svg></span><span data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.0:$/fr/contribuer.1">Contribuer</span></a><a href="https://github.com/putaindecode/putaindecode.io" class="putainde-Nav-item putainde-Nav-item--icon r-Tooltip r-Tooltip r-Tooltip--bottom" data-r-tooltip="GitHub" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.1:$https=2//github=1com/putaindecode/putaindecode=1io"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.1:$https=2//github=1com/putaindecode/putaindecode=1io.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M461.633,250.645l0.367-3.819c-22.896-2.221-45.667-2.419-67.79-0.73	c3.557-11.347,5.43-24.164,5.295-38.739c-0.292-30.965-10.616-55.081-26.843-75.096c3.116-18.852,0.769-37.702-5.111-56.561	c-23.187,1.898-44.053,9.493-62.634,22.686c-34.725-7.044-69.447-7.493-104.172,0c-21.673-14.627-42.956-21.802-63.909-22.686	c-6.21,20.765-7.169,41.233-1.917,61.357c-18.28,19.397-25.268,42.944-24.925,69.019c0.196,14.927,2.496,28.209,6.738,39.952	c-21.796-1.599-44.201-1.386-66.732,0.798l0.367,3.819c22.947-2.228,45.76-2.411,67.919-0.678c0.814,1.974,1.633,3.939,2.567,5.815	c-24.009-0.633-45.618,1.453-65.854,6.43l0.914,3.723c20.538-5.048,42.54-7.081,67.107-6.254	c16.246,28.864,47.52,45.824,93.063,51.205c-10.581,8.594-16.269,18.731-17.735,30.201c0,0-4.787,0-24.121,0	c-32.394,0-41.226-41.304-74.779-37.229C132,320,125.5,371.599,177.587,371.599c17.506,0,21.226,0,21.881,0v47.296	c0.234,7.643-3.093,12.754-8.469,16.297c18.654,1.884,32.674-7.43,32.674-18.854s0-56.948,0-62.518s5.833-6,5.833-6v72.992	c0.245,7.265-3.284,11.392-7.031,15.339c16.434,0.654,31.892-2.629,32.592-16.615c0,0,0-66.345,0-69.857s5.756-3.599,5.756,0	s0,66.58,0,66.58c0.169,11.8,10.361,21.367,31.953,19.893c-5.776-4.65-7.549-9.35-7.549-16.15s0-72.181,0-72.181s5.95-0.306,5.95,6	s0,50.331,0,60.881c0,13.55,16.267,19.14,34.829,18.615c-6.081-4.558-10.196-9.991-10.223-17.256v-73.217	c-0.629-10.762-5.003-20.906-13.582-30.358c41.63-6.392,71.637-23.011,86.578-52.796c24.647-0.847,46.715,1.183,67.307,6.246	l0.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415c0.839-1.891,1.67-3.789,2.389-5.785	C415.363,248.215,438.431,248.391,461.633,250.645z M114,310.023c-1.023,0-1.853-0.588-1.853-1.313c0-0.728,0.83-1.315,1.853-1.315	c1.024,0,1.854,0.588,1.854,1.315C115.854,309.436,115.024,310.023,114,310.023z M119.833,314.003c-1.137,0-2.06-0.653-2.06-1.46	s0.923-1.462,2.06-1.462s2.059,0.655,2.059,1.462S120.97,314.003,119.833,314.003z M125.75,319.172	c-1.333,0-2.415-0.766-2.415-1.712s1.082-1.714,2.415-1.714c1.333,0,2.416,0.768,2.416,1.714S127.083,319.172,125.75,319.172z M131.5,325.379c-1.56,0-2.825-0.896-2.825-2.003s1.265-2.005,2.825-2.005s2.825,0.898,2.825,2.005S133.06,325.379,131.5,325.379z M137.833,332.394c-1.733,0-3.139-0.996-3.139-2.226s1.406-2.228,3.139-2.228s3.139,0.998,3.139,2.228	S139.566,332.394,137.833,332.394z M145.167,339.517c-1.926,0-3.488-1.107-3.488-2.474s1.562-2.476,3.488-2.476	c1.925,0,3.487,1.109,3.487,2.476S147.092,339.517,145.167,339.517z M155.083,346.291c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C158.958,345.06,157.223,346.291,155.083,346.291z M167.375,349.916	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C171.25,348.685,169.515,349.916,167.375,349.916z M180.333,350.333c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C184.208,349.102,182.473,350.333,180.333,350.333z M193.125,350.583	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C197,349.352,195.265,350.583,193.125,350.583z"/></svg></span></a><a href="https://twitter.com/putaindecode_fr/" class="putainde-Nav-item putainde-Nav-item--icon r-Tooltip r-Tooltip r-Tooltip--bottom" data-r-tooltip="Twitter" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.1:$https=2//twitter=1com/putaindecode_fr/"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.1:$https=2//twitter=1com/putaindecode_fr/.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764	c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787	c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574	c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699	C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435	C436.339,160.061,450.668,145.174,462,128.223z"/></svg></span></a><a href="/discuss/" class="putainde-Nav-item putainde-Nav-item--icon r-Tooltip r-Tooltip r-Tooltip--bottom" data-r-tooltip="Discuter" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.1:$/discuss/"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:1.0.1.0.1:$/discuss/.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M174.059,354.374c-0.031-0.008-0.062-0.014-0.093-0.021	c-25.892,15.965-82.983,32.107-123.141,39.412c14.984-29.725,31.616-70.527,30.764-98.977C61.403,270.511,50,239.224,50,207.358	c0-89.84,87.383-155.527,185.209-155.527c97.22,0,185.211,65.193,185.211,155.527c0,1.283-0.027,2.564-0.066,3.844	c-11.285-6.088-23.506-11.037-36.622-14.68c-6.854-60.861-70.842-108.715-148.522-108.715c-82.237,0-149.141,53.631-149.141,119.551	c0,34.688,15.009,56.529,36.192,78.068c-4.306,31.98-14.646,59.781-14.646,59.781s30.542-8.064,65.253-28.275	C171.395,329.616,171.806,342.101,174.059,354.374z M461.432,460.169c-27.634-5.029-66.922-16.137-84.739-27.123	c-98.102,24.029-169.6-36.424-169.6-101.154c0-62.166,60.552-107.029,127.453-107.029c67.322,0,127.454,45.203,127.454,107.029	c0,21.928-7.85,43.457-21.738,60.164C439.674,411.634,451.121,439.712,461.432,460.169z M302.524,333.198	c0-9.648-7.841-17.469-17.515-17.469c-9.673,0-17.515,7.82-17.515,17.469s7.842,17.471,17.515,17.471	C294.684,350.669,302.524,342.847,302.524,333.198z M354.75,333.198c0-9.648-7.841-17.469-17.515-17.469	c-9.673,0-17.515,7.82-17.515,17.469s7.842,17.471,17.515,17.471C346.909,350.669,354.75,342.847,354.75,333.198z M406.339,333.198	c0-9.648-7.842-17.469-17.515-17.469c-9.674,0-17.515,7.82-17.515,17.469s7.841,17.471,17.515,17.471	C398.497,350.669,406.339,342.847,406.339,333.198z"/></svg></span></a></nav></div></div></div><div data-reactid=".1zql6jxhhj4.0.0.0:2"><div class="putainde-Main" data-reactid=".1zql6jxhhj4.0.0.0:2.3"><noscript data-reactid=".1zql6jxhhj4.0.0.0:2.3.0"></noscript><article class="putainde-Post" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1"><header data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0"><div class="putainde-Post-header" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.0"><h1 class="putainde-Title" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.0.2">La puissance de dnsmasq</h1></div><div class="putainde-Post-metas" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1"><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.0"><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.0.0">Écrit par </span><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.0.1"><a href="http://kud.io" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.0.1.0:$[object Object]">kud</a><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.0.1.0:$[object Object]-glue"></span></span></span><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.1">, </span><span class="putainde-Date" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.2">on Feb 20, 2014</span><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.3">. </span><span class="r-Tooltip r-Tooltip--top putainde-Post-readingTime" data-r-tooltip="Temps de lecture approximatif, sur une base de 250 mots par minute" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.4"><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.4.0">Temps de lecture : </span><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.1.4.2">environ 6 minutes</span></span></div><ul class="putainde-Tags putainde-Post-tags" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.2"><li class="putainde-Tag" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.2.$dnsmasq">dnsmasq</li><li class="putainde-Tag" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.2.$macosx">macosx</li><li class="putainde-Tag" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.2.$test">test</li><li class="putainde-Tag" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.2.$dns">dns</li><li class="putainde-Tag" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.0.2.$serveur">serveur</li></ul></header><div class="r-Grid" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1"><div class="r-Grid-cell r-minM--8of12 putainde-Post-contents" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0"><div class="putainde-Post-md" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.0"><div data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.0.0"><p>Dernièrement, j’ai voulu accéder avec mon Smartphone à ma machine virtuelle (<em>VM</em>) de développement qui se trouve sur mon poste de travail (<em>machine ou poste hôte</em>). Ma machine virtuelle me permet de reproduire à l’identique la production afin d’avoir le moins de marge d’erreur possible entre la phase de développement et la phase de mise en production.</p>
<p>A ce moment là, j’accédais à ma machine virtuelle à partir de mon poste via le fichier <em>hosts</em> comprenant ceci :</p>
<pre><code>192<span class="hljs-class">.168</span><span class="hljs-class">.1</span><span class="hljs-class">.145</span> <span class="hljs-tag">monsite</span><span class="hljs-class">.dev</span></code></pre>
<p>Le problème est que seul mon poste est au courant de la résolution du nom de domaine de par cette méthode.</p>
<p>Étant donné qu’il est laborieux de changer des <em>hosts</em> sur un appareil comme un téléphone et que je n’ai pas non plus envie de dupliquer cette modification sur chaque appareil, il me fallait trouver une solution généralisée.</p>
<p>C’est là que <strong><a href="http://fr.wikipedia.org/wiki/Dnsmasq">dnsmasq</a></strong> entre en jeu.</p>
<blockquote>
<p>Dnsmasq est un serveur léger pour fournir les services DNS, DHCP, Bootstrap Protocol et TFTP pour un petit réseau, voire pour un poste de travail. Il permet d’offrir un service de nommage des machines du réseau interne non intégrées au service de nommage global (i.e. le service DNS d’Internet). Le service de nommage est associé au service d’adressage de telle manière que les machines dont le bail DHCP est fourni par Dnsmasq peuvent avoir automatiquement un nom DNS sur le réseau interne. Le logiciel offre un service DHCP statique ou dynamique.</p>
</blockquote>
<h2 id="dnsmasq-le-serveur-dns-tout-petit"><a class="markdownIt-Anchor" href="#dnsmasq-le-serveur-dns-tout-petit">#</a> dnsmasq, le serveur dns tout petit</h2>
<p><strong>dnsmasq</strong> va me permettre de faire plusieurs choses :</p>
<ul>
<li>accélérer la résolution dns</li>
<li>ne pas polluer le réseau interne de la boite avec des résolutions de domaines propre à votre poste (imaginez que vous soyez plusieurs à avoir <em>monsite.dev</em> (ce qui est le cas dans notre boite)); une résolution se ferait uniquement vers un seul poste donc impossible de faire sans si vous êtes plusieurs</li>
<li>ne pas dupliquer sur chacun appareil la résolution dns</li>
<li>réussir à résoudre un nom de domaine sur un appareil où le fichier <em>hosts</em> est difficile voire impossible d’accès</li>
</ul>
<p>Cependant, tout n’est pas si rose, je vais vous montrer pourquoi après.</p>
<h3 id="partage-de-connexion"><a class="markdownIt-Anchor" href="#partage-de-connexion">#</a> Partage de connexion</h3>
<p>Je vous propose dans un premier temps de partager votre connexion via le Wifi sous Mac OS X afin :</p>
<ul>
<li>d’avoir constamment un débit stable et performant; étant donné que vous êtes souvent devant votre poste pour tester sur différents appareils, en partageant votre connexion via Wifi, vous vous assurez d’avoir un excellent débit, chose qui n’est pas toujours évidente quand le wifi de votre boite est un peu / souvent trop loin</li>
<li>d’utiliser le serveur dns (dnsmasq) que vous allez monter</li>
</ul>
<p>Pour cela, il suffit de faire : <code>System Preferences &gt; Sharing &gt; Internet Sharing</code> puis choisir <code>Ethernet</code> en source, et <code>Wifi</code> en sortie. (Je vous conseille d’ailleurs de protéger votre Wifi avec une clé WPA2).</p>
<figure>
  <img src="macosx-network-sharing.png" alt="" />
</figure>
<p><em>Ici, c’est USB Ethernet en source car je suis sur un Mac Book Air donc aucun port ethernet natif mais choisissez Ethernet si possible.</em></p>
<p>Une fois que le partage de connexion via Wifi est activé, vous pouvez vous y connecter avec votre smartphone (ou tablette).</p>
<p>Cela crée alors un nouveau réseau privé entre votre machine hôte et votre téléphone avec des adresses comme <code>192.168.2.x</code>. La machine hôte aura sûrement l’adresse <code>192.168.2.1</code> et votre téléphone très probablement <code>192.168.2.2</code>.</p>
<p>C’est alors un autre réseau que le réseau interne à la boite en <code>192.168.1.x</code>.</p>
<p>Notez aussi que la machine hôte, faisant bridge, donne les informations en cascade aux appareils connectés. Ce que vous spécifiez comme serveurs dns sur la machine hôte sera alors ceux utilisés par les appareils étant connectés à votre partage de réseau.</p>
<h3 id="aaaah-dnsmasq"><a class="markdownIt-Anchor" href="#aaaah-dnsmasq">#</a> Aaaah dnsmasq !</h3>
<p>On est sous Mac OS X, la vie est si simple, on installe <strong>dnsmasq</strong> via <strong>homebrew</strong>.</p>
<h4 id="dnsmasq-via-homebrew"><a class="markdownIt-Anchor" href="#dnsmasq-via-homebrew">#</a> dnsmasq via homebrew</h4>
<pre><code>$ <span class="hljs-keyword">brew </span>install dnsmasq</code></pre>
<h4 id="configuration-de-dnsmasq"><a class="markdownIt-Anchor" href="#configuration-de-dnsmasq">#</a> configuration de dnsmasq</h4>
<p>Une fois installé, on copie la configuration :</p>
<pre><code>$ cp <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/opt/</span>dnsmasq<span class="hljs-regexp">/dnsmasq.conf.example /u</span>sr<span class="hljs-regexp">/local/</span>etc<span class="hljs-regexp">/dnsmasq.conf</span></code></pre>
<p>puis on édite le comme ceci :</p>
<pre><code><span class="hljs-comment"># Add domains which you want to force to an IP address here.</span>
<span class="hljs-comment"># The example below send any host in double-click.net to a local</span>
<span class="hljs-comment"># web-server.</span>
<span class="hljs-comment">#address=/double-click.net/127.0.0.1</span>
address=<span class="hljs-regexp">/monsite.dev/</span><span class="hljs-number">192.168</span>.<span class="hljs-number">1.145</span>

<span class="hljs-comment"># If you want dnsmasq to listen for DHCP and DNS requests only on</span>
<span class="hljs-comment"># specified interfaces (and the loopback) give the name of the</span>
<span class="hljs-comment"># interface (eg eth0) here.</span>
<span class="hljs-comment"># Repeat the line for more than one interface.</span>
<span class="hljs-comment">#interface=</span>
<span class="hljs-comment"># Or you can specify which interface _not_ to listen on</span>
<span class="hljs-comment">#except-interface=</span>
<span class="hljs-comment"># Or which to listen on by address (remember to include 127.0.0.1 if</span>
<span class="hljs-comment"># you use this.)</span>
<span class="hljs-keyword">listen</span>-address=<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>
<span class="hljs-comment"># If you don't want dnsmasq to read /etc/hosts, uncomment the</span>
<span class="hljs-comment"># following line.</span>
<span class="hljs-keyword">no</span>-hosts</code></pre>
<p>Nous précisons dans un premier temps la résolution du nom de domaine <code>monsite.dev</code> (notez que c’est du wildcard, donc pas besoin de préciser les sous-domaines), puis nous indiquons que le serveur DNS marche sur toutes les IPs de la machine hôte et enfin nous indiquons que nous ne voulons pas prendre en compte le fichier <code>/etc/hosts</code> vu qu’on spécifie les résolutions via <code>address</code>.</p>
<p>Cela permettra à terme de ne plus gérer le fichier <code>/etc/hosts</code> et de tout spécifier dans <code>dnsmasq.conf</code>.</p>
<h4 id="lancer-dnsmasq-au-d-marrage-de-la-machine"><a class="markdownIt-Anchor" href="#lancer-dnsmasq-au-d-marrage-de-la-machine">#</a> lancer dnsmasq au démarrage de la machine</h4>
<p>On copie le fichier de démon dans le dossier qui va bien puis on lance le démon.</p>
<pre><code>$ sudo <span class="hljs-preprocessor">cp</span> -fv /usr/local/<span class="hljs-preprocessor">opt</span>/dnsmasq<span class="hljs-comment">/*.plist /Library/LaunchDaemons
$ sudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.dnsmasq.plist</span></code></pre>
<h4 id="utiliser-le-serveur-dnsmasq"><a class="markdownIt-Anchor" href="#utiliser-le-serveur-dnsmasq">#</a> utiliser le serveur dnsmasq</h4>
<p>Etant donné que vous partagez votre connexion et que votre poste fait hôte, le serveur dns utilisé sera celui installé sur votre poste, donc rien à faire.</p>
<p>Sinon :</p>
<ul>
<li>
<p>vous pouvez changer le serveur dns de la machine hôte dans <code>network</code> et dans ce cas, que ce soit sur vos appareils connectés au wifi ou votre machine principale, vous utiliserez <strong>dnsmasq</strong> mais je vous le déconseile car j’ai constaté que j’atteignais trop facilement le nombre de connexions maximum.</p>
</li>
<li>
<p>vous pouvez aussi modifier le serveur dns de l’appareil connecté au wifi partagé :</p>
</li>
</ul>
<p><em>(Sous Android)</em></p>
<p><code>Wifi &gt; Press on the current connnection &gt; Modify network &gt; Show advanced options</code></p>
<figure>
  <img src="android-network-advanced.jpg" alt="" />
</figure>
<p>Mais quel intérêt car vous devrez faire cela sur tous vos appareils connectés</p>
<ul>
<li>vous pouvez aussi éditer le fichier <code>/etc/bootpd.plist</code> qui définit toute votre configuration de partage de connexion :</li>
</ul>
<pre><code>$ sudo <span class="hljs-variable">$EDITOR</span> /etc/bootpd.plist</code></pre>
<pre><code class="language-xml"><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-doctype">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">plist</span> <span class="hljs-attribute">version</span>=<span class="hljs-value">"1.0"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dict</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>Subnets<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">array</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">dict</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>_creator<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>com.apple.InternetSharing<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>allocate<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">true</span>/&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>dhcp_domain_name_server<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">array</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>192.168.2.1<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">array</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>dhcp_router<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>192.168.2.1<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>lease_max<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">integer</span>&gt;</span>86400<span class="hljs-tag">&lt;/<span class="hljs-title">integer</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>lease_min<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">integer</span>&gt;</span>86400<span class="hljs-tag">&lt;/<span class="hljs-title">integer</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>name<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>192.168.2/24<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>net_address<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>192.168.2.0<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>net_mask<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>255.255.255.0<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>net_range<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">array</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>192.168.2.2<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>192.168.2.254<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">array</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">dict</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">array</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>bootp_enabled<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">false</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>detect_other_dhcp_server<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">true</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>dhcp_enabled<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">array</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">string</span>&gt;</span>bridge100<span class="hljs-tag">&lt;/<span class="hljs-title">string</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">array</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">key</span>&gt;</span>use_server_config_for_dhcp_options<span class="hljs-tag">&lt;/<span class="hljs-title">key</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">false</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dict</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">plist</span>&gt;</span></code></pre>
<p><code>192.168.2.1</code> est l’adresse de votre machine hôte dans le réseau de partage.</p>
<h2 id="oh-oui-j-oubliais-mac-os-x-peut-tre-lourd-parfois"><a class="markdownIt-Anchor" href="#oh-oui-j-oubliais-mac-os-x-peut-tre-lourd-parfois">#</a> Oh oui, j’oubliais, Mac OS X peut être lourd parfois</h2>
<p>Oui, quand vous créez un partage de connexion sur Mac OS X, il lance son propre serveur dns s’appelant <strong>_mdnsresponder</strong>. C’est le système <em>Bonjour</em> de iOS/Mac OS X permettant à n’importe quel appareil Apple de communiquer entre eux. Le problème c’est qu’il risque de marcher sur les pieds de <strong>dnsmasq</strong>.</p>
<p>Faites donc un <code>$ sudo lsof -i :53</code> et vous pourrez éventuellement voir que <strong>_mdnsresponder</strong> est lancé aussi bien en ipv6 qu’en ipv4 sur le port 53. Cela vous empêchera de lancer <strong>dnsmasq</strong>.</p>
<p>Ce que je vous propose dans ces cas là, c’est de couper votre partage de connexion, puis notez le pid de <strong>_mdnsresponder</strong> via <code>$ sudo lsof -i :53</code>, de le <code>sudo kill :pid</code>, de lancer <code>$ sudo dnsmasq</code> puis de relancer le partage de connexion. Comme ça <strong>_mdnsresponser</strong> ne prendra plus la place de <strong>dnsmasq</strong>.</p>
<p>Autre point, évitez, mais vraiment, de nommer vos noms de domaines personnels en <code>.local</code>. En effet, ceux-ci sont plutôt réservés à l’environnement Mac OS X. Ils sont d’ailleurs en rapport avec <strong>_mdnsresponder</strong>. Les <code>.local</code> permettent à n’importe quel produit Apple sur le réseau de se connecter à d’autres postes Apple via <code>nom-de-l-appareil.local</code>. Votre connexion pourrait alors s’emméler entre le serveur dns de <strong>Bonjour</strong> et votre propre serveur dns.</p>
<p>Happy coding !</p>
</div></div><footer class="putainde-Post-footer" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1"><div data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0"><div class="putainde-Author undefined" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0"><a href="http://kud.io" class="putainde-Avatar putainde-Author-picture" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/655838?v=3&amp;s=128" alt="" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.0.0"/></a><div class="putainde-Author-description" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1"><div class="putainde-Author-title" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0"><h3 class="putainde-Author-name" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.0"><span class="putainde-WrittenBy" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.0.0">Écrit par </span><a class="putainde-Link" href="http://kud.io" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.0.1">kud</a></h3><div class="putainde-Author-social" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.1"><a href="http://kud.io" class="r-Tooltip r-Tooltip--top" data-r-tooltip="Website" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.1.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.1.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M394.072,174.805l-47.916-48.023V88.472h47.916V174.805z M462,275.815h-42.508v166.213H92.508V275.815H50	L256,69.972L462,275.815z M296.847,271.972c-15.811-3.316-29.021,4.086-38.792,19.387c-9.771-15.301-22.98-22.703-38.789-19.387	c-36.746,10.876-36.336,69.543,38.582,113.047C332.908,341.761,333.59,282.848,296.847,271.972z"/></svg></span></a><a href="https://twitter.com/_kud" class="r-Tooltip r-Tooltip--top" data-r-tooltip="Twitter" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.1.1"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.1.1.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764	c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787	c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574	c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699	C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435	C436.339,160.061,450.668,145.174,462,128.223z"/></svg></span></a><a href="https://github.com/kud" class="r-Tooltip r-Tooltip--top" data-r-tooltip="Github" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.1.2"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.0.1.2.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M461.633,250.645l0.367-3.819c-22.896-2.221-45.667-2.419-67.79-0.73	c3.557-11.347,5.43-24.164,5.295-38.739c-0.292-30.965-10.616-55.081-26.843-75.096c3.116-18.852,0.769-37.702-5.111-56.561	c-23.187,1.898-44.053,9.493-62.634,22.686c-34.725-7.044-69.447-7.493-104.172,0c-21.673-14.627-42.956-21.802-63.909-22.686	c-6.21,20.765-7.169,41.233-1.917,61.357c-18.28,19.397-25.268,42.944-24.925,69.019c0.196,14.927,2.496,28.209,6.738,39.952	c-21.796-1.599-44.201-1.386-66.732,0.798l0.367,3.819c22.947-2.228,45.76-2.411,67.919-0.678c0.814,1.974,1.633,3.939,2.567,5.815	c-24.009-0.633-45.618,1.453-65.854,6.43l0.914,3.723c20.538-5.048,42.54-7.081,67.107-6.254	c16.246,28.864,47.52,45.824,93.063,51.205c-10.581,8.594-16.269,18.731-17.735,30.201c0,0-4.787,0-24.121,0	c-32.394,0-41.226-41.304-74.779-37.229C132,320,125.5,371.599,177.587,371.599c17.506,0,21.226,0,21.881,0v47.296	c0.234,7.643-3.093,12.754-8.469,16.297c18.654,1.884,32.674-7.43,32.674-18.854s0-56.948,0-62.518s5.833-6,5.833-6v72.992	c0.245,7.265-3.284,11.392-7.031,15.339c16.434,0.654,31.892-2.629,32.592-16.615c0,0,0-66.345,0-69.857s5.756-3.599,5.756,0	s0,66.58,0,66.58c0.169,11.8,10.361,21.367,31.953,19.893c-5.776-4.65-7.549-9.35-7.549-16.15s0-72.181,0-72.181s5.95-0.306,5.95,6	s0,50.331,0,60.881c0,13.55,16.267,19.14,34.829,18.615c-6.081-4.558-10.196-9.991-10.223-17.256v-73.217	c-0.629-10.762-5.003-20.906-13.582-30.358c41.63-6.392,71.637-23.011,86.578-52.796c24.647-0.847,46.715,1.183,67.307,6.246	l0.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415c0.839-1.891,1.67-3.789,2.389-5.785	C415.363,248.215,438.431,248.391,461.633,250.645z M114,310.023c-1.023,0-1.853-0.588-1.853-1.313c0-0.728,0.83-1.315,1.853-1.315	c1.024,0,1.854,0.588,1.854,1.315C115.854,309.436,115.024,310.023,114,310.023z M119.833,314.003c-1.137,0-2.06-0.653-2.06-1.46	s0.923-1.462,2.06-1.462s2.059,0.655,2.059,1.462S120.97,314.003,119.833,314.003z M125.75,319.172	c-1.333,0-2.415-0.766-2.415-1.712s1.082-1.714,2.415-1.714c1.333,0,2.416,0.768,2.416,1.714S127.083,319.172,125.75,319.172z M131.5,325.379c-1.56,0-2.825-0.896-2.825-2.003s1.265-2.005,2.825-2.005s2.825,0.898,2.825,2.005S133.06,325.379,131.5,325.379z M137.833,332.394c-1.733,0-3.139-0.996-3.139-2.226s1.406-2.228,3.139-2.228s3.139,0.998,3.139,2.228	S139.566,332.394,137.833,332.394z M145.167,339.517c-1.926,0-3.488-1.107-3.488-2.474s1.562-2.476,3.488-2.476	c1.925,0,3.487,1.109,3.487,2.476S147.092,339.517,145.167,339.517z M155.083,346.291c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C158.958,345.06,157.223,346.291,155.083,346.291z M167.375,349.916	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C171.25,348.685,169.515,349.916,167.375,349.916z M180.333,350.333c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C184.208,349.102,182.473,350.333,180.333,350.333z M193.125,350.583	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C197,349.352,195.265,350.583,193.125,350.583z"/></svg></span></a></div></div><p class="putainde-Author-bio" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.1"><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.0.0.1.1.0">Frontend engineer (avec une pointe de back en JavaScript), batteur, s&#x27;essayant à la photographie, aime la cuisine et le cinema.</span></p></div></div></div><div class="putainde-Contributors" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2"><strong class="putainde-Contributors-label" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.0"><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.0.1">4 contributeurs sur cette page</span></strong><div class="r-Grid putainde-Contributors-actions" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.1"><div class="r-Grid-cell r-all--1of3" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.1.0"><a class="putainde-Contributors-action" href="https://github.com/putaindecode/putaindecode.io/edit/master/content/fr/articles/dnsmasq/index.md" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.1.0.0">Modifier</a></div><div class="r-Grid-cell r-all--1of3" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.1.1"><a class="putainde-Contributors-action" href="https://github.com/putaindecode/putaindecode.io/blame/master/content/fr/articles/dnsmasq/index.md" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.1.1.0">Tracer les changements</a></div><div class="r-Grid-cell r-all--1of3" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.1.2"><a class="putainde-Contributors-action" href="https://github.com/putaindecode/putaindecode.io/commits/master/content/fr/articles/dnsmasq/index.md" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.1.2.0">Historique</a></div></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="MoOx
(10 commits)" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:0"><a href="http://moox.io/" class="putainde-Avatar putainde-Contributor-avatar--small" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:0.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/157534?v=3&amp;s=128" alt="" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:0.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="kud
(1 commit)" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:1"><a href="http://kud.io" class="putainde-Avatar putainde-Contributor-avatar--small" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:1.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/655838?v=3&amp;s=128" alt="" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:1.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="bloodyowl
(1 commit)" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:2"><a href="http://bloodyowl.github.io" class="putainde-Avatar putainde-Contributor-avatar--small" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:2.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/1688645?v=3&amp;s=128" alt="" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:2.0.0"/></a></div><div class="putainde-Contributor r-Tooltip r-Tooltip--bottom r-Tooltip--allowNewLines" data-r-tooltip="Macxim
(1 commit)" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:3"><a href="http://macx.im" class="putainde-Avatar putainde-Contributor-avatar--small" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:3.0"><img class="js-AnimateLoad" src="https://avatars.githubusercontent.com/u/1909957?v=3&amp;s=128" alt="" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.2.2:3.0.0"/></a></div></div><div data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.3"><div id="disqus_thread" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.3.0"></div><noscript data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.3.1"><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.3.1.0"><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.3.1.0.0">Please enable JavaScript to view the</span><a href="http://disqus.com/?ref_noscript" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.3.1.0.1">comments powered by Disqus.</a></span></noscript><a href="http://disqus.com" class="dsq-brlink" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.3.2"><span data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.3.2.0">blog comments powered by</span><span class="logo-disqus" data-reactid=".1zql6jxhhj4.0.0.0:2.3.1.1.0.1.3.2.1">Disqus</span></a></div></footer></div></div></article></div></div><div class="putainde-Footer" data-reactid=".1zql6jxhhj4.0.0.0:3"><div class="r-Grid" data-reactid=".1zql6jxhhj4.0.0.0:3.0"><div class="r-Grid-cell r-minM--1of4" data-reactid=".1zql6jxhhj4.0.0.0:3.0.0"><p class="putainde-Footer-text" data-reactid=".1zql6jxhhj4.0.0.0:3.0.0.0">© 1970 - 2015 Putain de code !</p></div><div class="r-Grid-cell r-minM--2of4" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1"><ul class="putainde-Footer-list" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0"><li data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.0:$/feed=1xml"><a href="/feed.xml" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.0:$/feed=1xml.0">Flux RSS</a></li><li data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/forum/issues"><a href="https://github.com/putaindecode/forum/issues" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/forum/issues.0">Forum</a></li><li data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/putaindecode=1io"><a href="https://github.com/putaindecode/putaindecode.io" data-r-tooltip="GitHub" class="r-Tooltip r-Tooltip--top" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/putaindecode=1io.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$https=2//github=1com/putaindecode/putaindecode=1io.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M461.633,250.645l0.367-3.819c-22.896-2.221-45.667-2.419-67.79-0.73	c3.557-11.347,5.43-24.164,5.295-38.739c-0.292-30.965-10.616-55.081-26.843-75.096c3.116-18.852,0.769-37.702-5.111-56.561	c-23.187,1.898-44.053,9.493-62.634,22.686c-34.725-7.044-69.447-7.493-104.172,0c-21.673-14.627-42.956-21.802-63.909-22.686	c-6.21,20.765-7.169,41.233-1.917,61.357c-18.28,19.397-25.268,42.944-24.925,69.019c0.196,14.927,2.496,28.209,6.738,39.952	c-21.796-1.599-44.201-1.386-66.732,0.798l0.367,3.819c22.947-2.228,45.76-2.411,67.919-0.678c0.814,1.974,1.633,3.939,2.567,5.815	c-24.009-0.633-45.618,1.453-65.854,6.43l0.914,3.723c20.538-5.048,42.54-7.081,67.107-6.254	c16.246,28.864,47.52,45.824,93.063,51.205c-10.581,8.594-16.269,18.731-17.735,30.201c0,0-4.787,0-24.121,0	c-32.394,0-41.226-41.304-74.779-37.229C132,320,125.5,371.599,177.587,371.599c17.506,0,21.226,0,21.881,0v47.296	c0.234,7.643-3.093,12.754-8.469,16.297c18.654,1.884,32.674-7.43,32.674-18.854s0-56.948,0-62.518s5.833-6,5.833-6v72.992	c0.245,7.265-3.284,11.392-7.031,15.339c16.434,0.654,31.892-2.629,32.592-16.615c0,0,0-66.345,0-69.857s5.756-3.599,5.756,0	s0,66.58,0,66.58c0.169,11.8,10.361,21.367,31.953,19.893c-5.776-4.65-7.549-9.35-7.549-16.15s0-72.181,0-72.181s5.95-0.306,5.95,6	s0,50.331,0,60.881c0,13.55,16.267,19.14,34.829,18.615c-6.081-4.558-10.196-9.991-10.223-17.256v-73.217	c-0.629-10.762-5.003-20.906-13.582-30.358c41.63-6.392,71.637-23.011,86.578-52.796c24.647-0.847,46.715,1.183,67.307,6.246	l0.914-3.723c-20.394-5.014-42.181-7.096-66.416-6.415c0.839-1.891,1.67-3.789,2.389-5.785	C415.363,248.215,438.431,248.391,461.633,250.645z M114,310.023c-1.023,0-1.853-0.588-1.853-1.313c0-0.728,0.83-1.315,1.853-1.315	c1.024,0,1.854,0.588,1.854,1.315C115.854,309.436,115.024,310.023,114,310.023z M119.833,314.003c-1.137,0-2.06-0.653-2.06-1.46	s0.923-1.462,2.06-1.462s2.059,0.655,2.059,1.462S120.97,314.003,119.833,314.003z M125.75,319.172	c-1.333,0-2.415-0.766-2.415-1.712s1.082-1.714,2.415-1.714c1.333,0,2.416,0.768,2.416,1.714S127.083,319.172,125.75,319.172z M131.5,325.379c-1.56,0-2.825-0.896-2.825-2.003s1.265-2.005,2.825-2.005s2.825,0.898,2.825,2.005S133.06,325.379,131.5,325.379z M137.833,332.394c-1.733,0-3.139-0.996-3.139-2.226s1.406-2.228,3.139-2.228s3.139,0.998,3.139,2.228	S139.566,332.394,137.833,332.394z M145.167,339.517c-1.926,0-3.488-1.107-3.488-2.474s1.562-2.476,3.488-2.476	c1.925,0,3.487,1.109,3.487,2.476S147.092,339.517,145.167,339.517z M155.083,346.291c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C158.958,345.06,157.223,346.291,155.083,346.291z M167.375,349.916	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C171.25,348.685,169.515,349.916,167.375,349.916z M180.333,350.333c-2.14,0-3.875-1.231-3.875-2.749	c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751C184.208,349.102,182.473,350.333,180.333,350.333z M193.125,350.583	c-2.14,0-3.875-1.231-3.875-2.749c0-1.519,1.735-2.751,3.875-2.751s3.875,1.232,3.875,2.751	C197,349.352,195.265,350.583,193.125,350.583z"/></svg></span></a></li><li data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$https=2//twitter=1com/putaindecode_fr/"><a href="https://twitter.com/putaindecode_fr/" data-r-tooltip="Twitter" class="r-Tooltip r-Tooltip--top" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$https=2//twitter=1com/putaindecode_fr/.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$https=2//twitter=1com/putaindecode_fr/.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M462,128.223c-15.158,6.724-31.449,11.269-48.547,13.31c17.449-10.461,30.854-27.025,37.164-46.764	c-16.333,9.687-34.422,16.721-53.676,20.511c-15.418-16.428-37.386-26.691-61.698-26.691c-54.56,0-94.668,50.916-82.337,103.787	c-70.25-3.524-132.534-37.177-174.223-88.314c-22.142,37.983-11.485,87.691,26.158,112.85c-13.854-0.438-26.891-4.241-38.285-10.574	c-0.917,39.162,27.146,75.781,67.795,83.949c-11.896,3.237-24.926,3.978-38.17,1.447c10.754,33.58,41.972,58.018,78.96,58.699	C139.604,378.282,94.846,390.721,50,385.436c37.406,23.982,81.837,37.977,129.571,37.977c156.932,0,245.595-132.551,240.251-251.435	C436.339,160.061,450.668,145.174,462,128.223z"/></svg></span></a></li><li data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$/discuss/"><a href="/discuss/" data-r-tooltip="Discuter" class="r-Tooltip r-Tooltip--top" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$/discuss/.0"><span class="SVGIcon SVGIcon--cleaned putainde-Icon" data-reactid=".1zql6jxhhj4.0.0.0:3.0.1.0.$/discuss/.0.0"><svg class="SVGIcon-svg SVGIcon--cleaned-svg putainde-Icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M174.059,354.374c-0.031-0.008-0.062-0.014-0.093-0.021	c-25.892,15.965-82.983,32.107-123.141,39.412c14.984-29.725,31.616-70.527,30.764-98.977C61.403,270.511,50,239.224,50,207.358	c0-89.84,87.383-155.527,185.209-155.527c97.22,0,185.211,65.193,185.211,155.527c0,1.283-0.027,2.564-0.066,3.844	c-11.285-6.088-23.506-11.037-36.622-14.68c-6.854-60.861-70.842-108.715-148.522-108.715c-82.237,0-149.141,53.631-149.141,119.551	c0,34.688,15.009,56.529,36.192,78.068c-4.306,31.98-14.646,59.781-14.646,59.781s30.542-8.064,65.253-28.275	C171.395,329.616,171.806,342.101,174.059,354.374z M461.432,460.169c-27.634-5.029-66.922-16.137-84.739-27.123	c-98.102,24.029-169.6-36.424-169.6-101.154c0-62.166,60.552-107.029,127.453-107.029c67.322,0,127.454,45.203,127.454,107.029	c0,21.928-7.85,43.457-21.738,60.164C439.674,411.634,451.121,439.712,461.432,460.169z M302.524,333.198	c0-9.648-7.841-17.469-17.515-17.469c-9.673,0-17.515,7.82-17.515,17.469s7.842,17.471,17.515,17.471	C294.684,350.669,302.524,342.847,302.524,333.198z M354.75,333.198c0-9.648-7.841-17.469-17.515-17.469	c-9.673,0-17.515,7.82-17.515,17.469s7.842,17.471,17.515,17.471C346.909,350.669,354.75,342.847,354.75,333.198z M406.339,333.198	c0-9.648-7.842-17.469-17.515-17.469c-9.674,0-17.515,7.82-17.515,17.469s7.841,17.471,17.515,17.471	C398.497,350.669,406.339,342.847,406.339,333.198z"/></svg></span></a></li></ul></div><div class="r-Grid-cell r-minM--1of4 putainde-Footer-text--right" data-reactid=".1zql6jxhhj4.0.0.0:3.0.2"><span class="putainde-Footer-text putainde-Footer-text--small" data-reactid=".1zql6jxhhj4.0.0.0:3.0.2.0"><a class="" href="/en/" data-reactid=".1zql6jxhhj4.0.0.0:3.0.2.0.0">English</a><span data-reactid=".1zql6jxhhj4.0.0.0:3.0.2.0.1"> | </span><a class="" href="/fr/" data-reactid=".1zql6jxhhj4.0.0.0:3.0.2.0.2">Français</a></span></div></div></div><script data-reactid=".1zql6jxhhj4.0.0.1"></script></div></div></div></div><script>window.__INITIAL_STATE__ = {"pages":{"fr/articles/dnsmasq":{"head":{"layout":"Post","comments":true,"date":"2014-02-20","title":"La puissance de dnsmasq","tags":["dnsmasq","macosx","test","dns","serveur"],"authors":["kud"]},"body":"<p>Dernièrement, j’ai voulu accéder avec mon Smartphone à ma machine virtuelle (<em>VM</em>) de développement qui se trouve sur mon poste de travail (<em>machine ou poste hôte</em>). Ma machine virtuelle me permet de reproduire à l’identique la production afin d’avoir le moins de marge d’erreur possible entre la phase de développement et la phase de mise en production.</p>\n<p>A ce moment là, j’accédais à ma machine virtuelle à partir de mon poste via le fichier <em>hosts</em> comprenant ceci :</p>\n<pre><code>192<span class=\"hljs-class\">.168</span><span class=\"hljs-class\">.1</span><span class=\"hljs-class\">.145</span> <span class=\"hljs-tag\">monsite</span><span class=\"hljs-class\">.dev</span></code></pre>\n<p>Le problème est que seul mon poste est au courant de la résolution du nom de domaine de par cette méthode.</p>\n<p>Étant donné qu’il est laborieux de changer des <em>hosts</em> sur un appareil comme un téléphone et que je n’ai pas non plus envie de dupliquer cette modification sur chaque appareil, il me fallait trouver une solution généralisée.</p>\n<p>C’est là que <strong><a href=\"http://fr.wikipedia.org/wiki/Dnsmasq\">dnsmasq</a></strong> entre en jeu.</p>\n<blockquote>\n<p>Dnsmasq est un serveur léger pour fournir les services DNS, DHCP, Bootstrap Protocol et TFTP pour un petit réseau, voire pour un poste de travail. Il permet d’offrir un service de nommage des machines du réseau interne non intégrées au service de nommage global (i.e. le service DNS d’Internet). Le service de nommage est associé au service d’adressage de telle manière que les machines dont le bail DHCP est fourni par Dnsmasq peuvent avoir automatiquement un nom DNS sur le réseau interne. Le logiciel offre un service DHCP statique ou dynamique.</p>\n</blockquote>\n<h2 id=\"dnsmasq-le-serveur-dns-tout-petit\"><a class=\"markdownIt-Anchor\" href=\"#dnsmasq-le-serveur-dns-tout-petit\">#</a> dnsmasq, le serveur dns tout petit</h2>\n<p><strong>dnsmasq</strong> va me permettre de faire plusieurs choses :</p>\n<ul>\n<li>accélérer la résolution dns</li>\n<li>ne pas polluer le réseau interne de la boite avec des résolutions de domaines propre à votre poste (imaginez que vous soyez plusieurs à avoir <em>monsite.dev</em> (ce qui est le cas dans notre boite)); une résolution se ferait uniquement vers un seul poste donc impossible de faire sans si vous êtes plusieurs</li>\n<li>ne pas dupliquer sur chacun appareil la résolution dns</li>\n<li>réussir à résoudre un nom de domaine sur un appareil où le fichier <em>hosts</em> est difficile voire impossible d’accès</li>\n</ul>\n<p>Cependant, tout n’est pas si rose, je vais vous montrer pourquoi après.</p>\n<h3 id=\"partage-de-connexion\"><a class=\"markdownIt-Anchor\" href=\"#partage-de-connexion\">#</a> Partage de connexion</h3>\n<p>Je vous propose dans un premier temps de partager votre connexion via le Wifi sous Mac OS X afin :</p>\n<ul>\n<li>d’avoir constamment un débit stable et performant; étant donné que vous êtes souvent devant votre poste pour tester sur différents appareils, en partageant votre connexion via Wifi, vous vous assurez d’avoir un excellent débit, chose qui n’est pas toujours évidente quand le wifi de votre boite est un peu / souvent trop loin</li>\n<li>d’utiliser le serveur dns (dnsmasq) que vous allez monter</li>\n</ul>\n<p>Pour cela, il suffit de faire : <code>System Preferences &gt; Sharing &gt; Internet Sharing</code> puis choisir <code>Ethernet</code> en source, et <code>Wifi</code> en sortie. (Je vous conseille d’ailleurs de protéger votre Wifi avec une clé WPA2).</p>\n<figure>\n  <img src=\"macosx-network-sharing.png\" alt=\"\" />\n</figure>\n<p><em>Ici, c’est USB Ethernet en source car je suis sur un Mac Book Air donc aucun port ethernet natif mais choisissez Ethernet si possible.</em></p>\n<p>Une fois que le partage de connexion via Wifi est activé, vous pouvez vous y connecter avec votre smartphone (ou tablette).</p>\n<p>Cela crée alors un nouveau réseau privé entre votre machine hôte et votre téléphone avec des adresses comme <code>192.168.2.x</code>. La machine hôte aura sûrement l’adresse <code>192.168.2.1</code> et votre téléphone très probablement <code>192.168.2.2</code>.</p>\n<p>C’est alors un autre réseau que le réseau interne à la boite en <code>192.168.1.x</code>.</p>\n<p>Notez aussi que la machine hôte, faisant bridge, donne les informations en cascade aux appareils connectés. Ce que vous spécifiez comme serveurs dns sur la machine hôte sera alors ceux utilisés par les appareils étant connectés à votre partage de réseau.</p>\n<h3 id=\"aaaah-dnsmasq\"><a class=\"markdownIt-Anchor\" href=\"#aaaah-dnsmasq\">#</a> Aaaah dnsmasq !</h3>\n<p>On est sous Mac OS X, la vie est si simple, on installe <strong>dnsmasq</strong> via <strong>homebrew</strong>.</p>\n<h4 id=\"dnsmasq-via-homebrew\"><a class=\"markdownIt-Anchor\" href=\"#dnsmasq-via-homebrew\">#</a> dnsmasq via homebrew</h4>\n<pre><code>$ <span class=\"hljs-keyword\">brew </span>install dnsmasq</code></pre>\n<h4 id=\"configuration-de-dnsmasq\"><a class=\"markdownIt-Anchor\" href=\"#configuration-de-dnsmasq\">#</a> configuration de dnsmasq</h4>\n<p>Une fois installé, on copie la configuration :</p>\n<pre><code>$ cp <span class=\"hljs-regexp\">/usr/</span>local<span class=\"hljs-regexp\">/opt/</span>dnsmasq<span class=\"hljs-regexp\">/dnsmasq.conf.example /u</span>sr<span class=\"hljs-regexp\">/local/</span>etc<span class=\"hljs-regexp\">/dnsmasq.conf</span></code></pre>\n<p>puis on édite le comme ceci :</p>\n<pre><code><span class=\"hljs-comment\"># Add domains which you want to force to an IP address here.</span>\n<span class=\"hljs-comment\"># The example below send any host in double-click.net to a local</span>\n<span class=\"hljs-comment\"># web-server.</span>\n<span class=\"hljs-comment\">#address=/double-click.net/127.0.0.1</span>\naddress=<span class=\"hljs-regexp\">/monsite.dev/</span><span class=\"hljs-number\">192.168</span>.<span class=\"hljs-number\">1.145</span>\n\n<span class=\"hljs-comment\"># If you want dnsmasq to listen for DHCP and DNS requests only on</span>\n<span class=\"hljs-comment\"># specified interfaces (and the loopback) give the name of the</span>\n<span class=\"hljs-comment\"># interface (eg eth0) here.</span>\n<span class=\"hljs-comment\"># Repeat the line for more than one interface.</span>\n<span class=\"hljs-comment\">#interface=</span>\n<span class=\"hljs-comment\"># Or you can specify which interface _not_ to listen on</span>\n<span class=\"hljs-comment\">#except-interface=</span>\n<span class=\"hljs-comment\"># Or which to listen on by address (remember to include 127.0.0.1 if</span>\n<span class=\"hljs-comment\"># you use this.)</span>\n<span class=\"hljs-keyword\">listen</span>-address=<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">0</span>.<span class=\"hljs-number\">0</span>\n<span class=\"hljs-comment\"># If you don't want dnsmasq to read /etc/hosts, uncomment the</span>\n<span class=\"hljs-comment\"># following line.</span>\n<span class=\"hljs-keyword\">no</span>-hosts</code></pre>\n<p>Nous précisons dans un premier temps la résolution du nom de domaine <code>monsite.dev</code> (notez que c’est du wildcard, donc pas besoin de préciser les sous-domaines), puis nous indiquons que le serveur DNS marche sur toutes les IPs de la machine hôte et enfin nous indiquons que nous ne voulons pas prendre en compte le fichier <code>/etc/hosts</code> vu qu’on spécifie les résolutions via <code>address</code>.</p>\n<p>Cela permettra à terme de ne plus gérer le fichier <code>/etc/hosts</code> et de tout spécifier dans <code>dnsmasq.conf</code>.</p>\n<h4 id=\"lancer-dnsmasq-au-d-marrage-de-la-machine\"><a class=\"markdownIt-Anchor\" href=\"#lancer-dnsmasq-au-d-marrage-de-la-machine\">#</a> lancer dnsmasq au démarrage de la machine</h4>\n<p>On copie le fichier de démon dans le dossier qui va bien puis on lance le démon.</p>\n<pre><code>$ sudo <span class=\"hljs-preprocessor\">cp</span> -fv /usr/local/<span class=\"hljs-preprocessor\">opt</span>/dnsmasq<span class=\"hljs-comment\">/*.plist /Library/LaunchDaemons\n$ sudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.dnsmasq.plist</span></code></pre>\n<h4 id=\"utiliser-le-serveur-dnsmasq\"><a class=\"markdownIt-Anchor\" href=\"#utiliser-le-serveur-dnsmasq\">#</a> utiliser le serveur dnsmasq</h4>\n<p>Etant donné que vous partagez votre connexion et que votre poste fait hôte, le serveur dns utilisé sera celui installé sur votre poste, donc rien à faire.</p>\n<p>Sinon :</p>\n<ul>\n<li>\n<p>vous pouvez changer le serveur dns de la machine hôte dans <code>network</code> et dans ce cas, que ce soit sur vos appareils connectés au wifi ou votre machine principale, vous utiliserez <strong>dnsmasq</strong> mais je vous le déconseile car j’ai constaté que j’atteignais trop facilement le nombre de connexions maximum.</p>\n</li>\n<li>\n<p>vous pouvez aussi modifier le serveur dns de l’appareil connecté au wifi partagé :</p>\n</li>\n</ul>\n<p><em>(Sous Android)</em></p>\n<p><code>Wifi &gt; Press on the current connnection &gt; Modify network &gt; Show advanced options</code></p>\n<figure>\n  <img src=\"android-network-advanced.jpg\" alt=\"\" />\n</figure>\n<p>Mais quel intérêt car vous devrez faire cela sur tous vos appareils connectés</p>\n<ul>\n<li>vous pouvez aussi éditer le fichier <code>/etc/bootpd.plist</code> qui définit toute votre configuration de partage de connexion :</li>\n</ul>\n<pre><code>$ sudo <span class=\"hljs-variable\">$EDITOR</span> /etc/bootpd.plist</code></pre>\n<pre><code class=\"language-xml\"><span class=\"hljs-pi\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span>\n<span class=\"hljs-doctype\">&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">plist</span> <span class=\"hljs-attribute\">version</span>=<span class=\"hljs-value\">\"1.0\"</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">dict</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>Subnets<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">array</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">dict</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>_creator<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">string</span>&gt;</span>com.apple.InternetSharing<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">string</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>allocate<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">true</span>/&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>dhcp_domain_name_server<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">array</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">string</span>&gt;</span>192.168.2.1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">string</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">array</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>dhcp_router<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">string</span>&gt;</span>192.168.2.1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">string</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>lease_max<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">integer</span>&gt;</span>86400<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">integer</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>lease_min<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">integer</span>&gt;</span>86400<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">integer</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>name<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">string</span>&gt;</span>192.168.2/24<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">string</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>net_address<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">string</span>&gt;</span>192.168.2.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">string</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>net_mask<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">string</span>&gt;</span>255.255.255.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">string</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>net_range<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">array</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">string</span>&gt;</span>192.168.2.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">string</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">string</span>&gt;</span>192.168.2.254<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">string</span>&gt;</span>\n      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">array</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">dict</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">array</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>bootp_enabled<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">false</span>/&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>detect_other_dhcp_server<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">true</span>/&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>dhcp_enabled<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">array</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">string</span>&gt;</span>bridge100<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">string</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">array</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">key</span>&gt;</span>use_server_config_for_dhcp_options<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">key</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-title\">false</span>/&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">dict</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-title\">plist</span>&gt;</span></code></pre>\n<p><code>192.168.2.1</code> est l’adresse de votre machine hôte dans le réseau de partage.</p>\n<h2 id=\"oh-oui-j-oubliais-mac-os-x-peut-tre-lourd-parfois\"><a class=\"markdownIt-Anchor\" href=\"#oh-oui-j-oubliais-mac-os-x-peut-tre-lourd-parfois\">#</a> Oh oui, j’oubliais, Mac OS X peut être lourd parfois</h2>\n<p>Oui, quand vous créez un partage de connexion sur Mac OS X, il lance son propre serveur dns s’appelant <strong>_mdnsresponder</strong>. C’est le système <em>Bonjour</em> de iOS/Mac OS X permettant à n’importe quel appareil Apple de communiquer entre eux. Le problème c’est qu’il risque de marcher sur les pieds de <strong>dnsmasq</strong>.</p>\n<p>Faites donc un <code>$ sudo lsof -i :53</code> et vous pourrez éventuellement voir que <strong>_mdnsresponder</strong> est lancé aussi bien en ipv6 qu’en ipv4 sur le port 53. Cela vous empêchera de lancer <strong>dnsmasq</strong>.</p>\n<p>Ce que je vous propose dans ces cas là, c’est de couper votre partage de connexion, puis notez le pid de <strong>_mdnsresponder</strong> via <code>$ sudo lsof -i :53</code>, de le <code>sudo kill :pid</code>, de lancer <code>$ sudo dnsmasq</code> puis de relancer le partage de connexion. Comme ça <strong>_mdnsresponser</strong> ne prendra plus la place de <strong>dnsmasq</strong>.</p>\n<p>Autre point, évitez, mais vraiment, de nommer vos noms de domaines personnels en <code>.local</code>. En effet, ceux-ci sont plutôt réservés à l’environnement Mac OS X. Ils sont d’ailleurs en rapport avec <strong>_mdnsresponder</strong>. Les <code>.local</code> permettent à n’importe quel produit Apple sur le réseau de se connecter à d’autres postes Apple via <code>nom-de-l-appareil.local</code>. Votre connexion pourrait alors s’emméler entre le serveur dns de <strong>Bonjour</strong> et votre propre serveur dns.</p>\n<p>Happy coding !</p>\n","rawBody":"\nDernièrement, j'ai voulu accéder avec mon Smartphone à ma machine virtuelle (_VM_) de développement qui se trouve sur mon poste de travail (_machine ou poste hôte_). Ma machine virtuelle me permet de reproduire à l'identique la production afin d'avoir le moins de marge d'erreur possible entre la phase de développement et la phase de mise en production.\n\nA ce moment là, j'accédais à ma machine virtuelle à partir de mon poste via le fichier _hosts_ comprenant ceci :\n\n```\n192.168.1.145 monsite.dev\n```\n\nLe problème est que seul mon poste est au courant de la résolution du nom de domaine de par cette méthode.\n\nÉtant donné qu'il est laborieux de changer des _hosts_ sur un appareil comme un téléphone et que je n'ai pas non plus envie de dupliquer cette modification sur chaque appareil, il me fallait trouver une solution généralisée.\n\nC'est là que **[dnsmasq](http://fr.wikipedia.org/wiki/Dnsmasq)** entre en jeu.\n\n> Dnsmasq est un serveur léger pour fournir les services DNS, DHCP, Bootstrap Protocol et TFTP pour un petit réseau, voire pour un poste de travail. Il permet d'offrir un service de nommage des machines du réseau interne non intégrées au service de nommage global (i.e. le service DNS d'Internet). Le service de nommage est associé au service d'adressage de telle manière que les machines dont le bail DHCP est fourni par Dnsmasq peuvent avoir automatiquement un nom DNS sur le réseau interne. Le logiciel offre un service DHCP statique ou dynamique.\n\n## dnsmasq, le serveur dns tout petit\n\n**dnsmasq** va me permettre de faire plusieurs choses :\n\n- accélérer la résolution dns\n- ne pas polluer le réseau interne de la boite avec des résolutions de domaines propre à votre poste (imaginez que vous soyez plusieurs à avoir _monsite.dev_ (ce qui est le cas dans notre boite)); une résolution se ferait uniquement vers un seul poste donc impossible de faire sans si vous êtes plusieurs\n- ne pas dupliquer sur chacun appareil la résolution dns\n- réussir à résoudre un nom de domaine sur un appareil où le fichier _hosts_ est difficile voire impossible d'accès\n\nCependant, tout n'est pas si rose, je vais vous montrer pourquoi après.\n\n### Partage de connexion\n\nJe vous propose dans un premier temps de partager votre connexion via le Wifi sous Mac OS X afin :\n\n- d'avoir constamment un débit stable et performant; étant donné que vous êtes souvent devant votre poste pour tester sur différents appareils, en partageant votre connexion via Wifi, vous vous assurez d'avoir un excellent débit, chose qui n'est pas toujours évidente quand le wifi de votre boite est un peu / souvent trop loin\n- d'utiliser le serveur dns (dnsmasq) que vous allez monter\n\nPour cela, il suffit de faire : `System Preferences > Sharing > Internet Sharing` puis choisir `Ethernet` en source, et `Wifi` en sortie. (Je vous conseille d'ailleurs de protéger votre Wifi avec une clé WPA2).\n\n<figure>\n  <img src=\"macosx-network-sharing.png\" alt=\"\" />\n</figure>\n\n_Ici, c'est USB Ethernet en source car je suis sur un Mac Book Air donc aucun port ethernet natif mais choisissez Ethernet si possible._\n\nUne fois que le partage de connexion via Wifi est activé, vous pouvez vous y connecter avec votre smartphone (ou tablette).\n\nCela crée alors un nouveau réseau privé entre votre machine hôte et votre téléphone avec des adresses comme `192.168.2.x`. La machine hôte aura sûrement l'adresse `192.168.2.1` et votre téléphone très probablement `192.168.2.2`.\n\nC'est alors un autre réseau que le réseau interne à la boite en `192.168.1.x`.\n\nNotez aussi que la machine hôte, faisant bridge, donne les informations en cascade aux appareils connectés. Ce que vous spécifiez comme serveurs dns sur la machine hôte sera alors ceux utilisés par les appareils étant connectés à votre partage de réseau.\n\n### Aaaah dnsmasq !\n\nOn est sous Mac OS X, la vie est si simple, on installe **dnsmasq** via **homebrew**.\n\n#### dnsmasq via homebrew\n\n```\n$ brew install dnsmasq\n```\n\n#### configuration de dnsmasq\n\nUne fois installé, on copie la configuration :\n\n```\n$ cp /usr/local/opt/dnsmasq/dnsmasq.conf.example /usr/local/etc/dnsmasq.conf\n```\n\npuis on édite le comme ceci :\n\n```\n# Add domains which you want to force to an IP address here.\n# The example below send any host in double-click.net to a local\n# web-server.\n#address=/double-click.net/127.0.0.1\naddress=/monsite.dev/192.168.1.145\n\n# If you want dnsmasq to listen for DHCP and DNS requests only on\n# specified interfaces (and the loopback) give the name of the\n# interface (eg eth0) here.\n# Repeat the line for more than one interface.\n#interface=\n# Or you can specify which interface _not_ to listen on\n#except-interface=\n# Or which to listen on by address (remember to include 127.0.0.1 if\n# you use this.)\nlisten-address=0.0.0.0\n# If you don't want dnsmasq to read /etc/hosts, uncomment the\n# following line.\nno-hosts\n```\n\nNous précisons dans un premier temps la résolution du nom de domaine `monsite.dev` (notez que c'est du wildcard, donc pas besoin de préciser les sous-domaines), puis nous indiquons que le serveur DNS marche sur toutes les IPs de la machine hôte et enfin nous indiquons que nous ne voulons pas prendre en compte le fichier `/etc/hosts` vu qu'on spécifie les résolutions via `address`.\n\nCela permettra à terme de ne plus gérer le fichier `/etc/hosts` et de tout spécifier dans `dnsmasq.conf`.\n\n#### lancer dnsmasq au démarrage de la machine\n\nOn copie le fichier de démon dans le dossier qui va bien puis on lance le démon.\n\n```\n$ sudo cp -fv /usr/local/opt/dnsmasq/*.plist /Library/LaunchDaemons\n$ sudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.dnsmasq.plist\n```\n\n#### utiliser le serveur dnsmasq\n\nEtant donné que vous partagez votre connexion et que votre poste fait hôte, le serveur dns utilisé sera celui installé sur votre poste, donc rien à faire.\n\nSinon :\n\n- vous pouvez changer le serveur dns de la machine hôte dans `network` et dans ce cas, que ce soit sur vos appareils connectés au wifi ou votre machine principale, vous utiliserez **dnsmasq** mais je vous le déconseile car j'ai constaté que j'atteignais trop facilement le nombre de connexions maximum.\n\n- vous pouvez aussi modifier le serveur dns de l'appareil connecté au wifi partagé :\n\n_(Sous Android)_\n\n`Wifi > Press on the current connnection > Modify network > Show advanced options`\n\n<figure>\n  <img src=\"android-network-advanced.jpg\" alt=\"\" />\n</figure>\n\nMais quel intérêt car vous devrez faire cela sur tous vos appareils connectés\n\n- vous pouvez aussi éditer le fichier `/etc/bootpd.plist` qui définit toute votre configuration de partage de connexion :\n\n```\n$ sudo $EDITOR /etc/bootpd.plist\n```\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n  <key>Subnets</key>\n  <array>\n    <dict>\n      <key>_creator</key>\n      <string>com.apple.InternetSharing</string>\n      <key>allocate</key>\n      <true/>\n      <key>dhcp_domain_name_server</key>\n      <array>\n        <string>192.168.2.1</string>\n      </array>\n      <key>dhcp_router</key>\n      <string>192.168.2.1</string>\n      <key>lease_max</key>\n      <integer>86400</integer>\n      <key>lease_min</key>\n      <integer>86400</integer>\n      <key>name</key>\n      <string>192.168.2/24</string>\n      <key>net_address</key>\n      <string>192.168.2.0</string>\n      <key>net_mask</key>\n      <string>255.255.255.0</string>\n      <key>net_range</key>\n      <array>\n        <string>192.168.2.2</string>\n        <string>192.168.2.254</string>\n      </array>\n    </dict>\n  </array>\n  <key>bootp_enabled</key>\n  <false/>\n  <key>detect_other_dhcp_server</key>\n  <true/>\n  <key>dhcp_enabled</key>\n  <array>\n    <string>bridge100</string>\n  </array>\n  <key>use_server_config_for_dhcp_options</key>\n  <false/>\n</dict>\n</plist>\n```\n\n`192.168.2.1` est l'adresse de votre machine hôte dans le réseau de partage.\n\n## Oh oui, j'oubliais, Mac OS X peut être lourd parfois\n\nOui, quand vous créez un partage de connexion sur Mac OS X, il lance son propre serveur dns s'appelant **_mdnsresponder**. C'est le système _Bonjour_ de iOS/Mac OS X permettant à n'importe quel appareil Apple de communiquer entre eux. Le problème c'est qu'il risque de marcher sur les pieds de **dnsmasq**.\n\nFaites donc un `$ sudo lsof -i :53` et vous pourrez éventuellement voir que **_mdnsresponder** est lancé aussi bien en ipv6 qu'en ipv4 sur le port 53. Cela vous empêchera de lancer **dnsmasq**.\n\nCe que je vous propose dans ces cas là, c'est de couper votre partage de connexion, puis notez le pid de **_mdnsresponder** via `$ sudo lsof -i :53`, de le `sudo kill :pid`, de lancer `$ sudo dnsmasq` puis de relancer le partage de connexion. Comme ça **_mdnsresponser** ne prendra plus la place de **dnsmasq**.\n\nAutre point, évitez, mais vraiment, de nommer vos noms de domaines personnels en `.local`. En effet, ceux-ci sont plutôt réservés à l'environnement Mac OS X. Ils sont d'ailleurs en rapport avec **_mdnsresponder**. Les `.local` permettent à n'importe quel produit Apple sur le réseau de se connecter à d'autres postes Apple via `nom-de-l-appareil.local`. Votre connexion pourrait alors s'emméler entre le serveur dns de **Bonjour** et votre propre serveur dns.\n\nHappy coding !\n","raw":"---\ndate: \"2014-02-20\"\ntitle: La puissance de dnsmasq\ntags:\n  - dnsmasq\n  - macosx\n  - test\n  - dns\n  - serveur\nauthors:\n  - kud\n---\n\nDernièrement, j'ai voulu accéder avec mon Smartphone à ma machine virtuelle (_VM_) de développement qui se trouve sur mon poste de travail (_machine ou poste hôte_). Ma machine virtuelle me permet de reproduire à l'identique la production afin d'avoir le moins de marge d'erreur possible entre la phase de développement et la phase de mise en production.\n\nA ce moment là, j'accédais à ma machine virtuelle à partir de mon poste via le fichier _hosts_ comprenant ceci :\n\n```\n192.168.1.145 monsite.dev\n```\n\nLe problème est que seul mon poste est au courant de la résolution du nom de domaine de par cette méthode.\n\nÉtant donné qu'il est laborieux de changer des _hosts_ sur un appareil comme un téléphone et que je n'ai pas non plus envie de dupliquer cette modification sur chaque appareil, il me fallait trouver une solution généralisée.\n\nC'est là que **[dnsmasq](http://fr.wikipedia.org/wiki/Dnsmasq)** entre en jeu.\n\n> Dnsmasq est un serveur léger pour fournir les services DNS, DHCP, Bootstrap Protocol et TFTP pour un petit réseau, voire pour un poste de travail. Il permet d'offrir un service de nommage des machines du réseau interne non intégrées au service de nommage global (i.e. le service DNS d'Internet). Le service de nommage est associé au service d'adressage de telle manière que les machines dont le bail DHCP est fourni par Dnsmasq peuvent avoir automatiquement un nom DNS sur le réseau interne. Le logiciel offre un service DHCP statique ou dynamique.\n\n## dnsmasq, le serveur dns tout petit\n\n**dnsmasq** va me permettre de faire plusieurs choses :\n\n- accélérer la résolution dns\n- ne pas polluer le réseau interne de la boite avec des résolutions de domaines propre à votre poste (imaginez que vous soyez plusieurs à avoir _monsite.dev_ (ce qui est le cas dans notre boite)); une résolution se ferait uniquement vers un seul poste donc impossible de faire sans si vous êtes plusieurs\n- ne pas dupliquer sur chacun appareil la résolution dns\n- réussir à résoudre un nom de domaine sur un appareil où le fichier _hosts_ est difficile voire impossible d'accès\n\nCependant, tout n'est pas si rose, je vais vous montrer pourquoi après.\n\n### Partage de connexion\n\nJe vous propose dans un premier temps de partager votre connexion via le Wifi sous Mac OS X afin :\n\n- d'avoir constamment un débit stable et performant; étant donné que vous êtes souvent devant votre poste pour tester sur différents appareils, en partageant votre connexion via Wifi, vous vous assurez d'avoir un excellent débit, chose qui n'est pas toujours évidente quand le wifi de votre boite est un peu / souvent trop loin\n- d'utiliser le serveur dns (dnsmasq) que vous allez monter\n\nPour cela, il suffit de faire : `System Preferences > Sharing > Internet Sharing` puis choisir `Ethernet` en source, et `Wifi` en sortie. (Je vous conseille d'ailleurs de protéger votre Wifi avec une clé WPA2).\n\n<figure>\n  <img src=\"macosx-network-sharing.png\" alt=\"\" />\n</figure>\n\n_Ici, c'est USB Ethernet en source car je suis sur un Mac Book Air donc aucun port ethernet natif mais choisissez Ethernet si possible._\n\nUne fois que le partage de connexion via Wifi est activé, vous pouvez vous y connecter avec votre smartphone (ou tablette).\n\nCela crée alors un nouveau réseau privé entre votre machine hôte et votre téléphone avec des adresses comme `192.168.2.x`. La machine hôte aura sûrement l'adresse `192.168.2.1` et votre téléphone très probablement `192.168.2.2`.\n\nC'est alors un autre réseau que le réseau interne à la boite en `192.168.1.x`.\n\nNotez aussi que la machine hôte, faisant bridge, donne les informations en cascade aux appareils connectés. Ce que vous spécifiez comme serveurs dns sur la machine hôte sera alors ceux utilisés par les appareils étant connectés à votre partage de réseau.\n\n### Aaaah dnsmasq !\n\nOn est sous Mac OS X, la vie est si simple, on installe **dnsmasq** via **homebrew**.\n\n#### dnsmasq via homebrew\n\n```\n$ brew install dnsmasq\n```\n\n#### configuration de dnsmasq\n\nUne fois installé, on copie la configuration :\n\n```\n$ cp /usr/local/opt/dnsmasq/dnsmasq.conf.example /usr/local/etc/dnsmasq.conf\n```\n\npuis on édite le comme ceci :\n\n```\n# Add domains which you want to force to an IP address here.\n# The example below send any host in double-click.net to a local\n# web-server.\n#address=/double-click.net/127.0.0.1\naddress=/monsite.dev/192.168.1.145\n\n# If you want dnsmasq to listen for DHCP and DNS requests only on\n# specified interfaces (and the loopback) give the name of the\n# interface (eg eth0) here.\n# Repeat the line for more than one interface.\n#interface=\n# Or you can specify which interface _not_ to listen on\n#except-interface=\n# Or which to listen on by address (remember to include 127.0.0.1 if\n# you use this.)\nlisten-address=0.0.0.0\n# If you don't want dnsmasq to read /etc/hosts, uncomment the\n# following line.\nno-hosts\n```\n\nNous précisons dans un premier temps la résolution du nom de domaine `monsite.dev` (notez que c'est du wildcard, donc pas besoin de préciser les sous-domaines), puis nous indiquons que le serveur DNS marche sur toutes les IPs de la machine hôte et enfin nous indiquons que nous ne voulons pas prendre en compte le fichier `/etc/hosts` vu qu'on spécifie les résolutions via `address`.\n\nCela permettra à terme de ne plus gérer le fichier `/etc/hosts` et de tout spécifier dans `dnsmasq.conf`.\n\n#### lancer dnsmasq au démarrage de la machine\n\nOn copie le fichier de démon dans le dossier qui va bien puis on lance le démon.\n\n```\n$ sudo cp -fv /usr/local/opt/dnsmasq/*.plist /Library/LaunchDaemons\n$ sudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.dnsmasq.plist\n```\n\n#### utiliser le serveur dnsmasq\n\nEtant donné que vous partagez votre connexion et que votre poste fait hôte, le serveur dns utilisé sera celui installé sur votre poste, donc rien à faire.\n\nSinon :\n\n- vous pouvez changer le serveur dns de la machine hôte dans `network` et dans ce cas, que ce soit sur vos appareils connectés au wifi ou votre machine principale, vous utiliserez **dnsmasq** mais je vous le déconseile car j'ai constaté que j'atteignais trop facilement le nombre de connexions maximum.\n\n- vous pouvez aussi modifier le serveur dns de l'appareil connecté au wifi partagé :\n\n_(Sous Android)_\n\n`Wifi > Press on the current connnection > Modify network > Show advanced options`\n\n<figure>\n  <img src=\"android-network-advanced.jpg\" alt=\"\" />\n</figure>\n\nMais quel intérêt car vous devrez faire cela sur tous vos appareils connectés\n\n- vous pouvez aussi éditer le fichier `/etc/bootpd.plist` qui définit toute votre configuration de partage de connexion :\n\n```\n$ sudo $EDITOR /etc/bootpd.plist\n```\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n  <key>Subnets</key>\n  <array>\n    <dict>\n      <key>_creator</key>\n      <string>com.apple.InternetSharing</string>\n      <key>allocate</key>\n      <true/>\n      <key>dhcp_domain_name_server</key>\n      <array>\n        <string>192.168.2.1</string>\n      </array>\n      <key>dhcp_router</key>\n      <string>192.168.2.1</string>\n      <key>lease_max</key>\n      <integer>86400</integer>\n      <key>lease_min</key>\n      <integer>86400</integer>\n      <key>name</key>\n      <string>192.168.2/24</string>\n      <key>net_address</key>\n      <string>192.168.2.0</string>\n      <key>net_mask</key>\n      <string>255.255.255.0</string>\n      <key>net_range</key>\n      <array>\n        <string>192.168.2.2</string>\n        <string>192.168.2.254</string>\n      </array>\n    </dict>\n  </array>\n  <key>bootp_enabled</key>\n  <false/>\n  <key>detect_other_dhcp_server</key>\n  <true/>\n  <key>dhcp_enabled</key>\n  <array>\n    <string>bridge100</string>\n  </array>\n  <key>use_server_config_for_dhcp_options</key>\n  <false/>\n</dict>\n</plist>\n```\n\n`192.168.2.1` est l'adresse de votre machine hôte dans le réseau de partage.\n\n## Oh oui, j'oubliais, Mac OS X peut être lourd parfois\n\nOui, quand vous créez un partage de connexion sur Mac OS X, il lance son propre serveur dns s'appelant **_mdnsresponder**. C'est le système _Bonjour_ de iOS/Mac OS X permettant à n'importe quel appareil Apple de communiquer entre eux. Le problème c'est qu'il risque de marcher sur les pieds de **dnsmasq**.\n\nFaites donc un `$ sudo lsof -i :53` et vous pourrez éventuellement voir que **_mdnsresponder** est lancé aussi bien en ipv6 qu'en ipv4 sur le port 53. Cela vous empêchera de lancer **dnsmasq**.\n\nCe que je vous propose dans ces cas là, c'est de couper votre partage de connexion, puis notez le pid de **_mdnsresponder** via `$ sudo lsof -i :53`, de le `sudo kill :pid`, de lancer `$ sudo dnsmasq` puis de relancer le partage de connexion. Comme ça **_mdnsresponser** ne prendra plus la place de **dnsmasq**.\n\nAutre point, évitez, mais vraiment, de nommer vos noms de domaines personnels en `.local`. En effet, ceux-ci sont plutôt réservés à l'environnement Mac OS X. Ils sont d'ailleurs en rapport avec **_mdnsresponder**. Les `.local` permettent à n'importe quel produit Apple sur le réseau de se connecter à d'autres postes Apple via `nom-de-l-appareil.local`. Votre connexion pourrait alors s'emméler entre le serveur dns de **Bonjour** et votre propre serveur dns.\n\nHappy coding !\n","__filename":"fr/articles/dnsmasq/index.md","__url":"/fr/articles/dnsmasq/","type":"Post"}}}</script><script src="/statinamic-client.js"></script></body></html>
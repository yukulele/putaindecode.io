<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title><![CDATA[Putain de code !]]></title>
        <description><![CDATA[Putain de code !]]></description>
        <link>http://putaindecode.fr</link>
        <generator>RSS for Node</generator>
        <lastBuildDate>Thu, 07 May 2015 05:44:56 GMT</lastBuildDate>
        <atom:link href="http://putaindecode.fr/feed.xml" rel="self" type="application/rss+xml"/>
        <language><![CDATA[fr]]></language>
        <category><![CDATA[code]]></category>
        <item>
            <title><![CDATA[Utiliser React en moteur de templates]]></title>
            <description><![CDATA[<p>Vous connaissez probablement tous des moteurs de templates.
En JavaScript nous avons Handlebars, Jade, EJS, Slimâ€¦
Tous ces projets partent de bonnes intentions mais Ã  lâ€™utilisation,
on peut sentir des limitations et donc de lâ€™insatisfaction.</p>
<p>Utiliser Handlebars par exemple, câ€™est un peu devoir coder tout un tas de helpers
pour gÃ©rer une partie de votre affichage, Ã§a peut vite devenir lourd.
ÃŠtre restreint Ã  une syntaxe limitÃ© par choix est un peu frustrant.
Quand câ€™est pas Ã§a, câ€™est la syntaxe du moteur qui va Ãªtre lourde.</p>
<p>On peut en regretter PHP. Faut avouer que ce language Ã©tait plutÃ´t simple
Ã  utiliser en tant que moteur de template.
Efficace et pas de restrictions. On trouve mÃªme parfois des <code>mysql_query()</code>
dans des templatesâ€¦</p>
<p>Blague Ã  part, nous cherchions des langages pour refaire une partie de notre site
puisque nous nâ€™Ã©tions pas vraiment satisfaits du processus actuel
(anciennement Handlebars, puis Jade).</p>
<p>Mais au final, pourquoi ne pas rester avec du JavaScript, purement et simplement ?</p>
<p>Câ€™est ce que nous avons fait avec React et JSX qui sont de plus en plus utilisÃ©s.
La syntaxe est plutÃ´t libÃ©ratrice.</p>
<p>Pour ceux qui ne connaissent pas JSX, il sâ€™agit dâ€™un superset de JavaScript qui
supporte une syntaxe XML transformÃ© en appel de fonctions JavaScript.
Il faut dire que le XML a beau Ãªtre verbeux, pour dÃ©finir des
Ã©lÃ©ments ayant des propriÃ©tÃ©s et des enfants, on a pas vraiment fait plus
lisible et clair sur ce point. Le HTML est plutÃ´t simple Ã  prendre en main câ€™est
certain. Les mÃ©thodes de rendu de React (ce qui va nous intÃ©resser) sont trÃ¨s proche
de lâ€™HTML.</p>
<p>Ceux qui ont utilisÃ© JSX (bien quâ€™ayant pu avoir des nausÃ©es au premier contact)
avouent souvent quâ€™ils ont fini par aimer cette petite syntaxe crÃ©Ã©e par Facebook qui
fonctionne trÃ¨s bien avec React.</p>
<p>Du coup, si on utilisait Ã§a pour faire de simple templates et non pas des composants
dâ€™interface utilisateur dynamiques ? Qui peut le plus peut le moins (quoi quâ€™en
fait, des templates, câ€™est un peu des composants dâ€™interface).</p>
<h2 id="exemple-de-template-react-jsx">
      <a class="putainde-Title-anchor" href="#exemple-de-template-react-jsx">#</a>
      Exemple de template React/JSX
    </h2><p>Si vous ne savez pas trop ce quâ€™est React, nous vous recommandons de lire
notre <a href="/posts/js/introduction-a-reactjs/">introduction Ã  React</a>.</p>
<p>Dans notre cas, on ne va pas spÃ©cialement bÃ©nÃ©ficier de certaines de ses forces,
mais Ã§a fera trÃ¨s bien le job pour notre besoin.</p>
<p>Nous nâ€™aborderons pas dans le dÃ©tail la syntaxe React/JSX, ni ES6, pour rester
focalisÃ©s sur la finalitÃ© (on a prÃ©vu des articles Ã  ce propos, en attendant
  <a href="http://babeljs.io/docs/learn-es6/">voici de quoi vous occuper avec ES6</a>).</p>
<p><em>Attention, pour ceux qui sont encore sur des plugins jQuery, Ã§a risque de vous
piquer les yeux</em> ğŸ˜­.</p>
<p><a name="es6-class"></a></p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, {Component} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>

export default class PostTemplate extends Component {

  static displayName = <span class="hljs-string">"PostTemplate"</span>

  render() {
    return (
      &lt;html&gt;
        &lt;head&gt;
          &lt;title&gt;{this.props.pageTitle}&lt;/title&gt;
        &lt;/head&gt;
        &lt;body&gt;
          &lt;article className=<span class="hljs-string">"org-Post"</span>&gt;
            &lt;header className=<span class="hljs-string">"org-Post-header"</span>&gt;
              &lt;h1&gt;{this.props.pageTitle}&lt;/h1&gt;
            &lt;/header&gt;
            &lt;div
              className=<span class="hljs-string">"org-Post-content"</span>
              dangerouslySetInnerHTML={{__html: this.props.pageContent}}
            /&gt;
          &lt;/article&gt;
        &lt;/body&gt;
      &lt;/html&gt;
    )
  }
}
</code></pre>
<p>Ce que vous voyez câ€™est bien du JavaScript. Un peu amÃ©liorÃ© via JSX, on ne va
pas le nier (dans notre cas, on gÃ¨re tout Ã§a de maniÃ¨re transparente avec
<a href="http://babeljs.io/">babel(-node)</a>).</p>
<p>Ã‡a ressemble drÃ´lement Ã  de lâ€™HTML et câ€™est Ã§a qui est apprÃ©ciable pour nous.
Vous noterez que lâ€™attribut pour dÃ©finir une classe HTML est <code>className</code> puisque
React est en JavaScript et que le mot <code>class</code> est rÃ©servÃ©
(cf. <a href="#es6-class">la dÃ©finition en ES6 de la classe</a>).</p>
<p>En mÃªme temps ce qui est cool, câ€™est quâ€™on reste dans du JavaScript.</p>
<p>On peut donc utiliser toutes nos bibliothÃ¨ques prÃ©fÃ©rÃ©s via <em>npm</em> pour lâ€™affichage
(exemple : <code>momentjs</code>), ou simplement des boucles via les mÃ©thodes de parcours de
tableau tel que <code>forEach()</code> ou <code>map()</code> en appelant dâ€™autres composants.</p>
<p>Ci-dessous vous trouverez un exemple plus complexe avec une page pour la liste
des posts et quelques composants.
Les balises qui ressemblent Ã  de HTML et qui commencent par une majuscule sont liÃ©s Ã  des
composants qui doivent Ãªtre dÃ©finis (dans notre cas importÃ©s).
Câ€™est une particularitÃ© de React.</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, {Component} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>

<span class="hljs-keyword">import</span> Html <span class="hljs-keyword">from</span> <span class="hljs-string">"../Html"</span>
<span class="hljs-keyword">import</span> Head <span class="hljs-keyword">from</span> <span class="hljs-string">"../Head"</span>
<span class="hljs-keyword">import</span> Body <span class="hljs-keyword">from</span> <span class="hljs-string">"../Body"</span>
<span class="hljs-keyword">import</span> PostsList <span class="hljs-keyword">from</span> <span class="hljs-string">"../PostsList"</span>

export default class Posts extends Component {

  static displayName = <span class="hljs-string">"Posts"</span>

  render() {
    return (
      &lt;Html&gt;
        &lt;Head title={this.props.file.title} /&gt;
        &lt;Body&gt;
          &lt;h1&gt;{this.props.file.title}&lt;/h1&gt;
          &lt;PostsList
            posts={
              this.props.collections.posts
                .filter((item) =&gt; {
                  /*
                    ce que vous voulez pour filtrer votre collection
                    eg:
                    return !item.draft
                  */
                }
              }
          /&gt;
        &lt;/Body&gt;
      &lt;/Html&gt;
    )
  }
}
</code></pre>
<p>Voici deux exemples de composants utilisÃ©s ci-dessus :</p>
<h3 id="head">
      <a class="putainde-Title-anchor" href="#head">#</a>
      Head
    </h3><pre><code class="lang-js"><span class="hljs-keyword">import</span> React, {Component} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>

export default class Head extends Component {

  static displayName = <span class="hljs-string">"Head"</span>

  render() {
    return (
      &lt;head&gt;
        &lt;meta charSet=<span class="hljs-string">"utf-8"</span> /&gt;
        &lt;meta httpEquiv=<span class="hljs-string">"X-UA-Compatible"</span> content=<span class="hljs-string">"IE=Edge"</span> /&gt;
        &lt;meta
          name=<span class="hljs-string">"viewport"</span>
          content=<span class="hljs-string">"width=device-width, initial-scale=1.0, minimal-ui"</span>
        /&gt;
        &lt;title&gt;{this.props.title}&lt;/title&gt;
        &lt;link
          rel=<span class="hljs-string">"stylesheet"</span>
          href=<span class="hljs-string">"/index.css"</span>
        /&gt;
        &lt;link
          rel=<span class="hljs-string">"alternate"</span>
          href=<span class="hljs-string">"/feed.xml"</span>
          title={this.props.title}
          type=<span class="hljs-string">"application/atom+xml"</span>
        /&gt;
        {this.props.children}
      &lt;/head&gt;
    )
  }
}
</code></pre>
<h3 id="body">
      <a class="putainde-Title-anchor" href="#body">#</a>
      Body
    </h3><pre><code class="lang-js"><span class="hljs-keyword">import</span> React, {Component, PropTypes} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>

<span class="hljs-keyword">import</span> Header <span class="hljs-keyword">from</span> <span class="hljs-string">"../Header"</span>
<span class="hljs-keyword">import</span> Footer <span class="hljs-keyword">from</span> <span class="hljs-string">"../Footer"</span>
<span class="hljs-keyword">import</span> GoogleAnalytics <span class="hljs-keyword">from</span> <span class="hljs-string">"../Analytics"</span>

export default class Body extends Component {

  static displayName = <span class="hljs-string">"Body"</span>

  render() {
    return (
      &lt;body&gt;

        &lt;Header /&gt;

        &lt;div className=<span class="hljs-string">"Main"</span>&gt;
          {this.props.children}
        &lt;/div&gt;

        &lt;Footer /&gt;

        &lt;script src={<span class="hljs-string">"/index.js"</span>}&gt;&lt;/script&gt;

        &lt;GoogleAnalytics /&gt;

      &lt;/body&gt;
    )
  }
}
</code></pre>
<p>Bon câ€™est bien beau mais comment je gÃ¨re lâ€™affichage du composant initial
au final (le parent) ?</p>
<h2 id="comment-utiliser-un-template-react-jsx">
      <a class="putainde-Title-anchor" href="#comment-utiliser-un-template-react-jsx">#</a>
      Comment utiliser un template React/JSX ?
    </h2><p>Câ€™est bien simple. Dans notre cas, pas besoin de React cÃ´tÃ© client. On doit gÃ©rer
Ã§a cÃ´tÃ© Â« serveur Â» (je met Ã§a entre guillement puisque dans notre cas prÃ©cis, câ€™est
pour gÃ©nÃ©rer un site statique, et câ€™est donc sur une machine quelconque que la
gÃ©nÃ©ration se fait).</p>
<p>VoilÃ  de quoi effectuer le rendu de nos composants vers du bon vieux HTML (car câ€™est la finalitÃ©
dâ€™un <em>moteur de template</em>).</p>
<pre><code class="lang-js">import react from &quot;react&quot;
import markdownify from &quot;./markdown-parser&quot;
// je vous conseille marked pour rendre du markdown
// c&#39;est ce que nous utilisons pour rendre nos pages Ã  l&#39;heure oÃ¹ j&#39;Ã©cris ce post

const reactClass = require(&quot;./template/PostTemplate&quot;)
const component = new (react.createFactory(reactClass))({
  // ici on passe nos &quot;props&quot; react
  pageTitle: &quot;Test&quot;,
  pageContent: markdownify(&quot;Imaginons du **markdown** parsÃ©&quot;),
  // vous pouvez bien entendu rajouter d&#39;autres choses
  collections: {
    posts: [
      //...
    ]
  }
})

let html
try {
  html = react.renderToStaticMarkup(component)
}
catch (err) {
  // Vous devrez gÃ©rer votre exception selon votre environnement
  // si c&#39;est pour un test on peut simplement ne pas utiliser
  // try/catch, Ã§a nous pÃ¨tera Ã  la gueule et c&#39;est tant mieux
  throw err
}

// maintenant vous faites ce que vous voulez de votre string html !
// ex: require(&quot;fs&quot;).writeFile(...)
</code></pre>
<p>La mÃ©thode intÃ©ressante de React est dans notre cas <code>renderToStaticMarkup()</code> qui
va nous gÃ©nÃ©rer un HTML qui va bien.</p>
<p>Pour aller plus loin on pourrait dÃ©cider dâ€™utiliser <code>renderToString()</code> plutÃ´t que
<code>renderToStaticMarkup()</code> afin de pouvoir faire prendre le relais Ã  ReactJS cÃ´tÃ© client
mais lÃ  <a href="/posts/js/reactjs-et-rendu-serverside/">le niveau de complexitÃ© est diffÃ©rent</a>.</p>
<p>Pour la petit anecdote, notre site utilise actuellement <a href="http://www.metalsmith.io/">metalsmith</a>,
une petite bibliothÃ¨que simple mais qui permet par son API de faire des choses sympas.</p>
<p>Jâ€™ai donc codÃ© <a href="https://github.com/search?q=user%3AMoOx+metalsmith">quelques plugins metalsmith</a>
dont un <a href="https://github.com/MoOx/metalsmith-react">metalsmith-react</a> Ã  lâ€™occassion.</p>
<p>Nâ€™hÃ©sitez pas Ã  consulter
<a href="https://github.com/putaindecode/putaindecode.fr">le code source de notre site</a>
pour faire des dÃ©couvertes sympas.</p>
]]></description>
            <link>http://putaindecode.fr/posts/js/utiliser-react-en-moteur-de-templates/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/utiliser-react-en-moteur-de-templates/</guid>
            <pubDate>Thu, 07 May 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[ImplÃ©menter Flux]]></title>
            <description><![CDATA[<p>Si vous nâ€™avez pas encore lu
<a href="http://putaindecode.fr/posts/js/flux-qu-est-ce-c-est/">lâ€™introduction Ã  flux</a>,
nâ€™hÃ©sitez pas Ã  jeter un Å“il avant de lire ce post.</p>
<p>Une des choses importantes avec Flux, et pourtant pas Ã©videntes aprÃ¨s lecture
<a href="https://github.com/facebook/flux/tree/master/examples/">des exemples officiels</a>,
câ€™est que les stores doivent Ãªtre des instances, et non des singletons que
les composants rÃ©cupÃ¨rent en dÃ©pendance directe.</p>
<p>La raison de cette nÃ©cessitÃ©, câ€™est la possibilitÃ© de servir une page
pre-rendue sur le serveur. En soi, vous devez impÃ©rativement amorcer votre
dispatcher et vos stores dans le scope de la requÃªte, ou vos utilisateurs
se retrouveront avec des stores remplis de data ne leur appartenant pas.</p>
<p>Puisque lâ€™intÃ©rÃªt dâ€™une solution comme react dans le cadre du server-side
rendering est dâ€™utiliser les mÃªmes composants que sur le client, il faut
que notre approche soit convenable sur nos deux environements.</p>
<p>La question dÃ¨s lors est Â«comment passer les stores Ã  nos composants react
maintenant quâ€™ils ne sont plus des dÃ©pendances directes ?Â».</p>
<p>On va les passer via les <code>props</code> de parent Ã  enfant ? lolnope.
La plupart de nos composants nâ€™auront pas conscience de la prÃ©sence de ces
stores, et seront utilisÃ©s dans diffÃ©rents contextes. Et câ€™est justement
lâ€™API <code>context</code> que nous allons utiliser.</p>
<p>Cette API est assez simple, en soi, le <code>context</code> dâ€™un composant est construit
au fur et Ã  mesure que ses ancÃªtres dÃ©cident dâ€™y ajouter de la data.</p>
<p>Exemple simple :</p>
<pre><code class="lang-javascript">import React, {Component, PropTypes} from "react"

class App extends Component {

  // on dÃ©finit les types de ce que l'on souhaite passer dans
  // le contexte
  static childContextTypes = {
    foo: PropTypes.string,
  }

  // on crÃ©e une mÃ©thode qui retourne ce contexte
  getChildContext() {
    return {
      foo: this.props.foo,
    }
  }

  render() {
    return (
      &lt;div className="putainde-App"&gt;
        &lt;Container /&gt;
      &lt;/div&gt;
    )
  }
}

class Container extends Component {

  // les contextes sont *merged*, ce qui nous permet de le construire
  // sans se soucier du niveau auquel sera notre composant.
  static childContextTypes = {
    bar: PropTypes.string,
  }

  getChildContext() {
    return {
      bar: "oh hai",
    }
  }

  render() {
    return (
      &lt;div className="putainde-Container"&gt;
        &lt;IntermediaryComponent /&gt;
      &lt;/div&gt;
    )
  }

}

// ce composant n'a pas besoin de savoir que ses enfants on besoin
// de certaines propriÃ©tÃ©s du contexte
class IntermediaryComponent extends Component {
  render() {
    return (
      &lt;Content /&gt;
    )
  }
}

class Content extends Component {

  // pour chaque composant utilisant des propriÃ©tÃ©s du contexte,
  // on stipule ce dont on a besoin
  static contextTypes = {
    foo: PropTypes.string,
    bar: PropTypes.string,
  }

  render() {
    return (
      &lt;div className="putainde-Content"&gt;
        &lt;div className="putainde-Content-line"&gt;
          &lt;strong&gt;foo&lt;/strong&gt;: {this.context.foo}
        &lt;/div&gt;
        &lt;div className="putainde-Content-line"&gt;
          &lt;strong&gt;bar&lt;/strong&gt;: {this.context.bar}
        &lt;/div&gt;
      &lt;/div&gt;
    )
  }

}

React.render(
  &lt;App foo={Date.now()} /&gt;,
  document.getElementById("App")
)
</code></pre>
<p>Cela nous donne cet output :
<a href="http://jsbin.com/zitohibaze/1/">http://jsbin.com/zitohibaze/1/</a></p>
<p>GrÃ¢ce Ã  cette API, on peut crÃ©er des composants isolÃ©s, et dont les
composants parents nâ€™auront pas nÃ©cessairement besoin de connaÃ®tre le
contexte.</p>
<p>Lâ€™idÃ©e, pour en revenir Ã  Flux, câ€™est de passer notre dispatcher dans
ce contexte, et de placer les stores dans le dispatcher au moment de
lâ€™amorce de lâ€™app.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> dispatcher = <span class="hljs-keyword">new</span> Dispatcher()

dispatcher.registerStore(<span class="hljs-keyword">new</span> SomeStore())
dispatcher.registerStore(<span class="hljs-keyword">new</span> SomeOtherStore())

React.render(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">App</span> <span class="hljs-attribute">dispatcher</span>=<span class="hljs-value">{dispatcher}</span> /&gt;</span>,
  document.getElementById("App")
)</span>
</code></pre>
<p>DÃ©sormais, pour avoir une API dÃ©cente pour rÃ©cuperer les donnÃ©es des stores,
on a deux principales solutions:</p>
<ul>
<li>utiliser un mixin</li>
<li>utiliser un higher-order component</li>
</ul>
<p>Puisque la direction que prend lâ€™API de React, Ã  terme, est de ne plus
fournir de mixins, et de laisser au TC39 le temps de prendre la bonne
dÃ©cision sur la faÃ§on dont JavaScript traitera la composition ; il semble
plus adÃ©quat dâ€™utiliser un higher-order component. Cela aura en plus
lâ€™avantage de rendre le composant rÃ©cupÃ©rant les donnÃ©es <em>stateless</em>.</p>
<p>Ce genre dâ€™API ressemble Ã  Ã§a :</p>
<pre><code class="lang-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComponentWithData</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  static stores = {
    <span class="hljs-comment">// nom du store: nom de la prop souhaitÃ©e</span>
    MyStore: <span class="hljs-string">"my_store"</span>,
  }

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
        {/* la data est passÃ©e via les props*/}
        {this.props.my_store.foo}
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    )</span>
  }
}

<span class="hljs-comment">// storeReceiver wrap `ComponentWithData` dans un higher-order component</span>
<span class="hljs-comment">// et se charge de rÃ©cupÃ©rer le store dans le contexte pour les passer</span>
<span class="hljs-comment">// dans les props de `ComponentWithData`</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> storeReceiver(ComponentWithData)
</code></pre>
<p>Enfin, avec cette approche, les action creators que lâ€™on voit dans les
exemples de flux ne peuvent plus garder la mÃªme forme, puisquâ€™il ne doivent
plus avoir le dispatcher comme dÃ©pendance directe (ce dernier Ã©tant une
instance). Du coup, ce sont dÃ©sormais des fonctions pures :</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> PostActions = {
  getPost(slug) {
    <span class="hljs-keyword">return</span> {
      type: ActionTypes.POST_GET,
      slug: slug,
    }
  },
  receivePost(res) {
    <span class="hljs-keyword">return</span> {
      type: ActionTypes.POST_RECEIVE,
      res,
    }
  },
  error(res) {
    <span class="hljs-keyword">return</span> {
      type: ActionTypes.POST_ERROR,
      res,
    }
  },
}
</code></pre>
<p>et nos composants utilisent :</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React, {Component, PropTypes} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
<span class="hljs-keyword">import</span> PostActions <span class="hljs-keyword">from</span> <span class="hljs-string">"actions/PostActions"</span>

class MyComponent extends Component {

  static contextTypes = {
    dispatcher: PropTypes.object,
  }

  static propTypes = {
    slug: PropTypes.string,
    title: PropTypes.title,
  }

  handleClick() {
    this.context.dispatcher.dispatch(
      PostActions.getPost(this.props.slug)
    )
  }

  render() {
    return (
      &lt;button
        onClick={() =&gt; this.handleClick()}&gt;
        {this.props.title}
      &lt;/button&gt;
    )
  }
}
</code></pre>
<p>Pour rÃ©sumer, les avantages de cette approche sont :</p>
<ul>
<li>un meilleur dÃ©couplage</li>
<li>une isolation solide des composants</li>
<li>la possibilitÃ© de pre-render sur le serveur</li>
<li>une testabilitÃ© accrue, puisquâ€™il est simple dâ€™utiliser un mock ou des
instances crÃ©es pour le test dans le contexte de nos composants.</li>
</ul>
<p>Bisous bisous.</p>
]]></description>
            <link>http://putaindecode.fr/posts/js/implementer-flux/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/implementer-flux/</guid>
            <pubDate>Fri, 01 May 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[HATEOAS, le Graal des dÃ©veloppeurs d'API]]></title>
            <description><![CDATA[<p>Nous vivons aujourdâ€™hui dans un monde oÃ¹ tout devient service. Twitter, Facebook, Google Drive, GitHub, tout le monde y va de sa petite API pour que nous, geeks, puissions profiter pleinement des moult fonctionnalitÃ©s offertes par ces plateformes. Quâ€™entend-on par service ? Comment les rendre disponibles facilement et intelligemment ? On va essayer dâ€™y rÃ©pondre ! </p>
<h2 id="les-webservices">
      <a class="putainde-Title-anchor" href="#les-webservices">#</a>
      Les webservices
    </h2><p>Rappelons juste, pour mettre tout le monde dâ€™accord, ce qui se passe pendant une simple navigation web.</p>
<ol>
<li>Tu tapes lâ€™adresse de ton site prÃ©fÃ©rÃ©</li>
<li>Le navigateur envoie la requÃªte</li>
<li>Le navigateur reÃ§oit du code HTML et lâ€™interprÃ¨te, pour voir sâ€™il faut charger dâ€™autres choses</li>
<li>Le navigateur relance les requÃªtes pour charger les images, scripts et CSS</li>
<li>Le navigateur reÃ§oit toutes les ressources et te les affiche dans sa fenÃªtre.</li>
</ol>
<p>On parle donc de contenu quâ€™il faut afficher pour les Ãªtres humains, avec des images, des styles et des comportements qui facilitent lâ€™ergonomie et te permettent de dire <em>â€œwouaouw, ce site est vraiment beau, cool et pratique !â€</em></p>
<p>Imaginons maintenant la mÃªme chose, mais Ã  destination des programmes, qui ne consomment que de lâ€™information brute et structurÃ©e, on ne va donc plus sâ€™encombrer avec les CSS, les JS, et autres gifs animÃ©s (oui, les gifs animÃ©s, Ã§a les fait pas marrer les machinesâ€¦) ! On va se concentrer sur le contenu Ã©changÃ© et sur les moyens utilisÃ©s pour optimiser ces Ã©changes.</p>
<h3 id="la-premiere-ecole-soap">
      <a class="putainde-Title-anchor" href="#la-premiere-ecole-soap">#</a>
      La premiÃ¨re Ã©cole : SOAP
    </h3><p>Imaginons deux programmes qui veulent discuter en passant par le web. Dans les annÃ©es 90, des mecs super brillants se sont dit : <em>â€œOn va se baser sur le XML pour faire communiquer nos programmes sur le webâ€</em>.
Lâ€™approche est assez logique et ingÃ©nieuse. Tout dâ€™abord, les deux parties (le client et le serveur) se partagent une notice dâ€™utilisation : la WSDL (Web Service Description Language), qui est un document XML dÃ©crivant toutes les mÃ©thodes qui peuvent Ãªtre appelÃ©es par le client sur le serveur, avec les structures de donnÃ©es disponibles pour ces Ã©changes.
Le client prÃ©pare donc sa demande et lâ€™enveloppe dans une grosse structure XML contenant toutes les mÃ©tadonnÃ©es (mÃ©thode appelÃ©e, signature numÃ©rique, etc.). Une fois que le serveur a reÃ§u cette demande, il la traite et rÃ©pond aussi dans une grosse enveloppe XML.</p>
<p>Tu viens de comprendre le SOAP (Service Oriented Application Protocol), aucun rapport avec une quelconque savonnette du coup. Cette mÃ©thode a fait ses preuves puisquâ€™elle fait tourner encore aujourdâ€™hui des milliers de systÃ¨mes trÃ¨s complexes et trÃ¨s fiables.</p>
<h3 id="la-maison-d-en-face-rest">
      <a class="putainde-Title-anchor" href="#la-maison-d-en-face-rest">#</a>
      La maison dâ€™en face : REST
    </h3><p>Plusieurs annÃ©es ont passÃ©es et les esprits ont Ã©voluÃ©. On a commencÃ© Ã  entendre des grandes dÃ©clarations comme : <em>â€œLe SOAP câ€™est vraiment lourdingue !â€</em>, <em>â€œLe protocole HTTP est sous-exploitÃ© !â€</em> ou encore <em>â€œLes enveloppes XML et les WSDL ? Merci bien !â€</em> et câ€™est Ã  ce moment-lÃ  quâ€™on a donnÃ© un acronyme bidon pour dÃ©crire le protocole HTTP sans vraiment le nommer : REST (REpresentational State Transfert). Pour lâ€™anecdote, tout le monde sâ€™accorde Ã  dire que cet acronyme ne veut rien dire ;)</p>
<p>Le but du jeu est donc dâ€™utiliser au maximum les possibilitÃ©s du protocole HTTP, les verbes, les URL et les codes retours pour dÃ©crire des API de la maniÃ¨re la plus fidÃ¨le possible. On a donc gagnÃ© en simplicitÃ© et la communication entre machines se veut dÃ©sormais Ã  la portÃ©e de tous. Je reviendrai en dÃ©tail sur le protocole HTTP un peu plus tard.</p>
<h3 id="un-partout-balle-au-centre">
      <a class="putainde-Title-anchor" href="#un-partout-balle-au-centre">#</a>
      Un partout : balle au centre
    </h3><p>Je tiens Ã  remettre les choses au clair. On entend beaucoup trop souvent : <em>â€œFais du REST, SOAP câ€™est nulâ€</em>. Il y a en effet clairement un effet de mode ! Les API REST pullulent et sont vraiment trÃ¨s pratiques. Toutefois, dans les gros systÃ¨mes nÃ©cessitant du RPC ou encore de la signature numÃ©rique, pour les Ã©changes de donnÃ©es mÃ©dicales par exemple, le contrat WSDL et la rigueur du XML sont clairement des alliÃ©s ! </p>
<h2 id="alors-comme-ca-http-ca-fait-tout">
      <a class="putainde-Title-anchor" href="#alors-comme-ca-http-ca-fait-tout">#</a>
      Alors comme Ã§a, HTTP Ã§a fait tout ?
    </h2><p>Il y a un type qui sâ€™appelle Leonard Richardson et qui a mis en place un <a href="http://martinfowler.com/articles/richardsonMaturityModel.html">modÃ¨le de maturitÃ©</a> pour qualifier les API webservice.</p>
<h3 id="niveau-0">
      <a class="putainde-Title-anchor" href="#niveau-0">#</a>
      Niveau 0
    </h3><p>Câ€™est le minimum acceptable dans la communication HTTP :</p>
<ul>
<li>Toutes les requÃªtes sont envoyÃ©es Ã  la mÃªme URL, quelle que soit la demande.</li>
<li>Toutes les requÃªtes sont envoyÃ©es avec le verbe POST.</li>
<li>Quel que soit le type de retour (donnÃ©e ou erreur), le code HTTP retournÃ© par le serveur sera toujours 200 (OK, tout sâ€™est bien passÃ©).</li>
<li>Le contenu Ã©changÃ© est majoritairement du XML (pour les enveloppes notamment).</li>
</ul>
<p>Quand on fait du webservice avec SOAP, câ€™est ce niveau qui est utilisÃ© lors de la communication HTTP.</p>
<h3 id="niveau-1">
      <a class="putainde-Title-anchor" href="#niveau-1">#</a>
      Niveau 1
    </h3><p>Avec ce premier niveau, on essaye dâ€™enrichir un peu plus lâ€™utilisation. On ajoute la notion de <em>ressource</em>, en fonction de la donnÃ©e mÃ©tier manipulÃ©e, lâ€™URL de la requÃªte sera diffÃ©rente. La preuve par lâ€™exemple :</p>
<ul>
<li><strong><em>POST /agenda</em></strong> : permet de travailler avec les donnÃ©es de lâ€™agenda de lâ€™application</li>
<li><strong><em>POST /customers</em></strong> : permet de travailler avec le registre des clients  </li>
</ul>
<p>On profite aussi de la vue hiÃ©rarchique que nous proposent les URL :</p>
<ul>
<li><strong><em>POST /customers/42</em></strong> : permet de travailler avec le client qui possÃ¨de lâ€™identifiant 42</li>
</ul>
<p>Rien quâ€™en traÃ§ant les URL appelÃ©es sur le serveur, on peut comprendre ce que le client HTTP cherche Ã  faireâ€¦ pas dÃ©gueu, non ?</p>
<h3 id="niveau-2">
      <a class="putainde-Title-anchor" href="#niveau-2">#</a>
      Niveau 2
    </h3><p>Le protocole HTTP utilise des verbes pour les requÃªtes et des codes numÃ©riques pour les retours. Ce sont ces deux mÃ©canismes qui seront utilisÃ©s en complÃ©ment du niveau 1.</p>
<p>Les principaux verbes HTTP que lâ€™on utilise sont GET, POST, PUT et DELETE. Leur nom est dÃ©jÃ  trÃ¨s Ã©vocateur.</p>
<ul>
<li><strong><em>GET /customers/42</em></strong> pour rÃ©cupÃ©rer les informations du client 42</li>
<li><strong><em>PUT /customers</em></strong> <em>(+ corps de la requÃªte)</em> pour enregistrer un nouveau client</li>
<li><strong><em>POST /customers/42</em></strong> <em>(+ corps de la requÃªte)</em> pour mettre Ã  jour les informations du client 42</li>
<li><strong><em>DELETE /customers/42</em></strong> pour supprimer le client 42</li>
</ul>
<p>Facile, non ? La rÃ©ponse du serveur devient tout aussi logique grÃ¢ce aux codes HTTP.
Ces codes sont juste des nombres de 3 chiffres respectant cette logique :</p>
<ul>
<li><strong><em>1xx</em></strong> : <em>â€œJe suis en train de bosser, attends encore un peu.â€</em></li>
<li><strong><em>2xx</em></strong> : <em>â€œVoilÃ  le rÃ©sultat, Ã§a sâ€™est bien passÃ©.â€</em></li>
<li><strong><em>3xx</em></strong> : <em>â€œLe contenu est dÃ©placÃ©, va voir ailleurs (cf. en-tÃªte location).â€</em></li>
<li><strong><em>4xx</em></strong> : <em>â€œTu me demandes nâ€™importe quoi, tu as merdÃ©.â€</em></li>
<li><strong><em>5xx</em></strong> : <em>â€œJâ€™ai merdÃ©â€¦â€</em></li>
</ul>
<p>Parmi les plus connus, on a donc 404 (<em>â€œtu me demandes quelque chose qui nâ€™existe pasâ€</em>), 403 (<em>â€œaccÃ¨s interditâ€</em>), 304 (<em>â€œpas la peine de mâ€™emmerder, la donnÃ©e est dans ton cacheâ€</em>) et bien sÃ»r 200 (<em>â€œOK, tout va bienâ€</em>).</p>
<p>Et si les codes HTTP sont ta nouvelle passion, je te suggÃ¨re de te documenter sur le code <a href="http://fr.wikipedia.org/wiki/Hyper_Text_Coffee_Pot_Control_Protocol">418</a> !</p>
<h3 id="niveau-3-hateoas">
      <a class="putainde-Title-anchor" href="#niveau-3-hateoas">#</a>
      Niveau 3 : HATEOAS
    </h3><p>Alors on a les verbes HTTP et les codes retours. Ã€ quoi peut ressembler le Graal des API REST alors ? Si on rÃ©flÃ©chit un peu, on peut se dire quâ€™il faudrait, pour toutes les URL, donner un code retour HTTP cohÃ©rent pour chaque verbe, logique non ? De cette maniÃ¨re, on peut entamer un vÃ©ritable dialogue avec le serveur HTTP, entiÃ¨rement basÃ© sur REST. VoilÃ  une bonne nouvelle pour ceux qui veulent tailler une bavette ailleurs que sur Google Hangouts !</p>
<p>Un petit exemple de dialogue : </p>
<pre><code>&gt; <span class="hljs-type">GET</span> /customers/<span class="hljs-number">42</span>
<span class="hljs-number">200</span> <span class="hljs-type">OK</span>

&gt; <span class="hljs-type">PUT</span> /customers/<span class="hljs-number">42</span> <span class="hljs-decorator">{...}</span>
<span class="hljs-number">409</span> <span class="hljs-type">Conflict</span>

&gt; <span class="hljs-type">DELETE</span> /customers/<span class="hljs-number">42</span>
<span class="hljs-number">204</span> <span class="hljs-type">No</span> <span class="hljs-type">Content</span>

&gt; <span class="hljs-type">GET</span> /customers/<span class="hljs-number">42</span>
<span class="hljs-number">404</span> <span class="hljs-type">Not</span> <span class="hljs-type">Found</span>
</code></pre><p>Câ€™est un bon dÃ©but, mais ce niveau 3 va quand mÃªme un peu plus loin ! Nâ€™as-tu jamais trouvÃ© gÃ©nial quâ€™avec de simples liens dans les pages web, tu pouvais naviguer des heures et des heures ? </p>
<p>Pourquoi ne pas ajouter des liens dans les ressources retournÃ©es via REST ? Nous venons de mettre le doigt sur HATEOAS (<em>Hypermedia As The Engine Of Application State</em>). On peut dÃ©sormais imaginer un tas de choses comme :</p>
<ul>
<li>Quand on renvoie un tableau json par exemple, dans chaque item, <ul>
<li>on peut ajouter les liens qui permettent de le mettre Ã  jour ;</li>
<li>on peut ajouter les liens qui permettent de rÃ©cupÃ©rer des donnÃ©es liÃ©es comme lâ€™auteur dâ€™un livre, les mentions dâ€™un tweet, etc. ;</li>
<li>on peut ajouter lâ€™URL de putaindecode.fr.</li>
</ul>
</li>
</ul>
<p>Voici un exemple de trame JSON avec les informations HATEOAS. Pour information, il sâ€™agit dâ€™un webservice qui permet de lister des confÃ©rences.</p>
<pre><code><span class="hljs-collection">[
  <span class="hljs-collection">{
    <span class="hljs-string">"conference"</span>: <span class="hljs-collection">{
      <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,
      <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
        <span class="hljs-collection">{
          <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
          <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/conferences/"</span>
        }</span>,
        <span class="hljs-collection">{
          <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
          <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/conferences/1"</span>
        }</span>
      ]</span>,
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"Take Off Conf 2013"</span>,
      <span class="hljs-string">"startDate"</span>: <span class="hljs-string">"2013-01-17T00:00:00+01:00"</span>,
      <span class="hljs-string">"endDate"</span>: <span class="hljs-string">"2013-01-18T00:00:00+01:00"</span>,
      <span class="hljs-string">"talks"</span>: <span class="hljs-collection">[
        <span class="hljs-collection">{
          <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,
          <span class="hljs-string">"speakerName"</span>: <span class="hljs-string">"Jakob Mattsson"</span>,
          <span class="hljs-string">"title"</span>: <span class="hljs-string">"You are not service oriented enough!"</span>,
          <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/1"</span>
            }</span>,
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/"</span>
            }</span>
          ]</span>
        }</span>,
        <span class="hljs-collection">{
          <span class="hljs-string">"id"</span>: <span class="hljs-number">2</span>,
          <span class="hljs-string">"speakerName"</span>: <span class="hljs-string">"Olivier Lacan"</span>,
          <span class="hljs-string">"title"</span>: <span class="hljs-string">"Science-based development"</span>,
          <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/2"</span>
            }</span>,
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/"</span>
            }</span>
          ]</span>
        }</span>,
        <span class="hljs-collection">{
          <span class="hljs-string">"id"</span>: <span class="hljs-number">3</span>,
          <span class="hljs-string">"speakerName"</span>: <span class="hljs-string">"Xavier Coulon"</span>,
          <span class="hljs-string">"title"</span>: <span class="hljs-string">"Build your website with awestruct and publish..."</span>,
          <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/3"</span>
            }</span>,
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/"</span>
            }</span>
          ]</span>
        }</span>,
        <span class="hljs-collection">{
          <span class="hljs-string">"id"</span>: <span class="hljs-number">4</span>,
          <span class="hljs-string">"speakerName"</span>: <span class="hljs-string">"RÃ©mi Parmentier"</span>,
          <span class="hljs-string">"title"</span>: <span class="hljs-string">"Design for developers"</span>,
          <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/4"</span>
            }</span>,
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/"</span>
            }</span>
          ]</span>
        }</span>
      ]</span>
    }</span>
  }</span>,<span class="hljs-collection">{
  ...
  }</span> 
]</span>
</code></pre><p>Dans cette trame, tu auras remarquÃ© les objets dans les tableaux nommÃ©s â€œlinksâ€, ce sont les liens disponibles pour chacun des objets renvoyÃ©s ! On peut imaginer quâ€™en fonction des droits de lâ€™utilisateur courant, il y ait plus ou moins de liens.</p>
<h2 id="est-ce-que-c-est-standard">
      <a class="putainde-Title-anchor" href="#est-ce-que-c-est-standard">#</a>
      Est-ce que câ€™est standard ?
    </h2><p>Eh bien non ! Il nâ€™y a pas vraiment de convention pour lâ€™Ã©criture des liens dans les trames renvoyÃ©es. Cela dÃ©pend du format renvoyÃ© dans un premier temps. Comment formaliser un standard si on renvoie en JSON, XML et YML en fonction des en-tÃªtes HTTP du client ?</p>
<p>De la mÃªme maniÃ¨re, tu auras remarquÃ© que lâ€™on ne prÃ©cise pas le verbe HTTP Ã  utiliser sur les URL. Câ€™est la raison pour laquelle il faut implÃ©menter un retour cohÃ©rent pour tous les verbes HTTP courants !</p>
<p>Et pour finir, comment connaÃ®tre le format du document JSON acceptÃ© avec les requÃªtes POST par exemple ? Il nâ€™y a pas non plus de rÃ¨gle ! On pourrait imaginer par exemple un document â€œtypeâ€ qui serait renvoyÃ© aprÃ¨s une requÃªte â€œOPTIONâ€ sur lâ€™URL.</p>
<p>Il y a toutefois quelques expÃ©rimentations comme <a href="http://en.wikipedia.org/wiki/Hypertext_Application_Language">HAL</a> ou encore <a href="http://jsonapi.org/">JSON API</a> qui tentent de normaliser un peu ce flou artistique.</p>
<p>Tu fais ta petite popote ! Tu fais comme tu veux ! Ã‡a a du bon aussi !</p>
<h2 id="bon-ok-je-fais-comment-pour-le-mettre-en-place-maintenant">
      <a class="putainde-Title-anchor" href="#bon-ok-je-fais-comment-pour-le-mettre-en-place-maintenant">#</a>
      â€œBon ok, je fais comment pour le mettre en place maintenant ?â€
    </h2><p>Tu remontes tes manches et tu te dÃ©merdes !</p>
<p>Il y a quelques frameworks qui vont te donner un coup de main. Dans le monde Java par exemple, il existe <a href="http://docs.jboss.org/resteasy/docs/2.0.0.GA/userguide/html/LinkHeader.html">Resteasy-links</a> (avec un exemple dâ€™utilisation <a href="https://github.com/awillemant/hateoas-example">sur mon repo GitHub</a>), ou encore <a href="http://projects.spring.io/spring-hateoas/">Spring HATEOAS</a></p>
<p>Pour les <em>Nodistes</em>, une simple recherche sur <a href="https://www.npmjs.com/search?q=hateoas">npmjs</a> renverra un tas dâ€™outils ! </p>
<h2 id="references">
      <a class="putainde-Title-anchor" href="#references">#</a>
      RÃ©fÃ©rences
    </h2><p>Oui, parce quâ€™il y a des gens bien plus brillants que moi pour vous convaincre sur lâ€™Hypermedia !</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/HATEOAS">WikipÃ©dia</a></li>
<li><a href="http://martinfowler.com/articles/richardsonMaturityModel.html">Blog de Martin Fowler</a></li>
<li>Les travaux de Steve Klabnik, Rubyiste reconnu (ex : <a href="https://www.youtube.com/watch?v=g4sqydY3hHU">Designing Hypermedia APIs</a>)</li>
<li>Ori Pekelman : <a href="https://www.youtube.com/watch?v=ZZxOaCP8vyg">son talk Ã  la Take Off Conf 2014</a></li>
<li><a href="http://blog.xebia.fr/2014/03/17/post-vs-put-la-confusion/">Un excellent article de Xebia sur la bonne utilisation de POST et PUT</a></li>
</ul>
]]></description>
            <link>http://putaindecode.fr/posts/api/hateoas/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/api/hateoas/</guid>
            <pubDate>Thu, 12 Mar 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Du CSS Ã©volutif]]></title>
            <description><![CDATA[<p>Modulaire, maintenable, rÃ©utilisable, accessible. Ces termes sont au cÅ“ur de nos mÃ©tiers et on nous les rabÃ¢che toute la journÃ©e.</p>
<p>MalgrÃ© la grossiÃ¨retÃ© de ces mots pour certains dâ€™entre vous, il est tout Ã  fait possible de pondre du CSS en utilisant tous ces principes.</p>
<h2 id="maintenable">
      <a class="putainde-Title-anchor" href="#maintenable">#</a>
      Maintenable
    </h2><p>Lâ€™un des trucs les plus chiants du CSS câ€™est bien la cascade, qui, malgrÃ© sa bonne volontÃ©, nâ€™apporte pas que des solutions. Pour pallier aux problÃ¨mes que lâ€™on peut vite crÃ©er, <a href="http://putaindecode.fr/posts/css/petite-definition-bem/">la mÃ©thodologie BEM</a> a vu le jour avec son <a href="http://blog.kaelig.fr/post/48196348743/fifty-shades-of-bem">lot de variantes</a>.</p>
<p>La grande majoritÃ© des membres de p! utilisent cette convention :</p>
<pre><code class="lang-css"><span class="hljs-class">.MyComponent</span> <span class="hljs-rules">{}</span>
<span class="hljs-class">.MyComponent</span><span class="hljs-class">.is-state</span> <span class="hljs-rules">{}</span>
<span class="hljs-class">.MyComponent--modifier</span> <span class="hljs-rules">{}</span>

<span class="hljs-class">.MyComponent-element</span> <span class="hljs-rules">{}</span>
<span class="hljs-class">.MyComponent-anotherElement</span> <span class="hljs-rules">{}</span>
</code></pre>
<p>Dâ€™un coup dâ€™Å“il, on devine la structure <code>HTML</code> qui en dÃ©coule et lâ€™utilitÃ© de chaque Ã©lÃ©ment. Les Ã©tats sont toujours les mÃªmes et clairement identifiables car commenÃ§ant par <code>is-*</code>, de mÃªme que les Ã©lÃ©ments dÃ©finis par <code>-</code> ainsi que les modificateurs <code>--</code>.</p>
<p>Avec cette mÃ©thodologie rares sont les sÃ©lecteurs dÃ©passant :</p>
<pre><code class="lang-css"><span class="hljs-class">.MyComponent-element</span> <span class="hljs-class">.MyComponent-anotherElement</span> <span class="hljs-rules">{}</span>
</code></pre>
<p>Lâ€™intÃ©rÃªt ? Apporter de la sÃ©mantique Ã  notre code CSS, en utilisant des classes, des classes et des classes afin de clairement sâ€™abstraire de la cascade. Finis les <code>!important</code>, on Ã©vite ainsi les problÃ¨mes dâ€™Ã©lÃ©ments et les soudains changements de structure HTML qui te forcent Ã  rÃ©Ã©crire tes sÃ©lecteurs.</p>
<p>Cette mÃ©thode est dâ€™ailleurs, entre autres, utilisÃ©e par <a href="http://twitter.com">Twitter</a> via <a href="http://suitcss.github.io/">SUIT CSS</a>.</p>
<h2 id="modulaire">
      <a class="putainde-Title-anchor" href="#modulaire">#</a>
      Modulaire
    </h2><p>Partant de notre mÃ©thodologie, on va dÃ©velopper notre site web comme un gros Lego. Chaque partie graphique de notre projet sera un composant, une brique.</p>
<p>On pourrait imaginer des Ã©lÃ©ments comme <code>NavBar</code>, <code>Pagination</code>, <code>Article</code> que lâ€™on va assembler au fur et Ã  mesure de notre dÃ©veloppement. Notre site sera composÃ© de plusieurs dizaines de fichiers (<code>Composant</code>), mais aucun nâ€™excÃ¨dera quelques centaines de lignes, grand maximum. Beaucoup plus facile Ã  dÃ©bugger et donc sur le long terme plus maintenable.</p>
<p>Il va de soi quâ€™on utilisera son outil prÃ©fÃ©rÃ© pour concatÃ©ner et minimiser le tout en un seul fichier, sinon on risque dâ€™avoir quelques problÃ¨mes de <em>webperf</em>.</p>
<h2 id="accessible">
      <a class="putainde-Title-anchor" href="#accessible">#</a>
      Accessible
    </h2><p>Pour obtenir un design adaptatif ou accessible, il est nÃ©cessaire dâ€™utiliser des unitÃ©s dites relatives. Câ€™est Ã  ce moment quâ€™interviennent les unitÃ©s stars du moment que sont <code>em</code> et <code>rem</code>.</p>
<p>Mais voilÃ  que <code>em</code> rencontre un inconvÃ©nient majeur, encore et toujours notre fameuse cascade. Chaque Ã©lÃ©ment dÃ©pend de son propre <code>font-size</code> ou de celui de son parent. Alors, vous imaginez lâ€™Ã©lÃ©ment de lâ€™Ã©lÃ©ment de lâ€™Ã©lÃ©ment. On peut vite perdre les pÃ©dales. Je vous vois venir avec lâ€™unitÃ© <code>rem</code>. Effectivement on rÃ©sout complÃ¨tement le problÃ¨me de la cascade, mais on perd en modularitÃ©.</p>
<p>Prenons notre exemple de <code>NavBar</code>, voici comment on pourrait commencer ce composant :</p>
<pre><code class="lang-css"><span class="hljs-class">.NavBar</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> <span class="hljs-number">1rem</span></span></span>;
}</span>
  <span class="hljs-class">.NavBar-item</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> .<span class="hljs-number">875em</span></span></span>;
    <span class="hljs-rule"><span class="hljs-attribute">padding</span>:<span class="hljs-value"> <span class="hljs-number">1em</span></span></span>;
  }</span>
</code></pre>
<p>Notre classe principale Ã©tant dÃ©finie en <code>rem</code>, il devient alors trÃ¨s facile de calculer lâ€™ensemble de ces <code>-item</code> en <code>em</code>.
On diminue ainsi de nouveau les problÃ¨mes de cascade. De plus, on peut trÃ¨s facilement augmenter la taille gÃ©nÃ©rale de notre composant, en augmentant la taille de son <code>font-size</code> dans sa classe principale.
On atteint alors un double dâ€™objectif : en plus dâ€™Ãªtre accessible en supprimant les pixels, on rend notre composant rÃ©utilisable sur dâ€™autres projets en sâ€™adaptant trÃ¨s facilement Ã  son contexte.</p>
<h2 id="namespace">
      <a class="putainde-Title-anchor" href="#namespace">#</a>
      Namespace
    </h2><p>On utilise tous des scripts <code>vendors</code>. Pour Ã©viter les collisions avec ceux-ci et encore une fois Ã  cause de cette maudite cascade, voici un petit truc qui vous Ã©vitera de modifier vos classes : lâ€™ajout dâ€™un namespace Ã  nos composants.</p>
<p>On va utiliser notre exemple de tout Ã  lâ€™heure avec <code>NavBar</code> :</p>
<pre><code class="lang-css"><span class="hljs-class">.putainde-NavBar</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> <span class="hljs-number">1rem</span></span></span>;
}</span>
  <span class="hljs-class">.putainde-NavBar-item</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> .<span class="hljs-number">875em</span></span></span>;
    <span class="hljs-rule"><span class="hljs-attribute">padding</span>:<span class="hljs-value"> <span class="hljs-number">1em</span></span></span>;
  }</span>
</code></pre>
<h2 id="pour-finir">
      <a class="putainde-Title-anchor" href="#pour-finir">#</a>
      Pour finir
    </h2><p>Câ€™est verbeux, on ne peut pas le nier. Par moment, on peut se dire quâ€™Ã©crire une classe seulement pour une propriÃ©tÃ©, est-ce si pertinent que Ã§a ? Sauf quâ€™au moment ou vous Ã©crivez votre <code>css</code> vous ne pouvez pas dire quâ€™Ã  la prochaine mise Ã  jour, il vous faudra peut-Ãªtre en rajouter 5, et donc votre classe sera finalement bien utile.</p>
<p>Toutes ces mÃ©thodes mâ€™ont fait abandonner <code>Sass</code> et son framework <code>Compass</code>. Ce quâ€™apporte un langage comme <code>Sass</code> (au-delÃ  de lâ€™aspect programmation, mais câ€™est une autre histoire) vient principalement de ses features telles que  <a href="http://sass-lang.com/documentation/file.SASS_REFERENCE.html#nested_rules">nested</a> et <a href="http://sass-lang.com/documentation/file.SASS_REFERENCE.html#extend">@extend</a>. Et franchement, une bonne indentation, un bon nommage de classes et une utilisation intelligente de <code>BEM</code> vous feront vite oublier <code>Sass</code> sans regarder en arriÃ¨re.</p>
<p>Sur lâ€™ensemble de mes projets, je nâ€™Ã©cris plus que ce quâ€™on appelle communÃ©ment du <code>Vanilla CSS</code>. Petit bÃ©mol quand mÃªme, histoire de pouvoir utiliser des spÃ©cifications pas forcÃ©ment encore compatibles sur tous les navigateurs, jâ€™ai ajoutÃ© dans mon workflow lâ€™outil <a href="https://github.com/postcss/postcss">PostCSS</a>, le tout contrÃ´lÃ© par <a href="http://cssnext.github.io/">cssnext</a> dont voici quelques exemples dâ€™<a href="https://cssnext.github.io/cssnext-playground/">utilisation</a>.</p>
<p>Je vous encourage vivement Ã  tester ces deux outils (<a href="https://github.com/postcss/postcss">PostCSS</a> ou <a href="http://cssnext.github.io/">cssnext</a>) qui vous apporteront variables, manipulation des couleurs, etc, ainsi que concatÃ©nation des <code>@import</code> tout en conservant du CSS valide (selon les spÃ©cifications).</p>
<h2 id="le-truc-du-moment">
      <a class="putainde-Title-anchor" href="#le-truc-du-moment">#</a>
      Le truc du moment
    </h2><p>Avant de terminer cet article, je voulais mentionner lâ€™idÃ©e/concept qui commence Ã  faire son petit bout de chemin Ã  savoir le <code>style inline</code>.</p>
<p>Cela revient tout simplement Ã  Ã©crire directement le CSS dans son code <code>HTML</code></p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"font-size:1rem"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"font-size:.875em; padding:1em"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>Avant dâ€™hurler au blasphÃ¨me ou au scandale, il est nÃ©cessaire de mettre en adÃ©quation cette idÃ©e avec les contraintes rencontrÃ©es lors du dÃ©veloppement dâ€™une application utilisant principalement du <code>JavaScript</code>.</p>
<p>Si vous souhaitez un peu plus dâ€™informations sur le sujet, je vous invite Ã  lire la <a href="https://speakerdeck.com/vjeux/react-css-in-js">prÃ©sentation</a> de <a href="https://twitter.com/Vjeux">@Vjeux</a>, front-end engineer chez Facebook. Il explique les problÃ¨mes rencontrÃ©s avec le <code>CSS</code> et les solutions mises en place par les dÃ©veloppeurs de Facebook ou plus exactement de <code>ReactJS</code>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/css/du-css-evolutif/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/css/du-css-evolutif/</guid>
            <pubDate>Tue, 10 Mar 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Il dÃ©marre Vim par erreur, ce qui se passe ensuite est tout simplement bluffant]]></title>
            <description><![CDATA[<blockquote>
<p>Ã€ premiÃ¨re vue, vous allez Ã©prouver de la tristesse, mais ce qui se passe ensuite est tout simplement incroyableâ€¦</p>
<p>Alors quâ€™il Ã©tait en train dâ€™effectuer une mise en production,
ce dÃ©veloppeur sâ€™est confrontÃ© Ã  une situation qui aurait pu complÃ¨tement dÃ©raper.
Une intervention directement sur le serveur de production Ã©tait obligatoire afin dâ€™Ã©diter la base de donnÃ©es au format .txt.</p>
<p>AprÃ¨s avoir passÃ© plusieurs heures pour se connecter Ã  distance via une connexion sÃ©curisÃ©e,
Maxime est tombÃ© nez Ã  nez avec une console dâ€™administration en ligne de commande !
Il Ã©tait complÃ¨tement dÃ©semparÃ© par lâ€™absence de fenÃªtre.</p>
<p>Ce qui sâ€™est passÃ© ensuite est tout simplement incroyable :
fort de sa persÃ©vÃ©rance, Maxime dÃ©cide tout de mÃªme de se rapprocher du clavier !
AprÃ¨s une rapide recherche sur les Internets,
il tape la premiÃ¨re commande quâ€™il trouve :</p>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>vim
</code></pre>
<p>Alors quâ€™on pourrait imaginer un drame, comme il arrive souvent quand <a href="https://duckduckgo.com/?q=I+am+stuck+in+VIM">une personne tombe dans ce piÃ¨ge</a>,
Maxime ne sâ€™est pas laissÃ© abattre et a persistÃ© dans sa dÃ©marcheâ€¦</p>
</blockquote>
<p>Bon, assez plaisantÃ©.</p>
<h2 id="pourquoi-j-essayerais-vim">
      <a class="putainde-Title-anchor" href="#pourquoi-j-essayerais-vim">#</a>
      <em>Pourquoi jâ€™essayerais Vim ?</em>
    </h2><p>Jâ€™ai commencÃ© par Eclipse. Quâ€™il fallait rÃ©installer assez souvent sans quoi on perdait 10 minutes de sa vie Ã  chaque ouverture dâ€™autocomplete.
Je suis passÃ© par NetBeans, WebStormâ€¦ Sans Ãªtre convaincu. Plus rÃ©cemment, jâ€™Ã©tais assez content sous Sublime Text avant dâ€™essayer Atom
(car en gros Atom est quasiment la mÃªme chose, en technologie web, open source et fait par GitHub).
Mais jâ€™ai toujours eu envie de me la pÃ©ter devant 2 Ã©crans tout noir,
en ligne de commande, comme dans les super productions amÃ©ricaines.</p>
<p>Plus sÃ©rieusement, je passe de plus en plus de temps devant ma consoleâ€¦
Enfin vous savez, le terminal, pas lâ€™autre truc un peu plus fun (et encore que).</p>
<p>Jâ€™ai toujours eu envie de comprendre pourquoi autant de gens (car mine de rien il y en a un paquet) utilisaient Vim,
et se moquaient un bon coup Ã  chaque sortie dâ€™un nouvel Ã©diteur.
Car bon faut avouer, se moquer câ€™est facile.
Du coup un jour, jâ€™ai dÃ©marrÃ© Vim.</p>
<h2 id="pourquoi-j-ai-rien-compris-quand-je-me-suis-retrouve-dans-vim">
      <a class="putainde-Title-anchor" href="#pourquoi-j-ai-rien-compris-quand-je-me-suis-retrouve-dans-vim">#</a>
      <em>Pourquoi jâ€™ai rien compris quand je me suis retrouvÃ© dans Vim ?</em>
    </h2><p>Le truc le plus dÃ©routant dans Vim, câ€™est les modes.
Et quand on ouvre Vim, on ne se retrouve pas dans le mode le plus logique (Ã  premiÃ¨re vue).</p>
<p>En fait, ce quâ€™on dit pas trop, câ€™est que Vim est toujours utilisÃ© aujourdâ€™hui car on peut lâ€™utiliser uniquement au clavier.
Vous allez me rÃ©pondre quâ€™on peut en faire de mÃªme avec tous les Ã©diteurs de texte.</p>
<p>Mais <strong>Vim a clairement Ã©tÃ© dÃ©veloppÃ© pour minimiser les dÃ©placements des mains</strong>.</p>
<p>Câ€™est pour moi la chose la plus importante Ã  retenir. Et la chose la plus attractive.
Les bons dÃ©veloppeurs ont tous une bonne flemme au fond dâ€™eux, câ€™est bien connu.</p>
<p>Pour un peu plus sur lâ€™histoire de Vim, direction <a href="https://fr.wikipedia.org/wiki/Vim">wikipedia.org/wiki/Vim</a>.</p>
<h2 id="commencer-avec-vim">
      <a class="putainde-Title-anchor" href="#commencer-avec-vim">#</a>
      Commencer avec Vim
    </h2><p>Du coup, quand je suis dans Vim, comment Ã§a se passe ?</p>
<p>Je passerai plus tard assez rapidement sur les diffÃ©rents points, vu que dâ€™autres ressources,
dont notamment le livre <a href="https://vimebook.com/">Vim pour les humains</a>, le font trÃ¨s bien en douceur.</p>
<p>Câ€™est dâ€™ailleur grÃ¢ce Ã  ce livre que je me suis lancÃ©.
Je tiens donc Ã  remercier <a href="http://viserlalune.com/">Vincent Jousse</a> pour avoir pris le temps dâ€™Ã©crire cet ouvrage.</p>
<p>Profitez de cet ouvrage, en plus <a href="http://ploum.net/le-prix-libre-une-impossible-utopie/">le prix est libre</a>.
Et puis quand on pense au prix des licences de certains IDEâ€¦</p>
<p>Ce livre est fait pour nâ€™importe qui, dÃ©butant ou pas.
Vraiment, mangez-en si vous souhaitez essayer Vim (oui je sais, manger un e-book comme Ã§a, Ã§a paraÃ®t pas Ã©vident).</p>
<p>Jâ€™ai essayÃ© plusieurs fois sans trop savoir oÃ¹ commencer, sans succÃ¨s.
Ce livre mâ€™a aidÃ© et se dÃ©vore en quelques dizaines de minutes (deux ou trois heures grand max),
clavier sous les mains (bah oui rien de mieux pour se lancer).</p>
<p>Jâ€™ai essayÃ© et me voilÃ  conquis, une fois que jâ€™ai compris sa valeur ajoutÃ©e.</p>
<p>Pour bien sâ€™y prendre, forcez-vous Ã  travailler avec Vim au moins une journÃ©e en suivant les conseils que vous trouverez dans cet ouvrage.
Cela a fonctionnÃ© pour moi : je gagne dÃ©jÃ  du temps au bout de quelques semaines dâ€™utilisation.</p>
<p>Pourquoi pas vous ?</p>
<h2 id="pour-apprendre-vim">
      <a class="putainde-Title-anchor" href="#pour-apprendre-vim">#</a>
      Pour apprendre Vim
    </h2><p>Vous pouvez donc :</p>
<ul>
<li>lire lâ€™e-book <a href="http://vimebook.com">Vim pour les humains</a></li>
<li>lancer la commande <code>vimtutor</code></li>
<li>jouer Ã  <a href="http://vim-adventures.com/">Vim Adventures</a></li>
<li>vous entraÃ®ner sur des exemples concrets avec <a href="http://vimgolf.com/">VimGolf</a></li>
</ul>
<p>Voici aussi un cheatsheet indispensable qui permet de bien mÃ©moriser le pourquoi des touches
(b = begin, w = word, e = end, r = replace, i = insert, a = append, o = open, ctrl f = forward, ctrl b = backward, etc).</p>
<p><img src="../vim-cheatsheet.gif" alt="cheatsheet VIM"></p>
<p>Vous remarquerez que souvent les commandes en majuscules font la mÃªme chose mais dans le sens inverse (f/F, o/O), ou de maniÃ¨re plus catÃ©gorique (d/D, y/Y).</p>
<h2 id="passer-a-vim-est-un-investissement">
      <a class="putainde-Title-anchor" href="#passer-a-vim-est-un-investissement">#</a>
      Passer Ã  Vim est un investissement
    </h2><p>Point important : il faut avoir envie.
Il ne sâ€™agit pas de changer simplement dâ€™Ã©diteur, car on doit complÃ¨tement changer ses habitudes.
Plus aucun raccourci clavier que vous avez lâ€™habitude dâ€™utiliser ne va fonctionner.
Je me rÃ©pÃ¨te mais il faut se forcer un minimum avant dâ€™imaginer les possibilitÃ©s de cet Ã©diteur.</p>
<p>Cela dit, on peut rapidement voir la puissance de Vim aprÃ¨s quelques heures dâ€™utilisation
(mÃªme si on peut aussi un peu rager en cherchant des commandes simples quâ€™on arrive pas Ã  faire).</p>
<p>Sachez aussi que beaucoup dâ€™Ã©diteurs ont des modes Vim (Sublime Text, Atom et dâ€™autres). Il doit bien y avoir une raison, non ?
Notez aussi que Vim est installÃ© par dÃ©faut sur beaucoup dâ€™environnement de type Unix.</p>
<p>Vim est configurable Ã  souhait (via le fichier <code>.vimrc</code>) et possÃ¨de mÃªme son propre language de scripts (Vim Script ou viml)
ce qui permet de crÃ©er de nouvelles fonctionnalitÃ©s simplement. Et mÃªme du coup dâ€™en faire des â€œpluginsâ€.</p>
<p>Je vous prÃ©pare un prochain post pour vous faire un petit mÃ©mo condensÃ© de ce quâ€™on peut faire avec, et surtout comment.</p>
<blockquote>
<p>:q^C:wq</p>
</blockquote>
]]></description>
            <link>http://putaindecode.fr/posts/vim/il-demarre-vim-par-erreur-ce-qui-se-passe-ensuite-est-tout-simplement-bluffant/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/vim/il-demarre-vim-par-erreur-ce-qui-se-passe-ensuite-est-tout-simplement-bluffant/</guid>
            <pubDate>Tue, 03 Mar 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Quelques retours sur React et le rendu serveur]]></title>
            <description><![CDATA[<p>On entend souvent parler dâ€™applications JavaScript isomorphiques, et mÃªme si le 
nom ne <a href="https://news.ycombinator.com/item?id=8237449">fait</a> <a href="https://twitter.com/wycats/status/566857009836724224">pas</a> 
<a href="https://medium.com/the-thinkmill/making-the-case-for-progressive-javascript-a98dfa82b9d7">lâ€™unanimitÃ©</a>, 
ce quâ€™il y a derriÃ¨re, le concept de <em>server side rendered JavaScript</em> est en 
passe de devenir  un sujet plutÃ´t tendance pour 2015 grÃ¢ce Ã  la montÃ© en puissance 
de <a href="http://facebook.github.io/react/">Reactjs</a>.  Faire du rendu dâ€™application 
JavaScript cotÃ© serveur permet de rÃ©concilier enfin le dÃ©veloppeur de 
<em>Single Page App</em> (SPA) avec lâ€™amÃ©lioration progressive, lâ€™accessibilitÃ© et le 
SEO&nbsp;; quoique Google comme les lecteurs dâ€™Ã©cran ont plutÃ´t bien Ã©voluÃ© sur
ce point. Lâ€™autre avantage non nÃ©gligeable Ã  mon sens, est quâ€™on amÃ©liore les 
performances perÃ§ues par rapport
 Ã  une SPA classique puisque&nbsp;:</p>
<ul>
<li>On supprime une requÃªte <em>ajax</em> au dÃ©marrage pour rÃ©cupÃ©rer le contenu
initial. </li>
<li>On amÃ©liore la vitesse de rendu initial de page. </li>
<li>On bÃ©nÃ©ficie de la fluiditÃ© de navigation dâ€™une SPA.</li>
</ul>
<p>Pour plus dâ€™info sur les avantages, il y a <a href="http://tech.m6web.fr/isomorphic-single-page-app-parfaite-react-flux/">cet article</a> sur le blog de M6Tech.</p>
<p>Afin de me familiariser avec React et son Ã©cosystÃ¨me, rien de mieux que mettre 
les mains dedans&nbsp;! Câ€™est un peu pour toutes ces raisons que jâ€™ai dÃ©cidÃ© de 
lâ€™utiliser pour mon site web (un site statique). </p>
<p><strong>Inutile et donc totalement justifiÃ© pour le dÃ©veloppeur que je suis</strong>. 
Une des premiÃ¨res briques que jâ€™ai mises en place a Ã©tÃ© le routeur.</p>
<h2 id="react-router">
      <a class="putainde-Title-anchor" href="#react-router">#</a>
      react-router
    </h2><p>Pour une fois dans la communautÃ© JavaScript, il y a une bibliothÃ¨que de rÃ©fÃ©rence 
et câ€™est celle lÃ  : <a href="https://github.com/rackt/react-router">react-router</a>. 
Le routeur est fortement inspirÃ© par celui dâ€™Ember au sens oÃ¹ les URL et leurs routes 
sont au cÅ“ur du dispositif. Le routeur se prÃ©sente sous forme de composant React 
et Ã§a donne Ã§a.</p>
<pre><code class="lang-jsx">//routes.js

var <span class="hljs-variable">React =</span> require(<span class="hljs-string">"react"</span>);
var <span class="hljs-variable">Router =</span> require(<span class="hljs-string">"react-router"</span>);

var <span class="hljs-variable">Route =</span> Router.Route;
var <span class="hljs-variable">DefaultRoute =</span> Router.DefaultRoute;
var <span class="hljs-variable">NotFoundRoute =</span> Router.NotFoundRoute;

var <span class="hljs-variable">App =</span> require(<span class="hljs-string">"./app"</span>);
var <span class="hljs-variable">Home =</span> require(<span class="hljs-string">"./home/homePage"</span>);
var <span class="hljs-variable">Project =</span> require(<span class="hljs-string">"./project/projectPage"</span>);
var <span class="hljs-variable">NotFound =</span> require(<span class="hljs-string">"./notFound"</span>);

var <span class="hljs-variable">routes =</span> (
  &lt;Route <span class="hljs-variable">path=</span><span class="hljs-string">"/"</span> <span class="hljs-variable">handler=</span>{App}&gt;
    &lt;DefaultRoute <span class="hljs-variable">name=</span><span class="hljs-string">"index"</span> <span class="hljs-variable">handler=</span>{Home} /&gt;
    &lt;Route <span class="hljs-variable">name=</span><span class="hljs-string">"project"</span> <span class="hljs-variable">path=</span><span class="hljs-string">"/projects/:url"</span> <span class="hljs-variable">handler=</span>{Project} /&gt;
    &lt;NotFoundRoute <span class="hljs-variable">name=</span><span class="hljs-string">"404"</span> <span class="hljs-variable">handler=</span>{NotFound} /&gt;
  &lt;/Route&gt;
);

module.<span class="hljs-variable">exports =</span> routes;
</code></pre>
<p>Ã€ mon sens, lâ€™aspect dÃ©claratif apporte de la clartÃ© et amÃ©liore la comprÃ©hension 
du systÃ¨me. On voit rapidement quel composant est utilisÃ© en fonction de lâ€™URL. 
Lâ€™autre avantage du dÃ©claratif, câ€™est quâ€™il permet de maniÃ¨re assez simple, 
dâ€™imbriquer les routes en imbriquant les nÅ“uds <code>&lt;Route&gt;</code>.</p>
<p>En plus des composants, on a aussi Ã  disposition des <em>mixins</em> pour naviguer 
programmatiquement ou accÃ©der aux infos du routeur (chemin, paramÃ¨tres, â€¦)</p>
<p>Et le gros plus de cette bibliothÃ¨que : elle peut aussi sâ€™utiliser cotÃ© serveur, 
pour la gÃ©nÃ©ration des vues et Ã©viter ainsi de dupliquer du code puisquâ€™on va 
pouvoir carrÃ©ment utiliser tel quel le fichier prÃ©cÃ©dent. PlutÃ´t cool&nbsp;!
Voici un exemple de <em>middleware</em> pour faire marcher Ã§a dans Express&nbsp;:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react"</span>);
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react-router"</span>);

<span class="hljs-comment">// notre fichier routes.js</span>
<span class="hljs-keyword">var</span> routes = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./src/routes"</span>);
<span class="hljs-comment">// notre template de page html</span>
<span class="hljs-keyword">var</span> Html = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./src/html"</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reactView</span><span class="hljs-params">(req, res, next)</span> </span>{
  Router.run(routes, req.url, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Handler, state)</span> </span>{
    <span class="hljs-comment">// on rÃ©cupÃ¨re les donnÃ©es pour cette vue en fonction de la requÃªte.</span>
    <span class="hljs-keyword">var</span> data = getViewData(req);

    <span class="hljs-comment">// on gÃ©nÃ¨re la soupe au tag avec nos donnÃ©es dedans</span>
    <span class="hljs-keyword">var</span> markup = React.renderToString(React.createElement(Handler), data);

    <span class="hljs-comment">// on utilise React comme moteur de template</span>
    <span class="hljs-keyword">var</span> HtmlElement = React.createElement(Html, {markup: markup});  
    res.send(<span class="hljs-string">"&lt;!DOCTYPE html&gt;"</span> +  React.renderToStaticMarkup(HtmlElement));
  });
}
</code></pre>
<p>Et voici le composant <code>Html.jsx</code> que lâ€™on utilise comme <em>template</em> pour notre page principale.</p>
<pre><code class="lang-jsx">var React = require('react');

var Html = React.createClass({
  render: function() {
    return (
      <span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charSet</span>=<span class="hljs-value">"utf-8"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">meta</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>Mon site perso<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"/js/app.js"</span> /&gt;</span><span class="handlebars"><span class="xml">
        <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"react-app"</span> <span class="hljs-attribute">dangerouslySetInnerHTML</span>=</span></span><span class="hljs-expression">{{__<span class="hljs-variable">html</span>: <span class="hljs-variable">this.props.markup</span>}}</span><span class="xml"><span class="hljs-tag"> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
    );
  }

});

module.exports = Html;</span></span>
</code></pre>
<p>Une fois que le code HTML a Ã©tÃ© gÃ©nÃ©rÃ© via<code>React.renderToString(React.createElement(Handler), data);</code>, 
on pourrait utiliser nâ€™importe quel moteur de template (lodash.template, handlebars, ejs, jade, PHPâ€¦) 
pour gÃ©nÃ©rer le HTML de la page Ã  renvoyer. Dans un souci de rationalisation des outils, 
jâ€™ai prÃ©fÃ©rÃ© utiliser React. </p>
<p>Vous avez dÃ» vous apercevoir quâ€™on utilise 2 mÃ©thodes diffÃ©rentes pour gÃ©nÃ©rer 
du HTML avec React&nbsp;:</p>
<ul>
<li><code>React.renderToString(React.createElement(Handler), data);</code></li>
<li><code>React.renderToStaticMarkup(React.createElement(Handler), data);</code></li>
</ul>
<p>La diffÃ©rence entre les deux mÃ©thodes est simple. Dans la premiÃ¨re, React annote 
les nÅ“uds HTML avec des <code>data-reactid</code> dans le but de pouvoir ensuite reprendre 
la main lorsque votre lâ€™application sâ€™exÃ©cutera dans le navigateur. De cette maniÃ¨re, 
React sait que vous lâ€™initialisez avec un contenu gÃ©nÃ©rÃ© depuis le serveur. 
Et si il dÃ©tecte une diffÃ©rence entre le code existant et celui quâ€™il gÃ©nÃ¨re, 
vous aurez droit Ã  un <a href="https://github.com/facebook/react/blob/2aeb8a2a6beb00617a4217f7f8284924fa2ad819/src/browser/ui/__tests__/ReactRenderDocument-test.js#L205-L215">petit warning</a>. 
La deuxiÃ¨me mÃ©thode permet de gÃ©nÃ©rer du code HTML sans annotations, 
comme nâ€™importe quel moteur de <em>template</em>.</p>
<p>Les plus attentifs auront remarquÃ© quâ€™on passe les donnÃ©es initiales lors de 
la crÃ©ation de lâ€™application via des <em>props</em> React. Quid de lâ€™utilisation 
de flux dans tout Ã§a ?</p>
<h2 id="flux-et-le-rendu-serveur">
      <a class="putainde-Title-anchor" href="#flux-et-le-rendu-serveur">#</a>
      Flux et le rendu serveur
    </h2><p>Avec <a href="http://facebook.github.io/flux/">Flux</a>, ce sont les stores qui maintiennent 
lâ€™Ã©tat de notre application. Si lâ€™on ne veut pas afficher notre application 
sans aucune donnÃ©es, nous allons devoir prÃ©alablement peupler nos stores 
avant dâ€™appeler <code>React.renderToString()</code>. </p>
<p>LÃ  oÃ¹ Ã§a se corse un peu, câ€™est quâ€™il va falloir remplir nos stores avant de dÃ©marrer 
notre application sous peine de voir le message dâ€™alerte dont je parlais plus haut. 
Le plus simple alors est de passer ces donnÃ©es au moteur de template, 
en plus du markup (par exemple sous la forme dâ€™un nÅ“ud <code>&lt;script type=&quot;application/json&quot;&gt;JSON DATA&lt;/script&gt;</code>.
Il ne reste plus quâ€™a rÃ©cupÃ©rer ces donnÃ©es avant dâ€™appeler <code>React.render( Application, document.getElementById(&quot;react-app&quot;))</code></p>
<p>Par exemple&nbsp;: </p>
<pre><code class="lang-javascript"><span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
  <span class="hljs-comment">// getData() va rÃ©cuperer et parser le contenu du tag script </span>
  <span class="hljs-comment">// qui contient nos donnÃ©es</span>
  <span class="hljs-keyword">var</span> storeData= getData(); 

  <span class="hljs-comment">// on dÃ©clenche une actions</span>
  actions.init( storeData);

  <span class="hljs-comment">// on lance le rendu</span>
  React.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">App</span> /&gt;</span>, document.getElementById("react-app"));
});</span>
</code></pre>
<h2 id="le-mot-de-la-fin">
      <a class="putainde-Title-anchor" href="#le-mot-de-la-fin">#</a>
      Le mot de la fin
    </h2><p>Penser son application React pour quâ€™elle puisse Ãªtre rendue cotÃ© serveur 
introduit de nouvelles problÃ©matiques, notamment avec lâ€™ajout du <em>pattern</em> Flux. 
En fonction des pages que lâ€™on souhaite afficher, on devra initialiser diffÃ©rents <em>stores</em>. 
Ã€ nous de dÃ©terminer, en fonction de lâ€™URL et du composant Ã  afficher, 
lequel initialiser, et cela, que lâ€™on soit sur le client ou le serveur. 
De la mÃªme maniÃ¨re, il faudra Ãªtre capable de charger nos donnÃ©es, indÃ©pendamment 
de lâ€™environnement dâ€™exÃ©cution (coucou XHR).</p>
<p>Un dÃ©but de rÃ©ponse se trouve dans les exemples fournis avec react-router. 
Lâ€™idÃ©e est de passer par une propriÃ©tÃ© <code>statics</code> lors de la crÃ©ation des composants React 
qui seront associÃ©s Ã  une <code>&lt;Route/&gt;</code>.</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">var</span> ProjectPage = React.createClass({ 
  statics: {
    fetchData: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span></span>{
      <span class="hljs-keyword">return</span> api.getPageData(params.url)
        .then( actions.initProject)
        .<span class="hljs-keyword">catch</span>( actions.loadProjectError);
    }
  }
 ...
 });
</code></pre>
<p>Dans ce bloc <code>statics</code>, on dÃ©finit une fonction qui servira Ã  rÃ©cupÃ©rer les donnÃ©es 
pour ce composant mais on pourrait trÃ¨s bien imaginer retourner la liste dâ€™actions 
Ã  lancer ou encore les <em>stores</em> Ã  initialiser voire mÃªme un descripteur des donnÃ©es nÃ©cessaires 
Ã  la vue (<a href="https://www.youtube.com/watch?v=9sc8Pyc51uU">cf Relay / GraphQL</a>) </p>
<p>Ensuite, lorsque le callback fourni Ã  <code>Router.run()</code> est appelÃ©, il suffit de parcourir 
les <em>Handler</em> pour rÃ©cupÃ©rer les informations contenues dans les blocs <code>statics</code>, 
les traiter et enfin faire <code>React.render()</code>.</p>
<pre><code class="lang-Javascript">// On renvoie une promesse qui sera rÃ©solue lorsque que toutes les donnÃ©es dÃ©mandÃ©es via fetchData seront reÃ§ues.
Router.run(routes, Router.HistoryLocation, function (Handler, <span class="hljs-keyword">state</span>) {
  var p = Promise.<span class="hljs-literal">all</span>(<span class="hljs-keyword">state</span>.routes
    .filter(route =&gt; route.handler.fetchData)  // dÃ©finit fetchData
    .map(route =&gt; {
      return route.handler.fetchData(<span class="hljs-keyword">state</span>.params);
    })
  );
  p.then( x =&gt; {
    React.render(<span class="hljs-variable">&lt;Handler {...state} /&gt;</span>, document.getElementById(<span class="hljs-string">"react-app"</span>))
  });
});
</code></pre>
<p>Le principe est simple et peut Ãªtre facilement encapsulÃ© dans un module pour 
Ãªtre partagÃ© entre le client et le serveur.  Jâ€™espÃ¨re que cet article vous a permis 
dâ€™apprÃ©hender un peu mieux le rendu cotÃ© serveur dâ€™une application React. 
Nâ€™hÃ©sitez pas Ã  laisser des commentaires si vous avez des questions oÃ¹ 
si vous souhaitez partager vos expÃ©riences dans ce domaine. </p>
<p>Et quelques liens vidÃ©o des sessions de la #reactjsconf :</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=XZfvW1a8Xac">React.js Conf 2015 - react-router increases your productivity </a> </li>
<li><a href="https://www.youtube.com/watch?v=z5e7kWSHWTg">React.js Conf 2015 - Hype!</a> : un aperÃ§u des possibilitÃ©s de react-router</li>
</ul>
]]></description>
            <link>http://putaindecode.fr/posts/js/reactjs-et-rendu-serverside/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/reactjs-et-rendu-serverside/</guid>
            <pubDate>Mon, 23 Feb 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[JavaScript modulaire pour le front-end : les bases]]></title>
            <description><![CDATA[<p>Quand on rÃ©alise des applications en JS pour les navigateurs web, on ne peut plus se contenter de mettre des tags <code>script</code> dans le bon ordre pour charger les bibliothÃ¨ques tierces que lâ€™on utilise comme pour un site web. Câ€™est pourquoi il existe des outils pour permettre dâ€™Ã©crire du JavaScript modulaire et rÃ©utiliser plus facilement les innombrables bibliothÃ¨ques publiÃ©es par la communautÃ© JS.</p>
<p>Cependant, ce principe dâ€™Ã©criture modulaire et de publication de code nâ€™Ã©tant pas intÃ©grÃ© dans le langage lui-mÃªme, de trÃ¨s nombreuses solutions existent plus ou moins compatibles les unes avec les autres et aboutissant Ã  une forte fragmentation de la communautÃ©.
Donc quand on dÃ©cide de se mettre au JavaScript modulaire, on trouve tout un tas dâ€™articles (en anglais) parfois trop vieux (â€œune Ã©tape de build nâ€™est pas adaptÃ©e au navigateurâ€), parfois trop subjectifs (â€œJâ€™aime pas la syntaxe AMDâ€), parfois confus (â€œutiliser les modules pour de lâ€™injection de dÃ©pendancesâ€), parfois simplistes (â€œAMD vs CommonJSâ€).</p>
<p>Câ€™est pourquoi jâ€™ai voulu partager mon expÃ©rience, en essayant dâ€™abord de reposer les bases du problÃ¨me, puis en vous faisant part de ce que jâ€™estime Ãªtre la solution la plus satisfaisante actuellement.</p>
<p>Dâ€™abord, il faut faire la distinction entre 3 aspects du problÃ¨me :</p>
<ul>
<li>le format dâ€™Ã©criture des modules (â€œmodule authoring formatâ€)</li>
<li>le systÃ¨me de gestion des packages (â€œpackage managementâ€)</li>
<li>la convention de rÃ©solution des dÃ©pendances de module</li>
</ul>
<h1 id="format-d-ecriture-des-modules">
      <a class="putainde-Title-anchor" href="#format-d-ecriture-des-modules">#</a>
      Format dâ€™Ã©criture des modules
    </h1><p>Le module est la brique de base pour dÃ©composer un gros fichier JS en plusieurs fichiers plus petits et focalisÃ©s sur une fonctionnalitÃ© prÃ©cise. La plupart du temps un module est un fichier JS qui fournit une fonction, un constructeur ou un objet de valeur. Et comme, pour fournir cette fonctionnalitÃ©, un module peut avoir besoin dâ€™autres modules, il existe un mÃ©canisme pour dÃ©clarer ses dÃ©pendances.</p>
<p>Actuellement, 2 standards principaux existent pour Ã©crire ces modules : <strong>AMD</strong> et <strong>CommonJS</strong>.
Il est Ã©galement possible dâ€™utiliser la <a href="http://www.2ality.com/2014/09/es6-modules-final.html">syntaxe retenue par ES6</a> (qui jâ€™espÃ¨re va enfin devenir le standard unique) mais pour lâ€™instant, Ã§a demande encore une Ã©tape de â€œtranspilationâ€ en AMD ou CJS.</p>
<p>Le format AMD (dans sa forme la plus courante) est :</p>
<pre><code class="lang-js">define([<span class="hljs-string">'moduleA'</span>, <span class="hljs-string">'moduleB'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(a, b)</span> </span>{
  <span class="hljs-comment">// j'utilise a et b</span>
  <span class="hljs-keyword">return</span> maFonctionTresUtile;
});
</code></pre>
<p>Le format CommonJS (dans sa forme la plus courante) est :</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">'moduleA'</span>);
<span class="hljs-keyword">var</span> b = <span class="hljs-built_in">require</span>(<span class="hljs-string">'moduleB'</span>);
<span class="hljs-comment">// j'utilise a et b</span>
<span class="hljs-built_in">module</span>.exports = maFonctionTresUtile;
</code></pre>
<p>Ca nâ€™est pas trÃ¨s diffÃ©rent dans lâ€™esprit : tous les 2 permettent de dÃ©crire des dÃ©pendances et dâ€™exporter une valeur.
La diffÃ©rence principale rÃ©side dans le fait que :</p>
<ul>
<li>CommonJS prÃ©voit une Ã©valuation en une passe dans laquelle il faut rÃ©soudre les dÃ©pendances au fur et Ã  mesure</li>
<li>alors que AMD prÃ©voit une Ã©valuation en 2 passes :<ul>
<li>une premiÃ¨re pour rÃ©cupÃ©rer uniquement la liste des dÃ©pendances</li>
<li>et une seconde oÃ¹ on exÃ©cute le callback (le corps du module) avec les dÃ©pendances rÃ©solues.
Câ€™est pourquoi on parle de format â€œsynchroneâ€ dans le premier cas et â€œasynchroneâ€ dans le second car on peut rÃ©soudre les dÃ©pendances de faÃ§on asynchrone en AMD.</li>
</ul>
</li>
</ul>
<p>Dans les 2 cas, par contre, il y a besoin dâ€™une <em>rÃ©solution des dÃ©pendances</em>, câ€™est Ã  dire quâ€™un module ne peut pas Ãªtre exÃ©cutÃ© tel quel dans un navigateur en le chargeant via un tag <code>script</code>. Non, il faut un <em>loader</em>, câ€™est Ã  dire un outil qui va charger le module quâ€™on lui demande et va rÃ©soudre les dÃ©pendances en cascade. Mais contrairement Ã  ce que lâ€™on pourrait croire, les rÃ¨gles de rÃ©solution des dÃ©pendances nâ€™ont rien Ã  voir avec le format du module (on verra Ã§a plus tard).</p>
<h1 id="package-management">
      <a class="putainde-Title-anchor" href="#package-management">#</a>
      Package management
    </h1><p>Parlons maintenant des packages. En effet, pouvoir dÃ©couper du code en modules, câ€™est bien ; mais ce qui est encore mieux câ€™est de pouvoir le partager avec dâ€™autres pour quâ€™il soit facilement rÃ©utilisable et arrÃªter le syndrÃ´me de :</p>
<blockquote>
<p>â€œje recode un event emitter dans ma bibliothÃ¨que comme Ã§a je nâ€™ai pas de
dÃ©pendance et câ€™est plus facile Ã  consommer par mes utilisateursâ€</p>
</blockquote>
<p> Câ€™est le problÃ¨me nÂ°1 des bibliothÃ¨ques front qui prÃ©sentent souvent comme un argument de ne pas avoir de dÃ©pendances. Sauf que, si on y rÃ©flÃ©chit, Ã§a veut dire que : soit câ€™est une bibliothÃ¨que trÃ¨s bas niveau, soit le mec a recodÃ© des trucs qui existent dÃ©jÃ  au lieu de sâ€™occuper de son sujet principal.</p>
<p>Câ€™est lÃ  quâ€™entre en jeu la notion de <em>package</em> (que je ne traduirai pas en franÃ§ais, car Ã§a ne servirait quâ€™Ã  apporter de la confusion). Un package est un ensemble de fichiers (pas forcÃ©ment des fichiers JS dâ€™ailleurs) avec des mÃ©tadonnÃ©es associÃ©es pour dÃ©crire principalement :</p>
<ul>
<li>oÃ¹ est stockÃ© le package,</li>
<li>qui est lâ€™auteur,</li>
<li>quelle est la licence,</li>
<li>quelle est la version,</li>
<li>et â€¦ quelles sont les dÃ©pendances et leurs versions !</li>
</ul>
<p>Ici les dÃ©pendances sont des dÃ©pendances entre packages, <a href="http://fr.slideshare.net/domenicdenicola/client-side-packages">ce qui nâ€™a rien Ã  voir avec les dÃ©pendances entre modules</a>.</p>
<p>Pour faciliter lâ€™utilisation des packages, on utilise un <em>package manager</em>, dont le rÃ´le principal est, Ã  partir dâ€™un id de module (et Ã©ventuellement dâ€™un numÃ©ro de version), de trouver lâ€™adresse oÃ¹ se trouve les fichiers, les tÃ©lÃ©charger et les installer localementâ€¦ et ceci de faÃ§on rÃ©cursive pour les dÃ©pendances, ce qui est le gros avantage par rapport Ã  le faire Ã  la mano. Mais sinon, Ã§a nâ€™est pas plus compliquÃ© que Ã§a dans le principe, et Ã§a reste valable pour des fichiers JS ou non, front-end ou non.</p>
<p>Les principaux package managers pour le front-end sont <a href="https://www.npmjs.com/">npm</a> et <a href="http://bower.io">bower</a>.
La grande diffÃ©rence entre les deux est que <strong>npm installe les dÃ©pendances de faÃ§on relative</strong> : pour chaque package, les dÃ©pendances sont installÃ©es dans un sous-dossier (node_modules).</p>
<ul>
<li>mon-projet-avec-nmp<ul>
<li>app.js</li>
<li>node_modules<ul>
<li>une-dependance<ul>
<li>main.js</li>
<li>nodes_modules<ul>
<li>une-dependance-indirecte<ul>
<li>main.js</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>une-autre-dependance<ul>
<li>main.js</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Alors que <strong>bower prend le parti dâ€™installer les dÃ©pendances Ã  plat</strong> : le package et ses dÃ©pendances et les dÃ©pendances des dÃ©pendances sont toutes installÃ©es au mÃªme niveau dans le mÃªme dossier.</p>
<ul>
<li>mon-projet-avec-bower<ul>
<li>app.js</li>
<li>bower_components<ul>
<li>une-dependance<ul>
<li>main.js</li>
</ul>
</li>
<li>une-autre-dependance<ul>
<li>main.js</li>
</ul>
</li>
<li>une-dependance-indirecte<ul>
<li>main.js</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Lâ€™approche bower semble Ãªtre une bonne idÃ©e car si 2 packages ont la mÃªme dÃ©pendance (ou des dÃ©pendances compatibles semver), une seule est installÃ©e. Alors quâ€™avec npm chaque package installe sa propre dÃ©pendance.</p>
<p>Cependant, sâ€™il y a une incompatibilitÃ© de versions :</p>
<blockquote>
<p>le package A dÃ©clare une dÃ©pendance sur X en version 1
le package B dÃ©clare une dÃ©pendance sur X mais en version 2</p>
</blockquote>
<p>Avec bower, on est coincÃ© : on ne peut installer quâ€™une seule version. Lors du <code>bower install</code>, il faudra choisir quelle version on garde : soit A devra utiliser X2, soit B devra utiliser X1.</p>
<ul>
<li>mon-app-avec-bower<ul>
<li>bower_components<ul>
<li>package-A</li>
<li>package-B</li>
<li>package-X<ul>
<li>main.js // v1 ou v2 mais pas les 2</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Bower appelle cela de la <em>rÃ©solution de conflits</em>. Mais concrÃªtement, cela veut dire quâ€™on force une dÃ©pendance qui nâ€™est pas supportÃ©e officiellement par le package en question. Donc on se retrouve responsable de vÃ©rifier que le package B fonctionne correctement avec X1. Pas cool :-(</p>
<p>Alors quâ€™avec npm les versions des dÃ©pendances sont respectÃ©es, il nâ€™y a pas de question Ã  se poser.</p>
<ul>
<li>mon-app-avec-npm<ul>
<li>node_modules<ul>
<li>package-A<ul>
<li>node_modules<ul>
<li>package-X<ul>
<li>main.js // v1</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>package-B<ul>
<li>node_modules<ul>
<li>package-X<ul>
<li>main.js // v2</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="resolution-des-dependances-de-module">
      <a class="putainde-Title-anchor" href="#resolution-des-dependances-de-module">#</a>
      RÃ©solution des dÃ©pendances de module
    </h1><p>La question est alors :</p>
<blockquote>
<p>â€œPourquoi existe-t-il des package managers spÃ©cifiquement pour le web front-end ?â€</p>
</blockquote>
<p>RÃ©ponse :</p>
<blockquote>
<p> â€œPour faciliter lâ€™utilisation de modules publiÃ©s dans des packages dans le contexte du front-endâ€</p>
</blockquote>
<p>Super ! Mais concrÃªtement ?</p>
<p>Et bien, venons en au coeur du problÃ¨me : <em>la rÃ©solution des module-id en fichier</em>. Comme on lâ€™a vu, pour charger un module dans le navigateur, il faut utiliser un loader. Et une de ses tÃ¢ches est de <em>rÃ©soudre</em> les <code>module_id</code> en adresse de fichier.</p>
<p>Au pire il faudrait explicitement dire au loader pour chaque <code>module_id</code> oÃ¹ est le fichier correspondant. Heureusement, ce nâ€™est pas le cas, ni avec requireJS, ni avec les loaders compatibles npm.</p>
<h2 id="amd">
      <a class="putainde-Title-anchor" href="#amd">#</a>
      AMD
    </h2><p>RequireJS et les autres loaders AMD vont assez loin en  matiÃ¨re de <a href="http://requirejs.org/docs/api.html#config">configuration</a> mais souvent , Ã§a revient Ã  dÃ©crire des rÃ¨gles du style <em>tous les modules id qui commencent par <code>mon-package</code> sont Ã  chercher dans le dossier <code>./mon-package</code></em>.</p>
<p>En fait, Ã§a nâ€™est pas tout Ã  fait vrai quâ€™il faille systÃ©matiquement configurer les rÃ¨gles de rÃ©solution avec RequireJS : il y a une rÃ¨gle par dÃ©faut qui stipule que les module_id sont rÃ©solus par rapport Ã  une â€œbaseURLâ€ (qui par dÃ©faut est celle du fichier html). Donc si on installe tous les packages au mÃªme niveau, Ã§a marche par dÃ©faut.
Câ€™est pour cela que bower est souvent utilisÃ© pour les packages front-end en AMD car il installe les fichiers Ã  plat et de cette faÃ§on on limite le besoin de configuration.</p>
<h2 id="npm">
      <a class="putainde-Title-anchor" href="#npm">#</a>
      NPM
    </h2><p>A lâ€™opposÃ© de cette approche trÃ¨s flexible, il y a nodeJS avec une <a href="https://github.com/substack/browserify-handbook#how-node_modules-works">convention simple et statique</a>, qui dit en gros :</p>
<ul>
<li>si câ€™est une rÃ©fÃ©rence relative, il suffit de suivre le chemin</li>
<li>si câ€™est une rÃ©fÃ©rence absolue, il faut chercher dans le dossier <code>node_modules</code> et ceci de faÃ§on rÃ©cursive jusquâ€™Ã  arriver Ã  la racine</li>
</ul>
<p>Et donc zÃ©ro config, puisque Ã§a nâ€™est pas configurable. Ca peut paraÃ®tre Ãªtre une limitation mais câ€™est une force.</p>
<h1 id="conclusion">
      <a class="putainde-Title-anchor" href="#conclusion">#</a>
      Conclusion
    </h1><p>Si tous les packages en AMD utilisaient la rÃ¨gle de rÃ©solution par dÃ©faut et que lâ€™on utilisait bower pour les installer, on nâ€™aurait rien Ã  configurer. Mais dans la pratique, Ã§a nâ€™est pas le cas et on se retrouve Ã  devoir configurer les rÃ¨gles de rÃ©solution non seulement pour ses propres dÃ©pendances (<em>pourquoi pas</em>) mais Ã©galement pour les dÃ©pendances de ses dÃ©pendances (<em>et lÃ  Ã§a ne va plus</em>).
Et il reste toujours le problÃ¨me des conflits de version liÃ©s Ã  lâ€™approche de mettre les dÃ©pendances Ã  plat.</p>
<p>Dâ€™un autre cÃ´tÃ©, il y a la convention nodeJS qui impose des rÃ¨gles simples, non modifiables et qui nâ€™a pas de problÃ¨me de conflit de versions. Câ€™est Ã  dire quâ€™il suffit de faire <code>npm install mon-package</code> et Ã§a marche. Une convention qui fait lâ€™unanimitÃ© pour le backend JS.</p>
<p>CÃ´tÃ© front, on lui reproche de charger les dÃ©pendances sans les dÃ©doublonner et de le faire en synchrone, ce qui nâ€™est pas adaptÃ© quand le chargement des fichiers se fait via un rÃ©seau en http et pas directement depuis un disque local comme sur un serveur.</p>
<p>Câ€™est pourquoi a Ã©tÃ© inventÃ© <a href="http://http://browserify.org/">browserify</a> qui apporte actuellement <a href="http://putaindecode.fr/posts/js/browserify-all-the-things/">le meilleur des 2 mondes</a> : toujours zÃ©ro config selon la convention nodeJS et un systÃ¨me de bundle/build (via une analyse syntaxique du code JS pour dÃ©tecter les dÃ©pendances) afin dâ€™assembler tous les modules en un seul fichier adaptÃ© au navigateur.
On peut lui reprocher la nÃ©cessitÃ© dâ€™une Ã©tape de build et le fait que le code source en dÃ©bug est en un seul fichier mais :</p>
<ol>
<li>de toute faÃ§on pour la prod, il y aura une Ã©tape de build et en dÃ©v, avec un outillage adaptÃ© (par exemple <code>watchify</code> qui rebuild en incrÃ©mental) Ã§a nâ€™est pas la mer Ã  boire</li>
<li>avec le support des sources-map dans les navigateurs, on peut maintenant retrouver en debug les mÃªmes noms de fichiers et les mÃªmes numÃ©ro de ligne que dans les fichiers dâ€™origine et les points dâ€™arrÃªt fonctionnent.</li>
</ol>
<p>Au final, Ã§a en devient mÃªme un avantage, car le code que lâ€™on exÃ©cute en dev dans le navigateur est trÃ¨s proche de ce que lâ€™on aura en prod, en tout cas plus proche quâ€™avec requireJS pour lequel on dÃ©veloppe sans build et pour lequel il faut Ã©crire Ã  nouveau une config de build pour la mise en prod.</p>
<h1 id="conclusion-de-la-conclusion">
      <a class="putainde-Title-anchor" href="#conclusion-de-la-conclusion">#</a>
      Conclusion de la conclusion
    </h1><p>Ma conclusion est que le point crucial pour faciliter la rÃ©utilisation de modules, câ€™est de <strong>minimiser les contraintes sur les utilisateurs</strong> et donc de se rapprocher dâ€™un usage <em>plug and play</em>. Pour cela il faut une convention forte entre le package manager et le loader/builder de modules, afin dâ€™Ã©viter Ã  lâ€™utilisateur de devoir Ã©crire des configs â€¦ la plupart du temps.
Bien sÃ»r, la recherche du â€œzÃ©ro configâ€ nâ€™est pas une fin et câ€™est particuliÃ¨rement vrai cÃ´tÃ© front oÃ¹ les contraintes de chargement de fichiers sont fortes. Et si vous voulez diviser votre bundle en plusieurs fichiers ou si vous voulez des rÃ¨gles dâ€™optimisation complexes pour votre build, il est normal de devoir mettre les mains dans le cambouis.
Mais si au moins le cas dâ€™usage le plus frÃ©quent (compiler son appli en un seul fichier qui sera chargÃ© via un tag <code>script</code>) est simplifiÃ© au maximum, alors on pourra sÃ»rement voir cÃ´tÃ© front, le mÃªme Ã©tat dâ€™esprit que cÃ´tÃ© back. Et je suis plutÃ´t optimiste, <a href="https://medium.com/@trek/last-week-i-had-a-small-meltdown-on-twitter-about-npms-future-plans-around-front-end-packaging-b424dd8d367a">contrairement Ã  certains</a>.</p>
<p>Utilisateur de la premiÃ¨re heure dâ€™<code>AMD</code> et de <code>Dojo loader</code>, puis de <code>bower</code>, je me suis rendu compte de leurs limites et surtout jâ€™ai Ã©tÃ© rÃ©guliÃ¨rement gÃªnÃ© par la complexitÃ© de la configurationâ€¦ surtout lorsquâ€™il fallait passer au build. Cela freine la rÃ©utilisation de modules tiers et câ€™est dommage.
Ce nâ€™est pas un problÃ¨me intrinsÃ¨que au format de module et toutes les discussions sur â€œmoi jâ€™aime / jâ€™aime pas la syntaxe AMDâ€ sont secondaires (dâ€™ailleurs <a href="https://www.npmjs.com/package/deamdify">browserify peut fonctionner avec des bibliothÃ¨ques en AMD</a>).
Mais dans la pratique, nous migrons vers la solution <code>npm + browserify</code> et câ€™est vraiment moins compliquÃ©.</p>
<p>Jâ€™espÃ¨re que cet article vous permettra dâ€™y voir plus clair, de dÃ©passer les querelles sur les prÃ©fÃ©rences personnelles de chacun, et de vous aider Ã  faire votre choix.
Je nâ€™estime pas Ãªtre un expert du sujet, il y a sÃ»rement beaucoup de choses Ã  complÃ©ter ou prÃ©ciser, donc nâ€™hÃ©sitez pas Ã  rÃ©agir.</p>
<p>Pour aller plus loin et regarder vers le futur que nous amÃ¨ne ES6, il y a cet <a href="https://medium.com/@brianleroux/es6-modules-amd-and-commonjs-c1acefbe6fc0">excellent article</a>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/js/etat-lieux-js-modulaire-front/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/etat-lieux-js-modulaire-front/</guid>
            <pubDate>Mon, 15 Dec 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[PremiÃ¨re application Ember. Suite et fin.]]></title>
            <description><![CDATA[<p>Lâ€™<a href="/posts/js/premiere-app-ember">article prÃ©cÃ©dent</a> vous a accompagnÃ© pour la crÃ©ation dâ€™une premiÃ¨re application <a href="http://emberjs.com">Ember</a>. 
Mais il faut bien reconnaÃ®tre que lâ€™exemple Ã©tait trÃ¨s simple et que, du coup, le mÃ©rite est faible. 
Pour se  rattraper, on va complexifier un peu les choses.</p>
<p>Tout comme dans lâ€™article prÃ©cÃ©dent, nous dÃ©taillerons rÃ©guliÃ¨rement les concepts mis en Å“uvre. Parce que vous le valez bien.</p>
<h2 id="sommaire">
      <a class="putainde-Title-anchor" href="#sommaire">#</a>
      Sommaire
    </h2><ul>
<li><a href="#edition-d-une-serie">Ã‰dition dâ€™une sÃ©rie</a><ul>
<li><a href="#routes-imbriquees">Routes imbriquÃ©es</a></li>
<li><a href="#-code-outlets-code-">Outlets</a></li>
<li><a href="#liens-entre-routes">Liens entre routes</a></li>
<li><a href="#enregistrement-des-modifications">Enregistrement des modifications</a></li>
<li><a href="#actions-sur-les-transitions">Actions sur les transitions</a></li>
</ul>
</li>
<li><a href="#relations-avec-ember-data">Relations avec Ember Data</a></li>
<li><a href="#insertion-d-un-gabarit">Insertion dâ€™un gabarit</a></li>
<li><a href="#creation-d-une-nouvelle-serie">CrÃ©ation dâ€™une nouvelle sÃ©rie</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<h2 id="edition-d-une-serie">
      <a class="putainde-Title-anchor" href="#edition-d-une-serie">#</a>
      Ã‰dition dâ€™une sÃ©rie
    </h2><p>On veut pouvoir basculer depuis la fiche dâ€™une sÃ©rie vers son Ã©dition en mode <em>in place</em>. Câ€™est-Ã -dire
en <strong>remplaÃ§ant</strong> la zone de visualisation de cette fiche par sa zone dâ€™Ã©dition.</p>
<p>On accÃ¨de Ã  la fiche en mode visualisation Ã  lâ€™URL <code>/series/{id}/</code> et en mode Ã©dition Ã  lâ€™URL <code>/series/{id}/edit</code>. Ã‰videmment, 
on reconstruit uniquement la zone de la fiche et non lâ€™application entiÃ¨re (et donc ni lâ€™en-tÃªte ni la liste des sÃ©ries).</p>
<h3 id="routes-imbriquees">
      <a class="putainde-Title-anchor" href="#routes-imbriquees">#</a>
      Routes imbriquÃ©es
    </h3><p>CommenÃ§ons par dÃ©finir une nouvelle route <code>edit</code>, sous-route de <code>seriesItem</code> : </p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'series'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'seriesItem'</span>, { path: <span class="hljs-string">'/:seriesItem_id'</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'edit'</span>);
    });
  });
});
</code></pre>
<p>Pour que notre nouvelle route affiche la fiche en mode Ã©dition, on doit - <a href="/posts/js/debuter-avec-ember/#les-fondamentaux">rappelez-vous</a> - impÃ©rativement suivre les 
<a href="http://emberjs.com/guides/concepts/naming-conventions/">conventions de nommage</a> et crÃ©er un gabarit <code>edit.hbs</code> dans le 
rÃ©pertoire <code>/app/templates/series/series-item/</code> :</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/edit.hbs` --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"submit"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"submit"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"cancel"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cancel"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"title"</span>&gt;</span>{{input id="title" type="text" value=title}}<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">img</span> {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"coverUrl"</span><span class="hljs-value">}}</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">"Series's first album cover"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cover"</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"description"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"scriptwriter"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">"scriptwriter"</span>&gt;</span>Scriptwriter<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"control"</span>&gt;</span>{{input id="scriptwriter" type="text" value=scriptwriter required="required"}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"illustrator"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">"illustrator"</span>&gt;</span>Illustrator<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"control"</span>&gt;</span>{{input id="illustrator" type="text" value=illustrator}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"publisher"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">"publisher"</span>&gt;</span>Publisher<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"control"</span>&gt;</span>{{input id="publisher" type="text" value=publisher}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"summary"</span>&gt;</span>{{textarea value=summary rows="10"}}<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre>
<p>Ã€ ce stade, naviguer sur <code>/series/{@id}/edit</code> ne lÃ¨ve pas dâ€™erreur mais nâ€™a aucun effet. En effet, on a
dÃ©fini une route imbriquÃ©e mais conservÃ© le gabarit <code>/app/templates/series/series-item.hbs</code> inchangÃ©. Lâ€™activation de la route <code>series.seriesItem</code> 
affiche donc toujours ce gabarit, mÃªme dans le cas dâ€™une sous-route telle que <code>series.seriesItem.edit</code>. </p>
<h3 id="outlets">
      <a class="putainde-Title-anchor" href="#outlets">#</a>
      <code>outlets</code>
    </h3><p>La solution est Ã  aller chercher du cÃ´tÃ© du concept dâ€™<code>{{outlet}}</code> dÃ©fini dans lâ€™<a href="/posts/js/premiere-app-ember/#-code-outlet-code-et-routes-imbriquees">article prÃ©cÃ©dent</a>.
Un <code>{{outlet}}</code> est nÃ©cessaire <strong>Ã  chaque fois quâ€™on dÃ©finit un niveau dâ€™imbrication.</strong> Mais comme on veut quand mÃªme continuer Ã  afficher la sÃ©rie Ã  
lâ€™URL <code>/series/{@id}/</code>, on va utiliser la <strong>route implicite</strong> <code>series.seriesItem.index</code> (cf. <a href="/posts/js/premiere-app-ember/#routes-et-controleurs-implicites">article prÃ©cÃ©dent</a>) 
et son gabarit, dans lequel on va copier lâ€™ancien contenu de <code>series-item.hbs</code>.</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/index.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">h3</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-title">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">img</span> {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"coverUrl"</span><span class="hljs-value">}}</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">"Series's first album cover"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cover"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">dl</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"description"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>scriptwriter<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{scriptwriter}} <span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>illustrator<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{illustrator}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>publisher<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{publisher}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">dl</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">p</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"summary"</span>&gt;</span>
      {{summary}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>Le gabarit <code>series-item.hbs</code> est quant Ã  lui modifiÃ© car il doit changer en fonction de la sous-route activÃ©e.
Et puisquâ€™on ne veut rien afficher de plus, son contenu se rÃ©sume Ã  un <code>{{outlet}}</code> :</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series-item.hbs --&gt;</span>
{{outlet}}
</code></pre>
<p>Et voilÃ  ! Lâ€™affichage de lâ€™URL <code>/series/{@id}/</code> est inchangÃ© alors que lâ€™URL <code>/series/{@id}/edit</code> 
affiche dÃ©sormais le formulaire dâ€™Ã©dition.</p>
<h3 id="liens-entre-routes">
      <a class="putainde-Title-anchor" href="#liens-entre-routes">#</a>
      Liens entre routes
    </h3><p>Pour pouvoir plus facilement basculer en mode Ã©dition, on ajoute un lien vers la route correspondante grÃ¢ce Ã  <code>link-to</code> 
(cf. <a href="http://emberjs.com/guides/templates/links/">doc officielle</a>).</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/index.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
    {{#link-to 'series.seriesItem.edit' id class="edit"}}edit{{/link-to}}
    <span class="hljs-tag">&lt;<span class="hljs-title">h3</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-title">h3</span>&gt;</span>
    ...
</code></pre>
<p>On note que la route vers laquelle le lien pointe est prÃ©fixÃ©e par <code>series</code> parce quâ€™on a dÃ©fini une route et non une resource.
En effet, une ressource rÃ©initialise lâ€™espace de nommage et permet donc des noms de routes plus courts. Pour pouvoir pointer vers <code>seriesItem.edit</code> on aurait donc dÃ»
remplacer <code>this.route(&#39;seriesItem&#39;, ...</code> par <code>this.resource(&#39;seriesItem&#39;, ...</code>.</p>
<p>On peut dÃ©sormais Ã©diter notre sÃ©rie. On remarque au passage que la modification du titre de la sÃ©rie le met Ã©galement Ã  jour en temps rÃ©el dans la liste des sÃ©ries grÃ¢ce
au <em>binding</em> (cf. <a href="/posts/js/premiere-app-ember/#-em-bindings-em-et-mise-a-jour-des-gabarits">article prÃ©cÃ©dent</a>).</p>
<h3 id="enregistrement-des-modifications">
      <a class="putainde-Title-anchor" href="#enregistrement-des-modifications">#</a>
      Enregistrement des modifications
    </h3><p>Nous allons maintenant rendre opÃ©rationnels nos deux boutons dâ€™Ã©dition <em>annuler</em> et <em>valider</em>. Pour cela, on commence par associer des actions Ã  nos boutons :</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/edit.hbs` --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"submit"</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">submit</span>"}} <span class="hljs-attribute">class</span>=<span class="hljs-value">"submit"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"reset"</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">cancel</span>"}} <span class="hljs-attribute">class</span>=<span class="hljs-value">"cancel"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
...
</code></pre>
<p>Comme il sâ€™agit de manipulations sur le modÃ¨le et de transitions entre routes, les actions correspondantes seront traitÃ©es par la route.</p>
<pre><code class="lang-js"><span class="hljs-comment">// app/routes/series/series-item/edit.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
  model: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.seriesItem'</span>);
  },
  actions: {
    submit: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.seriesItem.edit'</span>).save().then(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series.seriesItem'</span>);
      }.bind(<span class="hljs-keyword">this</span>));
    },

    cancel: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.seriesItem.edit'</span>).rollback();
      <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series.seriesItem'</span>);
    }
  }
});
</code></pre>
<p>Quelques mots sur ces quelques lignes : </p>
<ul>
<li>Dans une <code>route</code>, le modÃ¨le courant est rÃ©cupÃ©rÃ© via <code>this.modelFor(&#39;nomRoute&#39;)</code>. Ici, on rÃ©cupÃ¨re explicitement le modÃ¨le chargÃ© automatiquement 
(par convention) par la route mÃ¨re <code>seriesItem</code>. Notez quâ€™on aurait pu omettre la rÃ©cupÃ©ration du modÃ¨le complÃ¨tement car la route mÃ¨re sâ€™en occupe pour nous.</li>
<li>Une fois le modÃ¨le rÃ©cupÃ©rÃ©, on peut invoquer les mÃ©thodes apportÃ©es par <a href="https://github.com/emberjs/data">Ember Data</a>.</li>
<li>Pour un <code>cancel</code>, on invoque <code>rollback()</code> : toutes les modifications effectuÃ©es sont annulÃ©es et le modÃ¨le est rÃ©initialisÃ©.</li>
<li>Pour un <code>submit</code>, on invoque un <code>save()</code> qui enregistre les modifications apportÃ©es au modÃ¨le dans le <em>magasin</em> 
(<a href="http://emberjs.com/api/data/classes/DS.Store.html">Store</a>) dâ€™<a href="https://github.com/emberjs/data">Ember Data</a>.</li>
<li>Les opÃ©rations effectuÃ©es sur les modÃ¨les sont bien souvent asynchrones puisque, dans le cas nominal, elles font 
intervenir des API REST pour enregistrer ou mettre Ã  jour les donnÃ©es depuis un serveur. Dans le cas oÃ¹ lâ€™on souhaite
attendre la fin du traitement pour effectuer une action (comme ici dans le cas du <code>save</code>), il est nÃ©cessaire dâ€™utiliser
les <em>promesses</em> (<code>promises</code>) quâ€™<a href="https://github.com/emberjs/data">Ember Data</a> renvoie (<code>.then(...)</code>). Dans le cas contraire, le code serait
exÃ©cutÃ© avant la fin du traitement et ne permettrait pas de proposer un retour utilisateur propre (gestion des cas dâ€™erreurs notamment).</li>
<li>Les transitions entre routes sont possibles via <code>this.transitionTo(&#39;nomRoute&#39;)</code>.</li>
</ul>
<h3 id="actions-sur-les-transitions">
      <a class="putainde-Title-anchor" href="#actions-sur-les-transitions">#</a>
      Actions sur les transitions
    </h3><p>Mais je voudrais encore ajouter une derniÃ¨re petite cerise sur ce gÃ¢teau : annuler automatiquement toutes les modifications effectuÃ©es
sur la sÃ©rie dÃ¨s que lâ€™on quitte la route. <a href="http://emberjs.com">Ember</a> prÃ©voit en effet des mÃ©canismes avancÃ©s pour travailler sur les transitions entre 
routes (cf. <a href="http://emberjs.com/guides/routing/preventing-and-retrying-transitions/">doc officielle</a>). En particulier <code>willTransition</code> : </p>
<pre><code class="lang-js"><span class="hljs-comment">// app/routes/series/series-item/edit.js</span>
  actions: {
    ...
    willTransition: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.seriesItem.edit'</span>).rollback();
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  }
</code></pre>
<p>Lâ€™action est trÃ¨s simple ici mais on imagine facilement comment on pourrait ajouter une confirmation et dÃ©terminer, en fonction
de la rÃ©ponse, si lâ€™on doit continuer la transition ou lâ€™abandonner.</p>
<h2 id="relations-avec-ember-data">
      <a class="putainde-Title-anchor" href="#relations-avec-ember-data">#</a>
      Relations avec <a href="https://github.com/emberjs/data">Ember Data</a>
    </h2><p><a href="https://github.com/emberjs/data">Ember Data</a> permet de dÃ©finir des relations entre nos modÃ¨les. Ajoutons donc des albums Ã  nos sÃ©ries :</p>
<p>On dÃ©finit dâ€™abord une nouvelle entitÃ© <code>Album</code> et ses propriÃ©tÃ©s et on indique que cet album Ã©tait associÃ© Ã  une sÃ©rie via la propriÃ©tÃ© <code>series</code> 
et Ã  la mÃ©thode <code>DS.belongsTo</code> (cf. <a href="http://emberjs.com/api/data/#method_belongsTo">doc officielle</a>). 
Ce qui se traduit plus loin, dans lâ€™initialisation des donnÃ©es par <code>series: 1</code> oÃ¹ 1 est lâ€™identifiant de la 
sÃ©rie en question.</p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/models/album.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">'ember-data'</span>;

<span class="hljs-keyword">var</span> Album = DS.Model.extend({
  title               : DS.attr(<span class="hljs-string">'string'</span>),
  publicationDate     : DS.attr(<span class="hljs-string">'date'</span>),
  number              : DS.attr(<span class="hljs-string">'number'</span>),
  coverName           : DS.attr(<span class="hljs-string">'string'</span>, {defaultValue: <span class="hljs-string">'default.jpg'</span>}),
  series              : DS.belongsTo(<span class="hljs-string">'seriesItem'</span>),
  coverUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'/assets/images/albums/covers/'</span> + <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'coverName'</span>);
  }.property(<span class="hljs-string">'coverName'</span>)
});

Album.reopenClass({
  FIXTURES: [{
    id: <span class="hljs-number">1</span>,
    title: <span class="hljs-string">'Somewhere Within the Shadows'</span>,
    publicationDate: <span class="hljs-string">'Nov 2000'</span>,
    number: <span class="hljs-number">1</span>,
    coverName: <span class="hljs-string">'blacksad-1.jpg'</span>,
    series: <span class="hljs-number">1</span>
  }, {
    id: <span class="hljs-number">2</span>,
    title: <span class="hljs-string">'Arctic-Nation'</span>,
    publicationDate: <span class="hljs-string">'Mar 2003'</span>,
    number: <span class="hljs-number">2</span>,
    coverName: <span class="hljs-string">'blacksad-2.jpg'</span>,
    series: <span class="hljs-number">1</span>
  }]
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Album;
</code></pre>
<p>On modifie ensuite le modÃ¨le <code>SeriesItem</code> pour indiquer une relation inverse grÃ¢ce Ã  la propriÃ©tÃ© <code>albums</code> et Ã  
la mÃ©thode <code>DS.hasMany</code> (cf. <a href="http://emberjs.com/api/data/#method_hasMany">doc officielle</a>) puis affecter la liste des 
identifiants des albums Ã  la sÃ©rie via <code>albums: [1, 2]</code> : </p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/models/series-item.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">'ember-data'</span>;

<span class="hljs-keyword">var</span> SeriesItem = DS.Model.extend({
    title               : DS.attr(<span class="hljs-string">'string'</span>, {defaultValue: <span class="hljs-string">'New Series'</span>}),
    ...
    albums              : DS.hasMany(<span class="hljs-string">'album'</span>, {async: <span class="hljs-literal">true</span>})
});

SeriesItem.reopenClass({
    FIXTURES: [{
    id: <span class="hljs-number">1</span>,
    ...
    albums: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
    }, ...
]});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> SeriesItem;
</code></pre>
<h2 id="insertion-d-un-gabarit">
      <a class="putainde-Title-anchor" href="#insertion-d-un-gabarit">#</a>
      Insertion dâ€™un gabarit
    </h2><p>Maintenant quâ€™on a des albums pour nos sÃ©ries, on serait bien intÃ©ressÃ© de les voir sâ€™afficher. Seulement voilÃ , on veut juste les
afficher Ã  cÃ´tÃ© de la visualisation dâ€™une sÃ©rie. On ne veut rien proposer dâ€™autre pour ces albums que le <em>binding</em> des propriÃ©tÃ©s et
leur affichage. Pas besoin de route ou de contrÃ´leur. On va pour cela utiliser un outil particulier permettant simplement
dâ€™insÃ©rer (dâ€™afficher) un gabarit au sein dâ€™une route existante via le <em>helper</em> : <code>render</code> (cf. 
<a href="http://emberjs.com/guides/templates/rendering-with-helpers/#toc_the-code-view-code-helper">doc officielle</a>).</p>
<p>On modifie donc le gabarit <code>/series/series-item.hbs</code> pour quâ€™Ã  cÃ´tÃ© de la fiche dâ€™une sÃ©rie soit affichÃ©e la liste de ses albums : </p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item.hbs --&gt;</span>

{{outlet}}

<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-albums"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">ul</span>&gt;</span>
        {{#each album in albums}}
            {{render 'partials/albumItem' album}}
        {{/each}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/partials/album-item.hbs --&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"album"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">img</span> {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"coverUrl"</span><span class="hljs-value">}}</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">"Album cover"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cover"</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"description"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">h4</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-title">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dl</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>volume<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{number}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>date<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{publicationDate}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dl</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
</code></pre>
<h2 id="creation-d-une-nouvelle-serie">
      <a class="putainde-Title-anchor" href="#creation-d-une-nouvelle-serie">#</a>
      CrÃ©ation dâ€™une nouvelle sÃ©rie
    </h2><p>Histoire de terminer en beautÃ© on va ajouter vite fait la crÃ©ation dâ€™une sÃ©rie.</p>
<p>Comme on commence Ã  avoir lâ€™habitude, on fait Ã§a en deux coups de cuillÃ¨re Ã  pot : </p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'series'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'seriesItem'</span>, { path: <span class="hljs-string">'/:seriesItem_id'</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'edit'</span>);
    });
    <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'create'</span>);
  });
});
</code></pre>
<pre><code class="lang-js"><span class="hljs-comment">// /app/routes/series/create.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
  model: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.store.createRecord(<span class="hljs-string">'seriesItem'</span>);
  },

  renderTemplate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.render(<span class="hljs-string">'series.seriesItem.edit'</span>);
  },

  actions: {
    submit: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.create'</span>).save().then(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series.seriesItem'</span>, <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.create'</span>));
      }.bind(<span class="hljs-keyword">this</span>));
    },

    cancel: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.create'</span>).rollback();
      <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series'</span>);
    },

    willTransition: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.create'</span>).rollback();
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  }
});
</code></pre>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
    ...
      {{/each}}
        <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-item"</span>&gt;</span>
          {{#link-to 'series.create' class="add"}}add{{/link-to}}
        <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
    ...
</code></pre>
<p>Les points importants Ã  noter : </p>
<ul>
<li>Le modÃ¨le est, cette fois-ci, crÃ©Ã© Ã  lâ€™activation de la route via <code>this.store.createRecord(...)</code>.</li>
<li>Comme on ne souhaite pas proposer de gabarit propre pour cette route, on utilise <code>renderTemplate</code> pour indiquer Ã  <a href="http://emberjs.com">Ember</a> quel
gabarit il doit utiliser. </li>
<li>Les actions <code>submit</code>, <code>cancel</code> et <code>willTransition</code> sont sensiblement les mÃªmes que pour lâ€™Ã©dition mais travaillent sur un modÃ¨le diffÃ©rent et 
renvoient vers dâ€™autres routes.</li>
<li>On note le passage du modÃ¨le lors de la transition en cas de <code>submit</code>.</li>
<li>Il serait lÃ©gitime de se poser la question de rÃ©utilisation de code entre ces deux routes, compte tenu des similaritÃ©s. Ce nâ€™est pas lâ€™objet 
de lâ€™article mais pourrait Ãªtre envisagÃ© Ã  lâ€™aide dâ€™un <code>mixin</code> partagÃ© (cf. <a href="http://emberjs.com/api/classes/Ember.Mixin.html">doc officielle</a>).  </li>
</ul>
<h2 id="conclusion">
      <a class="putainde-Title-anchor" href="#conclusion">#</a>
      Conclusion
    </h2><p>Au travers de cet article et des prÃ©cÃ©dents, jâ€™espÃ¨re vous avoir donnÃ© un aperÃ§u du modÃ¨le de dÃ©veloppement que propose
<a href="http://emberjs.com">Ember</a>. Vous avez compris, jâ€™espÃ¨re, quâ€™<a href="http://emberjs.com">Ember</a> est un vÃ©ritable framework avec des opinions fortes et quâ€™il doit Ãªtre pris comme
tel ou laissÃ© de cÃ´tÃ© pour une solution plus lÃ©gÃ¨re selon vos besoins.</p>
<p>Mais jâ€™ai Ã©galement essayÃ© dâ€™aller plus en profondeur sur certains aspects et de montrer des cas dâ€™utilisation concrets. 
Ce dernier article montre quâ€™il est Ã©galement possible de fournir Ã  <a href="http://emberjs.com">Ember</a> 
des configurations explicites afin dâ€™aller plus loin que les conventions par dÃ©faut.</p>
<p>Maintenant, vous nâ€™avez plus dâ€™excusesâ€¦ Vous ne pourrez pas dire que vous ne connaissiez pas. </p>
<p><em>Note: les sources de lâ€™application exemple sont <a href="https://github.com/bmeurant/ember-articles/tree/premiere-app-ember-suite">disponibles sur github</a>.</em></p>
]]></description>
            <link>http://putaindecode.fr/posts/js/premiere-app-ember-suite/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/premiere-app-ember-suite/</guid>
            <pubDate>Tue, 09 Dec 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[L'injection de dÃ©pendances en PHP]]></title>
            <description><![CDATA[<p>Salutations ! Aujourdâ€™hui, je suis venu te parler de PHP (sisi), et notamment du mÃ©canisme dâ€™injection de dÃ©pendances avec lequel tu nâ€™es peut-Ãªtre pas familier. Au menu, des objets, des usines et des conteneurs, alors enfile ton bonnet et tes gants, on va bouger du bordel !</p>
<h2 id="l-injection-de-dependances-c-est-quoi-ce-truc">
      <a class="putainde-Title-anchor" href="#l-injection-de-dependances-c-est-quoi-ce-truc">#</a>
      Lâ€™injection de dÃ©pendances ? Câ€™est quoi ce truc ?
    </h2><p>Si tu fais de la programmation orientÃ©e objet, il est fort probable que ce terme ne te soit pas totalement inconnu. En PHP, on a principalement commencÃ© Ã  nous en rebattre les oreilles avec lâ€™avÃ¨nement de Symfony, qui est aujourdâ€™hui le framework web majeur pour ce langage. Fabien Potencier, crÃ©ateur et <em>lead developer</em> de Symfony, cite en exemple sur <a href="http://fabien.potencier.org/article/11/what-is-dependency-injection">son blog</a> cette dÃ©finition :</p>
<blockquote>
<p><em>Dependency Injection is where components are given their dependencies through their constructors, methods, or directly into fields.</em></p>
<p>Quelquâ€™un</p>
</blockquote>
<p>Câ€™est clair, non ? Non ? Bon. Imaginons un bout dâ€™appli PHP, oÃ¹ lâ€™on dÃ©sire gÃ©rer des personnes qui ont chacune une adresse postale. Si tu nâ€™as pas trop dormi Ã  la fac le vendredi matin aprÃ¨s ta cuite du jeudi soir, tu devrais pouvoir dÃ©terminer tout seul quâ€™on va avoir besoin dâ€™une classe <code>Person</code> et dâ€™une classe <code>Address</code> :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$number</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$street</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$zipcode</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$city</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>)</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;number = <span class="hljs-variable">$number</span>;
        <span class="hljs-variable">$this</span>-&gt;street = <span class="hljs-variable">$street</span>;
        <span class="hljs-variable">$this</span>-&gt;zipcode = <span class="hljs-variable">$zipcode</span>;
        <span class="hljs-variable">$this</span>-&gt;city = <span class="hljs-variable">$city</span>;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;
}
</code></pre>
<p>Tu noteras que je nâ€™ai pas encore Ã©crit le constructeur de la classe <code>Person</code>. Justement. Le dÃ©veloppeur naÃ¯f procÃ©dera de la faÃ§on suivante :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>)</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;address = <span class="hljs-keyword">new</span> Address(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>);
    }
}

<span class="hljs-variable">$person</span> = <span class="hljs-keyword">new</span> Person(<span class="hljs-number">5</span>, <span class="hljs-string">'AllÃ©e des Rosiers'</span>, <span class="hljs-number">78670</span>, <span class="hljs-string">'Villennes-sur-Seine'</span>);
</code></pre>
<p>Alors oui, hein, Ã§a marche, et on peut instancier une personne et son adresse en une ligne de code. Le problÃ¨me est quâ€™en procÃ©dant ainsi, les classes <code>Person</code> et <code>Address</code> deviennent <strong>Ã©troitement couplÃ©es</strong> : la classe <code>Person</code> est inutilisable sans la classe <code>Address</code>, et pire, le code interne de la premiÃ¨re serait impactÃ© par un changement sur la seconde.</p>
<p>Pas convaincu ? Quâ€™est-ce qui se passera le jour oÃ¹ on lÃ¨vera 10 millions de dollars pour internationaliser lâ€™appli ?</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span>
</span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$country</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>, <span class="hljs-variable">$country</span>)</span>
    </span>{
        <span class="hljs-comment">// ...</span>
        <span class="hljs-variable">$this</span>-&gt;country = <span class="hljs-variable">$country</span>;
    }
}
</code></pre>
<p>Ah bah mince, il faut aussi modifier le constructeur de la classe <code>Person</code> pour y ajouter le nouveau paramÃ¨tre <code>$country</code> de maniÃ¨re symÃ©trique. Câ€™est ballot.</p>
<p>Dans lâ€™idÃ©al, la classe <code>Person</code> devrait se foutre royalement de la faÃ§on dont la classe <code>Address</code> fonctionne. Une personne a toujours besoin dâ€™une adresse, mais Ã§a nâ€™implique certainement pas que ce soit le rÃ´le de cette classe de la forger. Alors, on fait comment ? Câ€™est trÃ¨s simple :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(Address <span class="hljs-variable">$address</span>)</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;address = <span class="hljs-variable">$address</span>;
    }
}
</code></pre>
<p>Lâ€™injection de dÃ©pendances, câ€™est prÃ©cisÃ©ment Ã§a. Si une classe a besoin dâ€™une instance dâ€™une autre classe, que ce soit dans son constructeur ou dans une autre mÃ©thode (un <em>setter</em> par exemple), alors elle prend cette instance directement en paramÃ¨tre et ne sâ€™occupe certainement pas de lâ€™instancier elle-mÃªme. ProcÃ©der ainsi permet dâ€™Ã©crire du code <strong>dÃ©couplÃ©</strong>, Ã©vitant toute interdÃ©pendance entre ses diffÃ©rents composants, ce qui les rend <strong>rÃ©utilisables</strong> sans devoir embarquer toute la smala au passage, mais Ã©galement beaucoup plus <strong>maintenables</strong> puisque chaque classe sâ€™occupe de ses fesses et pas de celles des autres. En PHP, on tire Ã©galement parti du <em>type hinting</em> dâ€™objets, qui permet de sâ€™assurer dâ€™emblÃ©e que notre paramÃ¨tre est une instance de la classe voulue et non pas nâ€™importe quoi.</p>
<p>Alors oui, je tâ€™entends dÃ©jÃ  grommeler :</p>
<blockquote>
<p>Ouais mais du coup je dois instancier une adresse moi-mÃªme Ã  chaque fois que je crÃ©e une personne, câ€™est relou ton truc</p>
</blockquote>
<p>Si telle est ton opinion, <del>tu ne mÃ©rites pas de vivre</del> je tâ€™invite Ã  poursuivre la lecture de cet article avec lâ€™entrain qui te caractÃ©rise.</p>
<h2 id="l-usine-a-la-rescousse">
      <a class="putainde-Title-anchor" href="#l-usine-a-la-rescousse">#</a>
      Lâ€™usine Ã  la rescousse
    </h2><p>Je ne sais pas si tu sais, mais il existe un <em>design pattern</em> assez rÃ©pandu en programmation orientÃ©e objet que lâ€™on nomme <strong>factory</strong> (usine en franÃ§ais, dâ€™oÃ¹ le titre pourrave de cette partie).</p>
<p>En gros, le principe est de crÃ©er une classe dont le rÃ´le est dâ€™instancier dâ€™autres classes, prÃ©cisÃ©ment dans le cas oÃ¹ une telle tÃ¢che demande plusieurs lignes de code, afin justement dâ€™Ã©viter de rÃ©pÃ©ter celles-ci. Pour reprendre notre exemple :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PersonFactory</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createPerson</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>, <span class="hljs-variable">$country</span>)</span>
    </span>{
        <span class="hljs-variable">$address</span> = <span class="hljs-keyword">new</span> Address(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>, <span class="hljs-variable">$country</span>);

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Person(<span class="hljs-variable">$address</span>);
    }
}
</code></pre>
<p>Pour le coup, tu te dis peut-Ãªtre que je te prends allÃ¨grement pour un idiot : pourquoi se prendre le chou Ã  crÃ©er une classe qui fait exactement ce quâ€™on faisait directement dans <code>Person</code> au dÃ©part ? Parce que tu nâ€™as pas bien Ã©coutÃ©, <del>petit c</del> jeune padawan. Lâ€™objectif en utilisant lâ€™injection de dÃ©pendances, câ€™est que nos classes ne soient pas dÃ©pendantes (justement) les unes des autres si ce nâ€™est pas justifiÃ©. Une personne a beau avoir besoin dâ€™une adresse, on pourrait fort bien imaginer les utiliser lâ€™une sans lâ€™autre (tu comprendras Ã  la partie suivante). Dans le cas de <code>PersonFactory</code>, notre objectif est justement de crÃ©er une personne Ã  partir des diffÃ©rents composants dâ€™une adresse en une ligne de code, pour conserver la simplicitÃ© du code mÃ©tier qui te tient tant Ã  coeur (et tu as bien raison, au fond). Seulement, <code>Person</code> et <code>Address</code> restent utilisables avec ou sans <code>PersonFactory</code> : lâ€™objectif est atteint, petit navire.</p>
<p>Tant quâ€™on en est Ã  se simplifier la vie :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PersonFactory</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getZipcodeFromDistrict</span><span class="hljs-params">(<span class="hljs-variable">$district</span>)</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-number">75000</span> + <span class="hljs-variable">$district</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createParigot</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$district</span>)</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;createPerson(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$this</span>-&gt;getZipcodeFromDistrict(<span class="hljs-variable">$district</span>), <span class="hljs-string">'Paris'</span>, <span class="hljs-string">'France'</span>);
    }
}
</code></pre>
<p>Tu tâ€™imagines faire ce genre de chose dans la classe <code>Person</code> ou la classe <code>Address</code> ? Jâ€™espÃ¨re bien que non.</p>
<h2 id="oui-ca-sert-a-quelque-chose-une-interface">
      <a class="putainde-Title-anchor" href="#oui-ca-sert-a-quelque-chose-une-interface">#</a>
      Oui, Ã§a sert Ã  quelque chose une interface
    </h2><p>Dans tes souvenirs brumeux de vendredis matins Ã©tudiants (<em>cf. supra</em>), tu retrouveras peut-Ãªtre des bribes de cours portant sur les <strong>interfaces</strong>. Si tout ce que tu as retenu, câ€™est quâ€™â€une classe toute vide Ã§a sert Ã  rienâ€, lis donc ce qui va suivre.</p>
<p>Une interface, câ€™est avant tout un contrat. Une classe qui <strong>implÃ©mente</strong> une interface sâ€™engage Ã  implÃ©menter toutes les mÃ©thodes que celle-ci dÃ©clare. Sans mÃªme lire le code de ladite classe, on sait donc dâ€™emblÃ©e comment on peut jouer avec et comment elle est censÃ©e fonctionner.</p>
<p>Poursuivons encore sur notre exemple et imaginons quâ€™on doive gÃ©rer des adresses ne respectant pas le format utilisÃ© jusquâ€™ici, par exemple une adresse plus basique constituÃ©e dâ€™une unique chaÃ®ne de caractÃ¨res :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BasicAddress</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;
}
</code></pre>
<p>Dans lâ€™Ã©tat actuel des choses, on ne peut pas utiliser une instance de cette classe avec <code>Person</code>, puisque le constructeur de cette derniÃ¨re attend une instance dâ€™<code>Address</code>. Quâ€™Ã  cela ne tienne !</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AddressInterface</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFullAddress</span><span class="hljs-params">()</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BasicAddress</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AddressInterface</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFullAddress</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;address;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AddressInterface</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFullAddress</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;number.<span class="hljs-string">', '</span>.<span class="hljs-variable">$this</span>-&gt;street.<span class="hljs-string">', '</span>.<span class="hljs-variable">$this</span>-&gt;zipcode.<span class="hljs-string">' '</span>.<span class="hljs-variable">$this</span>-&gt;city.<span class="hljs-string">', '</span>.<span class="hljs-variable">$this</span>-&gt;country;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(AddressInterface <span class="hljs-variable">$address</span>)</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;address = <span class="hljs-variable">$address</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAddress</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;address;
    }
}

<span class="hljs-variable">$address</span> = <span class="hljs-keyword">new</span> BasicAddress(<span class="hljs-string">'test test un deux un deux'</span>);
<span class="hljs-variable">$person</span> = <span class="hljs-keyword">new</span> Person(<span class="hljs-variable">$address</span>);

<span class="hljs-variable">$factory</span> = <span class="hljs-keyword">new</span> PersonFactory();
<span class="hljs-variable">$robert</span> = <span class="hljs-variable">$factory</span>-&gt;createParigot(<span class="hljs-number">1</span>, <span class="hljs-string">'Rue de la Paix'</span>, <span class="hljs-number">2</span>);

<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$person</span>-&gt;getAddress()-&gt;getFullAddress()); <span class="hljs-comment">// 'test test un deux un deux'</span>
<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$robert</span>-&gt;getAddress()-&gt;getFullAddress()); <span class="hljs-comment">// '1, rue de la Paix, 75002 Paris, France'</span>
</code></pre>
<p>Tu vois lâ€™idÃ©e ? En demandant une instance de nâ€™importe quelle classe implÃ©mentant <code>AddressInterface</code> au lieu dâ€™une instance dâ€™<code>Address</code> spÃ©cifiquement, on se donne plus de mou et on rÃ©duit encore davantage le couplage entre nos classes. Quâ€™on crÃ©e une personne avec une instance dâ€™<code>Address</code> ou de <code>BasicAddress</code>, on pourra dans tous les cas obtenir lâ€™adresse postale de ladite personne de la mÃªme faÃ§on.</p>
<h2 id="elle-contient-ta-fiancee-hein-mitch">
      <a class="putainde-Title-anchor" href="#elle-contient-ta-fiancee-hein-mitch">#</a>
      Elle contient ta fiancÃ©e, hein Mitch ?
    </h2><p>Tu auras peut-Ãªtre tiquÃ© sur un dÃ©tail du dernier exemple : le fait de ne pas faire de <code>PersonFactory</code> une classe statique (beurk) nous oblige Ã  lâ€™instancier pour pouvoir lâ€™utiliser ; ce qui, Ã  nâ€™en pas douter, tâ€™aura menÃ© Ã  te dire â€œarf, Ã§a va mâ€™en faire des <code>new MachinFactory()</code> pour instancier mes objetsâ€. LÃ  encore, lâ€™injection de dÃ©pendances peut nous aider, quoique de maniÃ¨re indirecte : en utilisant un conteneur dâ€™injection de dÃ©pendances.</p>
<p>Un conteneur (Ã§a sera plus court) peut <em>grosso modo</em> Ãªtre comparÃ© Ã  une grosse <em>factory</em> capable dâ€™instancier plusieurs classes. En pratique, afin dâ€™Ã©viter dâ€™Ã©crire et de devoir maintenir une classe monolithique, on en fera plutÃ´t quelque chose qui fait appel aux diffÃ©rentes <em>factories</em>. Poursuivons sur notre exemple :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DependencyInjectionContainer</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPersonFactory</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PersonFactory();
    }
}
</code></pre>
<p>Mais Ã§a ne sâ€™arrÃªte Ã©videmment pas lÃ . De par le fait dâ€™utiliser lâ€™injection de dÃ©pendances Ã  grande Ã©chelle, on a souvent besoin dâ€™instancier nous-mÃªme les objets dont on a besoin. Dans certains cas, ce seront toujours les mÃªmes, ce qui vaut pour les <em>factories</em> mais pas que : pense aux diffÃ©rentes librairies qui composent un projet web, par exemple. Ce ne serait pas gÃ©nial que les diffÃ©rentes instances de ces classes soient accessibles via le conteneur pour pouvoir y accÃ©der Ã  lâ€™envi ?</p>
<pre><code class="lang-php"><span class="hljs-variable">$container</span> = <span class="hljs-keyword">new</span> DependencyInjectionContainer();

<span class="hljs-variable">$container</span>-&gt;getOrm()-&gt;performSomeNaughtyQuery();
<span class="hljs-variable">$container</span>-&gt;getTwig()-&gt;renderUglyTemplate();
<span class="hljs-variable">$container</span>-&gt;getTranslator()-&gt;translate(<span class="hljs-string">'Putain de code !'</span>);
</code></pre>
<p>Les objets ainsi gÃ©rÃ©s par un tel conteneur deviennent dÃ¨s lors des <strong>services</strong> dans ton application.</p>
<blockquote>
<p>Mais Ã§a signifie instancier un service Ã  chaque appel ?</p>
</blockquote>
<p>Pas nÃ©cessairement ! Il existe des mÃ©canismes permettant de conserver une mÃªme instance pour la servir lors des appels suivants. Cela sort un peu du cadre de cet article, mais je tâ€™invite vivement Ã  jeter un oeil Ã  <a href="http://php-di.org/">PHP-DI</a>, qui est un conteneur dâ€™injection de dÃ©pendances trÃ¨s bien fichu que tu peux utiliser dans ton projet si tu le souhaites.</p>
<h2 id="epilogue">
      <a class="putainde-Title-anchor" href="#epilogue">#</a>
      Ã‰pilogue
    </h2><p>Si tu dÃ©veloppes en PHP, jâ€™espÃ¨re tâ€™avoir montrÃ© quâ€™il est possible dâ€™Ã©crire du code plus maintenable et plus Ã©lÃ©gant en utilisant lâ€™injection de dÃ©pendances. Dans le cas contraire, sache que ce concept est trÃ¨s rÃ©pandu dans les langages orientÃ©s objet dâ€™une maniÃ¨re gÃ©nÃ©rale - aprÃ¨s tout, <a href="https://docs.angularjs.org/guide/di">on en retrouve mÃªme dans Angular</a>.</p>
<p>Bon code, et nâ€™oublie pas, on ne met pas en prod le vendredi, câ€™est mal. Allez, file !</p>
]]></description>
            <link>http://putaindecode.fr/posts/php/injection-dependances/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/php/injection-dependances/</guid>
            <pubDate>Wed, 05 Nov 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Laissez-vous pousser la barbe, apprenez Ã  Ã©crire des Makefiles]]></title>
            <description><![CDATA[<p>Ã€ lâ€™heure oÃ¹ tout le monde se rue sur des outils comme <a href="/posts/js/introduction-gulp/">Gulp</a>,
<a href="/posts/js/premiers-pas-avec-grunt/">Grunt</a> ou autres <a href="https://rubygems.org/gems/rake">Rake</a>, certains irrÃ©ductibles (dont je
fais partie) ont fait le choix dâ€™employer un des outils les plus standards et
emblÃ©matiques dont tout dÃ©veloppeur a entendu parler au moins une fois dans sa
vie : <em>Make</em>.</p>
<p>Si de prime abord on a lâ€™impression dâ€™un systÃ¨me assez archaÃ¯que (ce qui nâ€™est
pas toujours forcÃ©ment faux), on se rend rapidement compte que <em>Make</em>, couplÃ© Ã 
une petite dose de scripting shell permet rapidement de mettre en place un moyen
de compiler ses fichiers et de lancer des tÃ¢ches.</p>
<p>Les fichiers de configuration de <em>Make</em> sont appellÃ©s <em>Makefiles</em> (oui, ce sont
eux qui ont donnÃ© leurs noms aux <code>(Gulp|Grunt|Rake)files</code>). Les instructions
quâ€™ils contiennent sont exÃ©cutÃ©es grÃ¢ce Ã  la commande <code>make</code> dans votre
terminal.</p>
<h1 id="hello-world">
      <a class="putainde-Title-anchor" href="#hello-world">#</a>
      Hello World
    </h1><p>Je vous propose de commencer en douceur par un classique <em>Hello World</em>. On va
simplement dÃ©finir une tÃ¢che <code>hello-world</code> dont lâ€™action va Ãªtre dâ€™afficher
<em>â€œHello, worldâ€</em> Ã  lâ€™Ã©cran (boooring).</p>
<pre><code class="lang-make">hello-world:
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello, world"</span>
</code></pre>
<p>PremiÃ¨re remarque importante, les indentations dans un <em>Makefile</em> <strong>doivent</strong>
Ãªtre faites avec des tabulations. Oui, je sais, câ€™est moche, on dirait du
Python, mais câ€™est comme Ã§a.</p>
<p>VoilÃ  le genre dâ€™erreurs quâ€™on se prend si on met des espaces Ã  la place des
tabulations :</p>
<pre><code>Makefile:2: <span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span> sÃ©parateur manquant . ArrÃªt.
</code></pre><p>Pour exÃ©cuter notre commande, il nous suffit de lancer <code>make hello-world</code> dans
un terminal :</p>
<pre><code class="lang-console">$ <span class="hljs-keyword">make</span> hello-world
<span class="hljs-keyword">echo</span> <span class="hljs-string">"Hello, world"</span>
Hello, world
</code></pre>
<p>DÃ©cortiquons un peu cette exÃ©cution. Pour chaque commande quâ€™il exÃ©cute, <em>Make</em>
affiche la commande complÃ¨te avant dâ€™afficher la sortie standard de ladite
commande. Câ€™est souvent trÃ¨s pratique car toutes les variables (on va revenir lÃ  dessus)
quâ€™on met dans la commande sont rÃ©solues, et on voit clairement ce que <em>Make</em>
exÃ©cute. Par contre, dans certains cas on sâ€™en fout un peu, on peut alors
prÃ©fixer la ligne Ã  rendre silencieuse par un <code>@</code>, comme Ã§a :</p>
<pre><code class="lang-make">hello-world:
    @ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello, world"</span>
</code></pre>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>make hello-world
<span class="hljs-constant">Hello,</span> world
</code></pre>
<h1 id="regles-cibles-recettes-et-pre-requis">
      <a class="putainde-Title-anchor" href="#regles-cibles-recettes-et-pre-requis">#</a>
      RÃ¨gles, cibles, recettes et prÃ©-requis
    </h1><p>OK, jusque lÃ  câ€™est gÃ©nial, on a un super outil pour lancer des commandes quâ€™on
pourrait dÃ©jÃ  stocker dans un bÃªte script shell. Pas super utile finalement.</p>
<p>Bon, on va corser un peu les choses et commencer par dÃ©finir un peu de
terminologie avant que vous soyez totalement larguÃ©s.</p>
<p>Un <em>Makefile</em> est une collection de <strong>rÃ¨gles</strong>, chacune Ã©tant composÃ©e dâ€™une
<strong>cible</strong>, de <strong>prÃ©-requis</strong> (ou pas) et dâ€™une <strong>recette</strong>. Dans notre exemple
prÃ©cÃ©dent, <code>hello-world</code> est la cible et <code>@ echo &quot;Hello, world&quot;</code> est la recette
de la rÃ¨gle. Elle ne spÃ©cifie par contre pas de prÃ©-requis.</p>
<p>Relisez trois ou quatre fois le paragraphe prÃ©cÃ©dent jusquâ€™Ã  ce que ce soit bien
imprimÃ©.</p>
<p>Vous lâ€™aurez compris, on invoque une rÃ¨gle depuis la ligne de commande en
spÃ©cifiant le nom de sa cible aprÃ¨s la commande <code>make</code>. Si on ne prÃ©cise rien,
câ€™est la premiÃ¨re rÃ¨gle trouvÃ©e qui est exÃ©cutÃ©e (donc dans notre cas,
<code>hello-world</code>).</p>
<p>Les prÃ©-requis sont dÃ©clarÃ©s aprÃ¨s la cible. On pourrait par exemple ajouter un
<code>sauter-une-ligne</code> comme prÃ©-requis Ã  notre cible <code>hello-world</code> :</p>
<pre><code class="lang-make">hello-world: sauter-une-ligne
    @ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello, world"</span>

sauter-une-ligne:
    @ <span class="hljs-built_in">echo</span>
</code></pre>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>make hello-world

<span class="hljs-constant">Hello,</span> world
</code></pre>
<p>Facile, non ? Ok alors on peut <em>vraiment</em> attaquer les choses sÃ©rieuses.</p>
<h1 id="construire-des-fichiers">
      <a class="putainde-Title-anchor" href="#construire-des-fichiers">#</a>
      Construire des fichiers
    </h1><p>Les prÃ©-requis sont particuliÃ¨rement pratiques quand on veut construire un
fichier depuis un autre, ce qui est la principale action dâ€™Ã  peu prÃ¨s tout
processus de compilation (paraÃ®t mÃªme que câ€™est grosso modo la dÃ©finition de la
compilation).</p>
<p>On peut par exemple Ã©crire un <em>Makefile</em> nous permettant de compiler un fichier
<em>Markdown</em> en <em>HTML</em> :</p>
<pre><code class="lang-make"><span class="hljs-tag">article</span><span class="hljs-class">.html</span>: <span class="hljs-tag">article</span><span class="hljs-class">.md</span>
    marked <span class="hljs-tag">article</span><span class="hljs-class">.html</span> &gt; <span class="hljs-tag">article</span>.md
</code></pre>
<p>Cette rÃ¨gle spÃ©cifie simplement que pour construire le fichier <code>article.html</code>
jâ€™ai besoin du fichier <code>article.md</code> et que jâ€™utilise la commande
<a href="https://www.npmjs.org/package/marked"><code>marked</code></a> pour construire le fichier. Essayez, vous verrez, câ€™est
magique.</p>
<p>LÃ  oÃ¹ Ã§a devient intÃ©ressant, câ€™est que si je lance de nouveau <code>make
article.html</code>, rien ne se passe. Eh oui, <em>Make</em> vÃ©rifie les dates de
modification des prÃ©-requis et les compare avec la date de modification de la
cible pour savoir sâ€™il doit oÃ¹ non reconstruire la cible.</p>
<p>On peut bien sÃ»r aller plus loin en ayant des fichiers qui dÃ©pendent de
fichiers, qui Ã  leur tour dÃ©pendent de fichiers, â€¦</p>
<p><a name="ref-phony-target"></a></p>
<p>On peut aussi avoir une cible factice qui ne reprÃ©sente pas un fichier et qui
elle-mÃªme dÃ©pend de plusieurs fichiers (<code>website: index.html apropos.html
contact.html</code>).</p>
<h1 id="variables-et-substitutions">
      <a class="putainde-Title-anchor" href="#variables-et-substitutions">#</a>
      Variables et substitutions
    </h1><p>La syntaxe des variables dans un <em>Makefile</em> ressemblent beaucoup aux variables
de votre Shell, <em>mais pas tout Ã  fait</em>.</p>
<pre><code class="lang-make">SOURCE = <span class="hljs-keyword">index</span>.md
DESTINATION = <span class="hljs-keyword">index</span>.html

<span class="hljs-variable">${DESTINATION}</span>: <span class="hljs-variable">${SOURCE}</span>
  marked <span class="hljs-variable">${SOURCE}</span> &gt; <span class="hljs-variable">${DESTINATION}</span>
</code></pre>
<p>On peut aussi utiliser une substitution pour sâ€™Ã©viter de tout retaper. La
syntaxe pour Ã§a est assez simple et se passe dâ€™explications :</p>
<pre><code class="lang-make"><span class="hljs-variable">SOURCE =</span> index.md
<span class="hljs-variable">DESTINATION =</span> ${SOURCE:.<span class="hljs-variable">md=</span>.html}
</code></pre>
<p>LÃ  oÃ¹ Ã§a devient beaucoup plus intÃ©ressant câ€™est quâ€™on peut stocker des listes
dans une variable. Pour Ã§a, pas vraiment dâ€™effort Ã  faire, il suffit de rajouter
des noms Ã  la suite :</p>
<pre><code class="lang-make">SOURCE = index.<span class="hljs-built_in">md</span> article.<span class="hljs-built_in">md</span>
DESTINATION = ${SOURCE:.<span class="hljs-built_in">md</span>=.html}
</code></pre>
<p>Attention par contre ! En faisant Ã§a si vous utilisez <code>${SOURCE}</code> comme cible
dâ€™une rÃ¨gle, vous allez dÃ©finir plusieurs rÃ¨gles dâ€™un coup, ce qui nâ€™est peut
Ãªtre pas ce que vous voulez.</p>
<p>On peut contourner Ã§a assez simplement en utilisant une substitution au niveau
de la rÃ¨gle. La syntaxe est un poil diffÃ©rente :</p>
<pre><code class="lang-make"><span class="hljs-preprocessor">%</span>.html: <span class="hljs-preprocessor">%</span>.md
  [...]
</code></pre>
<p>Vous lâ€™aurez compris, <code>%</code> est identique dans la cible et dans la dÃ©pendance,
donc avec cette rÃ¨gle si vous faites un <code>make index.html</code>, <em>Make</em> va tenter de
construire la dÃ©pendance <code>index.md</code> avant tout.</p>
<p>Un problÃ¨me se pose Ã  nous avec cette syntaxe : Â« Bah merde, comment je rÃ©cupÃ¨re
les noms de fichiers lÃ  ? Â»</p>
<h1 id="variables-speciales">
      <a class="putainde-Title-anchor" href="#variables-speciales">#</a>
      Variables spÃ©ciales
    </h1><p>Superbe transition Ã©tant donnÃ© quâ€™on va parler ici de quelques variables
spÃ©ciales bien pratiques !</p>
<ul>
<li><code>$@</code> contient le nom de la cible de la rÃ¨gle en cours dâ€™exÃ©cution ;</li>
<li><code>$^</code> contient la liste des dÃ©pendances de la rÃ¨gle (la flÃ¨che pointe vers la
liste de dÃ©pendances) ;</li>
<li><code>$&lt;</code> contient la premiÃ¨re dÃ©pendance de la rÃ¨gle (la flÃ¨che pointe Ã  gauche,
lÃ  oÃ¹ est la dÃ©pendance).</li>
</ul>
<p>Ã€ lâ€™aide de celles-ci on peut du coup complÃ©ter notre exemple prÃ©cÃ©dent :</p>
<pre><code class="lang-make"><span class="hljs-variable">%.</span>html: <span class="hljs-variable">%.</span>md
  marked <span class="hljs-variable">$&lt;</span> &gt; <span class="hljs-variable">$@</span>
  [...]
</code></pre>
<h1 id="fonctions">
      <a class="putainde-Title-anchor" href="#fonctions">#</a>
      Fonctions
    </h1><p>Pour faciliter quelques opÃ©rations, <em>Make</em> fournit un ensemble de fonctions de
base. Appeler ces fonctions rappelle un peu la faÃ§on dont on lance une commande
dans un sous-shell en Bash : <code>$(fonction argument1 argument2)</code>.</p>
<p>Voici une petite dÃ©monstration de <code>wildcard</code>, <code>addsuffix</code> et <code>basename</code> dont
vous vous doutez sans doute les effets :</p>
<pre><code class="lang-make">SOURCES = <span class="hljs-variable">$(</span>wildcard <span class="hljs-variable">*.</span>md)
DESTINATIONS = <span class="hljs-variable">$(</span>addsuffix .html,<span class="hljs-variable">$(</span><span class="hljs-keyword">basename</span> <span class="hljs-variable">${SOURCES}</span>))

all: <span class="hljs-variable">${DESTINATIONS}</span>

<span class="hljs-variable">%.</span>html: <span class="hljs-variable">%.</span>md
  marked <span class="hljs-variable">$&lt;</span> &gt; <span class="hljs-variable">$@</span>
</code></pre>
<p>Lâ€™exemple construit dynamiquement la liste des fichiers HTML Ã  produire Ã  partir
de la liste des fichiers <em>Markdown</em> disponibles puis dÃ©finit une rÃ¨gle <code>all</code>
permettant de tout construire dâ€™un coup, et une rÃ¨gle dÃ©finissant compiler
unitairement un fichier <em>Markdown</em> vers HTML.</p>
<p>Vous noterez quâ€™<code>addsuffix</code>/<code>basename</code> peut Ãªtre remplacÃ© par une substitution
simple comme on a vu prÃ©cÃ©demment.</p>
<p>Je vous invite Ã  fouiller
<a href="https://www.gnu.org/software/make/manual/make.html#Functions">le chapitre sur les fonctions du manuel</a>.</p>
<h1 id="la-cible-phony">
      <a class="putainde-Title-anchor" href="#la-cible-phony">#</a>
      La cible <code>.PHONY</code>
    </h1><p>Dans certains cas la cible dâ€™une rÃ¨gle ne reprÃ©sente pas un fichier (câ€™Ã©tait le
cas de notre cible <code>website</code> <a href="#ref-phony-target">un peu plus haut</a>).</p>
<p>Dans ces cas-lÃ , on va vouloir exÃ©cuter la rÃ¨gle quoi quâ€™il arrive, comme si la
cible Ã©tait tout le temps pÃ©rimÃ©e.</p>
<p>Une cible particuliÃ¨re existe pour Ã§a : <code>.PHONY</code>. Toutes les dÃ©pendances de
cette cible seront marquÃ©es comme (traduction pourrie) imposteurs (<em>phony</em>
donc).</p>
<p>Pour reprendre lâ€™exemple prÃ©cÃ©dent, on dÃ©clarera donc :</p>
<pre><code class="lang-make"><span class="hljs-class">.PHONY</span>: website

website: index<span class="hljs-class">.html</span> apropos<span class="hljs-class">.html</span> contact<span class="hljs-class">.html</span>
  [...]
</code></pre>
<p>DÃ©sormais, chaque appel Ã  <code>make website</code> tentera de construire les dÃ©pendances
et exÃ©cutera les commandes de la recette de la rÃ¨gle.</p>
<h1 id="un-exemple-complet">
      <a class="putainde-Title-anchor" href="#un-exemple-complet">#</a>
      Un exemple complet
    </h1><p>Lâ€™exemple suivant permet de compiler un site Web depuis un ensemble de fichiers
<em>Markdown</em>.</p>
<pre><code class="lang-make"><span class="hljs-constant">SOURCES</span> = <span class="hljs-variable">$(</span>wildcard src/*.md)
<span class="hljs-constant">DESTINATIONS</span> = <span class="hljs-variable">${</span><span class="hljs-constant">SOURCES</span><span class="hljs-symbol">:src/%</span>.md=build/%.html}

<span class="hljs-symbol">all:</span> <span class="hljs-variable">${</span><span class="hljs-constant">DESTINATIONS</span>}

<span class="hljs-symbol">info:</span>
    @ echo <span class="hljs-constant">Will</span> build <span class="hljs-variable">${</span><span class="hljs-constant">DESTINATIONS</span>} from <span class="hljs-variable">${</span><span class="hljs-constant">SOURCES</span>}

<span class="hljs-symbol">clean:</span>
    rm -f <span class="hljs-variable">${</span><span class="hljs-constant">DESTINATIONS</span>}

build/%.<span class="hljs-symbol">html:</span> src/%.md
    mkdir -p build
    marked <span class="hljs-variable">$&lt;</span> &gt; <span class="hljs-variable">$@</span>

.<span class="hljs-constant">PHONY</span><span class="hljs-symbol">:</span> all info clean
</code></pre>
<p>Vous noterez que comme on stocke nos rÃ©sultats dans le dossier <code>build</code>, il faut
potentiellement le crÃ©er quand on compile un fichier dedans.</p>
<h1 id="pour-aller-plus-loin">
      <a class="putainde-Title-anchor" href="#pour-aller-plus-loin">#</a>
      Pour aller plus loin
    </h1><p>Il existe bien dâ€™autres fonctionnalitÃ©s dans <em>Make</em> (du moins dans <em>GNU Make</em>),
avec notamment :</p>
<ul>
<li>Les <a href="https://www.gnu.org/software/make/manual/make.html#Canned-Recipes"><em>canned recipes</em></a> (recettes en boÃ®te), permettant de
dÃ©finir un bout de rÃ¨gle rÃ©utilisable Ã  plusieurs endroits.</li>
<li>Des <a href="https://www.gnu.org/software/make/manual/make.html#Functions">expressions conditionnelles</a> pour avoir des tests
dans votre <em>Makefile</em> et effectuer des traitements diffÃ©rents selon
lâ€™environnement.</li>
<li>Les <a href="https://www.gnu.org/software/make/manual/make.html##Prerequisite-Types">rÃ¨gles en <em>order only</em></a> qui permettent dâ€™indiquer une
dÃ©pendance dont la date de modification ne doit pas Ãªtre prise en compte (on
peut sâ€™en servir pour Ã©viter le <code>mkdir</code> dans lâ€™exemple complet).</li>
<li>Et <a href="https://www.gnu.org/software/make/manual/make.html#Functions">plein dâ€™autres fonctions</a> bien pratiques !</li>
</ul>
<p>Je vous invite aussi Ã  jeter un coup dâ€™Å“il au <a href="https://github.com/madx/veil/"><em>Makefile</em> de Veil</a>, un outil que
jâ€™utilise pour gÃ©nÃ©rer des sites statiques Ã  partir de fichiers <em>Markdown</em>
(ah bah tiens, comme dans mes exemples, câ€™est rigolo). Il y a plein de
fonctionnalitÃ©s de <em>Make</em> utilisÃ©es dans ce projet et je pense que Ã§a peut Ãªtre
source dâ€™idÃ©es.</p>
<p>VoilÃ  pour cette premier introduction Ã  <em>Make</em>, jâ€™espÃ¨re que Ã§a vous a plu et
que vous Ãªtes fin prÃªts Ã  affronter tous ces bouseux avec leur systÃ¨me de build
Ã  base de streams, de brocolis et autres rÃ¢teaux.</p>
]]></description>
            <link>http://putaindecode.fr/posts/shell/apprendre-les-makefiles/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/shell/apprendre-les-makefiles/</guid>
            <pubDate>Mon, 03 Nov 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[L'auto-entrepreneuriat : retour d'expÃ©riences]]></title>
            <description><![CDATA[<figure>
  <img src="index.jpg" alt="Desktop">
  <small><a href="http://freebiesxpress.com/gallery/macbook-air-table-direct-stock-photo/">Credit photo</a></small>
</figure>

<p>Lâ€™auto-entreprenariat, voilÃ  la belle idÃ©e. Un statut facile qui permet Ã  nâ€™importe qui de crÃ©er sa propre entreprise. Une belle opportunitÃ© pour se lancer facilement et sans trop de risque Ã  lâ€™indÃ©pendance.</p>
<p>ChÃ´meur ? Cela vous permet de crÃ©er votre propre travail et de toucher tout de mÃªme vos aides sociales (en soustrayant certes vos gains).</p>
<p>En CDI ? Cela permet de vous aventurer en dehors de votre travail principal sur des tÃ¢ches que vous nâ€™avez pas forcÃ©ment lâ€™occasion de faire comme gÃ©rer un client, effectuer des factures, Ã©changer avec lâ€™administration (ah quel plaisir, Ã§a).</p>
<p>Ã‰tudiant(e) ? Cela peut sÃ©rieusement vous aider Ã  financer (malheureusement ?) vos Ã©tudes ou Ã  Ãªtre plus indÃ©pendant(e) de vos parents.</p>
<p>Tant de raisons qui peuvent vous pousser Ã  vous ouvrir Ã  lâ€™auto-entreprise. Et pour Ã§a, <a href="http://kud.io/">_kud</a> et <a href="http://moox.io/">MoOx</a> ont vÃ©cu cette expÃ©rience et vous proposent de rÃ©pondre Ã  quelques questions pour vous faire une petite idÃ©e.</p>
<h2 id="pourquoi-avez-vous-cree-votre-entreprise">
      <a class="putainde-Title-anchor" href="#pourquoi-avez-vous-cree-votre-entreprise">#</a>
      Pourquoi avez-vous crÃ©Ã© votre entreprise ?
    </h2><h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>Ã‰tant dÃ©jÃ  en CDI et Ã©tant souvent sollicitÃ© pour crÃ©er des petits sites Ã  droite Ã  gauche, je voulais mâ€™initier Ã  plusieurs choses comme la crÃ©ation dâ€™entreprise, lâ€™indÃ©pendance, me confronter Ã  lâ€™administration et surtout gÃ©rer un client.</p>
<p>Et puis bon, cela me permettait aussi dâ€™avoir un petit bonus non dÃ©sagrÃ©able en fin de mois.</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p><em>Travailler plus pour gagner plus</em>, au dÃ©part Ã§a devait Ãªtre pour cette raison. Je nâ€™avais pas de quoi frimer Ã  la sortie de lâ€™Ã©cole, et je pouvais encore moins me payer de la blanche. Il me fallait donc une solution (rires). Plus sÃ©rieusement, dans le fond, tout comme Erwann, jâ€™avais sÃ»rement envie de tester un modÃ¨le plus indÃ©pendant que le CDI, en attendant que <a href="http://revenudebase.info/comprendre-le-revenu-de-base/">le revenu de base</a> vienne bien dÃ©molir le modÃ¨le actuel.</p>
<h2 id="comment-s-inscrire">
      <a class="putainde-Title-anchor" href="#comment-s-inscrire">#</a>
      Comment sâ€™inscrire ?
    </h2><p>Câ€™est relativement simple. Il faut aller sur le <a href="http://www.lautoentrepreneur.fr/">site de lâ€™auto-entrepreneur</a> et remplir le formulaire.</p>
<h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>En ce qui me concerne, jâ€™ai choisi â€œPrestations de services informatiquesâ€, ce qui me permettait dâ€™Ãªtre plutÃ´t libre sur mes actions :</p>
<ul>
<li>donner des cours dâ€™informatique ;</li>
<li>crÃ©er des sites web ;</li>
<li>faire de la rÃ©paration (mÃªme si ce nâ€™est pas vraiment un cas que je souhaitais envisager).</li>
</ul>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>Dans la pratique, lâ€™inscription peut en effet Ãªtre trÃ¨s rapide. Cela dit, je me rappelle mâ€™Ãªtre pris la tÃªte avec le choix des mutuelles (choix qui, si tu as dÃ©jÃ  un CDI, ne sert pas vraiment Ã  grand-chose Ã  ce que jâ€™ai fini par comprendre).
Pour ce qui est du code, jâ€™avais pris â€œProgrammation informatiqueâ€ (6201Z)  car je ne regardais pas vraiment plus loin que le bout de mon nez Ã  lâ€™Ã©poque (2010). AprÃ¨s, on nâ€™ira pas vous ennuyer avec Ã§a, je pense.</p>
<h2 id="qu-avez-vous-fait-avec">
      <a class="putainde-Title-anchor" href="#qu-avez-vous-fait-avec">#</a>
      Quâ€™avez vous fait avec ?
    </h2><h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>Câ€™est une bonne question.</p>
<p>Jâ€™ai passÃ© quelques soirÃ©es et week-end Ã  faire des sites en urgence, chose pas forcÃ©ment agrÃ©able car peu dâ€™apprentissage cÃ´tÃ© technologieâ€¦ Mais par contre gÃ©rer le client Ã©tait trÃ¨s passionnant.</p>
<p>Jâ€™ai aussi, Ã  ma surprise, rÃ©ussi Ã  donner des cours. Deux fois. Une fois une semaine avec des licences sur le thÃ¨me de la crÃ©ation de sites mobiles en <em>single page</em> avec du <a href="http://backbonejs.org/">backbone.js</a> entre autres. Une autre fois Ã  des gens en reconversion. Le but Ã©tait de leur apprendre Ã  crÃ©er leur propre site web (statique) ainsi quâ€™Ã  comprendre (briÃ¨vement) comment marchaient Internet et le Web. Jâ€™ai tout bonnement <strong>adorÃ©</strong>.</p>
<p>(Je sens que MoOx va encore dire â€œpareil quâ€™Erwannâ€â€¦)</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>Pareil quâ€™Erwann (<strong>_kud</strong>: <em>bingo</em>), au dÃ©but câ€™Ã©tait forfait soir et week-end de temps en temps. Jâ€™ai pris quelques petits projets sur mesure ou â€œdu WordPress pour mangerâ€ (2 fois seulement je le jure).
Ensuite Ã§a mâ€™a fatiguÃ© mine de rien, puis jâ€™avais dâ€™autres prioritÃ©s mÃªme si mon seul salaire en CDI pour nourrir 2 bouches Ã©tait juste. Jâ€™ai donc arrÃªtÃ© un moment, sans pour autant fermer lâ€™AE (Ã©tant donnÃ© quâ€™au dÃ©but, 0 CA = 0 charge).
Mais câ€™est lÃ  oÃ¹ mon expÃ©rience avec lâ€™AE est intÃ©ressante. Jâ€™ai laissÃ© dormir le truc.</p>
<p>Puis par la suite, <a href="http://viserlalune.com/blog/et-si-le-cdi-etait-une-connerie/">le CDI Ã©tant ce quâ€™il est</a> avec ses bons et surtout ses mauvais cÃ´tÃ©s, un jour aprÃ¨s que le projet sur lequel jâ€™ai Ã©tÃ© embauchÃ© soit jetÃ© Ã  la poubelle et que je doive me rabattre sur dâ€™autres tÃ¢ches qui ne mâ€™amusaient plus du tout, jâ€™ai dÃ©cidÃ© de dÃ©missionner.
Mais bon, câ€™Ã©tait une situation un peu tendue, car je nâ€™avais rien en plan B. Qui dit dÃ©mission, dit â€œdÃ©merde-toiâ€. Et Ã  Toulouse, des boulots intÃ©ressants dans le web, si tu veux faire autre chose que du PHP, câ€™est un peu tendu du <code>string</code>.</p>
<p>En cherchant, jâ€™ai dÃ©couvert un truc sympa : la <a href="http://travail-emploi.gouv.fr/informations-pratiques,89/les-fiches-pratiques-du-droit-du,91/rupture-conventionnelle-du-contrat,1208/la-rupture-conventionnelle-du,8383.html">rupture conventionnelle</a>.
Pour faire simple, câ€™est une dÃ©mission Ã  lâ€™amiable avec ton patron. Il faut son accord et tout le tralala administratif, mais Ã  partir du moment oÃ¹ tu es en bons termes avec ton patron (et sâ€™il nâ€™est pas assez stupide pour dire des choses du genre â€œsi tu veux te barrer, barre-toi, je ne lÃ¢cherai pas un souâ€), câ€™est une faÃ§on de partir et dâ€™avoir droit aux indemnitÃ©s chÃ´mage (pour peu que tu aies assez cotisÃ©, bien entendu).
Avec cette solution, je pouvais partir, en sachant que mes cotisations pour PÃ´le Emploi nâ€™Ã©taient pas inutiles.
Clairement, mon but nâ€™Ã©tait pas de vivre de Ã§a (avec mÃªme pas 60 % de mon salaire qui Ã©tait dÃ©jÃ  juste, je vous laisse imaginer la misÃ¨re) mais câ€™Ã©tait plus dâ€™avoir un parachute, pour Ã©viter dâ€™aller pleurer Ã  papa et maman pour pouvoir payer le loyer et le crÃ©dit de mon A3 (sans quoi jâ€™aurais Ã©tÃ© forcÃ© de ne manger que des pÃ¢tes achetÃ©es par sachet de 20 kg). Blague Ã  part, je partais en ayant une botte de paille en bas de ma chute, histoire de pas me casser toutes les cÃ´tes si je ne trouvais rien oÃ¹ mâ€™accrocher au passage.</p>
<p>Je me lance donc dans une recherche effrÃ©nÃ©e, principalement pour du tÃ©lÃ©travail (car Ã§a marchait pour moi depuis un moment, mÃªme si en France faut sâ€™accrocher pour trouver des entreprises ouvertes Ã  ce mode de travail). Et cette fois-ci (car je dÃ©missionnais souvent, par ennui :/), jâ€™ai eu du mal Ã  trouver chaussure Ã  mon pied. Beaucoup de mal. Et jâ€™Ã©tais mal.
Mais câ€™Ã©tait sans compter que lâ€™Internet, câ€™est un rÃ©seau mondial. Avec un peu de bonne volontÃ©, jâ€™avais trouvÃ© de quoi bÃ©nÃ©ficier dâ€™une visibilitÃ© mondiale (no shit). Une fois via <a href="http://gun.io">gun.io</a> et une fois via Twitter (pour trouver du boulot en fait câ€™est pas mal, via quelques tweets et retweets). Finalement, jâ€™ai rapidement pu bosser pour des entreprises situÃ©es aux USA (no shitÂ²).</p>
<p>Le fait de ne pas avoir fermÃ© lâ€™AE a simplifiÃ© beaucoup de choses : je pouvais faire des factures lÃ , de suite. Puis aux Ã‰tats-Unis, Ã§a ne rigole pas, Ã§a ne paye pas comme en France Ã  30 ou 45 jours, Ã§a payait tous les 15 jours, le jour oÃ¹ tu envoies la facture. BONHEUR.</p>
<p>Bon, par contre attention, quand tu bosses avec des gens qui considÃ¨rent bien ton travail, et qui te mettent sur un piÃ©destal (tu es en position de force cher dÃ©veloppeur, je te laisse Ã  lâ€™Ã©tymologie du nom de mÃ©tier) plutÃ´t que de te prendre pour la derniÃ¨re roue du carrosse, tu vas vite dÃ©passer le plafond imposÃ© par lâ€™AE (no shitÂ³).
<a href="https://gist.github.com/tibastral/8301072">Et il nâ€™y a pas que mon expÃ©rience qui vous le dira</a>.</p>
<p>Pour lâ€™anecdote, je nâ€™ai demandÃ© les indemnitÃ©s de chÃ´mage que deux mois seulement sur prÃ¨s dâ€™un an en situation freestyle (avant que je change pour un vrai statut).</p>
<p>Du coup, pour moi lâ€™AE aura Ã©tÃ© une bonne transition entre CDI, situation prÃ©caire et ma situation actuelle de freelance. Jâ€™ai bien entendu changÃ© rapidement de statut depuis (pour passer simplement Ã  lâ€™AE Level 2, lâ€™<a href="http://www.apce.com/pid1628/l-entreprise-individuelle.html?espace=1&amp;tp=1">entreprise individuelle</a>.</p>
<h2 id="que-deviez-vous-declarer">
      <a class="putainde-Title-anchor" href="#que-deviez-vous-declarer">#</a>
      Que deviez-vous dÃ©clarer ?
    </h2><p>Oui, parce que câ€™est bien beau tout Ã§a mais qui dit statut administratif dit dÃ©claration.</p>
<h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>Tous les trimestres, je me devais de <a href="http://www.net-entreprises.fr/">dÃ©clarer</a> ce que je facturais Ã  mes clients et je payais directement mes impÃ´ts via le versement libÃ©ratoire.</p>
<p>Bon, je vous avoue que jâ€™ai mis du temps Ã  comprendre oÃ¹ je devais dÃ©clarer car vous avez trois champs Ã  remplir, et quand vous ne comprenez rien au charabia administratif, câ€™est pas super facile.</p>
<p>Bref, une fois que vous avez dÃ©clarÃ© vos revenus, un impÃ´t se calcule automatiquement et vous Ãªtes dÃ©bitÃ©(e) Ã  la date indiquÃ©e.</p>
<p>PlutÃ´t simple dans lâ€™idÃ©e.</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>Jâ€™avais choisi aussi le versement libÃ©ratoire, mÃªme constat. Il ne faut pas hÃ©siter Ã  prendre le tÃ©lÃ©phone pour obtenir une rÃ©ponse pertinente au plus vite sans perdre de temps. Se rendre sur place dans le lieu adÃ©quat est encore une meilleure idÃ©e pour Ãªtre sÃ»r de ne pas se tromper.</p>
<h2 id="avez-vous-eu-des-surprises">
      <a class="putainde-Title-anchor" href="#avez-vous-eu-des-surprises">#</a>
      Avez-vous eu des surprises ?
    </h2><h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>Tout dâ€™abord, ce qui est quelque peu dÃ©stabilisant, câ€™est la quantitÃ© de courriers reÃ§us. PrÃ©voyances, mutuelles, maaaaaass papiers. En fait, câ€™est pas tant la quantitÃ© qui dÃ©stabilise, ce sont plutÃ´t les propos. â€œVous avez crÃ©Ã© une entreprise, câ€™est bien. Savez-vous que vous Ãªtes dans lâ€™obligation de souscrire Ã  une mutuelle/prÃ©voyance ?!â€.</p>
<p>Si vous nâ€™Ãªtes pas un tant soit peu renseignÃ©(e), vous tomberez dans le piÃ¨ge et vous souscrirez Ã  des choses dont vous nâ€™avez pas du tout besoin.</p>
<p>En effet, lorsque vous vous inscrivez Ã  lâ€™URSSAF, celle-ci met par la suite Ã  disposition son fichier dâ€™entreprises Ã  diffÃ©rents organismes et ces derniers nâ€™hÃ©sitent pas Ã  vous mettre le grappin dessus afin que vous souscriviez Ã  leurs formules pour quâ€™ils se fassent de la thune. Oui, car quand vous avez une entreprise, vous avez la plupart du temps des employÃ©s et dans ce cas, vous devez souscrire Ã  certaines obligations pour couvrir vos employÃ©s. Sauf que ce que ne prÃ©cise pas lâ€™URSSAF dans son fichier, câ€™est que vous Ãªtes une entreprise dâ€™auto-entrepreneur, et Ã§a, Ã§a change tout. Ouaip, vu que vous nâ€™avez pas dâ€™employÃ©(e), vous avez un statut diffÃ©rent des autres boÃ®tes et il nâ€™est pas du tout question de souscrire Ã  quoi que ce soit. Surtout des mutuelles ou prÃ©voyances qui couvrent des employÃ©s inexistants. Vous avez tout Ã  fait le droit de souscrire Ã  une mutuelle pour vous mais nullement pour votre entreprise.</p>
<p>Pour ma part, une fois que jâ€™eus compris ceci, jâ€™ai tout jetÃ© Ã  la poubelle. :) (bande de vautours va).</p>
<p>Passons Ã  un autre domaine en terme de surprise : lâ€™impÃ´t sur votre revenu dâ€™auto-entrepreneur.</p>
<p>Moi qui pensais Ãªtre tranquille en payant directement par versement libÃ©ratoire, foutaise !</p>
<p>Alors oui, vous payez vos impÃ´ts directement dÃ¨s que vous dÃ©clarez ce que vous avez facturÃ©. Ã‡a, okay.</p>
<p>Cependant, la chose que je nâ€™avais pas calculÃ©e et dont personne ne mâ€™avait prÃ©venu : il nâ€™est pas du tout pareil dâ€™Ãªtre auto-entrepreneur sans et avec un travail Ã  cÃ´tÃ©.</p>
<p>Certes, on vous demandera de dÃ©clarer vos revenus annexes sur les impÃ´ts sur le revenu seulement <strong>Ã  titre informatif</strong>. Oui, vous ne paierez pas dâ€™impÃ´ts dessus en plus. Mais par contre cela fera augmenter votre quotient familial.</p>
<p>Explication. Si vous Ã©tiez de base Ã  10 % sur le revenu en impÃ´ts sur votre CDI, le fait que vous soyez en auto-entrepreneur et que vous gagniez de lâ€™argent fait que votre quotient familial sera plus important et donc vous augmenterez le taux dâ€™imposition sur votre CDI qui sera par exemple Ã  13,5 %, au lieu de 10 % initiaux. Ce qui ne vous fera finalement pas un impÃ´t Ã  23,5 % sur votre activitÃ© dâ€™AE (que vous payez directement chaque trimestre) mais plutÃ´t 30 % du fait dâ€™avoir un travail Ã  cÃ´tÃ©.</p>
<p>Câ€™est tout Ã  fait normal me direz-vous vu quâ€™il doit bien y avoir une diffÃ©rence entre une personne qui nâ€™a que lâ€™AE et une personne ayant dÃ©jÃ  un job. Mais câ€™est juste que ce nâ€™Ã©tait pas du tout prÃ©vu dans mes calculs et en connaissance de cause, jâ€™aurais sÃ»rement augmentÃ© mes tarifs AE.</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>Ce qui mâ€™a le plus surpris aussi câ€™est lâ€™impression de me transformer en fichier vendu : je me suis aussi retrouvÃ© Ã  recevoir plein de courriers dâ€™entreprise en tout sens. Câ€™est dâ€™un pÃ©nibleâ€¦</p>
<p>Jâ€™avais choisi aussi le versement libÃ©ratoire, et mon faible revenu pour 2 parts Ã  lâ€™Ã©poque nâ€™avait pas eu dâ€™impact puisque je ne payais mÃªme pas dâ€™impÃ´ts.</p>
<h2 id="si-vous-l-avez-arrete-pourquoi">
      <a class="putainde-Title-anchor" href="#si-vous-l-avez-arrete-pourquoi">#</a>
      Si vous lâ€™avez arrÃªtÃ©, pourquoi ?
    </h2><h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>Je nâ€™avais plus assez de temps pour moi. Les dÃ©marches mâ€™ont un peu saoulÃ© (mÃªme sâ€™il y en avait vraiment pas beaucoup mais devoir constamment dÃ©clarer mÃªme si vous Ãªtes Ã  0 â‚¬ sous peine dâ€™avoir une amende, Ã§a fait chier).</p>
<p>Je nâ€™ai pas non plus apprÃ©ciÃ© voir mon taux dâ€™impÃ´ts sur le revenu augmenter, câ€™Ã©tait pas ce qui Ã©tait â€œvenduâ€ lorsque ce statut mâ€™a Ã©tÃ© prÃ©sentÃ©.</p>
<p>Et puis, je risquais de payer <a href="http://vosdroits.service-public.fr/professionnels-entreprises/F23547.xhtml">la taxe CFE</a> dâ€™ici lâ€™annÃ©e prochaine. Chose dâ€™ailleurs qui nâ€™est toujours pas claire dâ€™aprÃ¨s ce que je peux lire sur Internet : les AE ne savent toujours pas si la CFE va devoir Ãªtre payÃ©e ou non.</p>
<p>Jâ€™ai surtout constatÃ© que je souhaitais avant tout donner des cours et Ã  ce sujet, on mâ€™a proposÃ© une offre plus avantageuse que le statut dâ€™AE, doncâ€¦</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>Comme indiquÃ© plus tÃ´t, jâ€™ai Ã©tÃ© limitÃ© par le plafond, jâ€™ai donc passÃ© la vitesse supÃ©rieure via une EI !</p>
<h2 id="comment-arreter">
      <a class="putainde-Title-anchor" href="#comment-arreter">#</a>
      Comment arrÃªter
    </h2><p>Aller sur le site de lâ€™<a href="https://www.cfe.urssaf.fr/autoentrepreneur/CFE_Bienvenue">AE</a> puis cliquer sur â€œCesser dÃ©finitivement votre activitÃ©â€ tout en bas. Un formulaire vous sera proposÃ© oÃ¹ vous rentrerez vos informations puis il vous sera demandÃ© de lâ€™imprimer. Signez-le et envoyez-le Ã  lâ€™adresse uniquement (avec accusÃ© de rÃ©ception vivement conseillÃ©).</p>
<p>Vous recevrez dans les jours suivants un courrier de lâ€™URSSAF vous indiquant que vous avez bien Ã©tÃ© radiÃ©(e).</p>
<p>Oh et vous recevrez aussi du courrier de mutuelles ou prÃ©voyances, comme dâ€™habitude, Ã  jeter. Du dÃ©but Ã  la fin, ils vous feront chier.</p>
<h2 id="conclusion">
      <a class="putainde-Title-anchor" href="#conclusion">#</a>
      Conclusion
    </h2><p>Lâ€™AE reste un trÃ¨s bon moyen de sâ€™initier au freelance, Ã  la crÃ©ation dâ€™entreprise sans trop de risque. Les dÃ©marches sont plutÃ´t simples, vous nâ€™avez pas besoin de comptable, et lâ€™impÃ´t est de lâ€™ordre de 23 % Ã  35 % en fonction de votre situation professionnelle initiale, ce qui est tout reste tout de mÃªme bien moins important que freelance ou une â€œvraieâ€ entreprise.</p>
<p>Nâ€™hÃ©sitez pas Ã  vous en servir pour sortir de votre zone de confort !</p>
<p>Dans tous les cas, si vous souhaitez en savoir plus, nâ€™hÃ©sitez pas Ã  aller sur <a href="http://www.economie.gouv.fr/cedef/auto-entrepreneur">le site du gouvernement</a>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/entreprendre/auto-entrepreneuriat-retour-experiences/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/entreprendre/auto-entrepreneuriat-retour-experiences/</guid>
            <pubDate>Thu, 30 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[PremiÃ¨re application Ember]]></title>
            <description><![CDATA[<p>AprÃ¨s lâ€™<a href="/posts/js/debuter-avec-ember">article prÃ©cÃ©dent</a> qui a dÃ©taillÃ© les principaux concepts dâ€™<a href="http://emberjs.com">Ember</a>, il est grand temps de
se dÃ©gourdir les doigts. Comme on a peur de rien, on va mÃªme construire progressivement ensemble une application
avec <a href="http://emberjs.com">Ember</a>.</p>
<p>Bon, faut pas non plus trop vous emballer, câ€™est juste une application bateau de gestion dâ€™une collection de BD. 
Ã‡a pourrait Ãªtre des clients, des lÃ©gumes ou des timbres mais lÃ , câ€™est des BD.</p>
<h2 id="structure-d-une-application-ember">
      <a class="putainde-Title-anchor" href="#structure-d-une-application-ember">#</a>
      Structure dâ€™une application Ember
    </h2><p>Lâ€™<a href="/posts/js/debuter-avec-ember">article prÃ©cÃ©dent</a> a insistÃ© sur le fait quâ€™<a href="http://emberjs.com">Ember</a> Ã©tait un framework avec des partis pris forts et un modÃ¨le de dÃ©veloppement structurant. </p>
<p><em>Note : sur ce sujet, vu que <a href="/posts/js/debuter-avec-ember/#comment-1644383934">Ã§a fait rÃ©agir</a>, je prÃ©cise. Je ne dis pas que câ€™est bien ou que ce nâ€™est pas bien.
Je dis juste que câ€™est une caractÃ©ristique importante dâ€™<a href="http://emberjs.com">Ember</a>. Autant le savoir.</em></p>
<p>Eh bien, aussi Ã©tonnant que cela puisse paraÃ®tre, <a href="http://emberjs.com">Ember</a> <strong>nous laisse quand mÃªme nous dÃ©brouiller tout seul comme des grands pour organiser nos applications</strong>.</p>
<p>Il existe donc diffÃ©rentes maniÃ¨res de structurer une application <a href="http://emberjs.com">Ember</a>, de la plus basique Ã  la plus complÃ¨te et, sur ce point, chacun pourra trouver ce qui conviendra le mieux Ã  ses goÃ»ts, ses envies, ses contraintes, son contexteâ€¦ Que sais-je ? Ci-dessous, quelques exemples parmi dâ€™autres.</p>
<h3 id="a-la-mano">
      <a class="putainde-Title-anchor" href="#a-la-mano">#</a>
      Ã€ la mano
    </h3><p>De base, avec <a href="http://emberjs.com">Ember</a> on peut donc dÃ©clarer nos routes, contrÃ´leurs, modÃ¨les, etc. dans un seul fichier JavaScript ou dans une balise <code>&lt;script&gt;</code>. On doit par contre impÃ©rativement respecter les <a href="http://emberjs.com/guides/concepts/naming-conventions/">conventions de nommage</a> et enregistrer nos objets dans une variable globale : </p>
<pre><code class="lang-js">App = Ember.Application.create();

App.Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  ...
});

App.BookRoute = Ember.Route.extend({
  ...
});
</code></pre>
<p>De la mÃªme maniÃ¨re, on peut dÃ©clarer nos gabarits <a href="http://handlebarsjs.com/">Handlebars</a> via des balises <code>&lt;script&gt;</code> :</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/x-handlebars"</span>&gt;</span><span class="handlebars"><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
    </span><span class="hljs-expression">{{<span class="hljs-variable"><span class="hljs-keyword">outlet</span></span>}}</span><span class="xml">
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</span></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
<h3 id="outille">
      <a class="putainde-Title-anchor" href="#outille">#</a>
      OutillÃ©
    </h3><p>Comme on peut trouver Ã§a un peu limitÃ© dans la vraie vie, on peut essayer dâ€™organiser nous-mÃªme notre application, nos fichiers, gÃ©rer des modules, etc. Tout Ã§a va passer par lâ€™utilisation dâ€™un outil de build javascript de type <a href="http://gruntjs.com/">Grunt</a>, <a href="http://gulpjs.com/">Gulp</a>, <a href="https://github.com/broccolijs/broccoli">Broccoli</a>. Ces outils vont nous permettre
de concatÃ©ner nos diffÃ©rents fichiers JavaScript en un seul, de sortir les gabarits dans des fichiers <code>.hbs</code> et de les prÃ©compiler. On nâ€™aura ensuite quâ€™Ã  importer ces fichiers dans notre index.html :</p>
<pre><code class="lang-html">...
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"dist/libs/handlebars.min.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"dist/libs/ember.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"dist/application.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"dist/templates.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
...
</code></pre>
<p>Ã‡a peut convenir parfaitement et on peut se mitonner des phases de build aux petits oignons pour nos besoins spÃ©cifiques. Mais on peut aussi rester un peu sur sa faim. Surtout si on a choisi <a href="http://emberjs.com">Ember</a> pour son cÃ´tÃ© structurant.</p>
<p>Du coup, une partie des membres de lâ€™Ã©quipe <a href="http://emberjs.com">Ember</a> a mis au point <a href="http://www.ember-cli.com/">Ember CLI</a>.</p>
<h3 id="ember-cli">
      <a class="putainde-Title-anchor" href="#ember-cli">#</a>
      Ember CLI
    </h3><p><a href="http://www.ember-cli.com/">Ember CLI</a> est une <strong>interface en ligne de commande</strong> pour <a href="http://emberjs.com">Ember</a>. Elle repose
sur lâ€™outil de build <a href="https://github.com/broccolijs/broccoli">Broccoli</a> et permet : </p>
<ul>
<li>dâ€™initialiser une application Ember avec, cette fois, une <a href="http://www.ember-cli.com/#folder-layout">structure de fichiers</a> et des
<a href="http://www.ember-cli.com/#naming-conventions">conventions de nommage</a></li>
<li>de gÃ©nÃ©rer diffÃ©rents objets en mode scaffolding via des <a href="http://www.ember-cli.com/#using-ember-cli">commandes</a>. Autant le dire tout de suite, je ne suis pas fan du scaffolding mais on va regarder quand mÃªme pour ne pas mourir idiots.</li>
<li>dâ€™utiliser des outils de build basÃ©s sur <a href="https://github.com/broccolijs/broccoli">Broccoli</a> pour le prÃ©traitement des prÃ©-processeurs CSS par exemple</li>
<li>dâ€™utiliser les <a href="https://people.mozilla.org/~jorendorff/es6-draft.html">modules ES6</a> plutÃ´t 
quâ€™<a href="http://en.wikipedia.org/wiki/Asynchronous_module_definition">AMD</a> ou 
<a href="http://en.wikipedia.org/wiki/CommonJS">CommonJS</a> pour la modularisation. Cette question a Ã©tÃ©
largement dÃ©battue. Si Ã§a vous intÃ©resse, je vous laisse dÃ©couvrir un 
<a href="http://tomdale.net/2012/01/amd-is-not-the-answer/">article trÃ¨s intÃ©ressant</a> Ã  ce sujet.</li>
<li>â€¦</li>
</ul>
<p>Je ne vais pas vous dÃ©tailler davantage le truc, vous trouverez vous-mÃªme la <a href="http://www.ember-cli.com/">doc officielle</a>. Et puis, on va tout de suite le mettre en pratique.</p>
<p><em>Note : lÃ  encore, <a href="http://www.ember-cli.com/">Ember CLI</a>, câ€™est un parti pris. Ce sera probablement trÃ¨s bien accueilli par certains pour qui cela offre un cadre de travail structurÃ© et structurant. Mais ce sera aussi rejetÃ© par dâ€™autres qui le verront comme une grosse machine inutile.
Ici encore, question de goÃ»t, question de contexte, question de besoins.</em></p>
<p>TrÃ¨ves de bavardages, on sâ€™y met sÃ©rieusement :</p>
<p>On installe <a href="http://nodejs.org/">Node</a>, <a href="http://www.ember-cli.com/">Ember CLI</a>, <a href="http://bower.io/">Bower</a> :</p>
<pre><code class="lang-console">$ npm install -<span class="hljs-keyword">g</span> ember-<span class="hljs-keyword">cli</span>
$ npm install -<span class="hljs-keyword">g</span> bower
</code></pre>
<p>Ã‡a y est, on peut maintenant demander gentiment Ã  <a href="http://www.ember-cli.com/">Ember CLI</a> de nous crÃ©er notre application grÃ¢ce Ã  la 
commande <code>ember</code> et voir ensuite une magnifique page de bienvenue sur <a href="http://localhost:4200/">http://localhost:4200/</a> :</p>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>ember new ember-articles
<span class="hljs-variable">$ </span>cd ember-articles
<span class="hljs-variable">$ </span>ember server
</code></pre>
<p>Je ne vous fais pas lâ€™affront de dÃ©tailler ici la structure de lâ€™application, tout est dÃ©crit dans la 
<a href="http://www.ember-cli.com/#folder-layout">documentation</a>.</p>
<h3 id="styles-amp-fonts">
      <a class="putainde-Title-anchor" href="#styles-amp-fonts">#</a>
      Styles &amp; Fonts
    </h3><p>Pour que cela ne soit pas trop moche dans le cadre de cet exemple ou va ajouter un peu de CSS et des fonts mais comme câ€™est pas lâ€™objet de lâ€™article,
on ne va pas passer de temps lÃ -dessus. Ceci dit, comme il y a  quand mÃªme un peu de conf <a href="http://www.ember-cli.com/">Ember CLI</a> qui peut vous intÃ©resser, vous avez les styles 
et la conf sur <a href="https://github.com/bmeurant/ember-articles/tree/premiere-app-ember">GitHub</a> et lâ€™explication dans ce <a href="https://gist.github.com/bmeurant/1bba49d8a12bf69a4cf0">gist</a>.</p>
<h2 id="et-maintenant-on-code">
      <a class="putainde-Title-anchor" href="#et-maintenant-on-code">#</a>
      Et maintenant, on code !
    </h2><p><em>Note: le code de lâ€™exemple est dispo sur <a href="https://github.com/bmeurant/ember-articles/tree/premiere-app-ember">github</a>.</em></p>
<ul>
<li>Modification du gabarit gÃ©nÃ©ral de lâ€™application <code>/app/templates/application.hbs</code> : </li>
</ul>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"app"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"sources"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"https://github.com/bmeurant/ember-articles"</span>&gt;</span>View source on GitHub<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Comic books library<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"main"</span>&gt;</span>
      {{outlet}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p><em>Note : on en profite pour remarquer le rechargement Ã  chaud via <code>ember server</code> lorsquâ€™on modifie un fichier.</em></p>
<ul>
<li>CrÃ©ation de la premiÃ¨re route <code>/series</code> via <code>ember</code> :</li>
</ul>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>ember generate route series
</code></pre>
<p><a href="http://www.ember-cli.com/">Ember CLI</a> met Ã  jour le routeur : </p>
<pre><code class="lang-js"><span class="hljs-comment">// routeur app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'series'</span>);
});
</code></pre>
<p>Il gÃ©nÃ¨re aussi pour nous une route <code>app/routes/series.js</code> et un gabarit <code>app/templates/series.hbs</code>, vides.</p>
<p>Modifions tout de suite le gabarit <code>app/templates/series.hbs</code>, histoire de mieux visualiser les choses : </p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Comics Series<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>
</code></pre>
<p>Lâ€™URL <code>/series</code> est dÃ©sormais accessible sur <a href="http://localhost:4200/series">http://localhost:4200/series</a> et on peut constater lâ€™imbrication du gabarit <code>series.hbs</code> dans le gabarit
gÃ©nÃ©ral <code>application.hbs</code> grÃ¢ce Ã  son <code>{{outlet}}</code>.</p>
<h3 id="outlet-et-routes-imbriquees">
      <a class="putainde-Title-anchor" href="#outlet-et-routes-imbriquees">#</a>
      <code>{{outlet}}</code> et routes imbriquÃ©es
    </h3><p>Ces notions sont au cÅ“ur dâ€™<a href="http://emberjs.com">Ember</a>. Leur fonctionnement est assez simple. Lorsquâ€™une route est imbriquÃ©e dans une autre,
<a href="http://emberjs.com">Ember</a> va rechercher les gabarits de ces deux routes et remplacer la zone <code>{{outlet}}</code> de la <em>route mÃ¨re</em>
avec le rendu de la <em>route fille</em>. Ainsi de suite jusquâ€™Ã  rÃ©solution complÃ¨te de la route. Lors des transitions entre routes, les
zones des <code>{{outlet}}</code> concernÃ©es par le changement sont mises Ã  jour.</p>
<p>Toutes les routes de lâ€™application sont imbriquÃ©es dans la route <code>ApplicationRoute</code> gÃ©nÃ©rÃ©e par <a href="http://emberjs.com">Ember</a> et dont le gabarit est <code>application.hbs</code>. 
Câ€™est ce qui explique que, dans le cas prÃ©sent, le gabarit <code>series.hbs</code> ait Ã©tÃ© <em>injectÃ©</em> dans <code>application.hbs</code> pour construire lâ€™application 
entiÃ¨re.</p>
<h3 id="routes-et-controleurs-implicites">
      <a class="putainde-Title-anchor" href="#routes-et-controleurs-implicites">#</a>
      Routes et contrÃ´leurs implicites
    </h3><p>Pour rappel, <a href="http://emberjs.com">Ember</a> dÃ©finit et utilise diffÃ©rents types dâ€™objets ayant chacun une responsabilitÃ© propre (voir <a href="/posts/js/debuter-avec-ember">article prÃ©cÃ©dent</a>) et, pour ne pas
nous obliger Ã  fournir nous-mÃªme une implÃ©mentation par dÃ©faut de ces objets, les gÃ©nÃ¨re pour nous (voir <a href="/posts/js/debuter-avec-ember/#generation-d-objets">article prÃ©cÃ©dent - <em>GÃ©nÃ©ration dâ€™objets</em></a>).</p>
<p>Si nous nâ€™avons eu ici quâ€™Ã  fournir le gabarit <code>application.hbs</code>, câ€™est quâ€™<a href="http://emberjs.com">Ember</a> a gÃ©nÃ©rÃ© pour nous la route implicite <code>ApplicationRoute</code> activÃ©e au dÃ©marrage
de lâ€™application et le contrÃ´leur <code>ApplicationController</code>.</p>
<p>Mais <a href="http://emberjs.com">Ember</a> a Ã©galement gÃ©nÃ©rÃ© pour nous la route <code>IndexRoute</code> et le contrÃ´leur <code>IndexController</code> en rÃ©ponse Ã  lâ€™URL <code>/</code>. Pour Ãªtre tout Ã 
fait complet, <a href="http://emberjs.com">Ember</a> a aussi gÃ©nÃ©rÃ© les Ã©lÃ©ments suivants <code>LoadingRoute</code>, <code>LoadingController</code>, <code>ErrorRoute</code> et <code>ErrorController</code> dont les
caractÃ©ristiques peuvent Ãªtre trouvÃ©es dans la <a href="http://emberjs.com/guides/routing/loading-and-error-substates/">documentation</a>.</p>
<p>Ces Ã©lÃ©ments implicites sont gÃ©nÃ©rÃ©s pour chaque route qui nâ€™est pas une route de dernier niveau et peuvent Ãªtre surchargÃ©s.</p>
<ul>
<li>Lâ€™URL <code>/</code> ne nous intÃ©resse pas. Surchargeons la route <code>IndexRoute</code> pour rediriger vers <code>/series</code> :</li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">// /app/routes/index.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
    redirect: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series'</span>);
    }
});
</code></pre>
<p>-&gt; Par-lÃ  la <a href="http://emberjs.com/guides/routing/redirection/">doc sur les redirections</a>.</p>
<p>Maintenant, on veut afficher la liste des sÃ©ries en allant sur <code>/series</code>. Encore faut-il avoir des sÃ©riesâ€¦ Pour Ã§a, on va utiliser
la librairie <a href="https://github.com/emberjs/data">Ember Data</a> pour la gestion de nos modÃ¨les. Ce nâ€™est pas obligatoire
et beaucoup font sans, mais nous on va lâ€™utiliser quand mÃªme. </p>
<h3 id="ember-data">
      <a class="putainde-Title-anchor" href="#ember-data">#</a>
      Ember Data
    </h3><p>Cette librairie qui est dÃ©veloppÃ©e en parallÃ¨le dâ€™<a href="http://emberjs.com">Ember</a> permet de gÃ©rer les modÃ¨les de donnÃ©es et les relations entre eux 
Ã  la maniÃ¨re dâ€™un <a href="http://fr.wikipedia.org/wiki/Mapping_objet-relationnel">ORM</a> (Ã  la <a href="http://en.wikipedia.org/wiki/Active_record_pattern">ActiveRecord</a>). 
Elle permet notamment de rÃ©cupÃ©rer les donnÃ©es depuis une interface REST HTTP 
(et est parfaitement adaptÃ©e Ã  <a href="http://jsonapi.org/">JSON API</a>) mais pas que.</p>
<p><a href="https://github.com/emberjs/data">Ember Data</a> sâ€™appuie sur un <code>store</code> (cf. <a href="http://emberjs.com/api/data/classes/DS.Store.html">doc</a>) manipulÃ© par lâ€™application
et qui contient des mÃ©thodes telles que <code>find</code>, <code>createRecord</code>, <code>update</code>, etc. qui permettent dâ€™effectuer des actions sur les diffÃ©rents modÃ¨les
du store. Au travers dâ€™<code>Adapters</code>, le <code>store</code> transmet Ã  la couche de persistence (REST ou autre).</p>
<p>Le <code>RESTAdapter</code> (cf. <a href="http://emberjs.com/api/data/classes/DS.Store.html">doc</a>) et son jumeau malÃ©fique le <code>RESTSerializer</code> 
(cf. <a href="http://emberjs.com/api/data/classes/DS.RESTSerializer.html">doc</a>) peuvent Ãªtre Ã©tendus facilement de maniÃ¨re Ã  sâ€™adapter Ã  une 
interface REST spÃ©cifique.</p>
<p>Pour un <a href="http://en.wikipedia.org/wiki/Proof_of_concept">POC</a>, on peut utiliser le <code>FixtureAdapter</code> 
(cf. <a href="http://emberjs.com/api/data/classes/DS.FixtureAdapter.html">doc</a>) qui permet
de charger simplement les objets depuis la mÃ©moire. Câ€™est ce que lâ€™on utilise ici.</p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/adapters/application.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">'ember-data'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> DS.FixtureAdapter.extend({});
</code></pre>
<ul>
<li>On va donc crÃ©er un modÃ¨le correspondant. Seulement, voilÃ , comme jâ€™ai eu la bonne idÃ©e de prendre un des rares mots en anglais
oÃ¹ le pluriel et le singulier sont identiques (<em>serie</em> nâ€™existe pas), on va devoir crÃ©er un modÃ¨le <em>seriesItem</em> :</li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">// /app/models/series-item.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">'ember-data'</span>;

<span class="hljs-keyword">var</span> SeriesItem = DS.Model.extend({
    title               : DS.attr(<span class="hljs-string">'string'</span>, {defaultValue: <span class="hljs-string">'New Series'</span>}),
    scriptwriter        : DS.attr(<span class="hljs-string">'string'</span>),
    illustrator         : DS.attr(<span class="hljs-string">'string'</span>),
    publisher           : DS.attr(<span class="hljs-string">'string'</span>),
    coverName           : DS.attr(<span class="hljs-string">'string'</span>, {defaultValue: <span class="hljs-string">'default.jpg'</span>}),
    summary             : DS.attr(<span class="hljs-string">'string'</span>),
    coverUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'/assets/images/series/covers/'</span> + <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'coverName'</span>);
    }.property(<span class="hljs-string">'coverName'</span>)
});

SeriesItem.reopenClass({
    FIXTURES: [{
    id: <span class="hljs-number">1</span>,
    title: <span class="hljs-string">'BlackSad'</span>,
    scriptwriter: <span class="hljs-string">'Juan Diaz Canales'</span>,
    illustrator: <span class="hljs-string">'Juanjo Guarnido'</span>,
    publisher: <span class="hljs-string">'Dargaud'</span>,
    coverName: <span class="hljs-string">'blacksad.jpg'</span>,
    summary: <span class="hljs-string">'Private investigator John Blacksad is up to his feline ears in mystery, digging into the backstories behind murders, child abductions, and nuclear secrets. Guarnido\'s sumptuously painted pages and rich cinematic style bring the world of 1950s America to vibrant life, with Canales weaving in fascinating tales of conspiracy, racial tension, and the "red scare" Communist witch hunts of the time. Guarnido reinvents anthropomorphism in these pages, and industry colleagues no less than Will Eisner, Jim Steranko, and Tim Sale are fans! Whether John Blacksad is falling for dangerous women or getting beaten to within an inch of his life, his stories are, simply put, unforgettable'</span>
}, {
    id: <span class="hljs-number">2</span>,
    title: <span class="hljs-string">'The Killer'</span>,
    scriptwriter: <span class="hljs-string">'Luc Jacamon'</span>,
    illustrator: <span class="hljs-string">'Matz'</span>,
    publisher: <span class="hljs-string">'Casterman'</span>,
    coverName: <span class="hljs-string">'the-killer.jpg'</span>,
    summary: <span class="hljs-string">'A man solitary and cold, methodical and unencumbered by scruples or regrets, the killer waits in the shadows, watching for his next target. And yet the longer he waits, the more he thinks he\'s losing his mind, if not his cool. A brutal, bloody and stylish noir story of a professional assassin lost in a world without a moral compass, this is a case study of a man alone, armed to the teeth and slowly losing his mind.'</span>
}, ...
]});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> SeriesItem;
</code></pre>
<p>Au passage, on remarque les valeurs par dÃ©faut ainsi que la <a href="http://emberjs.com/guides/object-model/computed-properties/">propriÃ©tÃ© calculÃ©e</a> <code>coverUrl</code>. On aura lâ€™occasion dâ€™en reparler.</p>
<ul>
<li>On modifie donc notre application pour afficher, lors de lâ€™activation de <code>SeriesRoute</code>, la liste des sÃ©ries :</li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">// /app/routes/series.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
    model: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.store.find(<span class="hljs-string">'seriesItem'</span>);
    }
});
</code></pre>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Comic Series<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-list"</span>&gt;</span>
      {{#each}}
          <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-item"</span>&gt;</span>
              {{title}}
          <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
      {{/each}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>Number of series: {{length}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

{{outlet}}
</code></pre>
<p>On remarque le <code>{{#each}}</code> sans arguments qui par convention retrouve lâ€™objet <code>model</code> du contrÃ´leur. <code>{{#each model}}</code>, <code>{{#each controller}}</code> ou <code>{{#each controller.model}}</code> sont
des notations Ã©quivalentes.</p>
<ul>
<li>Maintenant, on va essayer de dynamiser un peu tout Ã§a en ajoutant un bouton pour trier la liste :</li>
</ul>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
...
<span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Comic Series<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">button</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">sort</span>"}} {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">":sort sortAscending:asc:desc"</span><span class="hljs-value">}}</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-list"</span>&gt;</span>
...
</code></pre>
<p>Pour Ã§a, il est nÃ©cessaire de dÃ©finir notre propre <code>SeriesController</code> :</p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/controllers/series.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.ArrayController.extend({
  sortAscending: <span class="hljs-literal">true</span>,

  actions: {
    sort: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.toggleProperty(<span class="hljs-string">'sortAscending'</span>);
    }
  }
});
</code></pre>
<p>Ce simple ajout demande de sâ€™arrÃªter sur quelques points importants, histoire de bien comprendre ce qui se passe.</p>
<h3 id="types-de-controleurs">
      <a class="putainde-Title-anchor" href="#types-de-controleurs">#</a>
      Types de contrÃ´leurs
    </h3><p>Nous avons dÃ» remplacer le <code>SeriesController</code> implicite par notre propre contrÃ´leur, histoire de proposer cette fonction de tri. <a href="http://emberjs.com">Ember</a>
dispose de deux types de contrÃ´leurs : <a href="http://emberjs.com/api/classes/Ember.ObjectController.html">ObjectController</a> et <a href="http://emberjs.com/api/classes/Ember.ArrayController.html">ArrayController</a>.
Comme leur nom lâ€™indique, ces contrÃ´leurs permettent respectivement de gÃ©rer des modÃ¨les de type objet ou de type collection.</p>
<p>Dans notre cas, nous souhaitons manipuler la liste des sÃ©ries et utilisons donc un <code>ArrayController</code>. Il utilise notamment le <a href="http://emberjs.com/api/classes/Ember.SortableMixin.html">SortableMixin</a>
qui fournit des fonctions de tri natives. Il nous suffit donc dâ€™initialiser et de mettre Ã  jour la propriÃ©tÃ© <code>sortAscending</code> apportÃ©e par ce mixin pour bÃ©nÃ©ficier du tri sur notre
collection de sÃ©ries, sans avoir besoin dâ€™autre chose.</p>
<h3 id="actions">
      <a class="putainde-Title-anchor" href="#actions">#</a>
      Actions
    </h3><p>La mise Ã  jour de cette propriÃ©tÃ© est effectuÃ©e grÃ¢ce Ã  <code>{{action &quot;sort&quot;}}</code> qui nous permet de lier lâ€™action sur le bouton (le clic) Ã  une
fonction <code>sort</code> du contrÃ´leur dÃ©finie dans <code>actions: { ... }</code>.</p>
<p>-&gt; Plus dâ€™infos sur les actions <a href="http://emberjs.com/guides/templates/actions/">ici</a>.</p>
<h3 id="bindings-de-classes-dynamiques">
      <a class="putainde-Title-anchor" href="#bindings-de-classes-dynamiques">#</a>
      <em>Bindings</em> de classes dynamiques
    </h3><p>On remarque aussi la maniÃ¨re dont les classes de lâ€™Ã©lÃ©ment <code>button</code> sont liÃ©es aux propriÃ©tÃ©s du contrÃ´leur de maniÃ¨re Ã  Ãªtre mises Ã 
jour dynamiquement grÃ¢ce Ã  <code>{{bind-attr class=&quot;...&quot;}}</code>. Cette syntaxe permet de basculer la classe du bouton de <code>asc</code> Ã  <code>desc</code> automatiquement
lorsque la valeur de <code>sortAscending</code> change. On note la notation <code>:sort</code> qui permet dâ€™ajouter une classe de base, statique.</p>
<p>-&gt; Plus dâ€™infos sur les classes <a href="http://emberjs.com/guides/templates/binding-element-class-names/">ici</a>.</p>
<ul>
<li>Mais on ne va pas sâ€™arrÃªter lÃ . On va ajouter un petit filtre sur le titre des sÃ©ries :</li>
</ul>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Comic Series<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>

    {{input value=filter class="filter"}}
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">sort</span>"}} {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">":sort sortAscending:asc:desc"</span><span class="hljs-value">}}</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-list"</span>&gt;</span>
      {{#each filteredModel}}
          <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-item"</span>&gt;</span>
              {{title}}
          <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
      {{/each}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>Number of series: {{filteredModel.length}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

{{outlet}}
</code></pre>
<pre><code class="lang-js"><span class="hljs-comment">// /app/controllers/series.js</span>
...
filter: <span class="hljs-string">""</span>,
sortAscending: <span class="hljs-literal">true</span>,

filteredModel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">var</span> filter = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'filter'</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'content'</span>).filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(item)</span></span>{
    <span class="hljs-keyword">if</span> (item.get(<span class="hljs-string">'title'</span>) === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> item.get(<span class="hljs-string">'title'</span>).toLowerCase().match(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(filter.toLowerCase()));
  }).sort(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(a, b)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'sortAscending'</span>) ? (b.get(<span class="hljs-string">'title'</span>) &lt; a.get(<span class="hljs-string">'title'</span>)) : (b.get(<span class="hljs-string">'title'</span>) &gt; a.get(<span class="hljs-string">'title'</span>));
  }.bind(<span class="hljs-keyword">this</span>));
}.property(<span class="hljs-string">'filter'</span>, <span class="hljs-string">'sortAscending'</span>, <span class="hljs-string">'model.@each.title'</span>),

actions: {
...
</code></pre>
<h3 id="proprietes-calculees">
      <a class="putainde-Title-anchor" href="#proprietes-calculees">#</a>
      PropriÃ©tÃ©s calculÃ©es
    </h3><p>Je vous passe le contenu de la fonction <code>filteredModel</code> qui nâ€™apporte rien au sujet. Examinons par contre la notation <code>.property(&#39;filter&#39;, &#39;sortAscending&#39;, &#39;model.@each.title&#39;)</code>. 
Cela constitue la dÃ©finition dâ€™une <a href="http://emberjs.com/guides/object-model/computed-properties/">propriÃ©tÃ© calculÃ©e</a> : propriÃ©tÃ©
accessible et manipulable comme nâ€™importe quelle propriÃ©tÃ© au sein des gabarits mais qui est le rÃ©sultat dâ€™une fonction dont le retour dÃ©pend de lâ€™Ã©tat dâ€™autres propriÃ©tÃ©s. </p>
<p>La syntaxe <code>.property(&#39;filter&#39;, &#39;sortAscending&#39;, &#39;model.@each.title&#39;)</code> dÃ©finit les autres propriÃ©tÃ©s <em>observÃ©es</em> par cette propriÃ©tÃ© calculÃ©e et dont le changement provoquera
lâ€™exÃ©cution de la fonction ainsi que le rafraÃ®chissement du gabarit. Ici, on peut constater que lâ€™affichage est mis Ã  jour et la liste filtrÃ©e Ã  chaque changement du champ 
de formulaire <code>filter</code> et donc de la propriÃ©tÃ© <code>filter</code> associÃ©e ou du sens du tri via la propriÃ©tÃ© <code>sortAscending</code>. </p>
<p>La syntaxe particuliÃ¨re <code>model.@each.title</code> permet de mettre Ã  jour lâ€™affichage en cas de changement externe du titre de lâ€™une (<code>@each</code>) des sÃ©ries. Vous pouvez facilement vous rendre compte de
Ã§a en utilisant <strong>Ember Inspector</strong> (<a href="https://chrome.google.com/webstore/detail/ember-inspector/bmdblncegkenkacieihfhpjfppoconhi?hl=en">Chrome</a> et 
<a href="https://addons.mozilla.org/en-US/firefox/addon/ember-inspector/">Firefox</a>). Allez dans <code>Data &gt; MODEL TYPES / series-item</code>, sÃ©lectionnez-en une et modifiez son titre. Vous constaterez que 
la liste est mise Ã  jour automatiquement.</p>
<p>Les <em>bindings</em> et les <a href="http://emberjs.com/guides/object-model/computed-properties/">propriÃ©tÃ©s calculÃ©es</a> constituent deux maniÃ¨res dâ€™observer les changements et de <em>rafraÃ®chir</em>
lâ€™application en consÃ©quence. Les <a href="http://emberjs.com/guides/object-model/observers">observeurs</a> en sont une troisiÃ¨me. Si vous avez un doute sur ce quâ€™il faut utiliser, allez
voir <a href="http://emberjs.com/guides/object-model/what-do-i-use-when">ici</a>.</p>
<h3 id="bindings-et-mise-a-jour-des-gabarits">
      <a class="putainde-Title-anchor" href="#bindings-et-mise-a-jour-des-gabarits">#</a>
      <em>Bindings</em> et mise Ã  jour des gabarits
    </h3><p>Alors, comment Ã§a marche ? Comment, concrÃ¨tement, <a href="http://emberjs.com">Ember</a> se dÃ©brouille pour mettre Ã  jour le gabarit lors de la mise Ã  jour dâ€™un modÃ¨le, dâ€™une propriÃ©tÃ© ? En rÃ©alitÃ©, lorsquâ€™on
affiche dans un gabarit une propriÃ©tÃ© dynamique liÃ©e Ã  un modÃ¨le ou Ã  une propriÃ©tÃ©, <a href="http://emberjs.com">Ember</a> va lâ€™encadrer par des Ã©lÃ©ments HTML spÃ©ciaux, des marqueurs de type <code>&lt;script&gt;</code> dâ€™id unique
appelÃ© <code>metamorph</code>. Attention, je prÃ©fÃ¨re vous prÃ©venir, Ã§a va piquer !</p>
<p>Ainsi,</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Blog de {{name}}<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
</code></pre>
<p>va se transformer en : </p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>
Blog de 
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"metamorph-0-start"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/x-placeholder"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
Baptiste Meurant
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"metamorph-0-end"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/x-placeholder"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
</code></pre>
<p>Alors oui, il faut avouer que lÃ  on est tentÃ© de partir en courant. Câ€™est le point qui mâ€™a vraiment gÃªnÃ© quand jâ€™ai dÃ©couvert <a href="http://emberjs.com">Ember</a> et Ã§a me gÃªne encore. Câ€™Ã©tait mÃªme
Ã  la limite du rÃ©dhibitoire. Ã‡a pollue vraiment le DOM et introduit mÃªme quelques effets de bord en CSS lorsquâ€™on utilise les <code>:first-child</code> ou <code>:last-child</code>. Ceci Ã©tant,
câ€™est ce qui permet Ã  <a href="http://emberjs.com">Ember</a> de mettre Ã  jour non pas un gabarit mais uniquement ces zones dynamiques de maniÃ¨re performante - jâ€™ai fini par voir Ã§a comme un mal nÃ©cessaire.
Mais surtout, jâ€™ai compris que ces <code>metamorph</code> Ã©taient vouÃ©s Ã  disparaÃ®tre assez rapidement avec lâ€™utilisation du moteur <a href="https://github.com/tildeio/htmlbars">HTMLBars</a>. Vous pouvez
jeter un Å“il Ã  ce sujet Ã  la <a href="http://talks.erikbryn.com/htmlbars/">prÃ©sentation dâ€™Eric Bryn</a> (notamment slide 10). Ouf ! Le support dâ€™<a href="https://github.com/tildeio/htmlbars">HTMLBars</a> est prÃ©vu pour 
<a href="http://emberjs.com">Ember</a> 1.9 ou 1.10 (la release actuelle est 1.7) â€¦ On est impatients !</p>
<p><em>Bonus: lâ€™Ã©lÃ©ment est un Ã©lÃ©ment <code>script</code> et pas un autre car câ€™est Ã  priori le seul Ã©lÃ©ment qui peut Ãªtre insÃ©rÃ© partout sans rien casser.</em></p>
<p><em><strong>Edit</strong>: Aujourdâ€™hui (28/10/2014) est sortie la <a href="http://emberjs.com/blog/2014/10/26/ember-1-8-0-released.html">version 1.8.0 dâ€™Ember</a>. Cette release ne contient pas encore
le support complet dâ€™<a href="https://github.com/tildeio/htmlbars">HTMLBars</a> mais signe dÃ©jÃ  la fin des <code>metamorph</code> au profit de lâ€™utilisation dâ€™Ã©lements <code>Text</code> vides, non intrusifs ! Ã‡a mÃ©ritait dâ€™Ãªtre signalÃ©.</em> </p>
<h3 id="runloop">
      <a class="putainde-Title-anchor" href="#runloop">#</a>
      <em>RunLoop</em>
    </h3><p>Un autre mÃ©canisme important est impliquÃ© tant dans le rendu des gabarits que dans le calcul et la synchronisation des propriÃ©tÃ©s entre elles : la <em>RunLoop</em>. Ce mÃ©canisme est
absolument central dans le fonctionnement dâ€™<a href="http://emberjs.com">Ember</a> et sâ€™appuie sur la lib <a href="https://github.com/ebryn/backburner.js/">Backburner</a>. Dans la plupart des cas, vous nâ€™avez pas
Ã  vous en prÃ©occuper et vous pouvez parfaitement mettre en place une application <a href="http://emberjs.com">Ember</a> complÃ¨te sans interagir directement avec la <em>RunLoop</em>, sauf lorsque
vous ajoutez vos propres <code>helpers</code> <a href="http://handlebarsjs.com/">Handlebars</a> ou vos propres composants avancÃ©s. Câ€™est par contre important dâ€™en comprendre le fonctionnement.</p>
<p>Comme son nom ne lâ€™indique pas, la <em>RunLoop</em> nâ€™est pas une loop mais un ensemble de queues permettant Ã  <a href="http://emberjs.com">Ember</a> de diffÃ©rer un certain nombre dâ€™opÃ©rations
qui seront ensuite exÃ©cutÃ©es en dÃ©pilant ces queues dans un ordre de prioritÃ© donnÃ©. Les queues sont <code>sync</code>, <code>actions</code>, <code>routerTransitions</code>, <code>render</code>, <code>afterRender</code>, et <code>destroy</code>.
Je vous laisse dÃ©couvrir par vous-mÃªme dans la <a href="http://emberjs.com/guides/understanding-ember/run-loop/">doc officielle</a> et dans cette 
<a href="http://talks.erikbryn.com/backburner.js-and-the-ember-run-loop">prÃ©sentation dâ€™Eric Bryn</a> le contenu de ces queues et la maniÃ¨re dont est faite lâ€™exÃ©cution.</p>
<p>Je voudrais juste insister sur un aspect particulier : câ€™est ce mÃ©canisme qui permet, en quelque sorte, dâ€™empiler les calculs de propriÃ©tÃ©s calculÃ©es lorsque les propriÃ©tÃ©s
<em>observÃ©es</em> sont modifiÃ©es et surtout câ€™est grÃ¢ce Ã  ce mÃ©canisme que le rendu nâ€™est effectuÃ© quâ€™une seule fois lors de la modification dâ€™un modÃ¨le.</p>
<p>Pour reprendre lâ€™exemple de la <a href="http://emberjs.com/guides/understanding-ember/run-loop/">doc officielle</a>, si vous avez lâ€™objet suivant :</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> User = Ember.Object.extend({
  firstName: <span class="hljs-literal">null</span>,
  lastName: <span class="hljs-literal">null</span>,
  fullName: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'firstName'</span>) + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'lastName'</span>);
  }.property(<span class="hljs-string">'firstName'</span>, <span class="hljs-string">'lastName'</span>)
});
</code></pre>
<p>Et le gabarit :</p>
<pre><code class="lang-html">{{firstName}}
{{fullName}}
</code></pre>
<p>Tout Ã§a, sans la <em>RunLoop</em>, ferait quâ€™on exÃ©cuterait le rendu deux fois si lâ€™on modifie successivement <code>firstname</code> puis <code>lastname</code>. La <em>RunLoop</em> met tout Ã§a (et plein dâ€™autres
choses) en queue et nâ€™effectue le rendu quâ€™une seule et unique fois, lorsque nÃ©cessaire.</p>
<ul>
<li>AprÃ¨s Ã§a, on va finir en douceur en ajoutant simplement ou nouvelle route pour afficher la sÃ©rie quâ€™on a sÃ©lectionnÃ© :</li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">// /app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'series'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'seriesItem'</span>, { path: <span class="hljs-string">'/:seriesItem_id'</span> });
  });
});
</code></pre>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
...
  <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-list"</span>&gt;</span>
    {{#each filteredModel}}
        <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-item"</span>&gt;</span>
          {{#link-to 'series.seriesItem' this title=title}}
            {{title}}
          {{/link-to}}
        <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
    {{/each}}
  <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
...

<span class="hljs-comment">&lt;!-- /app/templates/series/series-item.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">h3</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-title">h3</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"coverUrl"</span><span class="hljs-value">}}</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">"Series's first album cover"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cover"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">dl</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"description"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>scriptwriter<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{scriptwriter}} <span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>illustrator<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{illustrator}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>publisher<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{publisher}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">dl</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">p</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"summary"</span>&gt;</span>
    {{summary}}
  <span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>Et voilÃ  ! Quelques remarques en passant : </p>
<ul>
<li>on peut maintenant sÃ©lectionner une sÃ©rie dans la liste grÃ¢ce au <code>{{link-to}}</code>. On remarque au passage quâ€™<a href="http://emberjs.com">Ember</a> sÃ©lectionne automatiquement
(ajoute une classe <code>active</code>) la sÃ©rie de la liste dont la route est activÃ©e. On note Ã©galement lâ€™utilisation de <code>this</code> pour rÃ©fÃ©rencer lâ€™objet courant
(ici lâ€™instance courante de <code>SeriesItem</code>). -&gt; <a href="http://emberjs.com/guides/templates/links/">doc officielle</a>.</li>
<li>on a transformÃ© la route <code>series</code> en <em>Resource</em> qui permet de grouper les routes sous un mÃªme espace de nommage. Notez que si la route <code>seriesItem</code>
avait Ã©tÃ© une ressource, on aurait dÃ» fournir le template <code>/app/templates/series-item.hbs</code> au lieu de <code>/app/templates/series/series-item.hbs</code> car
une ressource rÃ©initialise lâ€™espace de nommage et permet ainsi de simplifier les URL. -&gt; <a href="http://emberjs.com/guides/routing/defining-your-routes/#toc_resources">doc officielle</a></li>
<li>on a ajoutÃ© un <em>segment dynamique</em> <code>{path: &#39;/:seriesItem_id&#39;}</code> Ã  la route <code>seriesItem</code> pour lâ€™ID de la sÃ©rie. -&gt; <a href="http://emberjs.com/guides/routing/defining-your-routes/#toc_dynamic-segments">doc officielle</a>.</li>
</ul>
<h2 id="conclusions">
      <a class="putainde-Title-anchor" href="#conclusions">#</a>
      Conclusions
    </h2><p>Cet article est un peu plus long que ce que jâ€™avais prÃ©vu et je nâ€™ai pas abordÃ© tous les sujets que je voulais traiter. Mais, plutÃ´t que de dÃ©rouler simplement du code pour montrer que Ã§a marche, jâ€™ai
prÃ©fÃ©rÃ© mâ€™arrÃªter sur les points importants pour en expliquer le fonctionnement. Ã‡a me paraissait important. Jâ€™espÃ¨re que ce nâ€™Ã©tait pas trop pÃ©nible Ã  lire. Les points que je nâ€™ai pas eu le temps
de traiter (API REST avec un backend, tests, helpers, partials, composants, relations avec ember-data, etc.) feront peut-Ãªtre lâ€™objet dâ€™un autre post mais un peu plus tard parce que je suis fatiguÃ© lÃ  et 
je sens que vous aussi.</p>
<p>Concernant <a href="http://emberjs.com">Ember</a>, jâ€™apprÃ©cie vraiment le modÃ¨le de dÃ©veloppement, la structure et jâ€™aime vraiment dÃ©velopper avec cet outil. La discussion framework / lib dÃ©jÃ  Ã©voquÃ©e fera sans doute toujours rage.
En ce qui me concerne, quand jâ€™ai besoin dâ€™un framework, ma prÃ©fÃ©rence va Ã  <a href="http://emberjs.com">Ember</a>.</p>
<p>Concernant <a href="http://www.ember-cli.com/">Ember CLI</a>, je suis plus partagÃ©. Jâ€™apprÃ©cie lâ€™aspect normalisation de la structure de lâ€™appli ainsi que lâ€™outillage assez fourni quâ€™il embarque, le transpileur ES6. Je ne suis, par contre, pas fan
du scaffolding en gÃ©nÃ©ral mais, au dÃ©marrage, Ã§a peut donner une idÃ©e de la maniÃ¨re de faire. Jâ€™espÃ¨re cependant vous avoir donnÃ© suffisamment de clefs pour que vous vous fassiez une idÃ©e.</p>
<p>Pour finir, je souhaite remercier lâ€™Ã©quipe de <em>Putain de code !</em> qui ne partage pas mes opinions sur les frameworks en gÃ©nÃ©ral mais qui mâ€™accueille quand mÃªme. Cet article a vraiment dÃ»
vous piquer les yeux. DÃ©solÃ© :-)</p>
<p><em>Note: les sources de lâ€™application exemple sont <a href="https://github.com/bmeurant/ember-articles/tree/premiere-app-ember">disponibles sur github</a>.</em></p>
]]></description>
            <link>http://putaindecode.fr/posts/js/premiere-app-ember/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/premiere-app-ember/</guid>
            <pubDate>Mon, 27 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Flux, qu'est-ce que c'est ?]]></title>
            <description><![CDATA[<p>Allez, tant pis, on saute lâ€™intro et on entre directement dans le vif du sujet (on nâ€™a pas que Ã§a Ã  foutre, aprÃ¨s tout).</p>
<h2 id="la-petite-histoire">
      <a class="putainde-Title-anchor" href="#la-petite-histoire">#</a>
      La petite histoire
    </h2><p>Il Ã©tait une fois un gros site web <em>que sâ€™apelorio</em> Facebook. Qui dit Facebook, dit webapp plus grosse que la plus grosse de tes copines (<em>no offense</em> <sup><a href="#foonote-1">1</a></sup>) ; et du coup, propension Ã  se retrouver submergÃ© de bugs plus Ã©levÃ©e.</p>
<p>Les ingÃ©nieurs front-end de Facebook, confrontÃ©s Ã  une codebase de plus en plus bordÃ©lique (personne ne voulant toucher certaines parties de celle-ci) ont dÃ» repenser la structure des composants les plus cruciaux.</p>
<p>Face Ã  ce besoin, ces dÃ©veloppeurs sont donc parvenus Ã  deux solutions :</p>
<ul>
<li><a href="http://putaindecode.fr/posts/js/introduction-a-reactjs/">ReactJS</a></li>
<li>Flux</li>
</ul>
<p>Flux nâ€™est pas un framework, mais simplement une architecture, une sorte de <em>guideline</em> qui rÃ©sout pas mal de problÃ¨mes ayant pu apparaÃ®tre avec les divers bibliothÃ¨ques et frameworks MV* apparus lors des derniÃ¨res annÃ©es.</p>
<h2 id="flux-l-explication-claire">
      <a class="putainde-Title-anchor" href="#flux-l-explication-claire">#</a>
      Flux, lâ€™explication claire
    </h2><p>Flux comporte 4 concepts :</p>
<ul>
<li>les <strong>actions</strong>, quâ€™elles proviennent du serveur ou dâ€™une interaction utilisateur ;</li>
<li>le <strong>dispatcher</strong> dans lequel sont envoyÃ©es les actions que ce dernier transmet <em>Ã  qui veut</em>, un peu comme un <code>EventEmitter</code> global ;</li>
<li>les <strong>stores</strong>, qui sont lâ€™Ã©quivalent du <code>model</code> de lâ€™architecture MVC, ils contiennent les donnÃ©es, et rÃ©agissent aux actions que le dispatcher leur transmet ;</li>
<li>les <strong>views</strong>, qui sâ€™occupent du rendu des donnÃ©es dans le DOM, et de lancer des actions lorsque lâ€™utilisateur effectue certaines actions.</li>
</ul>
<p>Jusque-lÃ , rien de bien fou. Câ€™est dans leur maniÃ¨re dâ€™interagir que la particularitÃ© se dessine :</p>
<figure>
  <img src="http://cl.ly/YENt/flux.png" alt="">
  <figcaption>Oh bah dis donc, Ã§a va toujours dans le mÃªme sens</figcaption>
</figure>

<p>En effet, le <em>flux</em> en question est unidirectionnel. Pour faire simple, on procÃ¨de ainsi :</p>
<p>On dÃ©finit une action via un <strong>action creator</strong> (on passera toujours par ces action-creators pour signaler une action) :</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// actions/BasketActions.js</span>
<span class="hljs-keyword">var</span> AppDispatcher = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../AppDispacher"</span>)
<span class="hljs-comment">/*
  On garde un dictionnaire des types d'actions
  afin d'avoir un fichier donnant une vision
  globale de toutes les interactions de l'app.
 */</span>
<span class="hljs-keyword">var</span> ActionTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../constants"</span>).ActionTypes

<span class="hljs-built_in">module</span>.exports = {
  addToBasket : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(productId)</span></span>{
    AppDispatcher.handleViewAction({
      type : ActionTypes.ADD_TO_BASKET,
      productId : productId
    })
  }
}
</code></pre>
<p>On lancera par la suite cette action lorsque lâ€™utilisateur aura cliquÃ© sur un certain bouton, dans la vue concernÃ©e.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// components/Product.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react/addons"</span>)
<span class="hljs-keyword">var</span> BasketActions = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../actions/BasketActions"</span>)

<span class="hljs-keyword">var</span> Button = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./common/Button.jsx"</span>)

<span class="hljs-keyword">var</span> Product = React.createClass({
  addToBasket : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(productId)</span></span>{
    BasketActions.addToBasket(productId)
  },
  render : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"Product"</span>&gt;</span>
        {/* rest of the component*/}
        <span class="hljs-tag">&lt;<span class="hljs-title">Button</span>
          <span class="hljs-attribute">onClick</span>=<span class="hljs-value">{this.addToBasket.bind(this.props.productId)}</span>
          <span class="hljs-attribute">label</span>=<span class="hljs-value">"Add to basket"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    )</span>
  }
})

<span class="hljs-built_in">module</span>.exports = Product
</code></pre>
<p>DÃ¨s lors, Ã  chaque clic sur le bouton en question, lâ€™action <code>ADD_TO_BASKET</code> sera passÃ©e au dispatcher, qui le signalera aux stores.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// stores/BasketStore.js</span>
<span class="hljs-keyword">var</span> AppDispatcher = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../AppDispatcher"</span>)
<span class="hljs-keyword">var</span> ActionTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../constants"</span>).ActionTypes
<span class="hljs-keyword">var</span> API = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../api"</span>)

<span class="hljs-keyword">var</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../utils/merge"</span>)
<span class="hljs-keyword">var</span> Store = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../utils/store"</span>)

<span class="hljs-keyword">var</span> _store = {
  products : []
}

<span class="hljs-keyword">var</span> BasketStore = merge(Store, {
  <span class="hljs-comment">/*
    Ici, on `register` un callback sur l'AppDispatcher,
    ce qui signifie qu'on verra passer toutes les actions
    de l'app.
   */</span>
  dispatchToken : AppDispatcher.register(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(payload)</span></span>{
    <span class="hljs-keyword">var</span> action = payload.action
    <span class="hljs-keyword">switch</span>(action.type) {
      <span class="hljs-keyword">case</span> ActionTypes.ADD_TO_BASKET:
          <span class="hljs-comment">/*
             L'API va ajouter le produit et lancer une
             action `BASKET_UPDATED` dÃ¨s que le serveur a rÃ©pondu.
          */</span>
        API.addToBasket(action.productId)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> ActionTypes.BASKET_UPDATED:
          <span class="hljs-comment">/*
            L'API a rÃ©pondu, on peut stocker la rÃ©ponse
            et signaler le changement
            aux vues rÃ©cupÃ©rant ces donnÃ©es.
          */</span>
          _store = action.reponse
          BasketStore.emitChange()
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">break</span>
    }
  })
})

<span class="hljs-built_in">module</span>.exports = BasketStore
</code></pre>
<p>La vue, quant Ã  elle, sera notifiÃ©e du changement, et effectuera un <code>render()</code> :</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// components/Basket.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react/addons"</span>)
<span class="hljs-keyword">var</span> BasketActions = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../actions/BasketActions"</span>)
<span class="hljs-keyword">var</span> BasketStore = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../stores/BasketStore"</span>)

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getState</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">return</span> BasketStore.getStore()
}

<span class="hljs-keyword">var</span> Product = React.createClass({
  getInitialState : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">return</span> getState()
  },
  _onStoreChange : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">/*
      Ã€ chaque changement du store, on update naÃ¯vement
      le component et on laisse le virtual DOM faire son job.
    */</span>
    <span class="hljs-keyword">this</span>.setState(getState())
  },
  componentDidMount : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">/*
      On Ã©coute le store uniquement lorsque le
      component est montÃ©.
     */</span>
    BasketStore.addChangeListener(<span class="hljs-keyword">this</span>._onStoreChange)
  },
  componentWillUnmount : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">/*
      Et on arrÃªte d'Ã©couter quand il ne l'est plus.
     */</span>
    BasketStore.removeChangeListener(<span class="hljs-keyword">this</span>._onStoreChange)
  },
  render : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"Basket"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"Basket-count"</span>&gt;</span>
          {this.state.products.length + " products"}
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        {/* rest of the component */}
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    )</span>
  }
})

<span class="hljs-built_in">module</span>.exports = Product
</code></pre>
<p>Tout cela peut sembler relativement verbeux, mais il faut prÃ©ciser deux choses :</p>
<ul>
<li>les exemples ici le sont volontairement pour la dÃ©monstration, et il est aisÃ©ment faisable dâ€™utiliser un <code>StoreMixin</code> simplifier la dÃ©claration des <code>class</code> React ;</li>
<li>pour ce qui est du reste, notamment stocker les noms dâ€™actions dans un objet partagÃ© dans lâ€™app, câ€™est pour rendre plus idiomatique et cohÃ©rente la faÃ§on dont on code lâ€™app, et pour simplifier ses <em>refactoring</em>.</li>
</ul>
<h2 id="ce-qu-il-faut-savoir-sur-l-alliance-flux-react">
      <a class="putainde-Title-anchor" href="#ce-qu-il-faut-savoir-sur-l-alliance-flux-react">#</a>
      Ce quâ€™il faut savoir sur lâ€™alliance Flux + React
    </h2><p>Si React et Flux vont si bien ensemble, câ€™est que lâ€™approche de rendu â€œnaÃ¯fâ€ de React (comprendre â€œReact sâ€™en fout de ce qui change, il appelle <code>render</code> Ã  chaque changementâ€) permet de rÃ©duire la logique Ã  Ã©crire dans les Stores, et donc de simplifier trÃ¨s fortement la codebase de lâ€™app.</p>
<p>Lorsque quâ€™un ou plusieurs stores composent lâ€™Ã©tat dâ€™un state React, alors Ã  chaque changement de lâ€™un de ces stores, tous les composants React concernÃ©s et leurs enfants vont appeler leur mÃ©thode <code>render()</code>. Afin dâ€™Ã©viter des appels superflus Ã  ces mÃ©thodes, React donne la possibilitÃ© de tester soi-mÃªme sâ€™il est nÃ©cessaire de mettre Ã  jour le component en dÃ©clarant une mÃ©thode <code>shouldComponentUpdate</code> retournant un <code>boolean</code> qui stipulera si oui ou non il est nÃ©cessaire dâ€™appeler <code>render()</code>.</p>
<h2 id="tl-dr">
      <a class="putainde-Title-anchor" href="#tl-dr">#</a>
      tl;dr
    </h2><ul>
<li>Flux, câ€™est comme du MVC en plus simple, et avec moins de bugs</li>
<li>Lâ€™architecture est unidirectionnelle</li>
<li>On raisonne en actions, qui sont dÃ©clenchÃ©es par la vue ou le serveur</li>
<li>Toutes les actions passent par le dispatcher</li>
<li>Seuls les stores signalent aux vues quâ€™il faut se mettre Ã  jour</li>
</ul>
<p>Bisous bisous.</p>
<p><img src="http://media.giphy.com/media/lxd2cZ2BkM4IE/giphy.gif" alt="angulol"></p>
<p>Pour aller un peu plus loin :</p>
<ul>
<li><a href="https://gist.github.com/bloodyowl/b41532cf3627c560b57e">Les sources des exemples</a> contenant le dispatcher et les constants ;</li>
<li><a href="http://facebook.github.io/flux/docs/overview.html#content">La doc de Flux</a> ;</li>
<li><a href="https://github.com/facebook/flux">Le repository Flux</a> et ses diffÃ©rents exemples.</li>
</ul>
<p><small>
  <a id="foonote-1"></a>1: <a href="https://www.youtube.com/watch?v=jRzv9gep5Ng&amp;t=4m">RÃ©fÃ©rence utile (<code>ntm install reference</code>)</a>
</small></p>
]]></description>
            <link>http://putaindecode.fr/posts/js/flux-qu-est-ce-c-est/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/flux-qu-est-ce-c-est/</guid>
            <pubDate>Mon, 27 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Ã€ la conquÃªte des bugs]]></title>
            <description><![CDATA[<p>Le Web, depuis sa crÃ©ation est un vaste champ de bataille. Que ce soit les problÃ¨mes de compatibilitÃ©s, les formats ou les langages propriÃ©taires, la volontÃ© de faire du Web un monde ouvert ne date pas dâ€™hier.</p>
<h2 id="au-depart">
      <a class="putainde-Title-anchor" href="#au-depart">#</a>
      Au dÃ©part
    </h2><p>Les dÃ©buts du Web furent compliquÃ©s. On assista Ã  une guerre entre Netscape et Microsoft. Chacun voulant dominer le marchÃ©, en tentant dâ€™imposer ses propres technologies. En 1996, Netscape propose au W3C JSSS (JavaScript-Based Style Sheets). Ce nâ€™est dâ€™ailleurs que depuis novembre 2000 que Netscape, basÃ© sur le moteur Gecko (moteur de Mozilla Firefox), prend vÃ©ritablement en charge le CSS. Microsoft pour sa part ne supportait par JavaScript Ã  ses dÃ©buts et avait dÃ©veloppÃ© son propre langage JScript.</p>
<p>Ces problÃ¨mes de compatibilitÃ©s, de technologies et de respect des normes vont considÃ©rablement ralentir lâ€™Ã©volution du Web.</p>
<h2 id="les-petits-nouveaux">
      <a class="putainde-Title-anchor" href="#les-petits-nouveaux">#</a>
      Les petits nouveaux
    </h2><p>Lâ€™arrivÃ©e des nouveaux navigateurs tels que Firefox, Chrome ou mÃªme Opera va inverser cette tendance. Les parts de marchÃ©s dâ€™Internet Explorer baissant, les dÃ©veloppeurs prenant conscience du potentiel du Web, vont dÃ©clencher une montÃ©e en puissance du Web.</p>
<p>On pourrait croire que cette concurrence ne va apporter que des points positifs, mais pas tant que Ã§a. Les parts de marchÃ©s vont pousser les navigateurs (ou les dÃ©veloppeurs) Ã  supporter des propriÃ©tÃ©s non standardisÃ©es, Ã  mettre en place des prÃ©fixes et Ã  dÃ©velopper une monoculture.</p>
<h2 id="le-debut-des-problemes">
      <a class="putainde-Title-anchor" href="#le-debut-des-problemes">#</a>
      Le dÃ©but des problÃ¨mes
    </h2><p>Les prÃ©fixes bien que partis dâ€™une bonne idÃ©e, avaient pour objectif dâ€™introduire les nouvelles propriÃ©tÃ©s CSS  toujours Ã  lâ€™Ã©tat de proposition/discussion/standardisation. Cela a permis de pouvoir utiliser des propriÃ©tÃ©s telles que  <code>border-radius</code>, <code>transform</code>, <code>box-shadow</code> bien avant leurs finalisations. Le risque bien entendu, Ã©tant dâ€™utiliser des propriÃ©tÃ©s qui pouvaient changer de spÃ©cification, comme ce fut le cas par exemple pour <code>flexbox</code>.</p>
<p>Lâ€™effet pervers a Ã©tÃ© aussi de ne pas utiliser tous les prÃ©fixes dâ€™une propriÃ©tÃ©. Cela a eu pour consÃ©quence de crÃ©er un Web (notamment sur le mobile) Ã  deux facettes. Nous avions dâ€™un cotÃ© les sites <code>-webkit</code> compatibles iPhone/iPad et le reste du monde.</p>
<p>Opera a dâ€™ailleurs <a href="http://thenextweb.com/insider/2013/02/13/opera-300-million-users-webkit/">abandonnÃ©</a> son moteur Presto en fÃ©vrier 2013 au profit du moteur WebKit.</p>
<p>Plusieurs discussions houleuses ont dâ€™ailleurs eu lieu sur lâ€™implÃ©mentation des propriÃ©tÃ©s <code>-webkit</code> dans les moteurs Gecko ou Presto. IdÃ©e abandonnÃ©e en cours de route.</p>
<p>Coup de thÃ©atre <a href="http://blogs.msdn.com/b/ie/archive/2014/07/31/the-mobile-web-should-just-work-for-everyone.aspx">rÃ©cemment</a>, Microsoft a intÃ©grÃ© dans son moteur certaines propriÃ©tÃ©s <code>-webkit</code> pour obtenir des sites Web mobiles (trop basÃ©s sur <code>-webkit</code>) compatibles avec Windows Phone 8.1.</p>
<h2 id="un-debut-de-solution">
      <a class="putainde-Title-anchor" href="#un-debut-de-solution">#</a>
      Un dÃ©but de solution ?
    </h2><p>Câ€™est dans ce contexte quâ€™est nÃ©e lâ€™initiative <a href="http://webcompat.com">webcompat.com</a>. LancÃ©e initialement par des dÃ©veloppeurs de chez <a href="https://hacks.mozilla.org/2014/06/introducing-webcompat-com/">Mozilla</a> et quelques autres <a href="https://github.com/webcompat/webcompat.com/graphs/contributors">contributeurs</a> en juin 2014.</p>
<p>Le site a un double objectif : rendre le Web le plus compatible possible et Ã©liminer les bugs.</p>
<p>Le site accepte toutes sortes de bugs, que ce soit un problÃ¨me de compatibilitÃ© entre navigateurs (<code>prefixe</code>, <code>sniffing UA</code>, etc), ou tout simplement un bug dâ€™affichage, que vous soyez propriÃ©taires ou simple utilisateurs du site.</p>
<p>Une fois le bug soumis, quiconque a la possibilitÃ© de proposer un diagnostic, de corriger le bug, voir de transmettre la solution aux Ã©quipes techniques du site en question (par Twitter, e-mail, GitHub, etc).</p>
<p>Le projet est libre et appartient Ã  sa communautÃ©.</p>
<p>Tout contributeur peut intervenir sur le site webcompat.com pour le <a href="https://github.com/webcompat/webcompat.com/issues?q=is%3Aopen+is%3Aissue+label%3Ahelp-wanted">dÃ©veloppement</a>, ou mÃªme le <a href="https://github.com/webcompat/webcompat.com/issues?q=is%3Aopen+is%3Aissue+label%3Adesign">design</a>.  Mais bien sÃ»r et surtout sur la correction de <a href="https://github.com/webcompat/web-bugs/issues?q=is%3Aopen+is%3Aissue">bugs</a>.</p>
<p>Microsoft vient dâ€™ailleurs de <a href="http://blogs.msdn.com/b/ie/archive/2014/07/31/the-mobile-web-should-just-work-for-everyone.aspx">rejoindre</a> Mozilla sur lâ€™initiative webcompat.com. En lanÃ§ant leur derniÃ¨re version de Window Phone 8.1 ils ont constatÃ© les <a href="https://github.com/webcompat/web-bugs/issues?q=is%3Aissue+is%3Aopen+is%3Aclosed+label%3Aie">dÃ©gÃ¢ts</a> de la monoculture des sites mobile.</p>
<p>Si comme eux, vous souhaitez rendre le Web plus compatible, nâ€™hÃ©sitez pas Ã  proposer votre aide. En effet, il est de notre responsabilitÃ© dâ€™Ã©viter tout monopole ou monoculture. Car mÃªme si les navigateurs ont leur part de responsabilitÃ©, nous, dÃ©veloppeurs en avons une aussi.</p>
]]></description>
            <link>http://putaindecode.fr/posts/bug-webcompat/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/bug-webcompat/</guid>
            <pubDate>Tue, 21 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[DÃ©buter avec Ember]]></title>
            <description><![CDATA[<p>DÃ©marrer une <a href="http://en.wikipedia.org/wiki/Single-page_application">Single Page Application</a> aujourdâ€™hui Ã§a commence souvent par : â€œmais quel putain de framework il 
faut que je prenne ?â€ Et, vu que câ€™est pas Ã§a qui manque, Ã§a se complique !</p>
<p>Parmi les multiples <a href="/posts/js/introduction-a-reactjs">technos disponibles</a> il y a <a href="http://emberjs.com">Ember</a>. Pour que le choix 
ne se rÃ©sume pas Ã  prendre celui qui a le plus joli logo ou qui gÃ©nÃ¨re le plus de spam sur votre Twitter, on vous propose de dÃ©couvrir 
<a href="http://emberjs.com">Ember</a>. Dans les posts Ã  venir on verra comment construire concrÃ¨tement une application avec ce framework.</p>
<h2 id="les-fondamentaux">
      <a class="putainde-Title-anchor" href="#les-fondamentaux">#</a>
      Les fondamentaux
    </h2><p>Parce que lâ€™approche â€œtÃªte la premiÃ¨reâ€ câ€™est bien mais que comprendre un minimum ce quâ€™on fait câ€™est encore mieux, il me paraÃ®t sage de commencer
par expliquer la philosophie et les principaux Ã©lÃ©ments du framework, sous peine de se prendre un bon vieux <a href="http://en.wikipedia.org/wiki/RTFM">RTFM</a> 
sur le coin du pif, comme Ã§a, en passant.</p>
<p><a href="http://emberjs.com">Ember</a> se dÃ©finit comme : â€œA framework for creating <strong>ambitious</strong> web applicationsâ€ et Ã§a, Ã§a claque !
Mais je vois bien que Ã§a ne suffit pas Ã  vous convaincre alors je vais dÃ©tailler un peu. Bon alors, bien que ce soit le mot â€œambitiousâ€
qui soit mis en gras, deux autres trucs me paraissent encore plus importants :</p>
<ul>
<li><p><strong>web</strong> : lâ€™une des caractÃ©ristiques majeures dâ€™<a href="http://emberjs.com">Ember</a> est son attachement au web et aux URL en particulier. <strong>Les URL
et donc le routeur sont au cÅ“ur dâ€™Ember</strong> lÃ  ou bien dâ€™autres frameworks les considÃ¨rent au mieux comme un addon important. </p>
</li>
<li><p><strong>framework</strong> : <a href="http://emberjs.com">Ember</a> est rÃ©ellement un framework. Pas une lib, pas une colonne vertÃ©brale, pas une boÃ®te Ã  outils : 
un framework ! <a href="http://emberjs.com">Ember</a> propose un vÃ©ritable modÃ¨le de dÃ©veloppement que vous allez tout de suite adopter â€¦ ou rejeter
(au moins Ã§a aura le mÃ©rite dâ€™Ãªtre clair).</p>
</li>
</ul>
<h3 id="conventions-de-nommage">
      <a class="putainde-Title-anchor" href="#conventions-de-nommage">#</a>
      Conventions de nommage
    </h3><p>Ce modÃ¨le de dÃ©veloppement commence par les conventions de nommage. <a href="http://emberjs.com">Ember</a>
applique en effet le principe de â€œ<em>conventions over configuration</em>â€œ et repose sur un nommage cohÃ©rent des diffÃ©rents composants 
de votre application. Et finalement, quand on y rÃ©flechit bien, la cohÃ©rence, Ã§a nâ€™a pas que des mauvais cÃ´tÃ©s. </p>
<p>Typiquement pour une URL <code>test</code>, <a href="http://emberjs.com">Ember</a> sâ€™attend Ã  trouver une <code>TestRoute</code>, un <code>TestController</code>, un gabarit <code>test</code>.
Jusquâ€™ici, tout va bien.</p>
<p>Curieux ? -&gt; <a href="http://emberjs.com/guides/concepts/naming-conventions/">doc officielle</a>.</p>
<h3 id="modeles">
      <a class="putainde-Title-anchor" href="#modeles">#</a>
      ModÃ¨les
    </h3><p>Un modÃ¨le est un objet avec des propriÃ©tÃ©s contenant des donnÃ©es mÃ©tier. Le modÃ¨le est ensuite passÃ© au gabarit pour Ãªtre rendu par lui
en HTML. Typiquement, les modÃ¨les peuvent Ãªtre rÃ©cupÃ©rÃ©s dâ€™un back end via une API REST JSON via <a href="https://github.com/emberjs/data">Ember Data</a>
mais pas que.</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> Book = DS.Model.extend({
    title               : DS.attr(<span class="hljs-string">'string'</span>),
    publicationDate     : DS.attr(<span class="hljs-string">'date'</span>),
    author              : DS.attr(<span class="hljs-string">'string'</span>),
    publisher           : DS.attr(<span class="hljs-string">'string'</span>),
    summary             : DS.attr(<span class="hljs-string">'string'</span>)
});
</code></pre>
<p>AssoifÃ© de connaissances ? -&gt; <a href="http://emberjs.com/guides/models/">doc officielle</a>.</p>
<h3 id="routeur">
      <a class="putainde-Title-anchor" href="#routeur">#</a>
      Routeur
    </h3><p>Le routeur permet de faire correspondre Ã  une URL un ensemble de gabarits imbriquÃ©s permettant le rendu des modÃ¨les associÃ©s Ã  
chacun de ces gabarits.</p>
<p>Lâ€™exemple suivant permet le rendu des URLs : </p>
<ul>
<li><code>/books</code></li>
<li><code>/books/:book_id</code></li>
<li><code>/books/:book_id/edit</code></li>
<li><code>/books/create</code></li>
</ul>
<pre><code class="lang-js">App.Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'books'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'book'</span>, { path: <span class="hljs-string">'/:book_id'</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
          <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'edit'</span>);
      });
      <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'create'</span>);
  });
});
</code></pre>
<h3 id="routes">
      <a class="putainde-Title-anchor" href="#routes">#</a>
      Routes
    </h3><p>Les routes associent un modÃ¨le Ã  un gabarit et sont Ã©galement impliquÃ©es dans les transitions entre les diffÃ©rentes URL (et donc les diffÃ©rents
Ã©tats) de lâ€™application. Elles gÃ¨rent notamment un certain nombre dâ€™opÃ©rations sur un modÃ¨le lors de ces transitions.</p>
<pre><code class="lang-js">App.BooksRoute = Ember.Route.extend({
    model: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.store.find(<span class="hljs-string">'book'</span>);
    }
});
</code></pre>
<p>IntriguÃ© ? -&gt; <a href="http://emberjs.com/guides/routing/">doc officielle</a>.</p>
<h3 id="controleurs">
      <a class="putainde-Title-anchor" href="#controleurs">#</a>
      ContrÃ´leurs
    </h3><p>Le contrÃ´leur gÃ¨re lâ€™Ã©tat de lâ€™application. Il est situÃ© entre la route dont il rÃ©cupÃ¨re le modÃ¨le et le gabarit dont il rÃ©pond aux appels.
Les donnÃ©es du contrÃ´leur sont accessibles au gabarit au mÃªme titre que le modÃ¨le.</p>
<p>Le contrÃ´leur est par exemple responsable du traitement des actions effectuÃ©es par lâ€™utilisateur sur lâ€™interface rendue par le gabarit : </p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">button</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">sort</span>"}}&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
</code></pre>
<pre><code class="lang-js">App.BooksController = Ember.ArrayController.extend({
  actions: {
    <span class="hljs-comment">// appelÃ© lors du clic sur le bouton</span>
    sort: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        ...
    }
  }
});
</code></pre>
<p>Perdu ? -&gt; <a href="http://emberjs.com/guides/controllers/">doc officielle</a>.</p>
<h3 id="vues">
      <a class="putainde-Title-anchor" href="#vues">#</a>
      Vues
    </h3><p>Il est trÃ¨s rare dâ€™avoir Ã  dÃ©finir des vues en <a href="http://emberjs.com">Ember</a> parce que les gabarits <a href="http://handlebarsjs.com/">Handlebars</a>
sont surpuissants et que les contrÃ´leurs se chargent de la gestion de lâ€™Ã©tat de lâ€™application.</p>
<p>Vous en voulez quand mÃªme ? -&gt; <a href="http://emberjs.com/guides/views/">doc officielle</a>.</p>
<h3 id="gabarits">
      <a class="putainde-Title-anchor" href="#gabarits">#</a>
      Gabarits
    </h3><p>Un gabarit est un fragment de code HTML permettant, via des expressions, dâ€™afficher les donnÃ©es du modÃ¨le associÃ©. Les gabarits dâ€™<a href="http://emberjs.com">Ember</a>
sont des gabarits <a href="http://handlebarsjs.com/">Handlebars</a>. Les expressions Handlebars sont dÃ©limitÃ©es par <code>{{</code> et <code>}}</code>.</p>
<p>Lâ€™exemple suivant permet dâ€™afficher le titre dâ€™une app composÃ© dâ€™un prÃ©nom et dâ€™un nom pour peu que lâ€™on ait passÃ© au gabarit un
modÃ¨le contenant les deux propriÃ©tÃ©s <code>firstname</code> et <code>lastname</code>.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>{{firstname}} {{lastname}} Library<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
</code></pre>
<p><a href="http://handlebarsjs.com/">Handlebars</a> vient avec de nombreux outils (helpers) permettant de dynamiser nos gabarits : <code>{{#if isActive}} ... {{/if}}</code>,
<code>{{#each users}} ... {{/each}}</code>, etc.</p>
<p>Dans <a href="http://emberjs.com">Ember</a>, les gabarits peuvent contenir un Ã©lÃ©ment trÃ¨s important : <code>{{outlet}}</code>. Cet outlet dÃ©finit un emplacement
pour un autre gabarit permettant ainsi de multiples imbrications Ã  mesure que les routes de lâ€™application sont activÃ©es.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>{{firstname}} {{lastname}} Library<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
  {{outlet}}
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>Tout Ã©lÃ©ment de modÃ¨le injectÃ© dans un gabarit sera <strong>automatiquement mis Ã  jour</strong> (binding) par <a href="http://emberjs.com">Ember</a> lorsque le modÃ¨le
associÃ© au gabarit sera modifiÃ©. Ã‰videmment, seul cet Ã©lÃ©ment sera rafraÃ®chit et non le gabarit entier sinon câ€™est tricher.</p>
<p>Envie de tester ? -&gt; <a href="http://emberjs.com/guides/templates/the-application-template/">doc officielle</a>.</p>
<h3 id="composants">
      <a class="putainde-Title-anchor" href="#composants">#</a>
      Composants
    </h3><p>Un composant <a href="http://emberjs.com">Ember</a> permet de dÃ©finir une balise HTML personnalisÃ©e, permettant ainsi de partager de puissants 
Ã©lÃ©ments rÃ©utilisables au sein de votre application.</p>
<p>Vous en avez toujours rÃªvÃ© ? -&gt; <a href="http://emberjs.com/guides/components/">doc officielle</a>.</p>
<h3 id="generation-d-objets">
      <a class="putainde-Title-anchor" href="#generation-d-objets">#</a>
      GÃ©neration dâ€™objets
    </h3><p>Pour quâ€™un gabarit soit rendu lorsquâ€™une URL est demandÃ©e, il faut donc que le routeur dÃ©finisse cette URL, quâ€™elle soit implÃ©mentÃ©e par 
une route qui rÃ©cupÃ¨rera un modÃ¨le quâ€™elle mettra Ã  disposition du contrÃ´leur et du gabarit. Le contrÃ´leur Ã©coutera les 
Ã©vÃ¨nements en provenance du gabarit et y apportera la rÃ©ponse adaptÃ©e. Ã€ noter que lâ€™Ã©vÃ¨nement peut Ã©galement remonter jusquâ€™Ã  la route.
Le gabarit est quant Ã  lui encapsulÃ© dans une vue gÃ©rÃ©e par Ember tout seul comme un grand.</p>
<p>Il nâ€™est cependant <strong>pas nÃ©cessaire de crÃ©er systÃ©matiquement tous ces objets</strong> si aucune logique spÃ©cifique nâ€™a besoin dâ€™y Ãªtre dÃ©finie.
En effet, <a href="http://emberjs.com">Ember</a> sâ€™appuie sur les <a href="#conventions-de-nommage">conventions de nommage</a> pour retrouver successivement,
Ã  partir dâ€™une URL, la route, le contrÃ´leur, la vue et le gabarit associÃ©s. Si lâ€™un de ces objet nâ€™est pas trouvÃ©, <a href="http://emberjs.com">Ember</a>
va en gÃ©nÃ©rer un par dÃ©faut. </p>
<p>Donc si lâ€™on crÃ©e dans le routeur la route suivante sans crÃ©er aucun autre objet : </p>
<pre><code class="lang-js">App.Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.route(<span class="hljs-string">"about"</span>, { path: <span class="hljs-string">"/about"</span> });
});
</code></pre>
<p><a href="http://emberjs.com">Ember</a> va gÃ©nÃ©rer les objets suivants :</p>
<ul>
<li><strong>route</strong> : <code>AboutRoute</code></li>
<li><strong>contrÃ´leur</strong> : <code>AboutController</code></li>
<li><strong>gabarit</strong> : <code>about</code></li>
</ul>
<p>Dans une application <a href="http://emberjs.com">Ember</a>, <strong>il est donc nÃ©cessaire de ne dÃ©finir que ce dont on a besoin !</strong>. Et câ€™est bien connu, 
moins il y a de boilerplate, plus il y a de plaisir !</p>
<p>Envie dâ€™en savoir plus ? -&gt; <a href="http://emberjs.com/guides/routing/generated-objects/">doc officielle</a>.</p>
<p>Un bon moyen de se rendre compte de Ã§a consiste Ã  installer le debugger Ember sur votre navigateur prÃ©fÃ©rÃ© (donc pas IE). Vous aurez, entre
autres, la liste de lâ€™ensemble des objets impliquÃ©s dans le rendu dâ€™une URL donnÃ©e. Cette liste distingue de maniÃ¨re claire les objets
crÃ©Ã©s par vous et ceux gÃ©nÃ©rÃ©s par Ember. </p>
<p>Ce module sâ€™appelle <strong>Ember Inspector</strong> et est disponible pour <a href="https://chrome.google.com/webstore/detail/ember-inspector/bmdblncegkenkacieihfhpjfppoconhi?hl=en">Chrome</a> 
et <a href="https://addons.mozilla.org/en-US/firefox/addon/ember-inspector/">Firefox</a>. Câ€™est absolument indispensable lorsquâ€™on dÃ©veloppe en Ember.</p>
<h2 id="conclusion-et-next-steps">
      <a class="putainde-Title-anchor" href="#conclusion-et-next-steps">#</a>
      Conclusion et next steps
    </h2><p><a href="http://emberjs.com">Ember</a> est donc un framework trÃ¨s riche et extrÃªmement plaisant Ã  pratiquer. 
<strong>Un vrai framework avec un vrai parti pris et des vrais choix structurants.</strong>
Il est rÃ©solument tournÃ© vers le web et les URL. Ses crÃ©ateurs sont Ã©galement ceux de son moteur de gabarit <a href="http://handlebarsjs.com/">Handlebars</a>
et sont trÃ¨s impliquÃ©s dans diverses initiatives autour de la standardisation et de lâ€™Ã©volution du web. Pour nâ€™en citer que deux :
<a href="http://jsonapi.org/">JSON API</a> et <a href="https://gist.github.com/wycats/9144666b0c606d1838be">Web Components</a>, notamment au travers du moteur
de gabarits <a href="https://github.com/tildeio/htmlbars">HTMLBars</a>. 
Ils embrassent trÃ¨s rapidement les nouveaux standards tels que <a href="https://people.mozilla.org/~jorendorff/es6-draft.html">ES6 Harmony</a> Ã  lâ€™image des travaux
effectuÃ©s autour dâ€™<a href="http://www.ember-cli.com/">ember-cli</a> qui sera abordÃ© dans un prochain article.</p>
<p>Enfin, contrairement aux <em>a priori</em>, la courbe dâ€™apprentissage dâ€™<a href="http://emberjs.com">Ember</a>
est progressive et il est trÃ¨s simple Ã  prendre en main une fois les concepts de base apprÃ©hendÃ©s - câ€™est justement le but de cet
article. Au prochain Ã©pisode, nous verrons justement - par la pratique cette fois, <strong>comment dÃ©marrer et construire progressivement une
application <a href="http://emberjs.com">Ember</a></strong>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/js/debuter-avec-ember/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/debuter-avec-ember/</guid>
            <pubDate>Mon, 20 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Comment essayer de coder Ã  peu prÃ¨s comme un chef (ratÃ©) sous Windows]]></title>
            <description><![CDATA[<figure>
  <img src="index.jpg" alt="Keyboard">
  <small><a href="http://www.customity.com/content/wallpaper/windows-key-wallpaper">Credit photo</a></small>
</figure>

<p>Oh oui, en voilÃ  une belle question.</p>
<p>Il nâ€™est pas toujours Ã©vident dâ€™avoir un Linux, Unix, BSD ou autre avec un petit shell bien sympa sous la main. Et parfois coder sous Windows est une nÃ©cessitÃ© voire un dÃ©sir. (Ouais, je ne vous parlerai pas ici de changer de boulot si Windows vous est imposÃ©(e). Je ne vous expliquerai pas non plus votre masochisme dâ€™apprÃ©cier cet OS pour dÃ©velopper, ce nâ€™est pas le sujet).</p>
<p>Ã‰tant un homme de challenge, jâ€™aime me mettre dans des contextes limitÃ©s et voir comment je me dÃ©brouille pour sortir dâ€™une situation pÃ©nible Ã  une situation acceptable voire agrÃ©able. Je me suis alors lancÃ© pour vous dans cette aventure.</p>
<p>Oh mais pourquoi jâ€™ai dÃ» faire Ã§a Ã  la base ?</p>
<p>AprÃ¨s avoir crÃ©Ã© <a href="https://github.com/kud/my">mon propre systÃ¨me de synchronisation de machines sous Mac OS X</a> (plus souvent communÃ©ment appelÃ© dotfiles mais faisant un peu plus), jâ€™ai voulu faire de mÃªme sous Windows au cas oÃ¹ mon systÃ¨me crasherait et oÃ¹ je devrais tout rÃ©installer. On nâ€™est jamais Ã  lâ€™abri.</p>
<p>Pour cela, plusieurs outils vont vous Ãªtre nÃ©cessaires. Un chef sans bons outils, câ€™est drÃ´lement handicapant. (DÃ©jÃ  que lâ€™OS en question nâ€™aide pas).</p>
<h2 id="chocolatey-la-base">
      <a class="putainde-Title-anchor" href="#chocolatey-la-base">#</a>
      Chocolatey : la base
    </h2><p><a href="http://chocolatey.org/">Chocolatey</a>. Ouais, chocolatey, ce petit script vous permettra de tÃ©lÃ©charger tout et nâ€™importe quoi en CLI (ligne de commandes). Pour ceux qui ont lâ€™habitude de Mac ou Linux, câ€™est le brew / apt-get de Windows.</p>
<p>Comment lâ€™installer ?</p>
<p>Lancez <code>cmd.exe</code> en mode administrateur (touche windows puis â€œcmdâ€ puis shift+ctrl+enter) et exÃ©cutez ce code :</p>
<pre><code class="lang-console">$ <span class="hljs-variable">@powershell</span> -NoProfile -ExecutionPolicy unrestricted -Command <span class="hljs-string">"iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1'))"</span> &amp;&amp; SET PATH=<span class="hljs-variable">%PATH</span><span class="hljs-variable">%;</span><span class="hljs-variable">%ALLUSERSPROFILE</span><span class="hljs-variable">%\</span>chocolatey\bin
</code></pre>
<p>Ou <code>PowerShell</code> en mode administrateur (touche windows puis â€œpowershellâ€ puis shift+ctrl+enter) et Ã©xecutez :</p>
<pre><code class="lang-console">$ iex ((new-<span class="hljs-tag">object</span> net.webclient).<span class="hljs-function"><span class="hljs-title">DownloadString</span><span class="hljs-params">(<span class="hljs-string">'https://chocolatey.org/install.ps1'</span>)</span></span>)
</code></pre>
<p>Une fois installÃ©, vous pourrez installer nâ€™importe quel logiciel listÃ© sur <a href="http://chocolatey.org/packages">leur site</a>.</p>
<p>Passons Ã  la suite.</p>
<h2 id="logiciels-de-developpement">
      <a class="putainde-Title-anchor" href="#logiciels-de-developpement">#</a>
      Logiciels de dÃ©veloppement
    </h2><p>Yes, on a donc Chocolatey qui va nous simplifier grandement lâ€™installation de logiciels. Passons maintenant aux outils pour bien dÃ©velopper.</p>
<h3 id="git">
      <a class="putainde-Title-anchor" href="#git">#</a>
      Git
    </h3><p>Lorsque tu joues Ã  un jeu vidÃ©o, tu sauvegardes rÃ©guliÃ¨rement ton avancement non ? Bah lÃ , câ€™est pareil mais pour le code.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> git.<span class="hljs-keyword">install</span>
</code></pre>
<ul>
<li><a href="http://git-scm.com/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/git.install">lien du package</a></li>
</ul>
<h3 id="node-js">
      <a class="putainde-Title-anchor" href="#node-js">#</a>
      Node.js
    </h3><p>Faire du JavaScript cÃ´tÃ© serveur ou en shell, le pied. Surtout pour faire des scripts Windows, plutÃ´t que de passer par Batch.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> nodejs.<span class="hljs-keyword">install</span>
</code></pre>
<ul>
<li><a href="http://nodejs.org/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/nodejs.install">lien du package</a></li>
</ul>
<h3 id="editeur-de-texte">
      <a class="putainde-Title-anchor" href="#editeur-de-texte">#</a>
      Ã‰diteur de texte
    </h3><p>Sublime Text, lâ€™Ã©diteur prÃ©fÃ©rÃ© des FranÃ§â€¦ je mâ€™Ã©gare. Bref, un bon Ã©diteur.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> sublimetext3
</code></pre>
<ul>
<li><a href="http://www.sublimetext.com/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/sublimetext3">lien du package</a></li>
</ul>
<p>Vous pouvez aussi installer <a href="https://atom.io/">Atom</a> si vous prÃ©fÃ©rez.</p>
<h3 id="gestion-d-une-base-de-donnees">
      <a class="putainde-Title-anchor" href="#gestion-d-une-base-de-donnees">#</a>
      Gestion dâ€™une base de donnÃ©es
    </h3><p>HeidiSQL, un logiciel avec une interface qui se rapproche de phpMyAdmin.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> HeidiSQL
</code></pre>
<ul>
<li><a href="http://www.heidisql.com/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/HeidiSQL">lien du package</a></li>
</ul>
<p>Ou encore MySQL Workbench un excellent soft pour gÃ©rer une base de donnÃ©es:</p>
<ul>
<li>ModÃ©lisation</li>
<li>Ã‰dition</li>
<li>Migration
Par contre, il est un peu plus complexe Ã  utiliser.</li>
</ul>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> mysql.workbench
</code></pre>
<ul>
<li><a href="http://dev.mysql.com/downloads/workbench/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/mysql.workbench">lien du package</a></li>
</ul>
<h3 id="un-meilleur-shell">
      <a class="putainde-Title-anchor" href="#un-meilleur-shell">#</a>
      Un meilleur shell
    </h3><p>Cmder va vous permettre quelques fonctionnalitÃ©s intÃ©ressantes que le shell de Windows nâ€™a pas de base, comme taper <code>&lt;tab&gt;</code> pour lâ€™autocomplÃ©tion, avoir un historique persistant entre 2 sessions, des onglets, le split de console, lâ€™intÃ©gration de PuTTY et dâ€™autres choses venu de la banquise. (le lieu de vie des pinguins)</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> Cmder
</code></pre>
<ul>
<li><a href="https://bliker.github.io/cmder/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/Cmder">lien du package</a></li>
</ul>
<h3 id="si-vous-avez-besoin-de-ssh">
      <a class="putainde-Title-anchor" href="#si-vous-avez-besoin-de-ssh">#</a>
      Si vous avez besoin de SSH
    </h3><p>Pour le SSH sous Windows câ€™est assez complexe, il faut quelques outils dont le principal, putty (un terminal et +).</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> putty
</code></pre>
<ul>
<li><a href="http://chocolatey.org/packages/putty">site officiel</a></li>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/">lien du package</a></li>
</ul>
<p>Putty vient avec une suite de logiciels :</p>
<ul>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">PuTTYgen</a> pour gÃ©nÃ©rer une clÃ© SSH sous Windows</li>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">Plink</a> pour permettre Ã  HeidiSQL de se connecter Ã  une base de donnÃ©es via SSH.</li>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">Pageant</a> pour charger votre clÃ© SSH dans Windows pour Ã©viter quâ€™il demande sans cesse la clÃ© ou le mot de passe.</li>
</ul>
<blockquote>
<p>Pour que le ssh soit agrÃ©able, je vous recommande pageant et ensuite un terminal comme <em>Clink</em> ou encore <em>git bash</em> qui sâ€™installe via <em>git</em>.</p>
</blockquote>
<h3 id="une-machine-virtuelle-pour-tester-ie-ou-meme-gnu-linux">
      <a class="putainde-Title-anchor" href="#une-machine-virtuelle-pour-tester-ie-ou-meme-gnu-linux">#</a>
      Une machine virtuelle pour tester IE ou mÃªme GNU/Linux
    </h3><p>On a toujours une intÃ©gration Ã  tester sous IE pour Ã§a Microsoft nous donne accÃ¨s Ã  des machines virtuelles gratuitement sur <a href="https://www.modern.ie/fr-fr">ModernIE</a>. Il nous faut donc Virtualbox pour les lancer.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> virtualbox
$ choco <span class="hljs-keyword">install</span> VirtualBox.ExtensionPack
</code></pre>
<blockquote>
<p>lâ€™Extension Pack est utile pour une intÃ©gration parfaite avec votre machine si vous installez votre propre VM GNU/Linux ou Windows.</p>
</blockquote>
<ul>
<li><a href="hhttps://www.virtualbox.org/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/virtualbox">lien du package</a></li>
</ul>
<h3 id="compresser-decompresser-comme-vous-le-voulez">
      <a class="putainde-Title-anchor" href="#compresser-decompresser-comme-vous-le-voulez">#</a>
      Compresser / dÃ©compresser comme vous le voulez
    </h3><p>7zip, le logiciel de rÃ©fÃ©rence pour ce genre de pratique.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> <span class="hljs-number">7</span>zip.<span class="hljs-keyword">install</span>
</code></pre>
<ul>
<li><a href="http://www.7-zip.org/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/7zip.install">lien du package</a></li>
</ul>
<h3 id="gerer-les-pdf">
      <a class="putainde-Title-anchor" href="#gerer-les-pdf">#</a>
      GÃ©rer les pdf
    </h3><p>Sumatra pour les lire. PDFCreator pour faire une imprimante virtuelle sortant des PDFs.</p>
<h4 id="sumatra">
      <a class="putainde-Title-anchor" href="#sumatra">#</a>
      Sumatra
    </h4><ul>
<li><a href="http://blog.kowalczyk.info/software/sumatrapdf/free-pdf-reader.html">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/sumatrapdf.install">lien du package</a></li>
</ul>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> sumatrapdf.<span class="hljs-keyword">install</span>
</code></pre>
<h4 id="pdfcreator">
      <a class="putainde-Title-anchor" href="#pdfcreator">#</a>
      PDFCreator
    </h4><ul>
<li><a href="http://www.pdfforge.org/pdfcreator">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/pdfcreator">lien du package</a></li>
</ul>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> pdfcreator
</code></pre>
<h3 id="mettre-des-onglets-dans-l-explorateur-de-fichiers">
      <a class="putainde-Title-anchor" href="#mettre-des-onglets-dans-l-explorateur-de-fichiers">#</a>
      Mettre des onglets dans lâ€™explorateur de fichiers
    </h3><p>Nous sommes en 2014 Ã§a fait des annÃ©es que Microsoft sait mais, ce nâ€™est toujours pas disponible. Câ€™est lÃ  que Clover rentre en jeu.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> Clover
</code></pre>
<ul>
<li><a href="http://ejie.me/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/Clover">lien du package</a></li>
</ul>
<h3 id="spaaaaaaaces">
      <a class="putainde-Title-anchor" href="#spaaaaaaaces">#</a>
      Spaaaaaaaces
    </h3><p>Parce quâ€™avoir plusieurs bureaux / espaces, câ€™est plus pratique pour gÃ©rer ses fenÃªtres, je vous propose VirtuaWin. Cela vous permettra de garder en plein Ã©cran vos logiciels et de zapper dâ€™un logiciel Ã  un autre sans passer par <code>alt+tab</code> mais en allant dâ€™un bureau Ã  un autre.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> virtuawin
</code></pre>
<ul>
<li><a href="http://virtuawin.sourceforge.net/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/virtuawin">lien du package</a></li>
</ul>
<h3 id="launchy-le-alfred-like-sous-windows">
      <a class="putainde-Title-anchor" href="#launchy-le-alfred-like-sous-windows">#</a>
      Launchy, le Alfred-like sous Windows
    </h3><p>Je sais pas vous mais moi, les raccourcis qui me gÃ¢chent mon beau wallpaper choisi avec goÃ»t, Ã§a mâ€™Ã©nerve. Et puis le clickodrome, câ€™est lent et chiant. Du coup, lancer ses logiciels Ã  partir dâ€™un moteur de recherche, câ€™est quand mÃªme vachement bien. Ca permet aussi de faire des recherches de fichier, des calculs, et tout un tas dâ€™autres choses. Voici alors Launchy.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> launchy-beta
</code></pre>
<ul>
<li><a href="http://www.launchy.net/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/launchy-beta">lien du package</a></li>
</ul>
<h3 id="pipette-et-retouche">
      <a class="putainde-Title-anchor" href="#pipette-et-retouche">#</a>
      Pipette et retouche
    </h3><p>Lâ€™indispensable <a href="http://photofiltre.free.fr/frames.htm">PhotoFiltre</a> qui, bien quâ€™il ne soit plus mis Ã  jour depuis 2012, est trÃ¨s stable et efficace. Il fait peu mais, le fait bien.</p>
<ul>
<li>Ã‰dition rapide dâ€™images</li>
<li>Pipette</li>
<li>etc.</li>
</ul>
<p>Et surtout, il est ultra lÃ©ger et dÃ©marre en moins dâ€™une seconde.</p>
<h3 id="et-enfin-comment-ne-pas-se-niquer-les-yeux-toute-la-journee">
      <a class="putainde-Title-anchor" href="#et-enfin-comment-ne-pas-se-niquer-les-yeux-toute-la-journee">#</a>
      Et enfin, comment ne pas se niquer les yeux toute la journÃ©e
    </h3><h4 id="f-lux">
      <a class="putainde-Title-anchor" href="#f-lux">#</a>
      f.lux
    </h4><p>On va commencer par f.lux. Ce petit logiciel permettant de gÃ©rer la colorimÃ©trie de votre Ã©cran en fonction de lâ€™heure. Typiquement, les Ã©crans rendent un blanc digne dâ€™un soleil Ã  midi. Sauf que le soir, on allume la lumiÃ¨re et celle-ci nâ€™a pas du coup une couleur blanche mais souvent plutÃ´t rouge. f.lux permet alors dâ€™ajuster votre Ã©cran afin que la couleur soit identique Ã  la lumiÃ¨re ambiante pour rÃ©duire les diffÃ©rences de couleurs et Ã©viter de vous abimer les yeux. En plus, Ã§a permet au cerveau de se prÃ©parer Ã  aller se coucher. :D</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> f.lux
</code></pre>
<ul>
<li><a href="https://justgetflux.com/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/f.lux">lien du package</a></li>
</ul>
<h4 id="mactype">
      <a class="putainde-Title-anchor" href="#mactype">#</a>
      MacType
    </h4><p>Et surtout, MacType. Oh oui MacType. Je pense que seule une personne venant de Mac OS X peut comprendre. Dieu sait que le font rendering sous Windows est vraiment pourri et que Steve Jobs depuis le dÃ©part de Mac a fait en sorte sur le rendering des fonts sous son OS soit de qualitÃ©.</p>
<p>Pour rÃ©duire cette diffÃ©rence entre un Windows et un Mac OS X, je vous propose MacType qui permet de remplacer le font rendering de Windows et dâ€™apprÃ©cier lire Ã  nouveau sur cet OS.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> mactype
</code></pre>
<p>Je vous conseille le profil <code>XMac.LCD.Default</code>.</p>
<ul>
<li><a href="https://code.google.com/p/mactype/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/mactype">lien du package</a></li>
</ul>
<h2 id="vous-voila-pare-e">
      <a class="putainde-Title-anchor" href="#vous-voila-pare-e">#</a>
      Vous voilÃ  parÃ©(e) !
    </h2><p>On est bon, on a tous les outils nÃ©cessaires pour pouvoir coder correctement sur Windows.</p>
<p>Si vous souhaitez en savoir plus et surtout vous tenir Ã  jour dâ€™Ã©ventuels logiciels que je pourrais installer, nâ€™hÃ©sitez pas Ã  vous rendre sur mon projet <a href="https://github.com/kud/my-unfortunately">my-unfortunately</a> qui est le <em>synchroniser</em> dont je vous ai parlÃ© tout Ã  lâ€™heure.</p>
<p>Bon code !</p>
]]></description>
            <link>http://putaindecode.fr/posts/windows/comment-coder-sous-windows/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/windows/comment-coder-sous-windows/</guid>
            <pubDate>Wed, 15 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[DÃ©pendances et premier projet en Ruby]]></title>
            <description><![CDATA[<p><a href="#tl-dr">tl;dr</a></p>
<p>Dans lâ€™<a href="/posts/backend/premiers-pas-avec-ruby">article prÃ©cÃ©dent</a>
nous avons installÃ© Ruby. DÃ©sormais nous allons aborder les gems,
les dÃ©pendances et commencer notre web service.</p>
<p>Un gem en Ruby câ€™est une lib, comme un paquet NPM pour NodeJS. Câ€™est
dâ€™ailleurs le systÃ¨me de rubygems qui a inspirÃ© le systÃ¨me de NPM.
Pour installer un gem, rien de plus simple que <code>gem install sass</code>,
qui ici va installer la bibliothÃ¨que <code>sass</code>.</p>
<p>Un projet Ruby nÃ©cessite la plupart du temps des bibliothÃ¨ques afin
de ne pas tout faire soi-mÃªme, il est donc nÃ©cessaire dâ€™avoir une
gestion des dÃ©pendances pour le projet.</p>
<h2 id="bundler-le-gem-qui-gere-les-gems">
      <a class="putainde-Title-anchor" href="#bundler-le-gem-qui-gere-les-gems">#</a>
      Bundler, le gem qui gÃ¨re les gems
    </h2><p><a href="http://bundler.io">Bundler</a> est un gem qui va vous permettre de crÃ©er un fichier Gemfile
contenant vos dÃ©pendances, et qui vous installera les gems
nÃ©cessaires avec la gestion des versions et de leurs propres
dÃ©pendances. Un fichier Gemfile se prÃ©sente comme ceci :</p>
<pre><code class="lang-ruby">source <span class="hljs-string">'https://rubygems.org'</span>
ruby <span class="hljs-string">'2.1.2'</span>
gem <span class="hljs-string">'sinatra'</span>
</code></pre>
<p>Lâ€™instruction <code>source</code> permet de prÃ©ciser lâ€™url des dÃ©pÃ´ts de gems.
La version de ruby nâ€™est pas obligatoire mais jâ€™aime la prÃ©ciser pour
ne pas me mÃ©langer dans mes projets avec diffÃ©rentes versions de Ruby
(voir le
<a href="/posts/backend/premiers-pas-avec-ruby">prÃ©cÃ©dent article pour les versions du Ruby</a>
et <a href="https://github.com/sstephenson/rbenv">rbenv</a>). Et enfin, la
dÃ©claration de notre premiÃ¨re bibliothÃ¨que de dÃ©pendance :
<a href="http://www.sinatrarb.com">Sinatra</a>.</p>
<p>Il est possible dâ€™Ãªtre bien plus prÃ©cis dans le Gemfile, commeâ€¦</p>
<p>PrÃ©ciser dans quel environnement charger les gems :</p>
<pre><code class="lang-ruby">gem <span class="hljs-string">'sqlite3'</span>, <span class="hljs-symbol">group:</span> [<span class="hljs-symbol">:development</span>, <span class="hljs-symbol">:test</span>]
</code></pre>
<p>Une numÃ©ro de version :</p>
<pre><code class="lang-ruby">gem <span class="hljs-string">'rails'</span>, <span class="hljs-string">'4.1.6'</span>         <span class="hljs-comment"># version 4.1.6</span>
gem <span class="hljs-string">'sass-rails'</span>, <span class="hljs-string">'~&gt; 4.0.3'</span> <span class="hljs-comment"># &gt;= 4.0.3 mais &lt; 4.1.0</span>
</code></pre>
<p>PrÃ©ciser la classe Ã  charger :</p>
<pre><code class="lang-ruby">gem <span class="hljs-string">'valid_email'</span>, <span class="hljs-symbol">require:</span> <span class="hljs-string">'valid_email/email_validator'</span>
</code></pre>
<p>Aller chercher directement sur Github :</p>
<pre><code class="lang-ruby">gem <span class="hljs-string">'nokogiri'</span>, <span class="hljs-symbol">github:</span> <span class="hljs-string">'sparklemotion/nokogiri'</span>
<span class="hljs-comment"># https://github.com/sparklemotion/nokogiri.git</span>

gem <span class="hljs-string">'rails'</span>, <span class="hljs-symbol">github:</span> <span class="hljs-string">'rails'</span>
<span class="hljs-comment"># https://github.com/rails/rails.git</span>

gem <span class="hljs-string">'rails'</span>, <span class="hljs-symbol">github:</span> <span class="hljs-string">'rails'</span>, <span class="hljs-symbol">branch:</span> <span class="hljs-string">'4-1-stable'</span>
<span class="hljs-comment"># https://github.com/rails/rails.git sur la branche 4-1-stable</span>
</code></pre>
<p>Il existe encore dâ€™autres instructions, de quoi rendre sa gestion des
dÃ©pendances vraiment fine et prÃ©cise.</p>
<p>Une fois le Gemfile prÃªt, bundler a plusieurs commandes de
disponibles pour pouvoir les tÃ©lÃ©charger et utiliser.</p>
<ul>
<li><code>$ bundle install</code> installera les gems requis</li>
<li><code>$ bundle update</code> mettra Ã  jour vers les versions les plus rÃ©centes si possible les gems requis</li>
<li><code>$ bundle exec</code> permettra de prÃ©cÃ©der une commande ruby afin de lâ€™exÃ©cuter dans le contexte du Gemfile, trÃ¨s utile lorsque lâ€™on a diffÃ©rentes versions de Ruby qui se baladent dans le terminal</li>
</ul>
<p>Bundler va gÃ©nÃ©rer un fichier <code>Gemfile.lock</code> qui est la description
exhaustive des dÃ©pendances de votre application, chaque gem avec le
numÃ©ro de sa version installÃ©e, chaque dÃ©pendance pour chaque gem,
une jolie arborescence plus que prÃ©cise.</p>
<h2 id="commencons-notre-web-service">
      <a class="putainde-Title-anchor" href="#commencons-notre-web-service">#</a>
      CommenÃ§ons notre web service
    </h2><p>Assez parlÃ© des outils qui existent, utilisons-les. Tout dâ€™abord
installons Bundler, sans oublier le <code>$ rbenv rehash</code> nÃ©cessaire si vous
utilisez rbenv pour vos versions de Ruby afin de mettre Ã  jour les
commandes disponibles dans le terminal :</p>
<pre><code><span class="hljs-variable">$ </span>gem install bundler
<span class="hljs-variable">$ </span>rbenv rehash
</code></pre><p>Pour notre premiÃ¨re application, nous allons faire un web service
avec Sinatra qui est un micro-framework web, ayant dâ€™ailleurs
clairement inspirÃ© Express (â€œSinatra inspired web development
framework for node.jsâ€). Notre Gemfile va donc Ãªtre exactement
comme notre premier exemple :</p>
<pre><code class="lang-ruby">source <span class="hljs-string">'https://rubygems.org'</span>
ruby <span class="hljs-string">'2.1.2'</span>
gem <span class="hljs-string">'sinatra'</span>
</code></pre>
<p>Un petit <code>bundle install</code> et nous sommes prÃªts Ã  dÃ©marrer !</p>
<p>Pour ne pas brusquer les choses, nous allons faire la version la plus
simple dâ€™un web service avec Sinatra, ce qui nous permettra de
constater la simplicitÃ© extrÃªme de Ruby et du framework :</p>
<pre><code class="lang-ruby"><span class="hljs-comment">########</span>
<span class="hljs-comment"># app.rb</span>
<span class="hljs-comment">#</span>

<span class="hljs-keyword">require</span> <span class="hljs-string">'sinatra'</span>

get <span class="hljs-string">'/'</span> <span class="hljs-keyword">do</span>
  <span class="hljs-string">'Hello World!'</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Quâ€™avons-nous fait lÃ  ? Pas grand chose, et en mÃªme temps tout juste
ce quâ€™il faut. Nous avons inclus le gem Ã  notre script et utilisÃ© la
mÃ©thode Sinatra <code>get</code> nous permettant de dÃ©clarer un point dâ€™entrÃ©e
en <code>GET</code> sur la route â€˜/â€˜. Cette mÃ©thode prend Ã©galement comme
argument un <code>block</code> caractÃ©risÃ© par le <code>do</code> et le <code>end</code>. La derniÃ¨re
valeur du block Ã©tant la valeur de retour, nous renvoyons la seule
chaÃ®ne de caractÃ¨res â€œHello World!â€.</p>
<p>Et maintenant : lancement ! <code>$ bundle exec ruby app.rb</code> va lancer
lâ€™application (mais <code>ruby app.rb</code> suffit), par dÃ©faut sur le port
<code>4567</code>. Regardez vite <a href="http://localhost:4567">http://localhost:4567</a>
et lÃ  magie, â€œHello World!â€ sur une magnifique page blanche, notre
tout premier web service est fonctionnel.</p>
<p>Alors oui, ce nâ€™est pas une rÃ©volution. Mais tout de mÃªme, en
rÃ©duisant la syntaxe du block on se retrouve avec un script de deux
lignes qui crÃ©e un vrai web service web. Et vous allez vite voir
quâ€™en quelques lignes de plus on peut vite complexifier le bousin.</p>
<h2 id="au-prochain-episode">
      <a class="putainde-Title-anchor" href="#au-prochain-episode">#</a>
      Au prochain Ã©pisode
    </h2><p>Dans lâ€™article suivant nous allons ajouter des fonctionnalitÃ©s Ã 
notre toute nouvelle application, de nouvelles routes, de la
persistence et aussi des vues dans un format un peu plus utile.</p>
<p>Stay tuned!</p>
<h2 id="tl-dr">
      <a class="putainde-Title-anchor" href="#tl-dr">#</a>
      tl;dr
    </h2><p>Voici la version abrÃ©gÃ©e de cet article :</p>
<pre><code class="lang-ruby"><span class="hljs-comment"># Gemfile</span>
source <span class="hljs-string">'https://rubygems.org'</span>
ruby <span class="hljs-string">'2.1.2'</span>
gem <span class="hljs-string">'sinatra'</span>
</code></pre>
<pre><code class="lang-ruby"><span class="hljs-comment"># app.rb</span>
<span class="hljs-keyword">require</span> <span class="hljs-string">'sinatra'</span>
get <span class="hljs-string">'/'</span> <span class="hljs-keyword">do</span>
  <span class="hljs-string">'Hello World!'</span>
<span class="hljs-keyword">end</span>
</code></pre>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>gem install bundler
<span class="hljs-variable">$ </span>rbenv rehash
<span class="hljs-variable">$ </span>bundle install
<span class="hljs-variable">$ </span>ruby app.rb
</code></pre>
<h2 id="sources">
      <a class="putainde-Title-anchor" href="#sources">#</a>
      Sources
    </h2><ul>
<li><a href="https://rubygems.org">RubyGems</a></li>
<li><a href="http://bundler.io">Bundler</a></li>
<li><a href="https://github.com/sstephenson/rbenv">rbenv</a></li>
<li><a href="http://www.sinatrarb.com">Sinatra</a> et surtout son <a href="http://www.sinatrarb.com/intro.html">README</a></li>
</ul>
]]></description>
            <link>http://putaindecode.fr/posts/backend/ruby-dependances-et-projet/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/backend/ruby-dependances-et-projet/</guid>
            <pubDate>Tue, 14 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Le guide complet pour centrer en css]]></title>
            <description><![CDATA[<p>Centrer en css, câ€™est la base, et parfois, ce nâ€™est pas si simple. Ce guide vous servira donc pour vous lister les techniques les plus connues pour rÃ©aliser ce fameux effet centrÃ©.</p>
<p>Les principales techniques de centrage en css seront expliquÃ©es pendant les premiÃ¨res dÃ©clarations, et rÃ©utilisÃ©es par la suite dans tout le guide, vous pouvez donc avoir un intÃ©rÃªt Ã  lire le guide dans le sens normal de la lecture.</p>
<p>Cependant, si vous souhaitez juste avoir le code correspondant Ã  votre problÃ¨me, vous pouvez utiliser le menu composÃ© dâ€™ancres ci-dessous.</p>
<h2 id="sommaire">
      <a class="putainde-Title-anchor" href="#sommaire">#</a>
      Sommaire
    </h2><ul>
<li><a href="#tl-dr-mes-techniques-preferees">tl;dr - mes techniques prÃ©fÃ©rÃ©es</a></li>
<li><a href="#techniques-traditionnelles">Techniques tradtionnelles</a><ul>
<li><a href="#un-bloc-dans-un-bloc">Un bloc dans un bloc</a></li>
<li><a href="#des-blocs-dans-un-bloc">Des blocs dans un bloc</a></li>
<li><a href="#des-elements-inlines-dans-un-bloc">Des Ã©lÃ©ments inlines dans un bloc</a></li>
</ul>
</li>
<li><a href="#techniques-avancees-flexbox-ie11-">Techniques avancÃ©es : flexbox (ie11+)</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<h2 id="tl-dr-mes-techniques-preferees">
      <a class="putainde-Title-anchor" href="#tl-dr-mes-techniques-preferees">#</a>
      tl;dr - mes techniques prÃ©fÃ©rÃ©es
    </h2><h3 id="un-bloc-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#un-bloc-dans-un-bloc">#</a>
      Un bloc dans un bloc
    </h3><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;

  <span class="hljs-comment">/* facultatif : rÃ©soud un bug non systÃ©matique de blur sur IE */</span>
  <span class="hljs-rule"><span class="hljs-attribute">transform-style</span>:<span class="hljs-value"> preserve-<span class="hljs-number">3</span>d</span></span>; 
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform</span>:<span class="hljs-value"> <span class="hljs-function">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>)</span></span>; <span class="hljs-comment">/* compatibilitÃ© : ie9+ */</span>
}</span>
</code></pre>
<p><em>Note : le dÃ©tail de la technique est expliquÃ© plus loin dans le post</em></p>
<h3 id="des-blocs-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#des-blocs-dans-un-bloc">#</a>
      Des blocs dans un bloc
    </h3><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  content: <span class="hljs-string">''</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-right</span>:<span class="hljs-value"> -<span class="hljs-number">0.25em</span></span></span>; <span class="hljs-comment">/* space width */</span>
}

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<p><em>Note : le dÃ©tail de la technique est expliquÃ© plus loin dans le post</em></p>
<h3 id="des-elements-inline-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#des-elements-inline-dans-un-bloc">#</a>
      Des Ã©lÃ©ments inline dans un bloc
    </h3><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<p><em>Note : le dÃ©tail de la technique est expliquÃ© plus loin dans le post</em></p>
<h2 id="techniques-traditionnelles">
      <a class="putainde-Title-anchor" href="#techniques-traditionnelles">#</a>
      Techniques traditionnelles
    </h2><h3 id="un-bloc-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#un-bloc-dans-un-bloc">#</a>
      Un bloc dans un bloc
    </h3><h4 id="centrage-horizontal">
      <a class="putainde-Title-anchor" href="#centrage-horizontal">#</a>
      Centrage horizontal
    </h4><p>La technique du <code>margin: 0 auto;</code> consiste Ã  dire au browser que les marges de gauche et droite seront identiques et que leur valeur sera <code>auto</code>. Le browser calcule donc des marges de mÃªme taille de chaque cÃ´tÃ© et centre le bloc naturellement.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">margin</span>:<span class="hljs-value"> <span class="hljs-number">0</span> auto</span></span>;
}</span>
</code></pre>
<p>La technique du <code>left: 50%; + margin nÃ©gative en unitÃ©s</code> est Ã  utiliser sur les blocs dont vous connaissez la taille Ã  lâ€™avance. Le principe consiste Ã  expliquer au navigateur quâ€™on place un bloc en <code>position: absolute;</code>. Celui-ci va donc chercher Ã  se placer par rapport Ã  son Ã©lÃ©ment parent le plus proche qui est en <code>position: relative;</code>. Il faut donc ne pas oublier dâ€™attribuer cette propriÃ©tÃ© sur le <code>.parent</code>. Il suffit ensuite dâ€™indiquer quâ€™on place le bloc Ã  <code>left: 50%;</code>. Le bloc se place donc Ã  50% vers la gauche par rapport Ã  la taille totale du bloc conteneur. Il ne nous reste plus quâ€™Ã  dÃ©caler vers la droite le bloc <code>.child</code> en lui donnant une valeur de margin nÃ©gative vers la gauche. Celle-ci doit Ãªtre Ã©gale Ã  la moitiÃ© de la <code>width</code>(en pixels, em, rems, pourcentages, â€¦).</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> {X}em</span></span>; <span class="hljs-comment">/* remplacer {X} par votre valeur */</span>
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-left</span>:<span class="hljs-value"> -{X/<span class="hljs-number">2</span>}em</span></span>; <span class="hljs-comment">/* remplacer {X/2} par la moitiÃ© de votre width */</span>
}</span>
</code></pre>
<p>En combinant la technique prÃ©cÃ©dente et des propriÃ©tÃ©s css modernes, on arrive Ã  la technique du <code>transform: translate; nÃ©gatif</code>. MÃªme principe que la technique prÃ©cÃ©dente, sauf quâ€™Ã  la fin, on indique au bloc enfant dâ€™effectuer une translation sur lui-mÃªme, en suivant lâ€™axe X (lâ€™axe horizontal) de -50%, donc 50% vers la droite. Sauf que ce 50% sâ€™applique sur le bloc enfant directement. Vous nâ€™avez donc pas besoin de connaitre la <code>width</code> de lâ€™Ã©lÃ©ment enfant Ã  lâ€™avance. Le <code>transform-style: preserve-3d;</code> sur le bloc <code>.parent</code> est lÃ  pour rÃ©gler des problÃ¨mes de flou sur certains navigateurs lors de transitions.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;

  <span class="hljs-comment">/* facultatif : rÃ©soud un bug non systÃ©matique de blur sur IE */</span>
  <span class="hljs-rule"><span class="hljs-attribute">transform-style</span>:<span class="hljs-value"> preserve-<span class="hljs-number">3</span>d</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform</span>:<span class="hljs-value"> <span class="hljs-function">translateX</span>(-<span class="hljs-number">50%</span>)</span></span>;
}</span>
</code></pre>
<h4 id="centrage-vertical">
      <a class="putainde-Title-anchor" href="#centrage-vertical">#</a>
      Centrage vertical
    </h4><p>MÃªme principe que la technique <code>left: 50%; + margin nÃ©gative en unitÃ©s</code>, sauf quâ€™on applique le principe aux propriÃ©tÃ©s css relatives Ã  la hauteur. Vous avez donc besoin de connaitre Ã  lâ€™avance la hauteur de votre bloc.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> {Y}em</span></span>; <span class="hljs-comment">/* remplacer {Y} par votre valeur */</span>
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-top</span>:<span class="hljs-value"> -{Y/<span class="hljs-number">2</span>}em</span></span>; <span class="hljs-comment">/* remplacer {Y/2} par la moitiÃ© de votre height */</span>
}</span>
</code></pre>
<p>Ici on rÃ©utilise le principe expliquÃ© dans la technique <code>transform: translate; nÃ©gatif</code>, mais appliquÃ© Ã  la hauteur. Notez que le nom de la <a href="http://apps.workflower.fi/vocabs/css/fr">valeur de la propriÃ©tÃ©</a> css passe de <code>translateX</code> Ã  <code>translateY</code>.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;

  <span class="hljs-comment">/* facultatif : rÃ©soud un bug non systÃ©matique de blur sur IE */</span>
  <span class="hljs-rule"><span class="hljs-attribute">transform-style</span>:<span class="hljs-value"> preserve-<span class="hljs-number">3</span>d</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform</span>:<span class="hljs-value"> <span class="hljs-function">translateY</span>(-<span class="hljs-number">50%</span>)</span></span>;
}</span>
</code></pre>
<h4 id="les-deux">
      <a class="putainde-Title-anchor" href="#les-deux">#</a>
      Les deux
    </h4><p>En rÃ©utilisant toutes les techniques expliquÃ©es prÃ©cÃ©demment, on peut arriver Ã  plusieurs solutions, Ã  choisir selon votre contexte et vos prÃ©fÃ©rences.</p>
<p>MÃ©thode Ã  base de <code>display: inline-block</code></p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  content: <span class="hljs-string">''</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-right</span>:<span class="hljs-value"> -<span class="hljs-number">0.25em</span></span></span>;
}

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<p>Technique des <code>position: absolute; + marges nÃ©gatives</code> avec tailles connues Ã  lâ€™avance</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> {X}em</span></span>; <span class="hljs-comment">/* remplacer {X} par votre valeur */</span>
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> {Y}em</span></span>; <span class="hljs-comment">/* remplacer {Y} par votre valeur */</span>
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-left</span>:<span class="hljs-value"> -{X/<span class="hljs-number">2</span>}em</span></span>; <span class="hljs-comment">/* remplacer {X/2} par la moitiÃ© de votre height */</span>
  <span class="hljs-rule"><span class="hljs-attribute">margin-top</span>:<span class="hljs-value"> -{Y/<span class="hljs-number">2</span>}em</span></span>; <span class="hljs-comment">/* remplacer {Y/2} par la moitiÃ© de votre height */</span>
}</span>
</code></pre>
<p>Technique des <code>position: absolute; + marges nÃ©gatives</code> avec tailles inconnues</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform-style</span>:<span class="hljs-value"> preserve-<span class="hljs-number">3</span>d</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform</span>:<span class="hljs-value"> <span class="hljs-function">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>)</span></span>;
}</span>
</code></pre>
<h3 id="des-blocs-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#des-blocs-dans-un-bloc">#</a>
      Des blocs dans un bloc
    </h3><h4 id="centrage-horizontal">
      <a class="putainde-Title-anchor" href="#centrage-horizontal">#</a>
      Centrage horizontal
    </h4><p>On utilise la propriÃ©tÃ© <code>display: inline-block;</code> qui permet dâ€™avoir des propriÃ©tÃ©s dâ€™affichage relatives aux Ã©lÃ©ments de type <code>block</code> et de type <code>inline</code>. Le cÃ´tÃ© <code>inline</code> nous permet dâ€™utiliser tout simplement un <code>text-align: center;</code></p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;  
}</span>
</code></pre>
<h4 id="centrage-vertical">
      <a class="putainde-Title-anchor" href="#centrage-vertical">#</a>
      Centrage vertical
    </h4><p>De la mÃªme faÃ§on que pour le centrage horizontal, on utilise le cÃ´tÃ© <code>inline</code> de la propriÃ©tÃ© <code>display: inline-block;</code> pour aligner verticalement les Ã©lÃ©ments enfants par rapport Ã  leur conteneur parent.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>; 
}</span>
</code></pre>
<p>Une autre technique consiste Ã  utiliser les propriÃ©tÃ©s css de <code>mise en tableaux</code>. On est obligÃ© de crÃ©er un <a href="https://developer.mozilla.org/fr/docs/Web/CSS/Pseudo-%C3%A9l%C3%A9ments">pseudo-Ã©lÃ©ment</a> pour gÃ©rer la mise en page par tableau. On crÃ©Ã©e tout simplement un tableau, puis une cellule de tableau, quâ€™on positionne grÃ¢ce Ã  un <code>vertical-align: middle;</code>. Les Ã©lÃ©ments <code>.child</code> sâ€™alignent automatiquement dans leur conteneur.</p>
<pre><code class="lang-css"><span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  display: table</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
}

<span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> table-cell</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>; <span class="hljs-comment">/* Ã  enlever si vous ne souhaitez pas avoir vos blocs enfants alignÃ©s sur la mÃªme ligne, mais juste centrÃ©s verticalement sur la hauteur */</span>
}</span>
</code></pre>
<h4 id="les-deux">
      <a class="putainde-Title-anchor" href="#les-deux">#</a>
      Les deux
    </h4><p>On peut combiner les deux solutions basÃ©es sur le <code>display: inline-block;</code> pour avoir le rÃ©sultat souhaitÃ©.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<p>On peut aussir rÃ©utiliser la mÃ©thode Ã  base de <code>display: table-cell</code> et lâ€™adapter pour quâ€™elle centre horizontalement et verticalement.</p>
<pre><code class="lang-css"><span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  display: table</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
}

<span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> table-cell</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> left</span></span>;
}</span>
</code></pre>
<p>On peut rÃ©utiliser la technique prÃ©cÃ©dente en Ã©tant un peu imaginatif pour fonctionner avec des <code>display: inline-block;</code>. Pour dÃ©tailler, on crÃ©e un pseudo-Ã©lÃ©ment, qui aura un <code>content: &#39;&#39;;</code> pour faire quâ€™il existe et soit affichÃ©, puis on annule son affichage via un <code>margin-right nÃ©gatif</code> qui a pour valeur magique <code>-0.25em</code> ce qui correspond Ã  la largeur dâ€™un espace. On lui applique ensuite un <code>display: inline-block + height: 100% + vertical-align: middle</code> pour crÃ©er le conteneur Ã  la taille souhaitÃ©e et on termine en calant lâ€™Ã©lÃ©ment enfant <code>.child</code> avec un centrage vertical.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  content: <span class="hljs-string">''</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-right</span>:<span class="hljs-value"> -<span class="hljs-number">0.25em</span></span></span>;
}

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<h3 id="des-elements-inlines-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#des-elements-inlines-dans-un-bloc">#</a>
      Des Ã©lÃ©ments inlines dans un bloc
    </h3><p>Ces Ã©lÃ©ments <code>inline</code> peuvent Ãªtre par exemple des liens <code>&lt;a&gt;</code> ou des <code>&lt;span&gt;</code> tout simples. Ces techniques sont souvent trÃ¨s connues et ne devraient pas vous poser beaucoup de problÃ¨mes, elles ne seront pas commentÃ©es. Veuillez vous rÃ©fÃ©rer <a href="https://developer.mozilla.org/fr/docs/Web/CSS/text-align">text-align</a> et <a href="https://developer.mozilla.org/fr/docs/Web/CSS/vertical-align">vertical-align</a> si vous souhaitez plus dâ€™informations.</p>
<h4 id="centrage-horizontal">
      <a class="putainde-Title-anchor" href="#centrage-horizontal">#</a>
      Centrage horizontal
    </h4><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{}</span>
</code></pre>
<h4 id="centrage-vertical">
      <a class="putainde-Title-anchor" href="#centrage-vertical">#</a>
      Centrage vertical
    </h4><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<h4 id="les-deux">
      <a class="putainde-Title-anchor" href="#les-deux">#</a>
      Les deux
    </h4><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<h2 id="techniques-avancees-flexbox-ie11">
      <a class="putainde-Title-anchor" href="#techniques-avancees-flexbox-ie11">#</a>
      Techniques avancÃ©es : flexbox (<a href="http://caniuse.com/#feat=flexbox">ie11+</a>)
    </h2><p>Flexbox est un outil trÃ¨s puissant quand il sâ€™agit de gÃ©rer le position de blocs flex. Son seul dÃ©faut consiste en son faible support navigateur, mais il vous faudra maitriser ces techniques si vous comptez faire du dÃ©veloppement web dans les annÃ©es Ã  venir, dâ€™autant plus quâ€™elles sont trÃ¨s simples Ã  rÃ©diger et comprendre.</p>
<h3 id="centrage-horizontal">
      <a class="putainde-Title-anchor" href="#centrage-horizontal">#</a>
      Centrage horizontal
    </h3><p>On dÃ©clare le conteneur en bloc flex, et on lui applique la propriÃ©tÃ© <a href="https://developer.mozilla.org/fr/docs/Web/CSS/justify-content">justify-content</a>.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> flex</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">justify-content</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{}</span>
</code></pre>
<h3 id="centrage-vertical">
      <a class="putainde-Title-anchor" href="#centrage-vertical">#</a>
      Centrage vertical
    </h3><p>Idem, on dÃ©clare le conteneur en bloc flex, et cette fois, on lui applique la propriÃ©tÃ© <a href="https://developer.mozilla.org/fr/docs/Web/CSS/align-items">align-items</a>.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> flex</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">align-items</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{}</span>
</code></pre>
<h3 id="les-deux">
      <a class="putainde-Title-anchor" href="#les-deux">#</a>
      Les deux
    </h3><p>On combine le tout pour un rÃ©sultat gÃ©nial et simpliste.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> flex</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">justify-content</span>:<span class="hljs-value"> center</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">align-items</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{}</span>
</code></pre>
<h2 id="conclusion">
      <a class="putainde-Title-anchor" href="#conclusion">#</a>
      Conclusion
    </h2><p>Essayez de toujours utiliser la solution la plus avancÃ©e techniquement par rapport Ã  votre scope navigateur : si vous devez ne supporter que les IE rÃ©cents, utilisez flexbox ; si vous devez ne supporter que IE9+, utilisez les transform: translate() ; sinon utilisez des techniques de plus en plus <em>anciennes</em>.</p>
<p>Ce guide nâ€™a volontairement pas parlÃ© des prÃ©fixes navigateurs, car ce genre de chose doit Ãªtre pris en charge automatiquement dans votre workflow par un autoprefixer (<a href="https://www.npmjs.org/package/gulp-autoprefixer">gulp-autoprefixer</a>, <a href="https://www.npmjs.org/package/grunt-autoprefixer">grunt-autoprefixer</a>, <a href="http://www.myth.io/">inclus dans myth</a>, â€¦). Pour apprendre Ã  lâ€™installer ou Ã  en apprendre plus sur le sujet, je vous renvoie <a href="http://localhost:4242/posts/css/mise-en-place-autoprefixer/">Ã  lâ€™article de MoOx</a>. Si vous souhaitez quand mÃªme vous passez dâ€™autoprefixer, vous pourrez vÃ©rifier la compatibilitÃ© des propriÃ©tÃ©s sur <a href="http://caniuse.com/">caniuse</a>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/css/le-guide-complet-pour-centrer-en-css/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/css/le-guide-complet-pour-centrer-en-css/</guid>
            <pubDate>Tue, 23 Sep 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[MaÃ®triser les redirections shell]]></title>
            <description><![CDATA[<p>Le shell (ou ligne de commande) est lâ€™outil de prÃ©dilection pour bon nombre
dâ€™entre nous qui utilisons un OS de la famille UNIX. Nous sommes persuadÃ©s que
bien utilisÃ©, il remplace avantageusement un IDE complexe et gourmand.</p>
<p>Chez <em>Putain de code !</em>, on a une certaine tendance Ã  utiliser <a href="http://fr.wikipedia.org/wiki/Z_Shell">Zsh</a>, mais
pour ma part, jâ€™utilise encore et toujours le vÃ©nÃ©rable <a href="http://fr.wikipedia.org/wiki/Bourne-Again_shell">Bash</a>, non pas
pour faire mon barbu mais simplement car il me suffit amplement.</p>
<p>La suite de lâ€™article est donc basÃ©e sur celui-ci mais tout devrait fonctionner
Ã  lâ€™identique sur Zsh.</p>
<p>Venons en au sujet mÃªme de cet article, lâ€™un des Ã©lÃ©ments essentiels de
lâ€™utilisation du shell : lâ€™utilisation des redirections dâ€™entrÃ©e/sortie de
base.</p>
<p>Si Ã§a vous paraÃ®t barbare, tenez-vous bien, on attaque tout de suite !</p>
<h2 id="une-entree-deux-sorties">
      <a class="putainde-Title-anchor" href="#une-entree-deux-sorties">#</a>
      Une entrÃ©e, deux sorties
    </h2><p>Un des principes de base sous UNIX est que tout est fichier et que lâ€™activitÃ© du
systÃ¨me est rendue par lâ€™interaction de programmes (ou processus) Ã  lâ€™aide
des dits fichiers.</p>
<p>Pour pouvoir collaborer avec ses congÃ©nÃ¨res, chaque processus peut accÃ©der par
dÃ©faut Ã  trois fichiers bien particuliers : lâ€™entrÃ©e, la sortie, et la sortie
dâ€™erreur standards.</p>
<ul>
<li>Lâ€™entrÃ©e standard (<code>stdin</code>)</li>
<li>La sortie standard (<code>stdout</code>)</li>
<li>La sortie dâ€™erreur (<code>stderr</code>)</li>
</ul>
<p>Habituellement, lâ€™entrÃ©e standard est liÃ©e au clavier de lâ€™utilisateur <em>via</em> son
Ã©mulateur de terminal, et les deux sorties sont liÃ©es Ã  lâ€™affichage dans ce mÃªme
Ã©mulateur.</p>
<p>Lâ€™idÃ©e pour pouvoir faire collaborer les processus est donc de <em>brancher</em> les
entrÃ©es et sorties de diffÃ©rents programmes afin dâ€™obtenir un rÃ©sultat.</p>
<h2 id="les-redirections-de-base">
      <a class="putainde-Title-anchor" href="#les-redirections-de-base">#</a>
      Les redirections de base
    </h2><p>CommenÃ§ons par quelques redirections de base, celles quâ€™il faut connaÃ®tre et qui
sont employÃ©es systÃ©matiquement.</p>
<p>Pour nous exercer, nous allons utiliser principalement deux commandes :</p>
<ul>
<li><code>echo</code> : permet dâ€™Ã©crire un message spÃ©cifiÃ© en tant quâ€™argument sur sa sortie
standard.</li>
<li><code>cat</code> : permet dâ€™afficher le contenu dâ€™un fichier passÃ© en argument sur sa
sortie standard ou de rÃ©pÃ©ter son entrÃ©e standard sur sa sortie standard.</li>
</ul>
<p>Rappelez vous que par dÃ©faut, la sortie standard est affichÃ©e dans le terminal
et lâ€™entrÃ©e standard est le clavier de lâ€™utilisateur.</p>
<h3 id="redirection-de-sortie-gt">
      <a class="putainde-Title-anchor" href="#redirection-de-sortie-gt">#</a>
      Redirection de sortie : <code>&gt;</code>
    </h3><p>Ce type de redirection permet dâ€™indiquer Ã  un processus que tout ce qui devrait
aller sur la sortie standard (par dÃ©faut, le terminal), doit plutÃ´t Ãªtre stockÃ©
dans un fichier.</p>
<p>Pour Ã§a, on utilise la syntaxe <code>&gt; [fichier]</code> :</p>
<pre><code class="lang-console">$ echo <span class="hljs-string">"Hello"</span> &gt; <span class="hljs-keyword">message</span>
$ cat <span class="hljs-keyword">message</span>
Hello
</code></pre>
<h3 id="redirection-d-entree-lt">
      <a class="putainde-Title-anchor" href="#redirection-d-entree-lt">#</a>
      Redirection dâ€™entrÃ©e : <code>&lt;</code>
    </h3><p>Ã€ lâ€™inverse, on peut aussi spÃ©cifier Ã  un programme quâ€™il doit utiliser un
fichier comme son entrÃ©e standard, Ã  la place du clavier de lâ€™utilisateur.</p>
<p>En rÃ©utilisant notre fichier <code>message</code>, on peut par exemple faire :</p>
<pre><code class="lang-console">$ cat &lt; <span class="hljs-keyword">message</span>
Hello
</code></pre>
<p>Notez quâ€™on utilise bien <code>cat</code> <em>sans argument</em>, il utilise donc lâ€™entrÃ©e
standard.</p>
<h3 id="connecter-deux-processus">
      <a class="putainde-Title-anchor" href="#connecter-deux-processus">#</a>
      Connecter deux processus : <code>|</code>
    </h3><p>Dernier des connecteurs de base, lâ€™opÃ©rateur <code>|</code>, aussi appelÃ© <em>pipe</em> (et qui se
prononce <em>paillepe</em>, avÃ© lâ€™accent).</p>
<p>Il permet tout simplement dâ€™utiliser la sortie dâ€™un programme comme entrÃ©e dâ€™un
autre.</p>
<p>Pour montrer Ã§a, introduisons la commande <code>tr</code>, qui permet de remplacer des
caractÃ¨res dans lâ€™entrÃ©e par dâ€™autres.</p>
<pre><code class="lang-console">$ <span class="hljs-keyword">echo</span> <span class="hljs-string">"Hello!"</span> | <span class="hljs-built_in">tr</span> <span class="hljs-string">"[:lower:]"</span> <span class="hljs-string">"[:upper:]"</span>
HELLO!
</code></pre>
<h2 id="descripteurs-de-fichiers-et-redirections-avancees">
      <a class="putainde-Title-anchor" href="#descripteurs-de-fichiers-et-redirections-avancees">#</a>
      Descripteurs de fichiers et redirections avancÃ©es
    </h2><p>Pour aller plus loin, on va maintenant voir que chaque descripteur de fichier
possÃ¨de son propre identifiant numÃ©rique.</p>
<p>Pour <code>stdin</code>, <code>stdout</code> et <code>stderr</code> ce sera respectivement 0, 1 et 2.</p>
<p>On peut se servir de ces identifiants pour faire des redirections plus
poussÃ©es !</p>
<h3 id="rediriger-les-autres-descripteur">
      <a class="putainde-Title-anchor" href="#rediriger-les-autres-descripteur">#</a>
      Rediriger les autres descripteur
    </h3><p>Par dÃ©faut, <code>&gt;</code> ne redirige que la sortie standard vers un fichier. Pour
rediriger un autre descripteur vers un fichier on emploiera la notation <code>X&gt;</code> oÃ¹
<em>X</em> prendra la valeur de lâ€™identifiant du descripteur.</p>
<p>Si vous avez bien suivi, on redirigera donc la sortie dâ€™erreur vers un fichier Ã 
lâ€™aide de la syntaxe <code>2&gt;</code>.</p>
<h3 id="rediriger-vers-un-autre-descripteur-gt-amp">
      <a class="putainde-Title-anchor" href="#rediriger-vers-un-autre-descripteur-gt-amp">#</a>
      Rediriger vers un autre descripteur : <code>&gt;&amp;</code>
    </h3><p>On peut connecter les descripteurs dâ€™un processus entre eux. Câ€™est un mÃ©canisme
que lâ€™on utilise trÃ¨s souvent quand on Ã©crit des scripts Shell, notamment pour
Ã©crire sur la sortie dâ€™erreur.</p>
<p>Pour celÃ , on utilise la redirection <code>X&gt;&amp;Y</code> avec <em>X</em> Ã©tant lâ€™identifiant
descripteur source et <em>Y</em> lâ€™identifiant du descripteur sur lequel on veut
rediriger.</p>
<p>Lâ€™exemple suivant montre comment rediriger la sortie standard sur la sortie
dâ€™erreur (câ€™est comme Ã§a quâ€™on Ã©crit sur la sortie dâ€™erreur dans un script).</p>
<pre><code class="lang-console">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Error"</span> <span class="hljs-number">1</span>&gt;&amp;<span class="hljs-number">2</span>
</code></pre>
<p>Plus gÃ©nÃ©ralement, on peut omettre la partie avant le <code>&gt;&amp;</code>, elle prendra la
valeur 1 par dÃ©faut. On aura donc le script suivant :</p>
<pre><code class="lang-console">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Error"</span> &gt;&amp;<span class="hljs-number">2</span>
</code></pre>
<h3 id="ajouter-en-fin-de-fichier-gt-gt">
      <a class="putainde-Title-anchor" href="#ajouter-en-fin-de-fichier-gt-gt">#</a>
      Ajouter en fin de fichier : <code>&gt;&gt;</code>
    </h3><p>Par dÃ©faut, <code>&gt;</code> Ã©crase le fichier dans lequel la redirection va sâ€™effectuer.
Pour Ã©viter ce problÃ¨me, on peut utiliser Ã  la place <code>&gt;&gt;</code> qui va ajouter en fin
de fichier.</p>
<pre><code class="lang-console"># Sans &gt;&gt;
$ <span class="hljs-keyword">echo</span> <span class="hljs-string">"1"</span> &gt; <span class="hljs-keyword">file</span>
$ <span class="hljs-keyword">echo</span> <span class="hljs-string">"2"</span> &gt; <span class="hljs-keyword">file</span>
$ <span class="hljs-keyword">cat</span> <span class="hljs-keyword">file</span>
<span class="hljs-number">2</span>
</code></pre>
<pre><code class="lang-console"><span class="hljs-comment"># Avec &gt;&gt;</span>
<span class="hljs-variable">$ </span>echo <span class="hljs-string">"1"</span> &gt; file
<span class="hljs-variable">$ </span>echo <span class="hljs-string">"2"</span> <span class="hljs-prompt">&gt;&gt; </span>file
<span class="hljs-variable">$ </span>cat file
<span class="hljs-number">1</span>
<span class="hljs-number">2</span>
</code></pre>
<h3 id="dev-null-le-trou-noir">
      <a class="putainde-Title-anchor" href="#dev-null-le-trou-noir">#</a>
      <code>/dev/null</code>, le trou noir
    </h3><p>Il existe un fichier un peu particulier sur tout bon UNIX qui se respecte :
<code>/dev/null</code>.</p>
<p>Ce dernier est en fait une sorte de trou noir : Si on affiche son contenu on
nâ€™obtient rien, et si on Ã©crit quelque chose dedans elle disparait.</p>
<p>On se sert souvent de ce fichier pour supprimer la sortie dâ€™un programme :</p>
<pre><code class="lang-console">$ echo <span class="hljs-string">"Hello"</span> &gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span>
$ cat <span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span>
$
</code></pre>
<h3 id="ordre-des-redirections">
      <a class="putainde-Title-anchor" href="#ordre-des-redirections">#</a>
      Ordre des redirections
    </h3><p>Un dernier mot avant la fin, lâ€™ordre des redirections est trÃ¨s important !</p>
<p>Imaginez la fonction suivante qui affiche un message sur la sortie standard et
un sur la sortie dâ€™erreur :</p>
<pre><code class="lang-console"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">programme</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">echo</span> <span class="hljs-string">"Message"</span>
  <span class="hljs-keyword">echo</span> <span class="hljs-string">"Error"</span> &gt;&amp;<span class="hljs-number">2</span>
}
</code></pre>
<p>Si on veut rediriger toutes les sorties vers <code>/dev/null</code> on peut utiliser la
syntaxe suivante :</p>
<pre><code class="lang-console">$ programme <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span> &gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span>
</code></pre>
<p>Vous remarquerez que câ€™est assez verbeux, et quâ€™on pourrait simplifier celÃ  en
utilisant <code>&gt;&amp;</code> comme vu prÃ©cÃ©demment.</p>
<p>On essaie donc naÃ¯vement :</p>
<pre><code class="lang-console">$ programme <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> &gt;<span class="hljs-regexp">/dev/</span><span class="hljs-literal">null</span>
<span class="hljs-built_in">Error</span>
</code></pre>
<p>Hmm, pourtant on a tout branchÃ© ensemble non ? En fait non, on a redirigÃ© la
sortie sur le fichier pointÃ© par <code>1</code> au moment oÃ¹ on Ã©crit la redirection, donc
avant quâ€™il soit redirigÃ© sur <code>/dev/null</code>.</p>
<p>Pour bien faire, il faut Ã©crire les redirections dans lâ€™autre ordre :</p>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>programme &gt;<span class="hljs-regexp">/dev/null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>
</code></pre>
<p>On lira ceci : Rediriger la sortie standard vers <code>/dev/null</code>, puis rediriger la
sortie dâ€™erreur vers la sortie standard.</p>
<h3 id="pour-resumer">
      <a class="putainde-Title-anchor" href="#pour-resumer">#</a>
      Pour rÃ©sumer
    </h3><p>On a en fait que deux redirections de sortie, <code>&gt;</code> et <code>&gt;&gt;</code>, les symboles qui les
entourent sont souvent optionnels.</p>
<p>Si on veut spÃ©cifier un fichier on donnera son nom, si on veut spÃ©cifier un
descripteur on donnera son identifiant prÃ©fixÃ© de <code>&amp;</code>.</p>
<h2 id="pour-aller-plus-loin">
      <a class="putainde-Title-anchor" href="#pour-aller-plus-loin">#</a>
      Pour aller plus loin
    </h2><p>Le manuel de bash contient <a href="http://www.gnu.org/software/bash/manual/bashref.html#Redirections">une section complÃ¨te sur les
redirections</a>. Elle va beaucoup plus loin que cet article et je vous
invite Ã  la lire pour voir tout ce quâ€™il est possible de faire.</p>
<p>Il y a aussi une section dÃ©diÃ©e Ã  ce sujet dans lâ€™<a href="http://tldp.org/LDP/abs/html/io-redirection.html">Advanced Bash-Scripting Guide</a>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/shell/maitriser-les-redirections-shell/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/shell/maitriser-les-redirections-shell/</guid>
            <pubDate>Wed, 16 Jul 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Un point sur les grilles CSS en inline-block]]></title>
            <description><![CDATA[<p>Les grilles sont devenues incontournables pour le layout dâ€™un site.
<a href="http://justifygrid.com/#methodology">Plusieurs</a> <a href="https://github.com/suitcss/components-grid">mÃ©thodes</a>  <a href="http://www.palantir.net/blog/responsive-design-s-dirty-little-secret">existent</a> en attendant de pouvoir utiliser le Graal, <a href="http://dev.w3.org/csswg/css-grid/">CSS3 grid layout</a>.</p>
<p>Mais en attendant, on bricole. Et une des solutions que jâ€™aime bien consiste Ã  utiliser des inline-block, car elle offre plusieurs avantages pratiques :</p>
<ul>
<li>On peut simplement renverser la grille grÃ¢ce Ã  la propriÃ©tÃ©  <code>direction:rtl;</code> ce qui est particuliÃ¨rement pratique sur des sites qui doivent supporter des langues dont le sens de lecture va de droite Ã  gauche.</li>
<li>les Ã©lÃ©ments en inline-block peuvent utiliser la propriÃ©tÃ© <code>vertical-align</code>.</li>
<li>les Ã©lÃ©ments de la grilles reste dans le flux, ce qui Ã©vite lâ€™utilisation de clearfix.</li>
</ul>
<p>Ce dernier point est aussi une source de problÃ¨mes puisque notre <code>.Grid</code> contient non seulement nos Ã©lÃ©ments de grille <code>.Grid-cell</code> mais aussi quelques caractÃ¨res espace Ã§a et lÃ  entre les noeuds enfants.</p>
<p>De la mÃªme maniÃ¨re quâ€™un espaces sÃ©pare 2 mots, on retrouve ces espaces entre nos blocs. Ces caractÃ¨res proviennent des espaces et autre sauts de lignes quâ€™on insÃ¨re dans le code source pour formater notre document.</p>
<p>Voici donc un aperÃ§u des diffÃ©rents moyens de se dÃ©barasser de ces espaces, afin que tout les Ã©lÃ©ments de notre grille restent Ã  leur place.</p>
<h2 id="supprimer-les-espaces-entre-les-tag-grid-cell">
      <a class="putainde-Title-anchor" href="#supprimer-les-espaces-entre-les-tag-grid-cell">#</a>
      Supprimer les espaces entre les tag <code>.Grid-cell</code>
    </h2><pre><code>&lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"Grid"</span>&gt;
  &lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"Grid-cell"</span>&gt;...&lt;/<span class="hljs-keyword">div</span>&gt;&lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"Grid-cell"</span>&gt;...&lt;/<span class="hljs-keyword">div</span>&gt;&lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"Grid-cell"</span>&gt;...&lt;/<span class="hljs-keyword">div</span>&gt;
&lt;/<span class="hljs-keyword">div</span>&gt;
</code></pre><p>Une mÃ©thode pas forcÃ©ment trÃ¨s lisible mais qui est robuste. Soyons crÃ©atifs,
on peut aussi faire comme Ã§a, mÃªme si le formatage en prend un coup.</p>
<pre><code>&lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"Grid"</span>&gt;
      &lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"Grid-cell"</span>&gt;...
&lt;/<span class="hljs-keyword">div</span>&gt;&lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"Grid-cell"</span>&gt;...
&lt;/<span class="hljs-keyword">div</span>&gt;&lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"Grid-cell"</span>&gt;...&lt;/<span class="hljs-keyword">div</span>&gt;
&lt;/<span class="hljs-keyword">div</span>&gt;
</code></pre><p>Notez que la premiÃ¨re technique peut Ãªtre facilement mise en place de maniÃ¨re automatique, via une traitement de <a href="https://github.com/kangax/html-minifier">minification du code html</a>.</p>
<h2 id="inserer-des-commentaires-html-entre-les-tags-grid-cell">
      <a class="putainde-Title-anchor" href="#inserer-des-commentaires-html-entre-les-tags-grid-cell">#</a>
      InsÃ©rer des commentaires html entre les tags <code>.Grid-cell</code>
    </h2><p>La solution est robuste, au prix de quelques caractÃ¨res supplÃ©mentaires. Un surpoids que gzip se fera un plaisir de vous faire oublier !
Câ€™est la mÃ©thode choisie dans le framework <a href="https://github.com/csswizardry/inuit.css/blob/master/objects/_grids.scss">inuitCss</a>.</p>
<pre><code><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"Grid"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"Grid-cell"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span><span class="hljs-comment">&lt;!--
--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"Grid-cell"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span><span class="hljs-comment">&lt;!--
--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"Grid-cell"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre><h2 id="font-size-0">
      <a class="putainde-Title-anchor" href="#font-size-0">#</a>
      font-size: 0
    </h2><pre><code><span class="hljs-class">.Grid</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> <span class="hljs-number">0</span></span></span>;
}</span>
<span class="hljs-class">.Grid-cell</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> <span class="hljs-number">16px</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> <span class="hljs-number">1rem</span></span></span>;
}</span>
</code></pre><p>Lâ€™idÃ©e est de faire disparaÃ®tre les caractÃ¨res <em>espace</em> situÃ©s entre les balises enfants en rÃ©glant la taille de la police Ã  zÃ©ro. Il suffit ensuite de rÃ©-initialiser la taille sur les noeuds enfants <code>.Grid-cell</code>. Cette mÃ©thode est utilisÃ©e dans <a href="https://github.com/suitcss/components-grid">SUIT Grid</a>.</p>
<p><em>Attention</em>, si votre scope navigateur va en dessous dâ€™IE9, cette mÃ©thode fait perdre le bÃ©nÃ©fice dâ€™une intÃ©gration Ã  base dâ€™em puisque la taille de la typo sur les blocs enfants est dÃ©sormais fixe.</p>
<h2 id="appliquer-une-marge-negative-entre-les-blocs-enfants">
      <a class="putainde-Title-anchor" href="#appliquer-une-marge-negative-entre-les-blocs-enfants">#</a>
      Appliquer une marge nÃ©gative entre les blocs enfants
    </h2><pre><code><span class="hljs-class">.Grid-cell</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">margin-right</span>:<span class="hljs-value"> -<span class="hljs-number">4px</span></span></span>;
}</span>
</code></pre><p>Cette mÃ©thode nâ€™est Ã  mon sens pas trÃ¨s robuste, surtout sur des intÃ©grations Ã  base dâ€™em, car on introduit un nombre magique qui dÃ©pend de plusieurs paramÃ¨tre, comme la typo utilisÃ©e, sa taille de base, etc. Cette mÃ©thode demande donc de bien tester puisque les font disponibles ne seront pas les mÃªmes selon des Ã©quipements, les OSâ€¦</p>
<h2 id="la-methode-kellum">
      <a class="putainde-Title-anchor" href="#la-methode-kellum">#</a>
      La mÃ©thode Kellum
    </h2><p>Ici, la mÃ©thode consiste Ã  utiliser une font particuliÃ¨re contenant le caractÃ¨re espace et dont la particularitÃ© est dâ€™avoir une largeur nulle. Cette technique est dÃ©crite dans lâ€™article de <a href="http://scottkellum.com/2013/10/25/the-new-kellum-method.html">Scott Kellum</a></p>
<p>Comme la technique prÃ©cÃ©dente, il suffit dâ€™appliquer la font au conteneur <code>.Grid</code> puis de remettre la font-family par defaut pour les enfants <code>.Grid-cell</code>. Et ainsi, toutes valeurs relatives en <em>em</em> sont prÃ©servÃ©es.</p>
<pre><code><span class="hljs-class">.Grid</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">font-family</span>:<span class="hljs-value"> <span class="hljs-string">'blank-kellum'</span></span></span>;
}</span>

<span class="hljs-class">.Grid-cell</span><span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> <span class="hljs-number">33.333333%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">font-family</span>:<span class="hljs-value">sans-serif</span></span>;
}</span>
</code></pre><p>Lâ€™inconvÃ©nient de cette technique est quâ€™elle nÃ©cessite le tÃ©lÃ©chargement dâ€™un fichier font particuliÃ¨r si le navigateur ne supporte pas Ã©lÃ©ments encodÃ©es en data-uri (en gros, en dessous dâ€™ie8). Par contre, si vous utilisez une font dâ€™icÃ´nes, rien ne vous empÃªche de combiner les deux, en ajoutant votre icÃ´ne de largeur nulle avec vos icÃ´nes. Voici un aperÃ§u sur <a href="http://codepen.io/lionelB/pen/fvyjH">codepen</a></p>
<h1 id="le-mot-de-la-fin">
      <a class="putainde-Title-anchor" href="#le-mot-de-la-fin">#</a>
      Le mot de la fin
    </h1><p>Non, il nâ€™y a pas vraiment une technique qui sort du lot. Comme toujours, cela dÃ©pend des navigateurs Ã  supporter, est ce que lâ€™utilisateur pourra personnaliser le layout, qui sera chargÃ© des mise Ã  jour, etcâ€¦ autant de points qui aideront Ã  choisir la meilleure solution.</p>
<hr>
<p>Quelques ressources :</p>
<ul>
<li>Lâ€™article <a href="http://css-tricks.com/fighting-the-space-between-inline-block-elements/">Fighting the space between inline block elements</a> sur css-tricks</li>
<li>Lâ€™article <a href="http://webdesigner-webdeveloper.com/weblog/about-inline-blocks/">About inline-block</a> sur lequel je suis tombÃ© en rÃ©digeant cet article.</li>
</ul>
]]></description>
            <link>http://putaindecode.fr/posts/css/les-grilles-en-inline-block/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/css/les-grilles-en-inline-block/</guid>
            <pubDate>Fri, 13 Jun 2014 00:00:00 GMT</pubDate>
        </item>
    </channel>
</rss>
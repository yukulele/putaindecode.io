<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title><![CDATA[Putain de code !]]></title>
        <description><![CDATA[Putain de code !]]></description>
        <link>http://putaindecode.fr</link>
        <generator>RSS for Node</generator>
        <lastBuildDate>Tue, 12 May 2015 05:42:24 GMT</lastBuildDate>
        <atom:link href="http://putaindecode.fr/feed.xml" rel="self" type="application/rss+xml"/>
        <language><![CDATA[fr]]></language>
        <category><![CDATA[code]]></category>
        <item>
            <title><![CDATA[Les utilitaires en ligne de commande]]></title>
            <description><![CDATA[<p>Avoir acc√®s √† ses utilitaires en ligne de commande (<a href="https://en.wikipedia.org/wiki/Command-line_interface">CLI</a>) est un quotidien dans nos m√©tiers et un avantage ind√©niable. Ce n‚Äôest pas nouveau et cela existe depuis la nuit des temps. Tout utilisateur
d‚ÄôUnix voue un culte particulier √† son terminal.</p>
<p>J‚Äôai r√©cemment eu √† d√©velopper un utilitaire en Node.js/iojs, j‚Äôai donc voulu avec cet article d√©blayer un peu le terrain
et pr√©senter quelques utilitaires tr√®s pratiques.</p>
<p>Deux postulats avant de commencer :</p>
<ul>
<li>Pourquoi JavaScript ? En coh√©rence avec le workflow que j‚Äôutilise.</li>
<li>Cet article n‚Äôa pas pour but d‚Äôapprendre √† √©crire du JavaScript avec Node.js/iojs.</li>
</ul>
<h2 id="hello-world">
      <a class="putainde-Title-anchor" href="#hello-world">#</a>
      Hello world
    </h2><p>Avant de commencer √† coder, il va tout d‚Äôabord falloir cr√©er deux fichiers qui seront n√©cessaires et obligatoires :</p>
<pre><code class="lang-console"><span class="hljs-comment">// cr√©ation du dossier</span>
$ <span class="hljs-keyword">mkdir</span> putaindecode-<span class="hljs-keyword">cli</span> &amp;&amp; <span class="hljs-keyword">cd</span> putaindecode-<span class="hljs-keyword">cli</span>

<span class="hljs-comment">// cr√©ation de index.js</span>
$ touch index.js

<span class="hljs-comment">// cr√©ation de package.json</span>
$ touch package.json
</code></pre>
<p>Le fichier <code>index.js</code> va se pr√©senter comme ceci :</p>
<pre><code><span class="hljs-shebang">#!/usr/bin/env node</span>
<span class="hljs-comment">// Cette ligne ou shebang permet de d√©finir l'interpr√©teur de notre script, √† savoir `node`</span>

<span class="hljs-comment">// notre fameux hello world</span>
console.log(<span class="hljs-string">"Hello world"</span>)
</code></pre><p>Pour notre fichier <code>package.json</code>, deux m√©thodes possibles pour l‚Äô√©crire, soit en faisant <code>npm init</code> puis suivre les instructions, soit adapter ce JSON :</p>
<pre><code class="lang-console">{
  "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"putaindecode-cli"</span></span>,
  "<span class="hljs-attribute">version</span>": <span class="hljs-value"><span class="hljs-string">"0.1.0"</span></span>,
  "<span class="hljs-attribute">description</span>": <span class="hljs-value"><span class="hljs-string">"Putaindecode cli"</span></span>,
  "<span class="hljs-attribute">keywords</span>": <span class="hljs-value">[
    <span class="hljs-string">"cli"</span>,
    <span class="hljs-string">"npm"</span>
  ]</span>,
  "<span class="hljs-attribute">author</span>": <span class="hljs-value"><span class="hljs-string">"magsout"</span></span>,
  "<span class="hljs-attribute">license</span>": <span class="hljs-value"><span class="hljs-string">"MIT"</span></span>,
  "<span class="hljs-attribute">repository</span>": <span class="hljs-value">{
    "<span class="hljs-attribute">type</span>": <span class="hljs-value"><span class="hljs-string">"git"</span></span>,
    "<span class="hljs-attribute">url</span>": <span class="hljs-value"><span class="hljs-string">"https://github.com/putaindecode/putaindecode-cli.git"</span>
  </span>}</span>,
  "<span class="hljs-attribute">engines</span>": <span class="hljs-value">{
    "<span class="hljs-attribute">node</span>": <span class="hljs-value"><span class="hljs-string">"&gt;=0.10"</span>
  </span>}</span>,
  "<span class="hljs-attribute">homepage</span>":<span class="hljs-value"><span class="hljs-string">"https://github.com/putaindecode-cs/putaindecode-cli"</span>
  <span class="hljs-string">"bugs"</span>: {
    "<span class="hljs-attribute">url</span>": <span class="hljs-value"><span class="hljs-string">"https://github.com/putaindecode-cs/putaindecode-cli/issues"</span>
  </span>}</span>,
  "<span class="hljs-attribute">files</span>": <span class="hljs-value">[
    <span class="hljs-string">"index.js"</span>
  ]</span>,
  "<span class="hljs-attribute">dependencies</span>": <span class="hljs-value">{}</span>,
  "<span class="hljs-attribute">devDependencies</span>": <span class="hljs-value">{}</span>,
  "<span class="hljs-attribute">bin</span>": <span class="hljs-value">{
    "<span class="hljs-attribute">putaindecode</span>": <span class="hljs-value"><span class="hljs-string">"index.js"</span>
  </span>}
</span>}
</code></pre>
<p>La ligne importante √† ne surtout pas oublier :</p>
<pre><code class="lang-console"><span class="hljs-string">"bin"</span>: {
  <span class="hljs-string">"putaindecode-cli"</span>: <span class="hljs-string">"index.js"</span>
}
</code></pre>
<p>Elle permettra de d√©terminer le script √† ex√©cuter lorsque la commande <code>putaindecode-cli</code> sera lanc√©e.</p>
<p>Si on vulgarise un peu le principe, en installant le script, le fichier <code>index.js</code> sera renomm√© en <code>putaindecode-cli.js</code> et sera copi√© dans le r√©pertoire ad√©quat (cela d√©pend de l‚ÄôOS).</p>
<p>Lorsque la commande <code>putaindecode-cli</code> sera ex√©cut√©e, le shell va chercher le fichier ex√©cutable en utilisant les r√©pertoires list√©s dans la variable PATH.</p>
<p>Si on suit ce raisonnement, l‚Äôinstallation d‚Äôun script √©crasera automatiquement l‚Äôancienne version ou tout script de m√™me nom.</p>
<p>Pour s‚Äôassurer qu‚Äôil n‚Äôexiste pas d‚Äôautres commandes portant le m√™me nom, il est conseill√© d‚Äôutiliser la commande : <code>which putaindecode-cli</code> qui ne retournera rien s‚Äôil n‚Äôy a aucun r√©sultat :</p>
<pre><code class="lang-console">#putaindecode-<span class="hljs-keyword">cli</span> ne retourne aucun r√©sultat
$ <span class="hljs-keyword">which</span> putaindecode-<span class="hljs-keyword">cli</span>

#node <span class="hljs-keyword">est</span> install√© et accessible au path suivant
$ <span class="hljs-keyword">which</span> node
  /usr/<span class="hljs-keyword">local</span>/bin/node
</code></pre>
<h2 id="installation-du-script">
      <a class="putainde-Title-anchor" href="#installation-du-script">#</a>
      Installation du script
    </h2><p>Afin de v√©rifier que le script fonctionne correctement, il suffit tout simplement d‚Äôex√©cuter dans le r√©pertoire la commande : <code>./index.js</code>.</p>
<p>Une erreur de droit ? Un petit chmod pour arranger √ßa : <code>chmod +x index.js</code>.</p>
<p>√Ä ce stade, si tout fonctionne bien, <code>Hello World</code> va s‚Äôafficher.</p>
<p>Par contre, ex√©cuter notre script de la sorte n‚Äôest pas tr√®s pratique, d‚Äôautant plus qu‚Äôil sera n√©cessaire de conna√Ætre √† chaque fois le chemin vers le fichier.</p>
<p>Il serait beaucoup plus simple de pouvoir ex√©cuter le script comme une commande. Comme pour tout package npm, cela se fait avec <code>npm install</code>.</p>
<pre><code class="lang-console"><span class="hljs-comment">// installation en global du script</span>
$ npm install -<span class="hljs-keyword">g</span>

<span class="hljs-comment">// ex√©cution de la commande</span>
$ putaindecode-<span class="hljs-keyword">cli</span>

<span class="hljs-comment">// r√©sultat de la commande</span>
Hello world
</code></pre>
<p>Le script est maintenant accessible partout sur l‚ÄôOS gr√¢ce √† la commande <code>putaindecode-cli</code>. L‚Äôinstallation en global n‚Äôest pas absolument pas n√©cessaire, tout d√©pend de l‚Äôint√©r√™t de votre script. Il est d‚Äôailleurs souvent pr√©f√©rable de l‚Äôinstaller en local dans un projet avec <code>--save</code> ou <code>--save-dev</code>.</p>
<h2 id="installation-des-scripts-de-base">
      <a class="putainde-Title-anchor" href="#installation-des-scripts-de-base">#</a>
      Installation des scripts de base
    </h2><p>La puissance de <code>NPM</code> provient de son nombre impressionnant de packages mis √† disposition.</p>
<p>Pour gagner du temps et √©viter d‚Äôavoir √† recoder la roue. Le script <code>putaindecode-cli</code> va avoir besoin de trois choses :</p>
<ul>
<li>une gestion des commandes (commande, argument, aide)</li>
<li>une gestion des couleurs (notice, error, warning)</li>
<li>une capacit√© √† stopper proprement notre code.</li>
</ul>
<h3 id="commander">
      <a class="putainde-Title-anchor" href="#commander">#</a>
      <code>commander</code>
    </h3><p>Pour les commandes avec en prime la gestion des arguments et de l‚Äôaide, <a href="https://github.com/tj/commander">commander</a> est tout a fait adapt√© et r√©pondra pratiquement √† tous nos besoins.</p>
<p>Il est simple d‚Äôutilisation et tr√®s bien maintenu.</p>
<p>Voici un exemple de ce qu‚Äôon peut faire :</p>
<pre><code class="lang-js"><span class="hljs-comment">/* Default */</span>
program
  .version(pkg.version)

<span class="hljs-comment">/* command */</span>
program
  .command(<span class="hljs-string">"command"</span>)
  .alias(<span class="hljs-string">'c'</span>)
  .description(<span class="hljs-string">"   command does something"</span>)
  .option(<span class="hljs-string">"-v, --verbose"</span>, <span class="hljs-string">"Verbose"</span>)
  .option(<span class="hljs-string">"-f, --force"</span>, <span class="hljs-string">"Force installation"</span>)
  .action(commandAction)
  .on(<span class="hljs-string">"--help"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"  Example:"</span>)
    <span class="hljs-built_in">console</span>.log();
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"     command does something"</span>)
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"     $ putaindecode-cli command"</span>)
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">""</span>)
  });

<span class="hljs-comment">/* help */</span>
program.on(<span class="hljs-string">"--help"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"  Examples:"</span>)
  <span class="hljs-built_in">console</span>.log();
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"     command do something"</span>)
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"     $ putaindecode-cli command"</span>)
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">""</span>)
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"     Force command does something"</span>)
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"     $ putaindecode-cli command -f"</span>)
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">""</span>)
});

program.parse(process.argv)

<span class="hljs-comment">/* help by default */</span>
<span class="hljs-keyword">if</span> (!program.args.length) program.help()
</code></pre>
<h3 id="chalk">
      <a class="putainde-Title-anchor" href="#chalk">#</a>
      <code>chalk</code>
    </h3><p><em>Null</em> besoin de faire un cours sur les couleurs, mais l‚Äôaffichage d‚Äôune notice est bien plus pertinent avec sa couleur associ√©e. C‚Äôest √† ce moment qu‚Äôentre en jeu <a href="https://github.com/sindresorhus/chalk">chalk</a>. Relativement simple √† mettre en place et √† utiliser :</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> chalk = <span class="hljs-built_in">require</span>(<span class="hljs-string">'chalk'</span>)

<span class="hljs-comment">/* var */</span>
<span class="hljs-keyword">var</span> error   = chalk.bold.red
<span class="hljs-keyword">var</span> warn    = chalk.yellow
<span class="hljs-keyword">var</span> success = chalk.green
<span class="hljs-keyword">var</span> notice  = chalk.blue

<span class="hljs-comment">/* code */</span>
<span class="hljs-built_in">console</span>.log(warn(<span class="hljs-string">'No command'</span>))
<span class="hljs-built_in">console</span>.log(notice(<span class="hljs-string">"file modified !"</span>))
</code></pre>
<h3 id="exit">
      <a class="putainde-Title-anchor" href="#exit">#</a>
      <code>exit</code>
    </h3><p>Peu importe comment s‚Äôex√©cute son code, il est important de bien savoir maitriser l‚Äôarr√™t de son script. Pour √ßa, <code>process.exit()</code> nous sera bien utile.</p>
<p>Dans le cas d‚Äôune erreur, la valeur de <code>exit</code> doit syst√©matiquement √™tre sup√©rieure √† 0, et donc bien naturellement en cas de succ√®s, elle doit √™tre √©gale √† 0.</p>
<p>Voici une <a href="http://www.virtsync.com/c-error-codes-include-errno">liste des valeurs</a> de <code>exit</code> et de leurs correspondances.</p>
<h2 id="thanks-god-for-our-terminal">
      <a class="putainde-Title-anchor" href="#thanks-god-for-our-terminal">#</a>
      Thanks god for our terminal
    </h2><p>Si vous souhaitez voir quelques exemples de projets avec des commandes et des mises en situations int√©ressantes, allez faire un tour sur ces projets :</p>
<ul>
<li><a href="https://github.com/cssnext/cssnext/blob/master/bin/cssnext.js">cssnext</a></li>
<li><a href="https://github.com/sindresorhus/trash/blob/master/cli.js">trash</a></li>
</ul>
<p>Je vous invite √©galement √† visionner la <a href="http://blog.clement.delafargue.name/posts/2015-02-25-declarative-cli-parsing-in-js.html">vid√©o</a> de <a href="https://twitter.com/clementd">Clement Delafargue</a> qui a fait une pr√©sentation sur le sujet en d√©but d‚Äôann√©e.</p>
<p>√Ä partir de l√† on dispose d‚Äôune bonne base pour refaire le monde et accro√Ætre la flemme du d√©veloppeur que l‚Äôon est en automatisant tout plein de t√¢ches.</p>
]]></description>
            <link>http://putaindecode.fr/posts/shell/utilitaires-ligne-commande/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/shell/utilitaires-ligne-commande/</guid>
            <pubDate>Tue, 12 May 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Utiliser React en moteur de templates]]></title>
            <description><![CDATA[<p>Vous connaissez probablement tous des moteurs de templates.
En JavaScript nous avons Handlebars, Jade, EJS, Slim‚Ä¶
Tous ces projets partent de bonnes intentions mais √† l‚Äôutilisation,
on peut sentir des limitations et donc de l‚Äôinsatisfaction.</p>
<p>Utiliser Handlebars par exemple, c‚Äôest un peu devoir coder tout un tas de helpers
pour g√©rer une partie de votre affichage, √ßa peut vite devenir lourd.
√ätre restreint √† une syntaxe limit√©e par choix est un peu frustrant.
Quand c‚Äôest pas √ßa, c‚Äôest la syntaxe du moteur qui va √™tre lourde.</p>
<p>On peut en venir √† regretter PHP. Faut avouer que ce langage √©tait plut√¥t simple
√† utiliser en tant que moteur de template.
Efficace et pas de restrictions. On trouve m√™me parfois des <code>mysql_query()</code>
dans des templates‚Ä¶</p>
<p>Blague √† part, nous cherchions des langages pour refaire une partie de notre site
puisque nous n‚Äô√©tions pas vraiment satisfaits du processus actuel
(anciennement Handlebars, puis Jade).</p>
<p>Mais finalement, pourquoi ne pas rester avec du JavaScript, purement et simplement ?</p>
<p>C‚Äôest ce que nous avons fait avec React et JSX qui sont de plus en plus utilis√©s.
La syntaxe est plut√¥t lib√©ratrice.</p>
<p>Pour ceux qui ne connaissent pas JSX, il s‚Äôagit d‚Äôun superset de JavaScript qui
supporte une syntaxe XML transform√© en appel de fonctions JavaScript.
Il faut dire que le XML a beau √™tre verbeux, pour d√©finir des
√©l√©ments ayant des propri√©t√©s et des enfants, on a pas vraiment fait plus
lisible et clair sur ce point. Le HTML est plut√¥t simple √† prendre en main c‚Äôest
certain. Les m√©thodes de rendu de React (ce qui va nous int√©resser) sont tr√®s proches
de l‚ÄôHTML.</p>
<p>Ceux qui ont utilis√© JSX (bien qu‚Äôayant pu avoir des naus√©es au premier contact)
avouent souvent qu‚Äôils ont fini par aimer cette petite syntaxe cr√©√©e par Facebook qui
fonctionne tr√®s bien avec React.</p>
<p>Du coup, si on utilisait √ßa pour faire de simple templates et non pas des composants
d‚Äôinterface utilisateur dynamiques ? Qui peut le plus peut le moins (quoi qu‚Äôen
fait, des templates, c‚Äôest un peu des composants d‚Äôinterface).</p>
<h2 id="exemple-de-template-react-jsx">
      <a class="putainde-Title-anchor" href="#exemple-de-template-react-jsx">#</a>
      Exemple de template React/JSX
    </h2><p>Si vous ne savez pas trop ce qu‚Äôest React, nous vous recommandons de lire
notre <a href="/posts/js/introduction-a-reactjs/">introduction √† React</a>.</p>
<p>Dans notre cas, on ne va pas sp√©cialement b√©n√©ficier de certaines de ses forces,
mais √ßa fera tr√®s bien le job pour notre besoin.</p>
<p>Nous n‚Äôaborderons pas dans le d√©tail la syntaxe React/JSX, ni ES6, pour rester
focalis√©s sur la finalit√© (on a pr√©vu des articles √† ce propos, en attendant
  <a href="http://babeljs.io/docs/learn-es6/">voici de quoi vous occuper avec ES6</a>).</p>
<p><em>Attention, pour ceux qui sont encore sur des plugins jQuery, √ßa risque de vous
piquer les yeux</em> üò≠.</p>
<p><a name="es6-class"></a></p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, {Component} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>

export default class PostTemplate extends Component {

  static displayName = <span class="hljs-string">"PostTemplate"</span>

  render() {
    return (
      &lt;html&gt;
        &lt;head&gt;
          &lt;title&gt;{this.props.pageTitle}&lt;/title&gt;
        &lt;/head&gt;
        &lt;body&gt;
          &lt;article className=<span class="hljs-string">"org-Post"</span>&gt;
            &lt;header className=<span class="hljs-string">"org-Post-header"</span>&gt;
              &lt;h1&gt;{this.props.pageTitle}&lt;/h1&gt;
            &lt;/header&gt;
            &lt;div
              className=<span class="hljs-string">"org-Post-content"</span>
              dangerouslySetInnerHTML={{__html: this.props.pageContent}}
            /&gt;
          &lt;/article&gt;
        &lt;/body&gt;
      &lt;/html&gt;
    )
  }
}
</code></pre>
<p>Ce que vous voyez c‚Äôest bien du JavaScript. Un peu am√©lior√© via JSX, on ne va
pas le nier (dans notre cas, on g√®re tout √ßa de mani√®re transparente avec
<a href="http://babeljs.io/">babel(-node)</a>).</p>
<p>√áa ressemble dr√¥lement √† de l‚ÄôHTML et c‚Äôest √ßa qui est appr√©ciable pour nous.
Vous noterez que l‚Äôattribut pour d√©finir une classe HTML est <code>className</code> puisque
React est en JavaScript et que le mot <code>class</code> est r√©serv√©
(cf. <a href="#es6-class">la d√©finition en ES6 de la classe</a>).</p>
<p>En m√™me temps ce qui est cool, c‚Äôest qu‚Äôon reste dans du JavaScript.</p>
<p>On peut donc utiliser toutes nos biblioth√®ques pr√©f√©r√©es via <em>npm</em> pour l‚Äôaffichage
(exemple : <code>momentjs</code>), ou simplement des boucles via les m√©thodes de parcours de
tableau tel que <code>forEach()</code> ou <code>map()</code> en appelant d‚Äôautres composants.</p>
<p>Ci-dessous vous trouverez un exemple plus complexe avec une page pour la liste
des posts et quelques composants.
Les balises qui ressemblent √† du HTML et qui commencent par une majuscule sont li√©es √† des
composants qui doivent √™tre d√©finis (dans notre cas import√©s).
C‚Äôest une particularit√© de React.</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, {Component} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>

<span class="hljs-keyword">import</span> Html <span class="hljs-keyword">from</span> <span class="hljs-string">"../Html"</span>
<span class="hljs-keyword">import</span> Head <span class="hljs-keyword">from</span> <span class="hljs-string">"../Head"</span>
<span class="hljs-keyword">import</span> Body <span class="hljs-keyword">from</span> <span class="hljs-string">"../Body"</span>
<span class="hljs-keyword">import</span> PostsList <span class="hljs-keyword">from</span> <span class="hljs-string">"../PostsList"</span>

export default class Posts extends Component {

  static displayName = <span class="hljs-string">"Posts"</span>

  render() {
    return (
      &lt;Html&gt;
        &lt;Head title={this.props.file.title} /&gt;
        &lt;Body&gt;
          &lt;h1&gt;{this.props.file.title}&lt;/h1&gt;
          &lt;PostsList
            posts={
              this.props.collections.posts
                .filter((item) =&gt; {
                  /*
                    ce que vous voulez pour filtrer votre collection
                    eg:
                    return !item.draft
                  */
                }
              }
          /&gt;
        &lt;/Body&gt;
      &lt;/Html&gt;
    )
  }
}
</code></pre>
<p>Voici deux exemples de composants utilis√©s ci-dessus :</p>
<h3 id="head">
      <a class="putainde-Title-anchor" href="#head">#</a>
      Head
    </h3><pre><code class="lang-js"><span class="hljs-keyword">import</span> React, {Component} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>

export default class Head extends Component {

  static displayName = <span class="hljs-string">"Head"</span>

  render() {
    return (
      &lt;head&gt;
        &lt;meta charSet=<span class="hljs-string">"utf-8"</span> /&gt;
        &lt;meta httpEquiv=<span class="hljs-string">"X-UA-Compatible"</span> content=<span class="hljs-string">"IE=Edge"</span> /&gt;
        &lt;meta
          name=<span class="hljs-string">"viewport"</span>
          content=<span class="hljs-string">"width=device-width, initial-scale=1.0, minimal-ui"</span>
        /&gt;
        &lt;title&gt;{this.props.title}&lt;/title&gt;
        &lt;link
          rel=<span class="hljs-string">"stylesheet"</span>
          href=<span class="hljs-string">"/index.css"</span>
        /&gt;
        &lt;link
          rel=<span class="hljs-string">"alternate"</span>
          href=<span class="hljs-string">"/feed.xml"</span>
          title={this.props.title}
          type=<span class="hljs-string">"application/atom+xml"</span>
        /&gt;
        {this.props.children}
      &lt;/head&gt;
    )
  }
}
</code></pre>
<h3 id="body">
      <a class="putainde-Title-anchor" href="#body">#</a>
      Body
    </h3><pre><code class="lang-js"><span class="hljs-keyword">import</span> React, {Component, PropTypes} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>

<span class="hljs-keyword">import</span> Header <span class="hljs-keyword">from</span> <span class="hljs-string">"../Header"</span>
<span class="hljs-keyword">import</span> Footer <span class="hljs-keyword">from</span> <span class="hljs-string">"../Footer"</span>
<span class="hljs-keyword">import</span> GoogleAnalytics <span class="hljs-keyword">from</span> <span class="hljs-string">"../Analytics"</span>

export default class Body extends Component {

  static displayName = <span class="hljs-string">"Body"</span>

  render() {
    return (
      &lt;body&gt;

        &lt;Header /&gt;

        &lt;div className=<span class="hljs-string">"Main"</span>&gt;
          {this.props.children}
        &lt;/div&gt;

        &lt;Footer /&gt;

        &lt;script src={<span class="hljs-string">"/index.js"</span>}&gt;&lt;/script&gt;

        &lt;GoogleAnalytics /&gt;

      &lt;/body&gt;
    )
  }
}
</code></pre>
<p>Bon c‚Äôest bien beau mais comment je g√®re l‚Äôaffichage du composant initial
finalement (le parent) ?</p>
<h2 id="comment-utiliser-un-template-react-jsx">
      <a class="putainde-Title-anchor" href="#comment-utiliser-un-template-react-jsx">#</a>
      Comment utiliser un template React/JSX ?
    </h2><p>C‚Äôest bien simple. Dans notre cas, pas besoin de React c√¥t√© client. On doit g√©rer
√ßa c√¥t√© ¬´ serveur ¬ª (je mets √ßa entre guillemets puisque dans notre cas pr√©cis, c‚Äôest
pour g√©n√©rer un site statique, et c‚Äôest donc sur une machine quelconque que la
g√©n√©ration se fait).</p>
<p>Voil√† de quoi effectuer le rendu de nos composants vers du bon vieux HTML (car c‚Äôest la finalit√©
d‚Äôun <em>moteur de template</em>).</p>
<pre><code class="lang-js">import react from &quot;react&quot;
import markdownify from &quot;./markdown-parser&quot;
// je vous conseille marked pour rendre du markdown
// c&#39;est ce que nous utilisons pour rendre nos pages √† l&#39;heure o√π j&#39;√©cris ce post

const reactClass = require(&quot;./template/PostTemplate&quot;)
const component = new (react.createFactory(reactClass))({
  // ici on passe nos &quot;props&quot; react
  pageTitle: &quot;Test&quot;,
  pageContent: markdownify(&quot;Imaginons du **markdown** pars√©&quot;),
  // vous pouvez bien entendu rajouter d&#39;autres choses
  collections: {
    posts: [
      //...
    ]
  }
})

let html
try {
  html = react.renderToStaticMarkup(component)
}
catch (err) {
  // Vous devrez g√©rer votre exception selon votre environnement
  // si c&#39;est pour un test on peut simplement ne pas utiliser
  // try/catch, √ßa nous p√®tera √† la gueule et c&#39;est tant mieux
  throw err
}

// maintenant vous faites ce que vous voulez de votre string html !
// ex: require(&quot;fs&quot;).writeFile(...)
</code></pre>
<p>La m√©thode int√©ressante de React est dans notre cas <code>renderToStaticMarkup()</code> qui
va nous g√©n√©rer un HTML qui va bien.</p>
<p>Pour aller plus loin on pourrait d√©cider d‚Äôutiliser <code>renderToString()</code> plut√¥t que
<code>renderToStaticMarkup()</code> afin de pouvoir faire prendre le relais √† ReactJS c√¥t√© client
mais l√† <a href="/posts/js/reactjs-et-rendu-serverside/">le niveau de complexit√© est diff√©rent</a>.</p>
<p>Pour la petite anecdote, notre site utilise actuellement <a href="http://www.metalsmith.io/">metalsmith</a>,
une petite biblioth√®que simple mais qui permet par son API de faire des choses sympas.</p>
<p>J‚Äôai donc cod√© <a href="https://github.com/search?q=user%3AMoOx+metalsmith">quelques plugins metalsmith</a>
dont un <a href="https://github.com/MoOx/metalsmith-react">metalsmith-react</a> √† l‚Äôoccasion.</p>
<p>N‚Äôh√©sitez pas √† consulter
<a href="https://github.com/putaindecode/putaindecode.fr">le code source de notre site</a>
pour faire des d√©couvertes sympas.</p>
]]></description>
            <link>http://putaindecode.fr/posts/js/utiliser-react-en-moteur-de-templates/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/utiliser-react-en-moteur-de-templates/</guid>
            <pubDate>Thu, 07 May 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Impl√©menter Flux]]></title>
            <description><![CDATA[<p>Si vous n‚Äôavez pas encore lu
<a href="http://putaindecode.fr/posts/js/flux-qu-est-ce-c-est/">l‚Äôintroduction √† flux</a>,
n‚Äôh√©sitez pas √† jeter un ≈ìil avant de lire ce post.</p>
<p>Une des choses importantes avec Flux, et pourtant pas √©videntes apr√®s lecture
<a href="https://github.com/facebook/flux/tree/master/examples/">des exemples officiels</a>,
c‚Äôest que les stores doivent √™tre des instances, et non des singletons que
les composants r√©cup√®rent en d√©pendance directe.</p>
<p>La raison de cette n√©cessit√©, c‚Äôest la possibilit√© de servir une page
pre-rendue sur le serveur. En soi, vous devez imp√©rativement amorcer votre
dispatcher et vos stores dans le scope de la requ√™te, ou vos utilisateurs
se retrouveront avec des stores remplis de data ne leur appartenant pas.</p>
<p>Puisque l‚Äôint√©r√™t d‚Äôune solution comme react dans le cadre du server-side
rendering est d‚Äôutiliser les m√™mes composants que sur le client, il faut
que notre approche soit convenable sur nos deux environements.</p>
<p>La question d√®s lors est ¬´comment passer les stores √† nos composants react
maintenant qu‚Äôils ne sont plus des d√©pendances directes ?¬ª.</p>
<p>On va les passer via les <code>props</code> de parent √† enfant ? lolnope.
La plupart de nos composants n‚Äôauront pas conscience de la pr√©sence de ces
stores, et seront utilis√©s dans diff√©rents contextes. Et c‚Äôest justement
l‚ÄôAPI <code>context</code> que nous allons utiliser.</p>
<p>Cette API est assez simple, en soi, le <code>context</code> d‚Äôun composant est construit
au fur et √† mesure que ses anc√™tres d√©cident d‚Äôy ajouter de la data.</p>
<p>Exemple simple :</p>
<pre><code class="lang-javascript">import React, {Component, PropTypes} from "react"

class App extends Component {

  // on d√©finit les types de ce que l'on souhaite passer dans
  // le contexte
  static childContextTypes = {
    foo: PropTypes.string,
  }

  // on cr√©e une m√©thode qui retourne ce contexte
  getChildContext() {
    return {
      foo: this.props.foo,
    }
  }

  render() {
    return (
      &lt;div className="putainde-App"&gt;
        &lt;Container /&gt;
      &lt;/div&gt;
    )
  }
}

class Container extends Component {

  // les contextes sont *merged*, ce qui nous permet de le construire
  // sans se soucier du niveau auquel sera notre composant.
  static childContextTypes = {
    bar: PropTypes.string,
  }

  getChildContext() {
    return {
      bar: "oh hai",
    }
  }

  render() {
    return (
      &lt;div className="putainde-Container"&gt;
        &lt;IntermediaryComponent /&gt;
      &lt;/div&gt;
    )
  }

}

// ce composant n'a pas besoin de savoir que ses enfants on besoin
// de certaines propri√©t√©s du contexte
class IntermediaryComponent extends Component {
  render() {
    return (
      &lt;Content /&gt;
    )
  }
}

class Content extends Component {

  // pour chaque composant utilisant des propri√©t√©s du contexte,
  // on stipule ce dont on a besoin
  static contextTypes = {
    foo: PropTypes.string,
    bar: PropTypes.string,
  }

  render() {
    return (
      &lt;div className="putainde-Content"&gt;
        &lt;div className="putainde-Content-line"&gt;
          &lt;strong&gt;foo&lt;/strong&gt;: {this.context.foo}
        &lt;/div&gt;
        &lt;div className="putainde-Content-line"&gt;
          &lt;strong&gt;bar&lt;/strong&gt;: {this.context.bar}
        &lt;/div&gt;
      &lt;/div&gt;
    )
  }

}

React.render(
  &lt;App foo={Date.now()} /&gt;,
  document.getElementById("App")
)
</code></pre>
<p>Cela nous donne cet output :
<a href="http://jsbin.com/zitohibaze/1/">http://jsbin.com/zitohibaze/1/</a></p>
<p>Gr√¢ce √† cette API, on peut cr√©er des composants isol√©s, et dont les
composants parents n‚Äôauront pas n√©cessairement besoin de conna√Ætre le
contexte.</p>
<p>L‚Äôid√©e, pour en revenir √† Flux, c‚Äôest de passer notre dispatcher dans
ce contexte, et de placer les stores dans le dispatcher au moment de
l‚Äôamorce de l‚Äôapp.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> dispatcher = <span class="hljs-keyword">new</span> Dispatcher()

dispatcher.registerStore(<span class="hljs-keyword">new</span> SomeStore())
dispatcher.registerStore(<span class="hljs-keyword">new</span> SomeOtherStore())

React.render(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">App</span> <span class="hljs-attribute">dispatcher</span>=<span class="hljs-value">{dispatcher}</span> /&gt;</span>,
  document.getElementById("App")
)</span>
</code></pre>
<p>D√©sormais, pour avoir une API d√©cente pour r√©cuperer les donn√©es des stores,
on a deux principales solutions:</p>
<ul>
<li>utiliser un mixin</li>
<li>utiliser un higher-order component</li>
</ul>
<p>Puisque la direction que prend l‚ÄôAPI de React, √† terme, est de ne plus
fournir de mixins, et de laisser au TC39 le temps de prendre la bonne
d√©cision sur la fa√ßon dont JavaScript traitera la composition ; il semble
plus ad√©quat d‚Äôutiliser un higher-order component. Cela aura en plus
l‚Äôavantage de rendre le composant r√©cup√©rant les donn√©es <em>stateless</em>.</p>
<p>Ce genre d‚ÄôAPI ressemble √† √ßa :</p>
<pre><code class="lang-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComponentWithData</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  static stores = {
    <span class="hljs-comment">// nom du store: nom de la prop souhait√©e</span>
    MyStore: <span class="hljs-string">"my_store"</span>,
  }

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
        {/* la data est pass√©e via les props*/}
        {this.props.my_store.foo}
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    )</span>
  }
}

<span class="hljs-comment">// storeReceiver wrap `ComponentWithData` dans un higher-order component</span>
<span class="hljs-comment">// et se charge de r√©cup√©rer le store dans le contexte pour les passer</span>
<span class="hljs-comment">// dans les props de `ComponentWithData`</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> storeReceiver(ComponentWithData)
</code></pre>
<p>Enfin, avec cette approche, les action creators que l‚Äôon voit dans les
exemples de flux ne peuvent plus garder la m√™me forme, puisqu‚Äôil ne doivent
plus avoir le dispatcher comme d√©pendance directe (ce dernier √©tant une
instance). Du coup, ce sont d√©sormais des fonctions pures :</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> PostActions = {
  getPost(slug) {
    <span class="hljs-keyword">return</span> {
      type: ActionTypes.POST_GET,
      slug: slug,
    }
  },
  receivePost(res) {
    <span class="hljs-keyword">return</span> {
      type: ActionTypes.POST_RECEIVE,
      res,
    }
  },
  error(res) {
    <span class="hljs-keyword">return</span> {
      type: ActionTypes.POST_ERROR,
      res,
    }
  },
}
</code></pre>
<p>et nos composants utilisent :</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React, {Component, PropTypes} <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
<span class="hljs-keyword">import</span> PostActions <span class="hljs-keyword">from</span> <span class="hljs-string">"actions/PostActions"</span>

class MyComponent extends Component {

  static contextTypes = {
    dispatcher: PropTypes.object,
  }

  static propTypes = {
    slug: PropTypes.string,
    title: PropTypes.title,
  }

  handleClick() {
    this.context.dispatcher.dispatch(
      PostActions.getPost(this.props.slug)
    )
  }

  render() {
    return (
      &lt;button
        onClick={() =&gt; this.handleClick()}&gt;
        {this.props.title}
      &lt;/button&gt;
    )
  }
}
</code></pre>
<p>Pour r√©sumer, les avantages de cette approche sont :</p>
<ul>
<li>un meilleur d√©couplage</li>
<li>une isolation solide des composants</li>
<li>la possibilit√© de pre-render sur le serveur</li>
<li>une testabilit√© accrue, puisqu‚Äôil est simple d‚Äôutiliser un mock ou des
instances cr√©es pour le test dans le contexte de nos composants.</li>
</ul>
<p>Bisous bisous.</p>
]]></description>
            <link>http://putaindecode.fr/posts/js/implementer-flux/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/implementer-flux/</guid>
            <pubDate>Fri, 01 May 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[HATEOAS, le Graal des d√©veloppeurs d'API]]></title>
            <description><![CDATA[<p>Nous vivons aujourd‚Äôhui dans un monde o√π tout devient service. Twitter, Facebook, Google Drive, GitHub, tout le monde y va de sa petite API pour que nous, geeks, puissions profiter pleinement des moult fonctionnalit√©s offertes par ces plateformes. Qu‚Äôentend-on par service ? Comment les rendre disponibles facilement et intelligemment ? On va essayer d‚Äôy r√©pondre ! </p>
<h2 id="les-webservices">
      <a class="putainde-Title-anchor" href="#les-webservices">#</a>
      Les webservices
    </h2><p>Rappelons juste, pour mettre tout le monde d‚Äôaccord, ce qui se passe pendant une simple navigation web.</p>
<ol>
<li>Tu tapes l‚Äôadresse de ton site pr√©f√©r√©</li>
<li>Le navigateur envoie la requ√™te</li>
<li>Le navigateur re√ßoit du code HTML et l‚Äôinterpr√®te, pour voir s‚Äôil faut charger d‚Äôautres choses</li>
<li>Le navigateur relance les requ√™tes pour charger les images, scripts et CSS</li>
<li>Le navigateur re√ßoit toutes les ressources et te les affiche dans sa fen√™tre.</li>
</ol>
<p>On parle donc de contenu qu‚Äôil faut afficher pour les √™tres humains, avec des images, des styles et des comportements qui facilitent l‚Äôergonomie et te permettent de dire <em>‚Äúwouaouw, ce site est vraiment beau, cool et pratique !‚Äù</em></p>
<p>Imaginons maintenant la m√™me chose, mais √† destination des programmes, qui ne consomment que de l‚Äôinformation brute et structur√©e, on ne va donc plus s‚Äôencombrer avec les CSS, les JS, et autres gifs anim√©s (oui, les gifs anim√©s, √ßa les fait pas marrer les machines‚Ä¶) ! On va se concentrer sur le contenu √©chang√© et sur les moyens utilis√©s pour optimiser ces √©changes.</p>
<h3 id="la-premiere-ecole-soap">
      <a class="putainde-Title-anchor" href="#la-premiere-ecole-soap">#</a>
      La premi√®re √©cole : SOAP
    </h3><p>Imaginons deux programmes qui veulent discuter en passant par le web. Dans les ann√©es 90, des mecs super brillants se sont dit : <em>‚ÄúOn va se baser sur le XML pour faire communiquer nos programmes sur le web‚Äù</em>.
L‚Äôapproche est assez logique et ing√©nieuse. Tout d‚Äôabord, les deux parties (le client et le serveur) se partagent une notice d‚Äôutilisation : la WSDL (Web Service Description Language), qui est un document XML d√©crivant toutes les m√©thodes qui peuvent √™tre appel√©es par le client sur le serveur, avec les structures de donn√©es disponibles pour ces √©changes.
Le client pr√©pare donc sa demande et l‚Äôenveloppe dans une grosse structure XML contenant toutes les m√©tadonn√©es (m√©thode appel√©e, signature num√©rique, etc.). Une fois que le serveur a re√ßu cette demande, il la traite et r√©pond aussi dans une grosse enveloppe XML.</p>
<p>Tu viens de comprendre le SOAP (Service Oriented Application Protocol), aucun rapport avec une quelconque savonnette du coup. Cette m√©thode a fait ses preuves puisqu‚Äôelle fait tourner encore aujourd‚Äôhui des milliers de syst√®mes tr√®s complexes et tr√®s fiables.</p>
<h3 id="la-maison-d-en-face-rest">
      <a class="putainde-Title-anchor" href="#la-maison-d-en-face-rest">#</a>
      La maison d‚Äôen face : REST
    </h3><p>Plusieurs ann√©es ont pass√©es et les esprits ont √©volu√©. On a commenc√© √† entendre des grandes d√©clarations comme : <em>‚ÄúLe SOAP c‚Äôest vraiment lourdingue !‚Äù</em>, <em>‚ÄúLe protocole HTTP est sous-exploit√© !‚Äù</em> ou encore <em>‚ÄúLes enveloppes XML et les WSDL ? Merci bien !‚Äù</em> et c‚Äôest √† ce moment-l√† qu‚Äôon a donn√© un acronyme bidon pour d√©crire le protocole HTTP sans vraiment le nommer : REST (REpresentational State Transfert). Pour l‚Äôanecdote, tout le monde s‚Äôaccorde √† dire que cet acronyme ne veut rien dire ;)</p>
<p>Le but du jeu est donc d‚Äôutiliser au maximum les possibilit√©s du protocole HTTP, les verbes, les URL et les codes retours pour d√©crire des API de la mani√®re la plus fid√®le possible. On a donc gagn√© en simplicit√© et la communication entre machines se veut d√©sormais √† la port√©e de tous. Je reviendrai en d√©tail sur le protocole HTTP un peu plus tard.</p>
<h3 id="un-partout-balle-au-centre">
      <a class="putainde-Title-anchor" href="#un-partout-balle-au-centre">#</a>
      Un partout : balle au centre
    </h3><p>Je tiens √† remettre les choses au clair. On entend beaucoup trop souvent : <em>‚ÄúFais du REST, SOAP c‚Äôest nul‚Äù</em>. Il y a en effet clairement un effet de mode ! Les API REST pullulent et sont vraiment tr√®s pratiques. Toutefois, dans les gros syst√®mes n√©cessitant du RPC ou encore de la signature num√©rique, pour les √©changes de donn√©es m√©dicales par exemple, le contrat WSDL et la rigueur du XML sont clairement des alli√©s ! </p>
<h2 id="alors-comme-ca-http-ca-fait-tout">
      <a class="putainde-Title-anchor" href="#alors-comme-ca-http-ca-fait-tout">#</a>
      Alors comme √ßa, HTTP √ßa fait tout ?
    </h2><p>Il y a un type qui s‚Äôappelle Leonard Richardson et qui a mis en place un <a href="http://martinfowler.com/articles/richardsonMaturityModel.html">mod√®le de maturit√©</a> pour qualifier les API webservice.</p>
<h3 id="niveau-0">
      <a class="putainde-Title-anchor" href="#niveau-0">#</a>
      Niveau 0
    </h3><p>C‚Äôest le minimum acceptable dans la communication HTTP :</p>
<ul>
<li>Toutes les requ√™tes sont envoy√©es √† la m√™me URL, quelle que soit la demande.</li>
<li>Toutes les requ√™tes sont envoy√©es avec le verbe POST.</li>
<li>Quel que soit le type de retour (donn√©e ou erreur), le code HTTP retourn√© par le serveur sera toujours 200 (OK, tout s‚Äôest bien pass√©).</li>
<li>Le contenu √©chang√© est majoritairement du XML (pour les enveloppes notamment).</li>
</ul>
<p>Quand on fait du webservice avec SOAP, c‚Äôest ce niveau qui est utilis√© lors de la communication HTTP.</p>
<h3 id="niveau-1">
      <a class="putainde-Title-anchor" href="#niveau-1">#</a>
      Niveau 1
    </h3><p>Avec ce premier niveau, on essaye d‚Äôenrichir un peu plus l‚Äôutilisation. On ajoute la notion de <em>ressource</em>, en fonction de la donn√©e m√©tier manipul√©e, l‚ÄôURL de la requ√™te sera diff√©rente. La preuve par l‚Äôexemple :</p>
<ul>
<li><strong><em>POST /agenda</em></strong> : permet de travailler avec les donn√©es de l‚Äôagenda de l‚Äôapplication</li>
<li><strong><em>POST /customers</em></strong> : permet de travailler avec le registre des clients  </li>
</ul>
<p>On profite aussi de la vue hi√©rarchique que nous proposent les URL :</p>
<ul>
<li><strong><em>POST /customers/42</em></strong> : permet de travailler avec le client qui poss√®de l‚Äôidentifiant 42</li>
</ul>
<p>Rien qu‚Äôen tra√ßant les URL appel√©es sur le serveur, on peut comprendre ce que le client HTTP cherche √† faire‚Ä¶ pas d√©gueu, non ?</p>
<h3 id="niveau-2">
      <a class="putainde-Title-anchor" href="#niveau-2">#</a>
      Niveau 2
    </h3><p>Le protocole HTTP utilise des verbes pour les requ√™tes et des codes num√©riques pour les retours. Ce sont ces deux m√©canismes qui seront utilis√©s en compl√©ment du niveau 1.</p>
<p>Les principaux verbes HTTP que l‚Äôon utilise sont GET, POST, PUT et DELETE. Leur nom est d√©j√† tr√®s √©vocateur.</p>
<ul>
<li><strong><em>GET /customers/42</em></strong> pour r√©cup√©rer les informations du client 42</li>
<li><strong><em>PUT /customers</em></strong> <em>(+ corps de la requ√™te)</em> pour enregistrer un nouveau client</li>
<li><strong><em>POST /customers/42</em></strong> <em>(+ corps de la requ√™te)</em> pour mettre √† jour les informations du client 42</li>
<li><strong><em>DELETE /customers/42</em></strong> pour supprimer le client 42</li>
</ul>
<p>Facile, non ? La r√©ponse du serveur devient tout aussi logique gr√¢ce aux codes HTTP.
Ces codes sont juste des nombres de 3 chiffres respectant cette logique :</p>
<ul>
<li><strong><em>1xx</em></strong> : <em>‚ÄúJe suis en train de bosser, attends encore un peu.‚Äù</em></li>
<li><strong><em>2xx</em></strong> : <em>‚ÄúVoil√† le r√©sultat, √ßa s‚Äôest bien pass√©.‚Äù</em></li>
<li><strong><em>3xx</em></strong> : <em>‚ÄúLe contenu est d√©plac√©, va voir ailleurs (cf. en-t√™te location).‚Äù</em></li>
<li><strong><em>4xx</em></strong> : <em>‚ÄúTu me demandes n‚Äôimporte quoi, tu as merd√©.‚Äù</em></li>
<li><strong><em>5xx</em></strong> : <em>‚ÄúJ‚Äôai merd√©‚Ä¶‚Äù</em></li>
</ul>
<p>Parmi les plus connus, on a donc 404 (<em>‚Äútu me demandes quelque chose qui n‚Äôexiste pas‚Äù</em>), 403 (<em>‚Äúacc√®s interdit‚Äù</em>), 304 (<em>‚Äúpas la peine de m‚Äôemmerder, la donn√©e est dans ton cache‚Äù</em>) et bien s√ªr 200 (<em>‚ÄúOK, tout va bien‚Äù</em>).</p>
<p>Et si les codes HTTP sont ta nouvelle passion, je te sugg√®re de te documenter sur le code <a href="http://fr.wikipedia.org/wiki/Hyper_Text_Coffee_Pot_Control_Protocol">418</a> !</p>
<h3 id="niveau-3-hateoas">
      <a class="putainde-Title-anchor" href="#niveau-3-hateoas">#</a>
      Niveau 3 : HATEOAS
    </h3><p>Alors on a les verbes HTTP et les codes retours. √Ä quoi peut ressembler le Graal des API REST alors ? Si on r√©fl√©chit un peu, on peut se dire qu‚Äôil faudrait, pour toutes les URL, donner un code retour HTTP coh√©rent pour chaque verbe, logique non ? De cette mani√®re, on peut entamer un v√©ritable dialogue avec le serveur HTTP, enti√®rement bas√© sur REST. Voil√† une bonne nouvelle pour ceux qui veulent tailler une bavette ailleurs que sur Google Hangouts !</p>
<p>Un petit exemple de dialogue : </p>
<pre><code>&gt; <span class="hljs-type">GET</span> /customers/<span class="hljs-number">42</span>
<span class="hljs-number">200</span> <span class="hljs-type">OK</span>

&gt; <span class="hljs-type">PUT</span> /customers/<span class="hljs-number">42</span> <span class="hljs-decorator">{...}</span>
<span class="hljs-number">409</span> <span class="hljs-type">Conflict</span>

&gt; <span class="hljs-type">DELETE</span> /customers/<span class="hljs-number">42</span>
<span class="hljs-number">204</span> <span class="hljs-type">No</span> <span class="hljs-type">Content</span>

&gt; <span class="hljs-type">GET</span> /customers/<span class="hljs-number">42</span>
<span class="hljs-number">404</span> <span class="hljs-type">Not</span> <span class="hljs-type">Found</span>
</code></pre><p>C‚Äôest un bon d√©but, mais ce niveau 3 va quand m√™me un peu plus loin ! N‚Äôas-tu jamais trouv√© g√©nial qu‚Äôavec de simples liens dans les pages web, tu pouvais naviguer des heures et des heures ? </p>
<p>Pourquoi ne pas ajouter des liens dans les ressources retourn√©es via REST ? Nous venons de mettre le doigt sur HATEOAS (<em>Hypermedia As The Engine Of Application State</em>). On peut d√©sormais imaginer un tas de choses comme :</p>
<ul>
<li>Quand on renvoie un tableau json par exemple, dans chaque item, <ul>
<li>on peut ajouter les liens qui permettent de le mettre √† jour ;</li>
<li>on peut ajouter les liens qui permettent de r√©cup√©rer des donn√©es li√©es comme l‚Äôauteur d‚Äôun livre, les mentions d‚Äôun tweet, etc. ;</li>
<li>on peut ajouter l‚ÄôURL de putaindecode.fr.</li>
</ul>
</li>
</ul>
<p>Voici un exemple de trame JSON avec les informations HATEOAS. Pour information, il s‚Äôagit d‚Äôun webservice qui permet de lister des conf√©rences.</p>
<pre><code><span class="hljs-collection">[
  <span class="hljs-collection">{
    <span class="hljs-string">"conference"</span>: <span class="hljs-collection">{
      <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,
      <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
        <span class="hljs-collection">{
          <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
          <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/conferences/"</span>
        }</span>,
        <span class="hljs-collection">{
          <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
          <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/conferences/1"</span>
        }</span>
      ]</span>,
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"Take Off Conf 2013"</span>,
      <span class="hljs-string">"startDate"</span>: <span class="hljs-string">"2013-01-17T00:00:00+01:00"</span>,
      <span class="hljs-string">"endDate"</span>: <span class="hljs-string">"2013-01-18T00:00:00+01:00"</span>,
      <span class="hljs-string">"talks"</span>: <span class="hljs-collection">[
        <span class="hljs-collection">{
          <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,
          <span class="hljs-string">"speakerName"</span>: <span class="hljs-string">"Jakob Mattsson"</span>,
          <span class="hljs-string">"title"</span>: <span class="hljs-string">"You are not service oriented enough!"</span>,
          <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/1"</span>
            }</span>,
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/"</span>
            }</span>
          ]</span>
        }</span>,
        <span class="hljs-collection">{
          <span class="hljs-string">"id"</span>: <span class="hljs-number">2</span>,
          <span class="hljs-string">"speakerName"</span>: <span class="hljs-string">"Olivier Lacan"</span>,
          <span class="hljs-string">"title"</span>: <span class="hljs-string">"Science-based development"</span>,
          <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/2"</span>
            }</span>,
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/"</span>
            }</span>
          ]</span>
        }</span>,
        <span class="hljs-collection">{
          <span class="hljs-string">"id"</span>: <span class="hljs-number">3</span>,
          <span class="hljs-string">"speakerName"</span>: <span class="hljs-string">"Xavier Coulon"</span>,
          <span class="hljs-string">"title"</span>: <span class="hljs-string">"Build your website with awestruct and publish..."</span>,
          <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/3"</span>
            }</span>,
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/"</span>
            }</span>
          ]</span>
        }</span>,
        <span class="hljs-collection">{
          <span class="hljs-string">"id"</span>: <span class="hljs-number">4</span>,
          <span class="hljs-string">"speakerName"</span>: <span class="hljs-string">"R√©mi Parmentier"</span>,
          <span class="hljs-string">"title"</span>: <span class="hljs-string">"Design for developers"</span>,
          <span class="hljs-string">"links"</span>: <span class="hljs-collection">[
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"self"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/4"</span>
            }</span>,
            <span class="hljs-collection">{
              <span class="hljs-string">"rel"</span>: <span class="hljs-string">"list"</span>,
              <span class="hljs-string">"href"</span>: <span class="hljs-string">"http://localhost:8080/hateoas-webservice/rs/talks/"</span>
            }</span>
          ]</span>
        }</span>
      ]</span>
    }</span>
  }</span>,<span class="hljs-collection">{
  ...
  }</span> 
]</span>
</code></pre><p>Dans cette trame, tu auras remarqu√© les objets dans les tableaux nomm√©s ‚Äúlinks‚Äù, ce sont les liens disponibles pour chacun des objets renvoy√©s ! On peut imaginer qu‚Äôen fonction des droits de l‚Äôutilisateur courant, il y ait plus ou moins de liens.</p>
<h2 id="est-ce-que-c-est-standard">
      <a class="putainde-Title-anchor" href="#est-ce-que-c-est-standard">#</a>
      Est-ce que c‚Äôest standard ?
    </h2><p>Eh bien non ! Il n‚Äôy a pas vraiment de convention pour l‚Äô√©criture des liens dans les trames renvoy√©es. Cela d√©pend du format renvoy√© dans un premier temps. Comment formaliser un standard si on renvoie en JSON, XML et YML en fonction des en-t√™tes HTTP du client ?</p>
<p>De la m√™me mani√®re, tu auras remarqu√© que l‚Äôon ne pr√©cise pas le verbe HTTP √† utiliser sur les URL. C‚Äôest la raison pour laquelle il faut impl√©menter un retour coh√©rent pour tous les verbes HTTP courants !</p>
<p>Et pour finir, comment conna√Ætre le format du document JSON accept√© avec les requ√™tes POST par exemple ? Il n‚Äôy a pas non plus de r√®gle ! On pourrait imaginer par exemple un document ‚Äútype‚Äù qui serait renvoy√© apr√®s une requ√™te ‚ÄúOPTION‚Äù sur l‚ÄôURL.</p>
<p>Il y a toutefois quelques exp√©rimentations comme <a href="http://en.wikipedia.org/wiki/Hypertext_Application_Language">HAL</a> ou encore <a href="http://jsonapi.org/">JSON API</a> qui tentent de normaliser un peu ce flou artistique.</p>
<p>Tu fais ta petite popote ! Tu fais comme tu veux ! √áa a du bon aussi !</p>
<h2 id="bon-ok-je-fais-comment-pour-le-mettre-en-place-maintenant">
      <a class="putainde-Title-anchor" href="#bon-ok-je-fais-comment-pour-le-mettre-en-place-maintenant">#</a>
      ‚ÄúBon ok, je fais comment pour le mettre en place maintenant ?‚Äù
    </h2><p>Tu remontes tes manches et tu te d√©merdes !</p>
<p>Il y a quelques frameworks qui vont te donner un coup de main. Dans le monde Java par exemple, il existe <a href="http://docs.jboss.org/resteasy/docs/2.0.0.GA/userguide/html/LinkHeader.html">Resteasy-links</a> (avec un exemple d‚Äôutilisation <a href="https://github.com/awillemant/hateoas-example">sur mon repo GitHub</a>), ou encore <a href="http://projects.spring.io/spring-hateoas/">Spring HATEOAS</a></p>
<p>Pour les <em>Nodistes</em>, une simple recherche sur <a href="https://www.npmjs.com/search?q=hateoas">npmjs</a> renverra un tas d‚Äôoutils ! </p>
<h2 id="references">
      <a class="putainde-Title-anchor" href="#references">#</a>
      R√©f√©rences
    </h2><p>Oui, parce qu‚Äôil y a des gens bien plus brillants que moi pour vous convaincre sur l‚ÄôHypermedia !</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/HATEOAS">Wikip√©dia</a></li>
<li><a href="http://martinfowler.com/articles/richardsonMaturityModel.html">Blog de Martin Fowler</a></li>
<li>Les travaux de Steve Klabnik, Rubyiste reconnu (ex : <a href="https://www.youtube.com/watch?v=g4sqydY3hHU">Designing Hypermedia APIs</a>)</li>
<li>Ori Pekelman : <a href="https://www.youtube.com/watch?v=ZZxOaCP8vyg">son talk √† la Take Off Conf 2014</a></li>
<li><a href="http://blog.xebia.fr/2014/03/17/post-vs-put-la-confusion/">Un excellent article de Xebia sur la bonne utilisation de POST et PUT</a></li>
</ul>
]]></description>
            <link>http://putaindecode.fr/posts/api/hateoas/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/api/hateoas/</guid>
            <pubDate>Thu, 12 Mar 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Du CSS √©volutif]]></title>
            <description><![CDATA[<p>Modulaire, maintenable, r√©utilisable, accessible. Ces termes sont au c≈ìur de nos m√©tiers et on nous les rab√¢che toute la journ√©e.</p>
<p>Malgr√© la grossi√®ret√© de ces mots pour certains d‚Äôentre vous, il est tout √† fait possible de pondre du CSS en utilisant tous ces principes.</p>
<h2 id="maintenable">
      <a class="putainde-Title-anchor" href="#maintenable">#</a>
      Maintenable
    </h2><p>L‚Äôun des trucs les plus chiants du CSS c‚Äôest bien la cascade, qui, malgr√© sa bonne volont√©, n‚Äôapporte pas que des solutions. Pour pallier aux probl√®mes que l‚Äôon peut vite cr√©er, <a href="http://putaindecode.fr/posts/css/petite-definition-bem/">la m√©thodologie BEM</a> a vu le jour avec son <a href="http://blog.kaelig.fr/post/48196348743/fifty-shades-of-bem">lot de variantes</a>.</p>
<p>La grande majorit√© des membres de p! utilisent cette convention :</p>
<pre><code class="lang-css"><span class="hljs-class">.MyComponent</span> <span class="hljs-rules">{}</span>
<span class="hljs-class">.MyComponent</span><span class="hljs-class">.is-state</span> <span class="hljs-rules">{}</span>
<span class="hljs-class">.MyComponent--modifier</span> <span class="hljs-rules">{}</span>

<span class="hljs-class">.MyComponent-element</span> <span class="hljs-rules">{}</span>
<span class="hljs-class">.MyComponent-anotherElement</span> <span class="hljs-rules">{}</span>
</code></pre>
<p>D‚Äôun coup d‚Äô≈ìil, on devine la structure <code>HTML</code> qui en d√©coule et l‚Äôutilit√© de chaque √©l√©ment. Les √©tats sont toujours les m√™mes et clairement identifiables car commen√ßant par <code>is-*</code>, de m√™me que les √©l√©ments d√©finis par <code>-</code> ainsi que les modificateurs <code>--</code>.</p>
<p>Avec cette m√©thodologie rares sont les s√©lecteurs d√©passant :</p>
<pre><code class="lang-css"><span class="hljs-class">.MyComponent-element</span> <span class="hljs-class">.MyComponent-anotherElement</span> <span class="hljs-rules">{}</span>
</code></pre>
<p>L‚Äôint√©r√™t ? Apporter de la s√©mantique √† notre code CSS, en utilisant des classes, des classes et des classes afin de clairement s‚Äôabstraire de la cascade. Finis les <code>!important</code>, on √©vite ainsi les probl√®mes d‚Äô√©l√©ments et les soudains changements de structure HTML qui te forcent √† r√©√©crire tes s√©lecteurs.</p>
<p>Cette m√©thode est d‚Äôailleurs, entre autres, utilis√©e par <a href="http://twitter.com">Twitter</a> via <a href="http://suitcss.github.io/">SUIT CSS</a>.</p>
<h2 id="modulaire">
      <a class="putainde-Title-anchor" href="#modulaire">#</a>
      Modulaire
    </h2><p>Partant de notre m√©thodologie, on va d√©velopper notre site web comme un gros Lego. Chaque partie graphique de notre projet sera un composant, une brique.</p>
<p>On pourrait imaginer des √©l√©ments comme <code>NavBar</code>, <code>Pagination</code>, <code>Article</code> que l‚Äôon va assembler au fur et √† mesure de notre d√©veloppement. Notre site sera compos√© de plusieurs dizaines de fichiers (<code>Composant</code>), mais aucun n‚Äôexc√®dera quelques centaines de lignes, grand maximum. Beaucoup plus facile √† d√©bugger et donc sur le long terme plus maintenable.</p>
<p>Il va de soi qu‚Äôon utilisera son outil pr√©f√©r√© pour concat√©ner et minimiser le tout en un seul fichier, sinon on risque d‚Äôavoir quelques probl√®mes de <em>webperf</em>.</p>
<h2 id="accessible">
      <a class="putainde-Title-anchor" href="#accessible">#</a>
      Accessible
    </h2><p>Pour obtenir un design adaptatif ou accessible, il est n√©cessaire d‚Äôutiliser des unit√©s dites relatives. C‚Äôest √† ce moment qu‚Äôinterviennent les unit√©s stars du moment que sont <code>em</code> et <code>rem</code>.</p>
<p>Mais voil√† que <code>em</code> rencontre un inconv√©nient majeur, encore et toujours notre fameuse cascade. Chaque √©l√©ment d√©pend de son propre <code>font-size</code> ou de celui de son parent. Alors, vous imaginez l‚Äô√©l√©ment de l‚Äô√©l√©ment de l‚Äô√©l√©ment. On peut vite perdre les p√©dales. Je vous vois venir avec l‚Äôunit√© <code>rem</code>. Effectivement on r√©sout compl√®tement le probl√®me de la cascade, mais on perd en modularit√©.</p>
<p>Prenons notre exemple de <code>NavBar</code>, voici comment on pourrait commencer ce composant :</p>
<pre><code class="lang-css"><span class="hljs-class">.NavBar</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> <span class="hljs-number">1rem</span></span></span>;
}</span>
  <span class="hljs-class">.NavBar-item</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> .<span class="hljs-number">875em</span></span></span>;
    <span class="hljs-rule"><span class="hljs-attribute">padding</span>:<span class="hljs-value"> <span class="hljs-number">1em</span></span></span>;
  }</span>
</code></pre>
<p>Notre classe principale √©tant d√©finie en <code>rem</code>, il devient alors tr√®s facile de calculer l‚Äôensemble de ces <code>-item</code> en <code>em</code>.
On diminue ainsi de nouveau les probl√®mes de cascade. De plus, on peut tr√®s facilement augmenter la taille g√©n√©rale de notre composant, en augmentant la taille de son <code>font-size</code> dans sa classe principale.
On atteint alors un double d‚Äôobjectif : en plus d‚Äô√™tre accessible en supprimant les pixels, on rend notre composant r√©utilisable sur d‚Äôautres projets en s‚Äôadaptant tr√®s facilement √† son contexte.</p>
<h2 id="namespace">
      <a class="putainde-Title-anchor" href="#namespace">#</a>
      Namespace
    </h2><p>On utilise tous des scripts <code>vendors</code>. Pour √©viter les collisions avec ceux-ci et encore une fois √† cause de cette maudite cascade, voici un petit truc qui vous √©vitera de modifier vos classes : l‚Äôajout d‚Äôun namespace √† nos composants.</p>
<p>On va utiliser notre exemple de tout √† l‚Äôheure avec <code>NavBar</code> :</p>
<pre><code class="lang-css"><span class="hljs-class">.putainde-NavBar</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> <span class="hljs-number">1rem</span></span></span>;
}</span>
  <span class="hljs-class">.putainde-NavBar-item</span> <span class="hljs-rules">{
    <span class="hljs-rule"><span class="hljs-attribute">font-size</span>:<span class="hljs-value"> .<span class="hljs-number">875em</span></span></span>;
    <span class="hljs-rule"><span class="hljs-attribute">padding</span>:<span class="hljs-value"> <span class="hljs-number">1em</span></span></span>;
  }</span>
</code></pre>
<h2 id="pour-finir">
      <a class="putainde-Title-anchor" href="#pour-finir">#</a>
      Pour finir
    </h2><p>C‚Äôest verbeux, on ne peut pas le nier. Par moment, on peut se dire qu‚Äô√©crire une classe seulement pour une propri√©t√©, est-ce si pertinent que √ßa ? Sauf qu‚Äôau moment ou vous √©crivez votre <code>css</code> vous ne pouvez pas dire qu‚Äô√† la prochaine mise √† jour, il vous faudra peut-√™tre en rajouter 5, et donc votre classe sera finalement bien utile.</p>
<p>Toutes ces m√©thodes m‚Äôont fait abandonner <code>Sass</code> et son framework <code>Compass</code>. Ce qu‚Äôapporte un langage comme <code>Sass</code> (au-del√† de l‚Äôaspect programmation, mais c‚Äôest une autre histoire) vient principalement de ses features telles que  <a href="http://sass-lang.com/documentation/file.SASS_REFERENCE.html#nested_rules">nested</a> et <a href="http://sass-lang.com/documentation/file.SASS_REFERENCE.html#extend">@extend</a>. Et franchement, une bonne indentation, un bon nommage de classes et une utilisation intelligente de <code>BEM</code> vous feront vite oublier <code>Sass</code> sans regarder en arri√®re.</p>
<p>Sur l‚Äôensemble de mes projets, je n‚Äô√©cris plus que ce qu‚Äôon appelle commun√©ment du <code>Vanilla CSS</code>. Petit b√©mol quand m√™me, histoire de pouvoir utiliser des sp√©cifications pas forc√©ment encore compatibles sur tous les navigateurs, j‚Äôai ajout√© dans mon workflow l‚Äôoutil <a href="https://github.com/postcss/postcss">PostCSS</a>, le tout contr√¥l√© par <a href="http://cssnext.github.io/">cssnext</a> dont voici quelques exemples d‚Äô<a href="https://cssnext.github.io/cssnext-playground/">utilisation</a>.</p>
<p>Je vous encourage vivement √† tester ces deux outils (<a href="https://github.com/postcss/postcss">PostCSS</a> ou <a href="http://cssnext.github.io/">cssnext</a>) qui vous apporteront variables, manipulation des couleurs, etc, ainsi que concat√©nation des <code>@import</code> tout en conservant du CSS valide (selon les sp√©cifications).</p>
<h2 id="le-truc-du-moment">
      <a class="putainde-Title-anchor" href="#le-truc-du-moment">#</a>
      Le truc du moment
    </h2><p>Avant de terminer cet article, je voulais mentionner l‚Äôid√©e/concept qui commence √† faire son petit bout de chemin √† savoir le <code>style inline</code>.</p>
<p>Cela revient tout simplement √† √©crire directement le CSS dans son code <code>HTML</code></p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"font-size:1rem"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">style</span>=<span class="hljs-value">"font-size:.875em; padding:1em"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>Avant d‚Äôhurler au blasph√®me ou au scandale, il est n√©cessaire de mettre en ad√©quation cette id√©e avec les contraintes rencontr√©es lors du d√©veloppement d‚Äôune application utilisant principalement du <code>JavaScript</code>.</p>
<p>Si vous souhaitez un peu plus d‚Äôinformations sur le sujet, je vous invite √† lire la <a href="https://speakerdeck.com/vjeux/react-css-in-js">pr√©sentation</a> de <a href="https://twitter.com/Vjeux">@Vjeux</a>, front-end engineer chez Facebook. Il explique les probl√®mes rencontr√©s avec le <code>CSS</code> et les solutions mises en place par les d√©veloppeurs de Facebook ou plus exactement de <code>ReactJS</code>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/css/du-css-evolutif/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/css/du-css-evolutif/</guid>
            <pubDate>Tue, 10 Mar 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Il d√©marre Vim par erreur, ce qui se passe ensuite est tout simplement bluffant]]></title>
            <description><![CDATA[<blockquote>
<p>√Ä premi√®re vue, vous allez √©prouver de la tristesse, mais ce qui se passe ensuite est tout simplement incroyable‚Ä¶</p>
<p>Alors qu‚Äôil √©tait en train d‚Äôeffectuer une mise en production,
ce d√©veloppeur s‚Äôest confront√© √† une situation qui aurait pu compl√®tement d√©raper.
Une intervention directement sur le serveur de production √©tait obligatoire afin d‚Äô√©diter la base de donn√©es au format .txt.</p>
<p>Apr√®s avoir pass√© plusieurs heures pour se connecter √† distance via une connexion s√©curis√©e,
Maxime est tomb√© nez √† nez avec une console d‚Äôadministration en ligne de commande !
Il √©tait compl√®tement d√©sempar√© par l‚Äôabsence de fen√™tre.</p>
<p>Ce qui s‚Äôest pass√© ensuite est tout simplement incroyable :
fort de sa pers√©v√©rance, Maxime d√©cide tout de m√™me de se rapprocher du clavier !
Apr√®s une rapide recherche sur les Internets,
il tape la premi√®re commande qu‚Äôil trouve :</p>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>vim
</code></pre>
<p>Alors qu‚Äôon pourrait imaginer un drame, comme il arrive souvent quand <a href="https://duckduckgo.com/?q=I+am+stuck+in+VIM">une personne tombe dans ce pi√®ge</a>,
Maxime ne s‚Äôest pas laiss√© abattre et a persist√© dans sa d√©marche‚Ä¶</p>
</blockquote>
<p>Bon, assez plaisant√©.</p>
<h2 id="pourquoi-j-essayerais-vim">
      <a class="putainde-Title-anchor" href="#pourquoi-j-essayerais-vim">#</a>
      <em>Pourquoi j‚Äôessayerais Vim ?</em>
    </h2><p>J‚Äôai commenc√© par Eclipse. Qu‚Äôil fallait r√©installer assez souvent sans quoi on perdait 10 minutes de sa vie √† chaque ouverture d‚Äôautocomplete.
Je suis pass√© par NetBeans, WebStorm‚Ä¶ Sans √™tre convaincu. Plus r√©cemment, j‚Äô√©tais assez content sous Sublime Text avant d‚Äôessayer Atom
(car en gros Atom est quasiment la m√™me chose, en technologie web, open source et fait par GitHub).
Mais j‚Äôai toujours eu envie de me la p√©ter devant 2 √©crans tout noir,
en ligne de commande, comme dans les super productions am√©ricaines.</p>
<p>Plus s√©rieusement, je passe de plus en plus de temps devant ma console‚Ä¶
Enfin vous savez, le terminal, pas l‚Äôautre truc un peu plus fun (et encore que).</p>
<p>J‚Äôai toujours eu envie de comprendre pourquoi autant de gens (car mine de rien il y en a un paquet) utilisaient Vim,
et se moquaient un bon coup √† chaque sortie d‚Äôun nouvel √©diteur.
Car bon faut avouer, se moquer c‚Äôest facile.
Du coup un jour, j‚Äôai d√©marr√© Vim.</p>
<h2 id="pourquoi-j-ai-rien-compris-quand-je-me-suis-retrouve-dans-vim">
      <a class="putainde-Title-anchor" href="#pourquoi-j-ai-rien-compris-quand-je-me-suis-retrouve-dans-vim">#</a>
      <em>Pourquoi j‚Äôai rien compris quand je me suis retrouv√© dans Vim ?</em>
    </h2><p>Le truc le plus d√©routant dans Vim, c‚Äôest les modes.
Et quand on ouvre Vim, on ne se retrouve pas dans le mode le plus logique (√† premi√®re vue).</p>
<p>En fait, ce qu‚Äôon dit pas trop, c‚Äôest que Vim est toujours utilis√© aujourd‚Äôhui car on peut l‚Äôutiliser uniquement au clavier.
Vous allez me r√©pondre qu‚Äôon peut en faire de m√™me avec tous les √©diteurs de texte.</p>
<p>Mais <strong>Vim a clairement √©t√© d√©velopp√© pour minimiser les d√©placements des mains</strong>.</p>
<p>C‚Äôest pour moi la chose la plus importante √† retenir. Et la chose la plus attractive.
Les bons d√©veloppeurs ont tous une bonne flemme au fond d‚Äôeux, c‚Äôest bien connu.</p>
<p>Pour un peu plus sur l‚Äôhistoire de Vim, direction <a href="https://fr.wikipedia.org/wiki/Vim">wikipedia.org/wiki/Vim</a>.</p>
<h2 id="commencer-avec-vim">
      <a class="putainde-Title-anchor" href="#commencer-avec-vim">#</a>
      Commencer avec Vim
    </h2><p>Du coup, quand je suis dans Vim, comment √ßa se passe ?</p>
<p>Je passerai plus tard assez rapidement sur les diff√©rents points, vu que d‚Äôautres ressources,
dont notamment le livre <a href="https://vimebook.com/">Vim pour les humains</a>, le font tr√®s bien en douceur.</p>
<p>C‚Äôest d‚Äôailleur gr√¢ce √† ce livre que je me suis lanc√©.
Je tiens donc √† remercier <a href="http://viserlalune.com/">Vincent Jousse</a> pour avoir pris le temps d‚Äô√©crire cet ouvrage.</p>
<p>Profitez de cet ouvrage, en plus <a href="http://ploum.net/le-prix-libre-une-impossible-utopie/">le prix est libre</a>.
Et puis quand on pense au prix des licences de certains IDE‚Ä¶</p>
<p>Ce livre est fait pour n‚Äôimporte qui, d√©butant ou pas.
Vraiment, mangez-en si vous souhaitez essayer Vim (oui je sais, manger un e-book comme √ßa, √ßa para√Æt pas √©vident).</p>
<p>J‚Äôai essay√© plusieurs fois sans trop savoir o√π commencer, sans succ√®s.
Ce livre m‚Äôa aid√© et se d√©vore en quelques dizaines de minutes (deux ou trois heures grand max),
clavier sous les mains (bah oui rien de mieux pour se lancer).</p>
<p>J‚Äôai essay√© et me voil√† conquis, une fois que j‚Äôai compris sa valeur ajout√©e.</p>
<p>Pour bien s‚Äôy prendre, forcez-vous √† travailler avec Vim au moins une journ√©e en suivant les conseils que vous trouverez dans cet ouvrage.
Cela a fonctionn√© pour moi : je gagne d√©j√† du temps au bout de quelques semaines d‚Äôutilisation.</p>
<p>Pourquoi pas vous ?</p>
<h2 id="pour-apprendre-vim">
      <a class="putainde-Title-anchor" href="#pour-apprendre-vim">#</a>
      Pour apprendre Vim
    </h2><p>Vous pouvez donc :</p>
<ul>
<li>lire l‚Äôe-book <a href="http://vimebook.com">Vim pour les humains</a></li>
<li>lancer la commande <code>vimtutor</code></li>
<li>jouer √† <a href="http://vim-adventures.com/">Vim Adventures</a></li>
<li>vous entra√Æner sur des exemples concrets avec <a href="http://vimgolf.com/">VimGolf</a></li>
</ul>
<p>Voici aussi un cheatsheet indispensable qui permet de bien m√©moriser le pourquoi des touches
(b = begin, w = word, e = end, r = replace, i = insert, a = append, o = open, ctrl f = forward, ctrl b = backward, etc).</p>
<p><img src="../vim-cheatsheet.gif" alt="cheatsheet VIM"></p>
<p>Vous remarquerez que souvent les commandes en majuscules font la m√™me chose mais dans le sens inverse (f/F, o/O), ou de mani√®re plus cat√©gorique (d/D, y/Y).</p>
<h2 id="passer-a-vim-est-un-investissement">
      <a class="putainde-Title-anchor" href="#passer-a-vim-est-un-investissement">#</a>
      Passer √† Vim est un investissement
    </h2><p>Point important : il faut avoir envie.
Il ne s‚Äôagit pas de changer simplement d‚Äô√©diteur, car on doit compl√®tement changer ses habitudes.
Plus aucun raccourci clavier que vous avez l‚Äôhabitude d‚Äôutiliser ne va fonctionner.
Je me r√©p√®te mais il faut se forcer un minimum avant d‚Äôimaginer les possibilit√©s de cet √©diteur.</p>
<p>Cela dit, on peut rapidement voir la puissance de Vim apr√®s quelques heures d‚Äôutilisation
(m√™me si on peut aussi un peu rager en cherchant des commandes simples qu‚Äôon arrive pas √† faire).</p>
<p>Sachez aussi que beaucoup d‚Äô√©diteurs ont des modes Vim (Sublime Text, Atom et d‚Äôautres). Il doit bien y avoir une raison, non ?
Notez aussi que Vim est install√© par d√©faut sur beaucoup d‚Äôenvironnement de type Unix.</p>
<p>Vim est configurable √† souhait (via le fichier <code>.vimrc</code>) et poss√®de m√™me son propre language de scripts (Vim Script ou viml)
ce qui permet de cr√©er de nouvelles fonctionnalit√©s simplement. Et m√™me du coup d‚Äôen faire des ‚Äúplugins‚Äù.</p>
<p>Je vous pr√©pare un prochain post pour vous faire un petit m√©mo condens√© de ce qu‚Äôon peut faire avec, et surtout comment.</p>
<blockquote>
<p>:q^C:wq</p>
</blockquote>
]]></description>
            <link>http://putaindecode.fr/posts/vim/il-demarre-vim-par-erreur-ce-qui-se-passe-ensuite-est-tout-simplement-bluffant/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/vim/il-demarre-vim-par-erreur-ce-qui-se-passe-ensuite-est-tout-simplement-bluffant/</guid>
            <pubDate>Tue, 03 Mar 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Quelques retours sur React et le rendu serveur]]></title>
            <description><![CDATA[<p>On entend souvent parler d‚Äôapplications JavaScript isomorphiques, et m√™me si le 
nom ne <a href="https://news.ycombinator.com/item?id=8237449">fait</a> <a href="https://twitter.com/wycats/status/566857009836724224">pas</a> 
<a href="https://medium.com/the-thinkmill/making-the-case-for-progressive-javascript-a98dfa82b9d7">l‚Äôunanimit√©</a>, 
ce qu‚Äôil y a derri√®re, le concept de <em>server side rendered JavaScript</em> est en 
passe de devenir  un sujet plut√¥t tendance pour 2015 gr√¢ce √† la mont√© en puissance 
de <a href="http://facebook.github.io/react/">Reactjs</a>.  Faire du rendu d‚Äôapplication 
JavaScript cot√© serveur permet de r√©concilier enfin le d√©veloppeur de 
<em>Single Page App</em> (SPA) avec l‚Äôam√©lioration progressive, l‚Äôaccessibilit√© et le 
SEO&nbsp;; quoique Google comme les lecteurs d‚Äô√©cran ont plut√¥t bien √©volu√© sur
ce point. L‚Äôautre avantage non n√©gligeable √† mon sens, est qu‚Äôon am√©liore les 
performances per√ßues par rapport
 √† une SPA classique puisque&nbsp;:</p>
<ul>
<li>On supprime une requ√™te <em>ajax</em> au d√©marrage pour r√©cup√©rer le contenu
initial. </li>
<li>On am√©liore la vitesse de rendu initial de page. </li>
<li>On b√©n√©ficie de la fluidit√© de navigation d‚Äôune SPA.</li>
</ul>
<p>Pour plus d‚Äôinfo sur les avantages, il y a <a href="http://tech.m6web.fr/isomorphic-single-page-app-parfaite-react-flux/">cet article</a> sur le blog de M6Tech.</p>
<p>Afin de me familiariser avec React et son √©cosyst√®me, rien de mieux que mettre 
les mains dedans&nbsp;! C‚Äôest un peu pour toutes ces raisons que j‚Äôai d√©cid√© de 
l‚Äôutiliser pour mon site web (un site statique). </p>
<p><strong>Inutile et donc totalement justifi√© pour le d√©veloppeur que je suis</strong>. 
Une des premi√®res briques que j‚Äôai mises en place a √©t√© le routeur.</p>
<h2 id="react-router">
      <a class="putainde-Title-anchor" href="#react-router">#</a>
      react-router
    </h2><p>Pour une fois dans la communaut√© JavaScript, il y a une biblioth√®que de r√©f√©rence 
et c‚Äôest celle l√† : <a href="https://github.com/rackt/react-router">react-router</a>. 
Le routeur est fortement inspir√© par celui d‚ÄôEmber au sens o√π les URL et leurs routes 
sont au c≈ìur du dispositif. Le routeur se pr√©sente sous forme de composant React 
et √ßa donne √ßa.</p>
<pre><code class="lang-jsx">//routes.js

var <span class="hljs-variable">React =</span> require(<span class="hljs-string">"react"</span>);
var <span class="hljs-variable">Router =</span> require(<span class="hljs-string">"react-router"</span>);

var <span class="hljs-variable">Route =</span> Router.Route;
var <span class="hljs-variable">DefaultRoute =</span> Router.DefaultRoute;
var <span class="hljs-variable">NotFoundRoute =</span> Router.NotFoundRoute;

var <span class="hljs-variable">App =</span> require(<span class="hljs-string">"./app"</span>);
var <span class="hljs-variable">Home =</span> require(<span class="hljs-string">"./home/homePage"</span>);
var <span class="hljs-variable">Project =</span> require(<span class="hljs-string">"./project/projectPage"</span>);
var <span class="hljs-variable">NotFound =</span> require(<span class="hljs-string">"./notFound"</span>);

var <span class="hljs-variable">routes =</span> (
  &lt;Route <span class="hljs-variable">path=</span><span class="hljs-string">"/"</span> <span class="hljs-variable">handler=</span>{App}&gt;
    &lt;DefaultRoute <span class="hljs-variable">name=</span><span class="hljs-string">"index"</span> <span class="hljs-variable">handler=</span>{Home} /&gt;
    &lt;Route <span class="hljs-variable">name=</span><span class="hljs-string">"project"</span> <span class="hljs-variable">path=</span><span class="hljs-string">"/projects/:url"</span> <span class="hljs-variable">handler=</span>{Project} /&gt;
    &lt;NotFoundRoute <span class="hljs-variable">name=</span><span class="hljs-string">"404"</span> <span class="hljs-variable">handler=</span>{NotFound} /&gt;
  &lt;/Route&gt;
);

module.<span class="hljs-variable">exports =</span> routes;
</code></pre>
<p>√Ä mon sens, l‚Äôaspect d√©claratif apporte de la clart√© et am√©liore la compr√©hension 
du syst√®me. On voit rapidement quel composant est utilis√© en fonction de l‚ÄôURL. 
L‚Äôautre avantage du d√©claratif, c‚Äôest qu‚Äôil permet de mani√®re assez simple, 
d‚Äôimbriquer les routes en imbriquant les n≈ìuds <code>&lt;Route&gt;</code>.</p>
<p>En plus des composants, on a aussi √† disposition des <em>mixins</em> pour naviguer 
programmatiquement ou acc√©der aux infos du routeur (chemin, param√®tres, ‚Ä¶)</p>
<p>Et le gros plus de cette biblioth√®que : elle peut aussi s‚Äôutiliser cot√© serveur, 
pour la g√©n√©ration des vues et √©viter ainsi de dupliquer du code puisqu‚Äôon va 
pouvoir carr√©ment utiliser tel quel le fichier pr√©c√©dent. Plut√¥t cool&nbsp;!
Voici un exemple de <em>middleware</em> pour faire marcher √ßa dans Express&nbsp;:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react"</span>);
<span class="hljs-keyword">var</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react-router"</span>);

<span class="hljs-comment">// notre fichier routes.js</span>
<span class="hljs-keyword">var</span> routes = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./src/routes"</span>);
<span class="hljs-comment">// notre template de page html</span>
<span class="hljs-keyword">var</span> Html = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./src/html"</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reactView</span><span class="hljs-params">(req, res, next)</span> </span>{
  Router.run(routes, req.url, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Handler, state)</span> </span>{
    <span class="hljs-comment">// on r√©cup√®re les donn√©es pour cette vue en fonction de la requ√™te.</span>
    <span class="hljs-keyword">var</span> data = getViewData(req);

    <span class="hljs-comment">// on g√©n√®re la soupe au tag avec nos donn√©es dedans</span>
    <span class="hljs-keyword">var</span> markup = React.renderToString(React.createElement(Handler), data);

    <span class="hljs-comment">// on utilise React comme moteur de template</span>
    <span class="hljs-keyword">var</span> HtmlElement = React.createElement(Html, {markup: markup});  
    res.send(<span class="hljs-string">"&lt;!DOCTYPE html&gt;"</span> +  React.renderToStaticMarkup(HtmlElement));
  });
}
</code></pre>
<p>Et voici le composant <code>Html.jsx</code> que l‚Äôon utilise comme <em>template</em> pour notre page principale.</p>
<pre><code class="lang-jsx">var React = require('react');

var Html = React.createClass({
  render: function() {
    return (
      <span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charSet</span>=<span class="hljs-value">"utf-8"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">meta</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>Mon site perso<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"/js/app.js"</span> /&gt;</span><span class="handlebars"><span class="xml">
        <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"react-app"</span> <span class="hljs-attribute">dangerouslySetInnerHTML</span>=</span></span><span class="hljs-expression">{{__<span class="hljs-variable">html</span>: <span class="hljs-variable">this.props.markup</span>}}</span><span class="xml"><span class="hljs-tag"> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
    );
  }

});

module.exports = Html;</span></span>
</code></pre>
<p>Une fois que le code HTML a √©t√© g√©n√©r√© via<code>React.renderToString(React.createElement(Handler), data);</code>, 
on pourrait utiliser n‚Äôimporte quel moteur de template (lodash.template, handlebars, ejs, jade, PHP‚Ä¶) 
pour g√©n√©rer le HTML de la page √† renvoyer. Dans un souci de rationalisation des outils, 
j‚Äôai pr√©f√©r√© utiliser React. </p>
<p>Vous avez d√ª vous apercevoir qu‚Äôon utilise 2 m√©thodes diff√©rentes pour g√©n√©rer 
du HTML avec React&nbsp;:</p>
<ul>
<li><code>React.renderToString(React.createElement(Handler), data);</code></li>
<li><code>React.renderToStaticMarkup(React.createElement(Handler), data);</code></li>
</ul>
<p>La diff√©rence entre les deux m√©thodes est simple. Dans la premi√®re, React annote 
les n≈ìuds HTML avec des <code>data-reactid</code> dans le but de pouvoir ensuite reprendre 
la main lorsque votre l‚Äôapplication s‚Äôex√©cutera dans le navigateur. De cette mani√®re, 
React sait que vous l‚Äôinitialisez avec un contenu g√©n√©r√© depuis le serveur. 
Et si il d√©tecte une diff√©rence entre le code existant et celui qu‚Äôil g√©n√®re, 
vous aurez droit √† un <a href="https://github.com/facebook/react/blob/2aeb8a2a6beb00617a4217f7f8284924fa2ad819/src/browser/ui/__tests__/ReactRenderDocument-test.js#L205-L215">petit warning</a>. 
La deuxi√®me m√©thode permet de g√©n√©rer du code HTML sans annotations, 
comme n‚Äôimporte quel moteur de <em>template</em>.</p>
<p>Les plus attentifs auront remarqu√© qu‚Äôon passe les donn√©es initiales lors de 
la cr√©ation de l‚Äôapplication via des <em>props</em> React. Quid de l‚Äôutilisation 
de flux dans tout √ßa ?</p>
<h2 id="flux-et-le-rendu-serveur">
      <a class="putainde-Title-anchor" href="#flux-et-le-rendu-serveur">#</a>
      Flux et le rendu serveur
    </h2><p>Avec <a href="http://facebook.github.io/flux/">Flux</a>, ce sont les stores qui maintiennent 
l‚Äô√©tat de notre application. Si l‚Äôon ne veut pas afficher notre application 
sans aucune donn√©es, nous allons devoir pr√©alablement peupler nos stores 
avant d‚Äôappeler <code>React.renderToString()</code>. </p>
<p>L√† o√π √ßa se corse un peu, c‚Äôest qu‚Äôil va falloir remplir nos stores avant de d√©marrer 
notre application sous peine de voir le message d‚Äôalerte dont je parlais plus haut. 
Le plus simple alors est de passer ces donn√©es au moteur de template, 
en plus du markup (par exemple sous la forme d‚Äôun n≈ìud <code>&lt;script type=&quot;application/json&quot;&gt;JSON DATA&lt;/script&gt;</code>.
Il ne reste plus qu‚Äôa r√©cup√©rer ces donn√©es avant d‚Äôappeler <code>React.render( Application, document.getElementById(&quot;react-app&quot;))</code></p>
<p>Par exemple&nbsp;: </p>
<pre><code class="lang-javascript"><span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event)</span> </span>{
  <span class="hljs-comment">// getData() va r√©cuperer et parser le contenu du tag script </span>
  <span class="hljs-comment">// qui contient nos donn√©es</span>
  <span class="hljs-keyword">var</span> storeData= getData(); 

  <span class="hljs-comment">// on d√©clenche une actions</span>
  actions.init( storeData);

  <span class="hljs-comment">// on lance le rendu</span>
  React.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">App</span> /&gt;</span>, document.getElementById("react-app"));
});</span>
</code></pre>
<h2 id="le-mot-de-la-fin">
      <a class="putainde-Title-anchor" href="#le-mot-de-la-fin">#</a>
      Le mot de la fin
    </h2><p>Penser son application React pour qu‚Äôelle puisse √™tre rendue cot√© serveur 
introduit de nouvelles probl√©matiques, notamment avec l‚Äôajout du <em>pattern</em> Flux. 
En fonction des pages que l‚Äôon souhaite afficher, on devra initialiser diff√©rents <em>stores</em>. 
√Ä nous de d√©terminer, en fonction de l‚ÄôURL et du composant √† afficher, 
lequel initialiser, et cela, que l‚Äôon soit sur le client ou le serveur. 
De la m√™me mani√®re, il faudra √™tre capable de charger nos donn√©es, ind√©pendamment 
de l‚Äôenvironnement d‚Äôex√©cution (coucou XHR).</p>
<p>Un d√©but de r√©ponse se trouve dans les exemples fournis avec react-router. 
L‚Äôid√©e est de passer par une propri√©t√© <code>statics</code> lors de la cr√©ation des composants React 
qui seront associ√©s √† une <code>&lt;Route/&gt;</code>.</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">var</span> ProjectPage = React.createClass({ 
  statics: {
    fetchData: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span></span>{
      <span class="hljs-keyword">return</span> api.getPageData(params.url)
        .then( actions.initProject)
        .<span class="hljs-keyword">catch</span>( actions.loadProjectError);
    }
  }
 ...
 });
</code></pre>
<p>Dans ce bloc <code>statics</code>, on d√©finit une fonction qui servira √† r√©cup√©rer les donn√©es 
pour ce composant mais on pourrait tr√®s bien imaginer retourner la liste d‚Äôactions 
√† lancer ou encore les <em>stores</em> √† initialiser voire m√™me un descripteur des donn√©es n√©cessaires 
√† la vue (<a href="https://www.youtube.com/watch?v=9sc8Pyc51uU">cf Relay / GraphQL</a>) </p>
<p>Ensuite, lorsque le callback fourni √† <code>Router.run()</code> est appel√©, il suffit de parcourir 
les <em>Handler</em> pour r√©cup√©rer les informations contenues dans les blocs <code>statics</code>, 
les traiter et enfin faire <code>React.render()</code>.</p>
<pre><code class="lang-Javascript">// On renvoie une promesse qui sera r√©solue lorsque que toutes les donn√©es d√©mand√©es via fetchData seront re√ßues.
Router.run(routes, Router.HistoryLocation, function (Handler, <span class="hljs-keyword">state</span>) {
  var p = Promise.<span class="hljs-literal">all</span>(<span class="hljs-keyword">state</span>.routes
    .filter(route =&gt; route.handler.fetchData)  // d√©finit fetchData
    .map(route =&gt; {
      return route.handler.fetchData(<span class="hljs-keyword">state</span>.params);
    })
  );
  p.then( x =&gt; {
    React.render(<span class="hljs-variable">&lt;Handler {...state} /&gt;</span>, document.getElementById(<span class="hljs-string">"react-app"</span>))
  });
});
</code></pre>
<p>Le principe est simple et peut √™tre facilement encapsul√© dans un module pour 
√™tre partag√© entre le client et le serveur.  J‚Äôesp√®re que cet article vous a permis 
d‚Äôappr√©hender un peu mieux le rendu cot√© serveur d‚Äôune application React. 
N‚Äôh√©sitez pas √† laisser des commentaires si vous avez des questions o√π 
si vous souhaitez partager vos exp√©riences dans ce domaine. </p>
<p>Et quelques liens vid√©o des sessions de la #reactjsconf :</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=XZfvW1a8Xac">React.js Conf 2015 - react-router increases your productivity </a> </li>
<li><a href="https://www.youtube.com/watch?v=z5e7kWSHWTg">React.js Conf 2015 - Hype!</a> : un aper√ßu des possibilit√©s de react-router</li>
</ul>
]]></description>
            <link>http://putaindecode.fr/posts/js/reactjs-et-rendu-serverside/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/reactjs-et-rendu-serverside/</guid>
            <pubDate>Mon, 23 Feb 2015 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[JavaScript modulaire pour le front-end : les bases]]></title>
            <description><![CDATA[<p>Quand on r√©alise des applications en JS pour les navigateurs web, on ne peut plus se contenter de mettre des tags <code>script</code> dans le bon ordre pour charger les biblioth√®ques tierces que l‚Äôon utilise comme pour un site web. C‚Äôest pourquoi il existe des outils pour permettre d‚Äô√©crire du JavaScript modulaire et r√©utiliser plus facilement les innombrables biblioth√®ques publi√©es par la communaut√© JS.</p>
<p>Cependant, ce principe d‚Äô√©criture modulaire et de publication de code n‚Äô√©tant pas int√©gr√© dans le langage lui-m√™me, de tr√®s nombreuses solutions existent plus ou moins compatibles les unes avec les autres et aboutissant √† une forte fragmentation de la communaut√©.
Donc quand on d√©cide de se mettre au JavaScript modulaire, on trouve tout un tas d‚Äôarticles (en anglais) parfois trop vieux (‚Äúune √©tape de build n‚Äôest pas adapt√©e au navigateur‚Äù), parfois trop subjectifs (‚ÄúJ‚Äôaime pas la syntaxe AMD‚Äù), parfois confus (‚Äúutiliser les modules pour de l‚Äôinjection de d√©pendances‚Äù), parfois simplistes (‚ÄúAMD vs CommonJS‚Äù).</p>
<p>C‚Äôest pourquoi j‚Äôai voulu partager mon exp√©rience, en essayant d‚Äôabord de reposer les bases du probl√®me, puis en vous faisant part de ce que j‚Äôestime √™tre la solution la plus satisfaisante actuellement.</p>
<p>D‚Äôabord, il faut faire la distinction entre 3 aspects du probl√®me :</p>
<ul>
<li>le format d‚Äô√©criture des modules (‚Äúmodule authoring format‚Äù)</li>
<li>le syst√®me de gestion des packages (‚Äúpackage management‚Äù)</li>
<li>la convention de r√©solution des d√©pendances de module</li>
</ul>
<h1 id="format-d-ecriture-des-modules">
      <a class="putainde-Title-anchor" href="#format-d-ecriture-des-modules">#</a>
      Format d‚Äô√©criture des modules
    </h1><p>Le module est la brique de base pour d√©composer un gros fichier JS en plusieurs fichiers plus petits et focalis√©s sur une fonctionnalit√© pr√©cise. La plupart du temps un module est un fichier JS qui fournit une fonction, un constructeur ou un objet de valeur. Et comme, pour fournir cette fonctionnalit√©, un module peut avoir besoin d‚Äôautres modules, il existe un m√©canisme pour d√©clarer ses d√©pendances.</p>
<p>Actuellement, 2 standards principaux existent pour √©crire ces modules : <strong>AMD</strong> et <strong>CommonJS</strong>.
Il est √©galement possible d‚Äôutiliser la <a href="http://www.2ality.com/2014/09/es6-modules-final.html">syntaxe retenue par ES6</a> (qui j‚Äôesp√®re va enfin devenir le standard unique) mais pour l‚Äôinstant, √ßa demande encore une √©tape de ‚Äútranspilation‚Äù en AMD ou CJS.</p>
<p>Le format AMD (dans sa forme la plus courante) est :</p>
<pre><code class="lang-js">define([<span class="hljs-string">'moduleA'</span>, <span class="hljs-string">'moduleB'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(a, b)</span> </span>{
  <span class="hljs-comment">// j'utilise a et b</span>
  <span class="hljs-keyword">return</span> maFonctionTresUtile;
});
</code></pre>
<p>Le format CommonJS (dans sa forme la plus courante) est :</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">'moduleA'</span>);
<span class="hljs-keyword">var</span> b = <span class="hljs-built_in">require</span>(<span class="hljs-string">'moduleB'</span>);
<span class="hljs-comment">// j'utilise a et b</span>
<span class="hljs-built_in">module</span>.exports = maFonctionTresUtile;
</code></pre>
<p>Ca n‚Äôest pas tr√®s diff√©rent dans l‚Äôesprit : tous les 2 permettent de d√©crire des d√©pendances et d‚Äôexporter une valeur.
La diff√©rence principale r√©side dans le fait que :</p>
<ul>
<li>CommonJS pr√©voit une √©valuation en une passe dans laquelle il faut r√©soudre les d√©pendances au fur et √† mesure</li>
<li>alors que AMD pr√©voit une √©valuation en 2 passes :<ul>
<li>une premi√®re pour r√©cup√©rer uniquement la liste des d√©pendances</li>
<li>et une seconde o√π on ex√©cute le callback (le corps du module) avec les d√©pendances r√©solues.
C‚Äôest pourquoi on parle de format ‚Äúsynchrone‚Äù dans le premier cas et ‚Äúasynchrone‚Äù dans le second car on peut r√©soudre les d√©pendances de fa√ßon asynchrone en AMD.</li>
</ul>
</li>
</ul>
<p>Dans les 2 cas, par contre, il y a besoin d‚Äôune <em>r√©solution des d√©pendances</em>, c‚Äôest √† dire qu‚Äôun module ne peut pas √™tre ex√©cut√© tel quel dans un navigateur en le chargeant via un tag <code>script</code>. Non, il faut un <em>loader</em>, c‚Äôest √† dire un outil qui va charger le module qu‚Äôon lui demande et va r√©soudre les d√©pendances en cascade. Mais contrairement √† ce que l‚Äôon pourrait croire, les r√®gles de r√©solution des d√©pendances n‚Äôont rien √† voir avec le format du module (on verra √ßa plus tard).</p>
<h1 id="package-management">
      <a class="putainde-Title-anchor" href="#package-management">#</a>
      Package management
    </h1><p>Parlons maintenant des packages. En effet, pouvoir d√©couper du code en modules, c‚Äôest bien ; mais ce qui est encore mieux c‚Äôest de pouvoir le partager avec d‚Äôautres pour qu‚Äôil soit facilement r√©utilisable et arr√™ter le syndr√¥me de :</p>
<blockquote>
<p>‚Äúje recode un event emitter dans ma biblioth√®que comme √ßa je n‚Äôai pas de
d√©pendance et c‚Äôest plus facile √† consommer par mes utilisateurs‚Äù</p>
</blockquote>
<p> C‚Äôest le probl√®me n¬∞1 des biblioth√®ques front qui pr√©sentent souvent comme un argument de ne pas avoir de d√©pendances. Sauf que, si on y r√©fl√©chit, √ßa veut dire que : soit c‚Äôest une biblioth√®que tr√®s bas niveau, soit le mec a recod√© des trucs qui existent d√©j√† au lieu de s‚Äôoccuper de son sujet principal.</p>
<p>C‚Äôest l√† qu‚Äôentre en jeu la notion de <em>package</em> (que je ne traduirai pas en fran√ßais, car √ßa ne servirait qu‚Äô√† apporter de la confusion). Un package est un ensemble de fichiers (pas forc√©ment des fichiers JS d‚Äôailleurs) avec des m√©tadonn√©es associ√©es pour d√©crire principalement :</p>
<ul>
<li>o√π est stock√© le package,</li>
<li>qui est l‚Äôauteur,</li>
<li>quelle est la licence,</li>
<li>quelle est la version,</li>
<li>et ‚Ä¶ quelles sont les d√©pendances et leurs versions !</li>
</ul>
<p>Ici les d√©pendances sont des d√©pendances entre packages, <a href="http://fr.slideshare.net/domenicdenicola/client-side-packages">ce qui n‚Äôa rien √† voir avec les d√©pendances entre modules</a>.</p>
<p>Pour faciliter l‚Äôutilisation des packages, on utilise un <em>package manager</em>, dont le r√¥le principal est, √† partir d‚Äôun id de module (et √©ventuellement d‚Äôun num√©ro de version), de trouver l‚Äôadresse o√π se trouve les fichiers, les t√©l√©charger et les installer localement‚Ä¶ et ceci de fa√ßon r√©cursive pour les d√©pendances, ce qui est le gros avantage par rapport √† le faire √† la mano. Mais sinon, √ßa n‚Äôest pas plus compliqu√© que √ßa dans le principe, et √ßa reste valable pour des fichiers JS ou non, front-end ou non.</p>
<p>Les principaux package managers pour le front-end sont <a href="https://www.npmjs.com/">npm</a> et <a href="http://bower.io">bower</a>.
La grande diff√©rence entre les deux est que <strong>npm installe les d√©pendances de fa√ßon relative</strong> : pour chaque package, les d√©pendances sont install√©es dans un sous-dossier (node_modules).</p>
<ul>
<li>mon-projet-avec-nmp<ul>
<li>app.js</li>
<li>node_modules<ul>
<li>une-dependance<ul>
<li>main.js</li>
<li>nodes_modules<ul>
<li>une-dependance-indirecte<ul>
<li>main.js</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>une-autre-dependance<ul>
<li>main.js</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Alors que <strong>bower prend le parti d‚Äôinstaller les d√©pendances √† plat</strong> : le package et ses d√©pendances et les d√©pendances des d√©pendances sont toutes install√©es au m√™me niveau dans le m√™me dossier.</p>
<ul>
<li>mon-projet-avec-bower<ul>
<li>app.js</li>
<li>bower_components<ul>
<li>une-dependance<ul>
<li>main.js</li>
</ul>
</li>
<li>une-autre-dependance<ul>
<li>main.js</li>
</ul>
</li>
<li>une-dependance-indirecte<ul>
<li>main.js</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>L‚Äôapproche bower semble √™tre une bonne id√©e car si 2 packages ont la m√™me d√©pendance (ou des d√©pendances compatibles semver), une seule est install√©e. Alors qu‚Äôavec npm chaque package installe sa propre d√©pendance.</p>
<p>Cependant, s‚Äôil y a une incompatibilit√© de versions :</p>
<blockquote>
<p>le package A d√©clare une d√©pendance sur X en version 1
le package B d√©clare une d√©pendance sur X mais en version 2</p>
</blockquote>
<p>Avec bower, on est coinc√© : on ne peut installer qu‚Äôune seule version. Lors du <code>bower install</code>, il faudra choisir quelle version on garde : soit A devra utiliser X2, soit B devra utiliser X1.</p>
<ul>
<li>mon-app-avec-bower<ul>
<li>bower_components<ul>
<li>package-A</li>
<li>package-B</li>
<li>package-X<ul>
<li>main.js // v1 ou v2 mais pas les 2</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Bower appelle cela de la <em>r√©solution de conflits</em>. Mais concr√™tement, cela veut dire qu‚Äôon force une d√©pendance qui n‚Äôest pas support√©e officiellement par le package en question. Donc on se retrouve responsable de v√©rifier que le package B fonctionne correctement avec X1. Pas cool :-(</p>
<p>Alors qu‚Äôavec npm les versions des d√©pendances sont respect√©es, il n‚Äôy a pas de question √† se poser.</p>
<ul>
<li>mon-app-avec-npm<ul>
<li>node_modules<ul>
<li>package-A<ul>
<li>node_modules<ul>
<li>package-X<ul>
<li>main.js // v1</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>package-B<ul>
<li>node_modules<ul>
<li>package-X<ul>
<li>main.js // v2</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="resolution-des-dependances-de-module">
      <a class="putainde-Title-anchor" href="#resolution-des-dependances-de-module">#</a>
      R√©solution des d√©pendances de module
    </h1><p>La question est alors :</p>
<blockquote>
<p>‚ÄúPourquoi existe-t-il des package managers sp√©cifiquement pour le web front-end ?‚Äù</p>
</blockquote>
<p>R√©ponse :</p>
<blockquote>
<p> ‚ÄúPour faciliter l‚Äôutilisation de modules publi√©s dans des packages dans le contexte du front-end‚Äù</p>
</blockquote>
<p>Super ! Mais concr√™tement ?</p>
<p>Et bien, venons en au coeur du probl√®me : <em>la r√©solution des module-id en fichier</em>. Comme on l‚Äôa vu, pour charger un module dans le navigateur, il faut utiliser un loader. Et une de ses t√¢ches est de <em>r√©soudre</em> les <code>module_id</code> en adresse de fichier.</p>
<p>Au pire il faudrait explicitement dire au loader pour chaque <code>module_id</code> o√π est le fichier correspondant. Heureusement, ce n‚Äôest pas le cas, ni avec requireJS, ni avec les loaders compatibles npm.</p>
<h2 id="amd">
      <a class="putainde-Title-anchor" href="#amd">#</a>
      AMD
    </h2><p>RequireJS et les autres loaders AMD vont assez loin en  mati√®re de <a href="http://requirejs.org/docs/api.html#config">configuration</a> mais souvent , √ßa revient √† d√©crire des r√®gles du style <em>tous les modules id qui commencent par <code>mon-package</code> sont √† chercher dans le dossier <code>./mon-package</code></em>.</p>
<p>En fait, √ßa n‚Äôest pas tout √† fait vrai qu‚Äôil faille syst√©matiquement configurer les r√®gles de r√©solution avec RequireJS : il y a une r√®gle par d√©faut qui stipule que les module_id sont r√©solus par rapport √† une ‚ÄúbaseURL‚Äù (qui par d√©faut est celle du fichier html). Donc si on installe tous les packages au m√™me niveau, √ßa marche par d√©faut.
C‚Äôest pour cela que bower est souvent utilis√© pour les packages front-end en AMD car il installe les fichiers √† plat et de cette fa√ßon on limite le besoin de configuration.</p>
<h2 id="npm">
      <a class="putainde-Title-anchor" href="#npm">#</a>
      NPM
    </h2><p>A l‚Äôoppos√© de cette approche tr√®s flexible, il y a nodeJS avec une <a href="https://github.com/substack/browserify-handbook#how-node_modules-works">convention simple et statique</a>, qui dit en gros :</p>
<ul>
<li>si c‚Äôest une r√©f√©rence relative, il suffit de suivre le chemin</li>
<li>si c‚Äôest une r√©f√©rence absolue, il faut chercher dans le dossier <code>node_modules</code> et ceci de fa√ßon r√©cursive jusqu‚Äô√† arriver √† la racine</li>
</ul>
<p>Et donc z√©ro config, puisque √ßa n‚Äôest pas configurable. Ca peut para√Ætre √™tre une limitation mais c‚Äôest une force.</p>
<h1 id="conclusion">
      <a class="putainde-Title-anchor" href="#conclusion">#</a>
      Conclusion
    </h1><p>Si tous les packages en AMD utilisaient la r√®gle de r√©solution par d√©faut et que l‚Äôon utilisait bower pour les installer, on n‚Äôaurait rien √† configurer. Mais dans la pratique, √ßa n‚Äôest pas le cas et on se retrouve √† devoir configurer les r√®gles de r√©solution non seulement pour ses propres d√©pendances (<em>pourquoi pas</em>) mais √©galement pour les d√©pendances de ses d√©pendances (<em>et l√† √ßa ne va plus</em>).
Et il reste toujours le probl√®me des conflits de version li√©s √† l‚Äôapproche de mettre les d√©pendances √† plat.</p>
<p>D‚Äôun autre c√¥t√©, il y a la convention nodeJS qui impose des r√®gles simples, non modifiables et qui n‚Äôa pas de probl√®me de conflit de versions. C‚Äôest √† dire qu‚Äôil suffit de faire <code>npm install mon-package</code> et √ßa marche. Une convention qui fait l‚Äôunanimit√© pour le backend JS.</p>
<p>C√¥t√© front, on lui reproche de charger les d√©pendances sans les d√©doublonner et de le faire en synchrone, ce qui n‚Äôest pas adapt√© quand le chargement des fichiers se fait via un r√©seau en http et pas directement depuis un disque local comme sur un serveur.</p>
<p>C‚Äôest pourquoi a √©t√© invent√© <a href="http://http://browserify.org/">browserify</a> qui apporte actuellement <a href="http://putaindecode.fr/posts/js/browserify-all-the-things/">le meilleur des 2 mondes</a> : toujours z√©ro config selon la convention nodeJS et un syst√®me de bundle/build (via une analyse syntaxique du code JS pour d√©tecter les d√©pendances) afin d‚Äôassembler tous les modules en un seul fichier adapt√© au navigateur.
On peut lui reprocher la n√©cessit√© d‚Äôune √©tape de build et le fait que le code source en d√©bug est en un seul fichier mais :</p>
<ol>
<li>de toute fa√ßon pour la prod, il y aura une √©tape de build et en d√©v, avec un outillage adapt√© (par exemple <code>watchify</code> qui rebuild en incr√©mental) √ßa n‚Äôest pas la mer √† boire</li>
<li>avec le support des sources-map dans les navigateurs, on peut maintenant retrouver en debug les m√™mes noms de fichiers et les m√™mes num√©ro de ligne que dans les fichiers d‚Äôorigine et les points d‚Äôarr√™t fonctionnent.</li>
</ol>
<p>Au final, √ßa en devient m√™me un avantage, car le code que l‚Äôon ex√©cute en dev dans le navigateur est tr√®s proche de ce que l‚Äôon aura en prod, en tout cas plus proche qu‚Äôavec requireJS pour lequel on d√©veloppe sans build et pour lequel il faut √©crire √† nouveau une config de build pour la mise en prod.</p>
<h1 id="conclusion-de-la-conclusion">
      <a class="putainde-Title-anchor" href="#conclusion-de-la-conclusion">#</a>
      Conclusion de la conclusion
    </h1><p>Ma conclusion est que le point crucial pour faciliter la r√©utilisation de modules, c‚Äôest de <strong>minimiser les contraintes sur les utilisateurs</strong> et donc de se rapprocher d‚Äôun usage <em>plug and play</em>. Pour cela il faut une convention forte entre le package manager et le loader/builder de modules, afin d‚Äô√©viter √† l‚Äôutilisateur de devoir √©crire des configs ‚Ä¶ la plupart du temps.
Bien s√ªr, la recherche du ‚Äúz√©ro config‚Äù n‚Äôest pas une fin et c‚Äôest particuli√®rement vrai c√¥t√© front o√π les contraintes de chargement de fichiers sont fortes. Et si vous voulez diviser votre bundle en plusieurs fichiers ou si vous voulez des r√®gles d‚Äôoptimisation complexes pour votre build, il est normal de devoir mettre les mains dans le cambouis.
Mais si au moins le cas d‚Äôusage le plus fr√©quent (compiler son appli en un seul fichier qui sera charg√© via un tag <code>script</code>) est simplifi√© au maximum, alors on pourra s√ªrement voir c√¥t√© front, le m√™me √©tat d‚Äôesprit que c√¥t√© back. Et je suis plut√¥t optimiste, <a href="https://medium.com/@trek/last-week-i-had-a-small-meltdown-on-twitter-about-npms-future-plans-around-front-end-packaging-b424dd8d367a">contrairement √† certains</a>.</p>
<p>Utilisateur de la premi√®re heure d‚Äô<code>AMD</code> et de <code>Dojo loader</code>, puis de <code>bower</code>, je me suis rendu compte de leurs limites et surtout j‚Äôai √©t√© r√©guli√®rement g√™n√© par la complexit√© de la configuration‚Ä¶ surtout lorsqu‚Äôil fallait passer au build. Cela freine la r√©utilisation de modules tiers et c‚Äôest dommage.
Ce n‚Äôest pas un probl√®me intrins√®que au format de module et toutes les discussions sur ‚Äúmoi j‚Äôaime / j‚Äôaime pas la syntaxe AMD‚Äù sont secondaires (d‚Äôailleurs <a href="https://www.npmjs.com/package/deamdify">browserify peut fonctionner avec des biblioth√®ques en AMD</a>).
Mais dans la pratique, nous migrons vers la solution <code>npm + browserify</code> et c‚Äôest vraiment moins compliqu√©.</p>
<p>J‚Äôesp√®re que cet article vous permettra d‚Äôy voir plus clair, de d√©passer les querelles sur les pr√©f√©rences personnelles de chacun, et de vous aider √† faire votre choix.
Je n‚Äôestime pas √™tre un expert du sujet, il y a s√ªrement beaucoup de choses √† compl√©ter ou pr√©ciser, donc n‚Äôh√©sitez pas √† r√©agir.</p>
<p>Pour aller plus loin et regarder vers le futur que nous am√®ne ES6, il y a cet <a href="https://medium.com/@brianleroux/es6-modules-amd-and-commonjs-c1acefbe6fc0">excellent article</a>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/js/etat-lieux-js-modulaire-front/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/etat-lieux-js-modulaire-front/</guid>
            <pubDate>Mon, 15 Dec 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Premi√®re application Ember. Suite et fin.]]></title>
            <description><![CDATA[<p>L‚Äô<a href="/posts/js/premiere-app-ember">article pr√©c√©dent</a> vous a accompagn√© pour la cr√©ation d‚Äôune premi√®re application <a href="http://emberjs.com">Ember</a>. 
Mais il faut bien reconna√Ætre que l‚Äôexemple √©tait tr√®s simple et que, du coup, le m√©rite est faible. 
Pour se  rattraper, on va complexifier un peu les choses.</p>
<p>Tout comme dans l‚Äôarticle pr√©c√©dent, nous d√©taillerons r√©guli√®rement les concepts mis en ≈ìuvre. Parce que vous le valez bien.</p>
<h2 id="sommaire">
      <a class="putainde-Title-anchor" href="#sommaire">#</a>
      Sommaire
    </h2><ul>
<li><a href="#edition-d-une-serie">√âdition d‚Äôune s√©rie</a><ul>
<li><a href="#routes-imbriquees">Routes imbriqu√©es</a></li>
<li><a href="#-code-outlets-code-">Outlets</a></li>
<li><a href="#liens-entre-routes">Liens entre routes</a></li>
<li><a href="#enregistrement-des-modifications">Enregistrement des modifications</a></li>
<li><a href="#actions-sur-les-transitions">Actions sur les transitions</a></li>
</ul>
</li>
<li><a href="#relations-avec-ember-data">Relations avec Ember Data</a></li>
<li><a href="#insertion-d-un-gabarit">Insertion d‚Äôun gabarit</a></li>
<li><a href="#creation-d-une-nouvelle-serie">Cr√©ation d‚Äôune nouvelle s√©rie</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<h2 id="edition-d-une-serie">
      <a class="putainde-Title-anchor" href="#edition-d-une-serie">#</a>
      √âdition d‚Äôune s√©rie
    </h2><p>On veut pouvoir basculer depuis la fiche d‚Äôune s√©rie vers son √©dition en mode <em>in place</em>. C‚Äôest-√†-dire
en <strong>rempla√ßant</strong> la zone de visualisation de cette fiche par sa zone d‚Äô√©dition.</p>
<p>On acc√®de √† la fiche en mode visualisation √† l‚ÄôURL <code>/series/{id}/</code> et en mode √©dition √† l‚ÄôURL <code>/series/{id}/edit</code>. √âvidemment, 
on reconstruit uniquement la zone de la fiche et non l‚Äôapplication enti√®re (et donc ni l‚Äôen-t√™te ni la liste des s√©ries).</p>
<h3 id="routes-imbriquees">
      <a class="putainde-Title-anchor" href="#routes-imbriquees">#</a>
      Routes imbriqu√©es
    </h3><p>Commen√ßons par d√©finir une nouvelle route <code>edit</code>, sous-route de <code>seriesItem</code> : </p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'series'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'seriesItem'</span>, { path: <span class="hljs-string">'/:seriesItem_id'</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'edit'</span>);
    });
  });
});
</code></pre>
<p>Pour que notre nouvelle route affiche la fiche en mode √©dition, on doit - <a href="/posts/js/debuter-avec-ember/#les-fondamentaux">rappelez-vous</a> - imp√©rativement suivre les 
<a href="http://emberjs.com/guides/concepts/naming-conventions/">conventions de nommage</a> et cr√©er un gabarit <code>edit.hbs</code> dans le 
r√©pertoire <code>/app/templates/series/series-item/</code> :</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/edit.hbs` --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"submit"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"submit"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"cancel"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cancel"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"title"</span>&gt;</span>{{input id="title" type="text" value=title}}<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">img</span> {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"coverUrl"</span><span class="hljs-value">}}</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">"Series's first album cover"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cover"</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"description"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"scriptwriter"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">"scriptwriter"</span>&gt;</span>Scriptwriter<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"control"</span>&gt;</span>{{input id="scriptwriter" type="text" value=scriptwriter required="required"}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"illustrator"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">"illustrator"</span>&gt;</span>Illustrator<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"control"</span>&gt;</span>{{input id="illustrator" type="text" value=illustrator}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"publisher"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">label</span> <span class="hljs-attribute">for</span>=<span class="hljs-value">"publisher"</span>&gt;</span>Publisher<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"control"</span>&gt;</span>{{input id="publisher" type="text" value=publisher}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"summary"</span>&gt;</span>{{textarea value=summary rows="10"}}<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
</code></pre>
<p>√Ä ce stade, naviguer sur <code>/series/{@id}/edit</code> ne l√®ve pas d‚Äôerreur mais n‚Äôa aucun effet. En effet, on a
d√©fini une route imbriqu√©e mais conserv√© le gabarit <code>/app/templates/series/series-item.hbs</code> inchang√©. L‚Äôactivation de la route <code>series.seriesItem</code> 
affiche donc toujours ce gabarit, m√™me dans le cas d‚Äôune sous-route telle que <code>series.seriesItem.edit</code>. </p>
<h3 id="outlets">
      <a class="putainde-Title-anchor" href="#outlets">#</a>
      <code>outlets</code>
    </h3><p>La solution est √† aller chercher du c√¥t√© du concept d‚Äô<code>{{outlet}}</code> d√©fini dans l‚Äô<a href="/posts/js/premiere-app-ember/#-code-outlet-code-et-routes-imbriquees">article pr√©c√©dent</a>.
Un <code>{{outlet}}</code> est n√©cessaire <strong>√† chaque fois qu‚Äôon d√©finit un niveau d‚Äôimbrication.</strong> Mais comme on veut quand m√™me continuer √† afficher la s√©rie √† 
l‚ÄôURL <code>/series/{@id}/</code>, on va utiliser la <strong>route implicite</strong> <code>series.seriesItem.index</code> (cf. <a href="/posts/js/premiere-app-ember/#routes-et-controleurs-implicites">article pr√©c√©dent</a>) 
et son gabarit, dans lequel on va copier l‚Äôancien contenu de <code>series-item.hbs</code>.</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/index.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">h3</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-title">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">img</span> {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"coverUrl"</span><span class="hljs-value">}}</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">"Series's first album cover"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cover"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">dl</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"description"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>scriptwriter<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{scriptwriter}} <span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>illustrator<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{illustrator}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>publisher<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{publisher}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">dl</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">p</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"summary"</span>&gt;</span>
      {{summary}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>Le gabarit <code>series-item.hbs</code> est quant √† lui modifi√© car il doit changer en fonction de la sous-route activ√©e.
Et puisqu‚Äôon ne veut rien afficher de plus, son contenu se r√©sume √† un <code>{{outlet}}</code> :</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series-item.hbs --&gt;</span>
{{outlet}}
</code></pre>
<p>Et voil√† ! L‚Äôaffichage de l‚ÄôURL <code>/series/{@id}/</code> est inchang√© alors que l‚ÄôURL <code>/series/{@id}/edit</code> 
affiche d√©sormais le formulaire d‚Äô√©dition.</p>
<h3 id="liens-entre-routes">
      <a class="putainde-Title-anchor" href="#liens-entre-routes">#</a>
      Liens entre routes
    </h3><p>Pour pouvoir plus facilement basculer en mode √©dition, on ajoute un lien vers la route correspondante gr√¢ce √† <code>link-to</code> 
(cf. <a href="http://emberjs.com/guides/templates/links/">doc officielle</a>).</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/index.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
    {{#link-to 'series.seriesItem.edit' id class="edit"}}edit{{/link-to}}
    <span class="hljs-tag">&lt;<span class="hljs-title">h3</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-title">h3</span>&gt;</span>
    ...
</code></pre>
<p>On note que la route vers laquelle le lien pointe est pr√©fix√©e par <code>series</code> parce qu‚Äôon a d√©fini une route et non une resource.
En effet, une ressource r√©initialise l‚Äôespace de nommage et permet donc des noms de routes plus courts. Pour pouvoir pointer vers <code>seriesItem.edit</code> on aurait donc d√ª
remplacer <code>this.route(&#39;seriesItem&#39;, ...</code> par <code>this.resource(&#39;seriesItem&#39;, ...</code>.</p>
<p>On peut d√©sormais √©diter notre s√©rie. On remarque au passage que la modification du titre de la s√©rie le met √©galement √† jour en temps r√©el dans la liste des s√©ries gr√¢ce
au <em>binding</em> (cf. <a href="/posts/js/premiere-app-ember/#-em-bindings-em-et-mise-a-jour-des-gabarits">article pr√©c√©dent</a>).</p>
<h3 id="enregistrement-des-modifications">
      <a class="putainde-Title-anchor" href="#enregistrement-des-modifications">#</a>
      Enregistrement des modifications
    </h3><p>Nous allons maintenant rendre op√©rationnels nos deux boutons d‚Äô√©dition <em>annuler</em> et <em>valider</em>. Pour cela, on commence par associer des actions √† nos boutons :</p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item/edit.hbs` --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"submit"</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">submit</span>"}} <span class="hljs-attribute">class</span>=<span class="hljs-value">"submit"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"reset"</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">cancel</span>"}} <span class="hljs-attribute">class</span>=<span class="hljs-value">"cancel"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
...
</code></pre>
<p>Comme il s‚Äôagit de manipulations sur le mod√®le et de transitions entre routes, les actions correspondantes seront trait√©es par la route.</p>
<pre><code class="lang-js"><span class="hljs-comment">// app/routes/series/series-item/edit.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
  model: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.seriesItem'</span>);
  },
  actions: {
    submit: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.seriesItem.edit'</span>).save().then(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series.seriesItem'</span>);
      }.bind(<span class="hljs-keyword">this</span>));
    },

    cancel: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.seriesItem.edit'</span>).rollback();
      <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series.seriesItem'</span>);
    }
  }
});
</code></pre>
<p>Quelques mots sur ces quelques lignes : </p>
<ul>
<li>Dans une <code>route</code>, le mod√®le courant est r√©cup√©r√© via <code>this.modelFor(&#39;nomRoute&#39;)</code>. Ici, on r√©cup√®re explicitement le mod√®le charg√© automatiquement 
(par convention) par la route m√®re <code>seriesItem</code>. Notez qu‚Äôon aurait pu omettre la r√©cup√©ration du mod√®le compl√®tement car la route m√®re s‚Äôen occupe pour nous.</li>
<li>Une fois le mod√®le r√©cup√©r√©, on peut invoquer les m√©thodes apport√©es par <a href="https://github.com/emberjs/data">Ember Data</a>.</li>
<li>Pour un <code>cancel</code>, on invoque <code>rollback()</code> : toutes les modifications effectu√©es sont annul√©es et le mod√®le est r√©initialis√©.</li>
<li>Pour un <code>submit</code>, on invoque un <code>save()</code> qui enregistre les modifications apport√©es au mod√®le dans le <em>magasin</em> 
(<a href="http://emberjs.com/api/data/classes/DS.Store.html">Store</a>) d‚Äô<a href="https://github.com/emberjs/data">Ember Data</a>.</li>
<li>Les op√©rations effectu√©es sur les mod√®les sont bien souvent asynchrones puisque, dans le cas nominal, elles font 
intervenir des API REST pour enregistrer ou mettre √† jour les donn√©es depuis un serveur. Dans le cas o√π l‚Äôon souhaite
attendre la fin du traitement pour effectuer une action (comme ici dans le cas du <code>save</code>), il est n√©cessaire d‚Äôutiliser
les <em>promesses</em> (<code>promises</code>) qu‚Äô<a href="https://github.com/emberjs/data">Ember Data</a> renvoie (<code>.then(...)</code>). Dans le cas contraire, le code serait
ex√©cut√© avant la fin du traitement et ne permettrait pas de proposer un retour utilisateur propre (gestion des cas d‚Äôerreurs notamment).</li>
<li>Les transitions entre routes sont possibles via <code>this.transitionTo(&#39;nomRoute&#39;)</code>.</li>
</ul>
<h3 id="actions-sur-les-transitions">
      <a class="putainde-Title-anchor" href="#actions-sur-les-transitions">#</a>
      Actions sur les transitions
    </h3><p>Mais je voudrais encore ajouter une derni√®re petite cerise sur ce g√¢teau : annuler automatiquement toutes les modifications effectu√©es
sur la s√©rie d√®s que l‚Äôon quitte la route. <a href="http://emberjs.com">Ember</a> pr√©voit en effet des m√©canismes avanc√©s pour travailler sur les transitions entre 
routes (cf. <a href="http://emberjs.com/guides/routing/preventing-and-retrying-transitions/">doc officielle</a>). En particulier <code>willTransition</code> : </p>
<pre><code class="lang-js"><span class="hljs-comment">// app/routes/series/series-item/edit.js</span>
  actions: {
    ...
    willTransition: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.seriesItem.edit'</span>).rollback();
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  }
</code></pre>
<p>L‚Äôaction est tr√®s simple ici mais on imagine facilement comment on pourrait ajouter une confirmation et d√©terminer, en fonction
de la r√©ponse, si l‚Äôon doit continuer la transition ou l‚Äôabandonner.</p>
<h2 id="relations-avec-ember-data">
      <a class="putainde-Title-anchor" href="#relations-avec-ember-data">#</a>
      Relations avec <a href="https://github.com/emberjs/data">Ember Data</a>
    </h2><p><a href="https://github.com/emberjs/data">Ember Data</a> permet de d√©finir des relations entre nos mod√®les. Ajoutons donc des albums √† nos s√©ries :</p>
<p>On d√©finit d‚Äôabord une nouvelle entit√© <code>Album</code> et ses propri√©t√©s et on indique que cet album √©tait associ√© √† une s√©rie via la propri√©t√© <code>series</code> 
et √† la m√©thode <code>DS.belongsTo</code> (cf. <a href="http://emberjs.com/api/data/#method_belongsTo">doc officielle</a>). 
Ce qui se traduit plus loin, dans l‚Äôinitialisation des donn√©es par <code>series: 1</code> o√π 1 est l‚Äôidentifiant de la 
s√©rie en question.</p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/models/album.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">'ember-data'</span>;

<span class="hljs-keyword">var</span> Album = DS.Model.extend({
  title               : DS.attr(<span class="hljs-string">'string'</span>),
  publicationDate     : DS.attr(<span class="hljs-string">'date'</span>),
  number              : DS.attr(<span class="hljs-string">'number'</span>),
  coverName           : DS.attr(<span class="hljs-string">'string'</span>, {defaultValue: <span class="hljs-string">'default.jpg'</span>}),
  series              : DS.belongsTo(<span class="hljs-string">'seriesItem'</span>),
  coverUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'/assets/images/albums/covers/'</span> + <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'coverName'</span>);
  }.property(<span class="hljs-string">'coverName'</span>)
});

Album.reopenClass({
  FIXTURES: [{
    id: <span class="hljs-number">1</span>,
    title: <span class="hljs-string">'Somewhere Within the Shadows'</span>,
    publicationDate: <span class="hljs-string">'Nov 2000'</span>,
    number: <span class="hljs-number">1</span>,
    coverName: <span class="hljs-string">'blacksad-1.jpg'</span>,
    series: <span class="hljs-number">1</span>
  }, {
    id: <span class="hljs-number">2</span>,
    title: <span class="hljs-string">'Arctic-Nation'</span>,
    publicationDate: <span class="hljs-string">'Mar 2003'</span>,
    number: <span class="hljs-number">2</span>,
    coverName: <span class="hljs-string">'blacksad-2.jpg'</span>,
    series: <span class="hljs-number">1</span>
  }]
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Album;
</code></pre>
<p>On modifie ensuite le mod√®le <code>SeriesItem</code> pour indiquer une relation inverse gr√¢ce √† la propri√©t√© <code>albums</code> et √† 
la m√©thode <code>DS.hasMany</code> (cf. <a href="http://emberjs.com/api/data/#method_hasMany">doc officielle</a>) puis affecter la liste des 
identifiants des albums √† la s√©rie via <code>albums: [1, 2]</code> : </p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/models/series-item.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">'ember-data'</span>;

<span class="hljs-keyword">var</span> SeriesItem = DS.Model.extend({
    title               : DS.attr(<span class="hljs-string">'string'</span>, {defaultValue: <span class="hljs-string">'New Series'</span>}),
    ...
    albums              : DS.hasMany(<span class="hljs-string">'album'</span>, {async: <span class="hljs-literal">true</span>})
});

SeriesItem.reopenClass({
    FIXTURES: [{
    id: <span class="hljs-number">1</span>,
    ...
    albums: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]
    }, ...
]});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> SeriesItem;
</code></pre>
<h2 id="insertion-d-un-gabarit">
      <a class="putainde-Title-anchor" href="#insertion-d-un-gabarit">#</a>
      Insertion d‚Äôun gabarit
    </h2><p>Maintenant qu‚Äôon a des albums pour nos s√©ries, on serait bien int√©ress√© de les voir s‚Äôafficher. Seulement voil√†, on veut juste les
afficher √† c√¥t√© de la visualisation d‚Äôune s√©rie. On ne veut rien proposer d‚Äôautre pour ces albums que le <em>binding</em> des propri√©t√©s et
leur affichage. Pas besoin de route ou de contr√¥leur. On va pour cela utiliser un outil particulier permettant simplement
d‚Äôins√©rer (d‚Äôafficher) un gabarit au sein d‚Äôune route existante via le <em>helper</em> : <code>render</code> (cf. 
<a href="http://emberjs.com/guides/templates/rendering-with-helpers/#toc_the-code-view-code-helper">doc officielle</a>).</p>
<p>On modifie donc le gabarit <code>/series/series-item.hbs</code> pour qu‚Äô√† c√¥t√© de la fiche d‚Äôune s√©rie soit affich√©e la liste de ses albums : </p>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series/series-item.hbs --&gt;</span>

{{outlet}}

<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-albums"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">ul</span>&gt;</span>
        {{#each album in albums}}
            {{render 'partials/albumItem' album}}
        {{/each}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/partials/album-item.hbs --&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"album"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">img</span> {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"coverUrl"</span><span class="hljs-value">}}</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">"Album cover"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cover"</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"description"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">h4</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-title">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dl</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>volume<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{number}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>date<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{publicationDate}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dl</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
</code></pre>
<h2 id="creation-d-une-nouvelle-serie">
      <a class="putainde-Title-anchor" href="#creation-d-une-nouvelle-serie">#</a>
      Cr√©ation d‚Äôune nouvelle s√©rie
    </h2><p>Histoire de terminer en beaut√© on va ajouter vite fait la cr√©ation d‚Äôune s√©rie.</p>
<p>Comme on commence √† avoir l‚Äôhabitude, on fait √ßa en deux coups de cuill√®re √† pot : </p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'series'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'seriesItem'</span>, { path: <span class="hljs-string">'/:seriesItem_id'</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'edit'</span>);
    });
    <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'create'</span>);
  });
});
</code></pre>
<pre><code class="lang-js"><span class="hljs-comment">// /app/routes/series/create.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
  model: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.store.createRecord(<span class="hljs-string">'seriesItem'</span>);
  },

  renderTemplate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.render(<span class="hljs-string">'series.seriesItem.edit'</span>);
  },

  actions: {
    submit: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.create'</span>).save().then(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series.seriesItem'</span>, <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.create'</span>));
      }.bind(<span class="hljs-keyword">this</span>));
    },

    cancel: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.create'</span>).rollback();
      <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series'</span>);
    },

    willTransition: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.modelFor(<span class="hljs-string">'series.create'</span>).rollback();
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  }
});
</code></pre>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
    ...
      {{/each}}
        <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-item"</span>&gt;</span>
          {{#link-to 'series.create' class="add"}}add{{/link-to}}
        <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
    ...
</code></pre>
<p>Les points importants √† noter : </p>
<ul>
<li>Le mod√®le est, cette fois-ci, cr√©√© √† l‚Äôactivation de la route via <code>this.store.createRecord(...)</code>.</li>
<li>Comme on ne souhaite pas proposer de gabarit propre pour cette route, on utilise <code>renderTemplate</code> pour indiquer √† <a href="http://emberjs.com">Ember</a> quel
gabarit il doit utiliser. </li>
<li>Les actions <code>submit</code>, <code>cancel</code> et <code>willTransition</code> sont sensiblement les m√™mes que pour l‚Äô√©dition mais travaillent sur un mod√®le diff√©rent et 
renvoient vers d‚Äôautres routes.</li>
<li>On note le passage du mod√®le lors de la transition en cas de <code>submit</code>.</li>
<li>Il serait l√©gitime de se poser la question de r√©utilisation de code entre ces deux routes, compte tenu des similarit√©s. Ce n‚Äôest pas l‚Äôobjet 
de l‚Äôarticle mais pourrait √™tre envisag√© √† l‚Äôaide d‚Äôun <code>mixin</code> partag√© (cf. <a href="http://emberjs.com/api/classes/Ember.Mixin.html">doc officielle</a>).  </li>
</ul>
<h2 id="conclusion">
      <a class="putainde-Title-anchor" href="#conclusion">#</a>
      Conclusion
    </h2><p>Au travers de cet article et des pr√©c√©dents, j‚Äôesp√®re vous avoir donn√© un aper√ßu du mod√®le de d√©veloppement que propose
<a href="http://emberjs.com">Ember</a>. Vous avez compris, j‚Äôesp√®re, qu‚Äô<a href="http://emberjs.com">Ember</a> est un v√©ritable framework avec des opinions fortes et qu‚Äôil doit √™tre pris comme
tel ou laiss√© de c√¥t√© pour une solution plus l√©g√®re selon vos besoins.</p>
<p>Mais j‚Äôai √©galement essay√© d‚Äôaller plus en profondeur sur certains aspects et de montrer des cas d‚Äôutilisation concrets. 
Ce dernier article montre qu‚Äôil est √©galement possible de fournir √† <a href="http://emberjs.com">Ember</a> 
des configurations explicites afin d‚Äôaller plus loin que les conventions par d√©faut.</p>
<p>Maintenant, vous n‚Äôavez plus d‚Äôexcuses‚Ä¶ Vous ne pourrez pas dire que vous ne connaissiez pas. </p>
<p><em>Note: les sources de l‚Äôapplication exemple sont <a href="https://github.com/bmeurant/ember-articles/tree/premiere-app-ember-suite">disponibles sur github</a>.</em></p>
]]></description>
            <link>http://putaindecode.fr/posts/js/premiere-app-ember-suite/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/premiere-app-ember-suite/</guid>
            <pubDate>Tue, 09 Dec 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[L'injection de d√©pendances en PHP]]></title>
            <description><![CDATA[<p>Salutations ! Aujourd‚Äôhui, je suis venu te parler de PHP (sisi), et notamment du m√©canisme d‚Äôinjection de d√©pendances avec lequel tu n‚Äôes peut-√™tre pas familier. Au menu, des objets, des usines et des conteneurs, alors enfile ton bonnet et tes gants, on va bouger du bordel !</p>
<h2 id="l-injection-de-dependances-c-est-quoi-ce-truc">
      <a class="putainde-Title-anchor" href="#l-injection-de-dependances-c-est-quoi-ce-truc">#</a>
      L‚Äôinjection de d√©pendances ? C‚Äôest quoi ce truc ?
    </h2><p>Si tu fais de la programmation orient√©e objet, il est fort probable que ce terme ne te soit pas totalement inconnu. En PHP, on a principalement commenc√© √† nous en rebattre les oreilles avec l‚Äôav√®nement de Symfony, qui est aujourd‚Äôhui le framework web majeur pour ce langage. Fabien Potencier, cr√©ateur et <em>lead developer</em> de Symfony, cite en exemple sur <a href="http://fabien.potencier.org/article/11/what-is-dependency-injection">son blog</a> cette d√©finition :</p>
<blockquote>
<p><em>Dependency Injection is where components are given their dependencies through their constructors, methods, or directly into fields.</em></p>
<p>Quelqu‚Äôun</p>
</blockquote>
<p>C‚Äôest clair, non ? Non ? Bon. Imaginons un bout d‚Äôappli PHP, o√π l‚Äôon d√©sire g√©rer des personnes qui ont chacune une adresse postale. Si tu n‚Äôas pas trop dormi √† la fac le vendredi matin apr√®s ta cuite du jeudi soir, tu devrais pouvoir d√©terminer tout seul qu‚Äôon va avoir besoin d‚Äôune classe <code>Person</code> et d‚Äôune classe <code>Address</code> :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$number</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$street</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$zipcode</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$city</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>)</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;number = <span class="hljs-variable">$number</span>;
        <span class="hljs-variable">$this</span>-&gt;street = <span class="hljs-variable">$street</span>;
        <span class="hljs-variable">$this</span>-&gt;zipcode = <span class="hljs-variable">$zipcode</span>;
        <span class="hljs-variable">$this</span>-&gt;city = <span class="hljs-variable">$city</span>;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;
}
</code></pre>
<p>Tu noteras que je n‚Äôai pas encore √©crit le constructeur de la classe <code>Person</code>. Justement. Le d√©veloppeur na√Øf proc√©dera de la fa√ßon suivante :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>)</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;address = <span class="hljs-keyword">new</span> Address(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>);
    }
}

<span class="hljs-variable">$person</span> = <span class="hljs-keyword">new</span> Person(<span class="hljs-number">5</span>, <span class="hljs-string">'All√©e des Rosiers'</span>, <span class="hljs-number">78670</span>, <span class="hljs-string">'Villennes-sur-Seine'</span>);
</code></pre>
<p>Alors oui, hein, √ßa marche, et on peut instancier une personne et son adresse en une ligne de code. Le probl√®me est qu‚Äôen proc√©dant ainsi, les classes <code>Person</code> et <code>Address</code> deviennent <strong>√©troitement coupl√©es</strong> : la classe <code>Person</code> est inutilisable sans la classe <code>Address</code>, et pire, le code interne de la premi√®re serait impact√© par un changement sur la seconde.</p>
<p>Pas convaincu ? Qu‚Äôest-ce qui se passera le jour o√π on l√®vera 10 millions de dollars pour internationaliser l‚Äôappli ?</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span>
</span>{
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$country</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>, <span class="hljs-variable">$country</span>)</span>
    </span>{
        <span class="hljs-comment">// ...</span>
        <span class="hljs-variable">$this</span>-&gt;country = <span class="hljs-variable">$country</span>;
    }
}
</code></pre>
<p>Ah bah mince, il faut aussi modifier le constructeur de la classe <code>Person</code> pour y ajouter le nouveau param√®tre <code>$country</code> de mani√®re sym√©trique. C‚Äôest ballot.</p>
<p>Dans l‚Äôid√©al, la classe <code>Person</code> devrait se foutre royalement de la fa√ßon dont la classe <code>Address</code> fonctionne. Une personne a toujours besoin d‚Äôune adresse, mais √ßa n‚Äôimplique certainement pas que ce soit le r√¥le de cette classe de la forger. Alors, on fait comment ? C‚Äôest tr√®s simple :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(Address <span class="hljs-variable">$address</span>)</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;address = <span class="hljs-variable">$address</span>;
    }
}
</code></pre>
<p>L‚Äôinjection de d√©pendances, c‚Äôest pr√©cis√©ment √ßa. Si une classe a besoin d‚Äôune instance d‚Äôune autre classe, que ce soit dans son constructeur ou dans une autre m√©thode (un <em>setter</em> par exemple), alors elle prend cette instance directement en param√®tre et ne s‚Äôoccupe certainement pas de l‚Äôinstancier elle-m√™me. Proc√©der ainsi permet d‚Äô√©crire du code <strong>d√©coupl√©</strong>, √©vitant toute interd√©pendance entre ses diff√©rents composants, ce qui les rend <strong>r√©utilisables</strong> sans devoir embarquer toute la smala au passage, mais √©galement beaucoup plus <strong>maintenables</strong> puisque chaque classe s‚Äôoccupe de ses fesses et pas de celles des autres. En PHP, on tire √©galement parti du <em>type hinting</em> d‚Äôobjets, qui permet de s‚Äôassurer d‚Äôembl√©e que notre param√®tre est une instance de la classe voulue et non pas n‚Äôimporte quoi.</p>
<p>Alors oui, je t‚Äôentends d√©j√† grommeler :</p>
<blockquote>
<p>Ouais mais du coup je dois instancier une adresse moi-m√™me √† chaque fois que je cr√©e une personne, c‚Äôest relou ton truc</p>
</blockquote>
<p>Si telle est ton opinion, <del>tu ne m√©rites pas de vivre</del> je t‚Äôinvite √† poursuivre la lecture de cet article avec l‚Äôentrain qui te caract√©rise.</p>
<h2 id="l-usine-a-la-rescousse">
      <a class="putainde-Title-anchor" href="#l-usine-a-la-rescousse">#</a>
      L‚Äôusine √† la rescousse
    </h2><p>Je ne sais pas si tu sais, mais il existe un <em>design pattern</em> assez r√©pandu en programmation orient√©e objet que l‚Äôon nomme <strong>factory</strong> (usine en fran√ßais, d‚Äôo√π le titre pourrave de cette partie).</p>
<p>En gros, le principe est de cr√©er une classe dont le r√¥le est d‚Äôinstancier d‚Äôautres classes, pr√©cis√©ment dans le cas o√π une telle t√¢che demande plusieurs lignes de code, afin justement d‚Äô√©viter de r√©p√©ter celles-ci. Pour reprendre notre exemple :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PersonFactory</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createPerson</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>, <span class="hljs-variable">$country</span>)</span>
    </span>{
        <span class="hljs-variable">$address</span> = <span class="hljs-keyword">new</span> Address(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$zipcode</span>, <span class="hljs-variable">$city</span>, <span class="hljs-variable">$country</span>);

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Person(<span class="hljs-variable">$address</span>);
    }
}
</code></pre>
<p>Pour le coup, tu te dis peut-√™tre que je te prends all√®grement pour un idiot : pourquoi se prendre le chou √† cr√©er une classe qui fait exactement ce qu‚Äôon faisait directement dans <code>Person</code> au d√©part ? Parce que tu n‚Äôas pas bien √©cout√©, <del>petit c</del> jeune padawan. L‚Äôobjectif en utilisant l‚Äôinjection de d√©pendances, c‚Äôest que nos classes ne soient pas d√©pendantes (justement) les unes des autres si ce n‚Äôest pas justifi√©. Une personne a beau avoir besoin d‚Äôune adresse, on pourrait fort bien imaginer les utiliser l‚Äôune sans l‚Äôautre (tu comprendras √† la partie suivante). Dans le cas de <code>PersonFactory</code>, notre objectif est justement de cr√©er une personne √† partir des diff√©rents composants d‚Äôune adresse en une ligne de code, pour conserver la simplicit√© du code m√©tier qui te tient tant √† coeur (et tu as bien raison, au fond). Seulement, <code>Person</code> et <code>Address</code> restent utilisables avec ou sans <code>PersonFactory</code> : l‚Äôobjectif est atteint, petit navire.</p>
<p>Tant qu‚Äôon en est √† se simplifier la vie :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PersonFactory</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getZipcodeFromDistrict</span><span class="hljs-params">(<span class="hljs-variable">$district</span>)</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-number">75000</span> + <span class="hljs-variable">$district</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createParigot</span><span class="hljs-params">(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$district</span>)</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;createPerson(<span class="hljs-variable">$number</span>, <span class="hljs-variable">$street</span>, <span class="hljs-variable">$this</span>-&gt;getZipcodeFromDistrict(<span class="hljs-variable">$district</span>), <span class="hljs-string">'Paris'</span>, <span class="hljs-string">'France'</span>);
    }
}
</code></pre>
<p>Tu t‚Äôimagines faire ce genre de chose dans la classe <code>Person</code> ou la classe <code>Address</code> ? J‚Äôesp√®re bien que non.</p>
<h2 id="oui-ca-sert-a-quelque-chose-une-interface">
      <a class="putainde-Title-anchor" href="#oui-ca-sert-a-quelque-chose-une-interface">#</a>
      Oui, √ßa sert √† quelque chose une interface
    </h2><p>Dans tes souvenirs brumeux de vendredis matins √©tudiants (<em>cf. supra</em>), tu retrouveras peut-√™tre des bribes de cours portant sur les <strong>interfaces</strong>. Si tout ce que tu as retenu, c‚Äôest qu‚Äô‚Äùune classe toute vide √ßa sert √† rien‚Äù, lis donc ce qui va suivre.</p>
<p>Une interface, c‚Äôest avant tout un contrat. Une classe qui <strong>impl√©mente</strong> une interface s‚Äôengage √† impl√©menter toutes les m√©thodes que celle-ci d√©clare. Sans m√™me lire le code de ladite classe, on sait donc d‚Äôembl√©e comment on peut jouer avec et comment elle est cens√©e fonctionner.</p>
<p>Poursuivons encore sur notre exemple et imaginons qu‚Äôon doive g√©rer des adresses ne respectant pas le format utilis√© jusqu‚Äôici, par exemple une adresse plus basique constitu√©e d‚Äôune unique cha√Æne de caract√®res :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BasicAddress</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;
}
</code></pre>
<p>Dans l‚Äô√©tat actuel des choses, on ne peut pas utiliser une instance de cette classe avec <code>Person</code>, puisque le constructeur de cette derni√®re attend une instance d‚Äô<code>Address</code>. Qu‚Äô√† cela ne tienne !</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">AddressInterface</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFullAddress</span><span class="hljs-params">()</span></span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BasicAddress</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AddressInterface</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$address</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFullAddress</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;address;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AddressInterface</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFullAddress</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;number.<span class="hljs-string">', '</span>.<span class="hljs-variable">$this</span>-&gt;street.<span class="hljs-string">', '</span>.<span class="hljs-variable">$this</span>-&gt;zipcode.<span class="hljs-string">' '</span>.<span class="hljs-variable">$this</span>-&gt;city.<span class="hljs-string">', '</span>.<span class="hljs-variable">$this</span>-&gt;country;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span>
</span>{
    <span class="hljs-comment">// ...</span>

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(AddressInterface <span class="hljs-variable">$address</span>)</span>
    </span>{
        <span class="hljs-variable">$this</span>-&gt;address = <span class="hljs-variable">$address</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAddress</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;address;
    }
}

<span class="hljs-variable">$address</span> = <span class="hljs-keyword">new</span> BasicAddress(<span class="hljs-string">'test test un deux un deux'</span>);
<span class="hljs-variable">$person</span> = <span class="hljs-keyword">new</span> Person(<span class="hljs-variable">$address</span>);

<span class="hljs-variable">$factory</span> = <span class="hljs-keyword">new</span> PersonFactory();
<span class="hljs-variable">$robert</span> = <span class="hljs-variable">$factory</span>-&gt;createParigot(<span class="hljs-number">1</span>, <span class="hljs-string">'Rue de la Paix'</span>, <span class="hljs-number">2</span>);

<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$person</span>-&gt;getAddress()-&gt;getFullAddress()); <span class="hljs-comment">// 'test test un deux un deux'</span>
<span class="hljs-keyword">echo</span>(<span class="hljs-variable">$robert</span>-&gt;getAddress()-&gt;getFullAddress()); <span class="hljs-comment">// '1, rue de la Paix, 75002 Paris, France'</span>
</code></pre>
<p>Tu vois l‚Äôid√©e ? En demandant une instance de n‚Äôimporte quelle classe impl√©mentant <code>AddressInterface</code> au lieu d‚Äôune instance d‚Äô<code>Address</code> sp√©cifiquement, on se donne plus de mou et on r√©duit encore davantage le couplage entre nos classes. Qu‚Äôon cr√©e une personne avec une instance d‚Äô<code>Address</code> ou de <code>BasicAddress</code>, on pourra dans tous les cas obtenir l‚Äôadresse postale de ladite personne de la m√™me fa√ßon.</p>
<h2 id="elle-contient-ta-fiancee-hein-mitch">
      <a class="putainde-Title-anchor" href="#elle-contient-ta-fiancee-hein-mitch">#</a>
      Elle contient ta fianc√©e, hein Mitch ?
    </h2><p>Tu auras peut-√™tre tiqu√© sur un d√©tail du dernier exemple : le fait de ne pas faire de <code>PersonFactory</code> une classe statique (beurk) nous oblige √† l‚Äôinstancier pour pouvoir l‚Äôutiliser ; ce qui, √† n‚Äôen pas douter, t‚Äôaura men√© √† te dire ‚Äúarf, √ßa va m‚Äôen faire des <code>new MachinFactory()</code> pour instancier mes objets‚Äù. L√† encore, l‚Äôinjection de d√©pendances peut nous aider, quoique de mani√®re indirecte : en utilisant un conteneur d‚Äôinjection de d√©pendances.</p>
<p>Un conteneur (√ßa sera plus court) peut <em>grosso modo</em> √™tre compar√© √† une grosse <em>factory</em> capable d‚Äôinstancier plusieurs classes. En pratique, afin d‚Äô√©viter d‚Äô√©crire et de devoir maintenir une classe monolithique, on en fera plut√¥t quelque chose qui fait appel aux diff√©rentes <em>factories</em>. Poursuivons sur notre exemple :</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DependencyInjectionContainer</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPersonFactory</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> PersonFactory();
    }
}
</code></pre>
<p>Mais √ßa ne s‚Äôarr√™te √©videmment pas l√†. De par le fait d‚Äôutiliser l‚Äôinjection de d√©pendances √† grande √©chelle, on a souvent besoin d‚Äôinstancier nous-m√™me les objets dont on a besoin. Dans certains cas, ce seront toujours les m√™mes, ce qui vaut pour les <em>factories</em> mais pas que : pense aux diff√©rentes librairies qui composent un projet web, par exemple. Ce ne serait pas g√©nial que les diff√©rentes instances de ces classes soient accessibles via le conteneur pour pouvoir y acc√©der √† l‚Äôenvi ?</p>
<pre><code class="lang-php"><span class="hljs-variable">$container</span> = <span class="hljs-keyword">new</span> DependencyInjectionContainer();

<span class="hljs-variable">$container</span>-&gt;getOrm()-&gt;performSomeNaughtyQuery();
<span class="hljs-variable">$container</span>-&gt;getTwig()-&gt;renderUglyTemplate();
<span class="hljs-variable">$container</span>-&gt;getTranslator()-&gt;translate(<span class="hljs-string">'Putain de code !'</span>);
</code></pre>
<p>Les objets ainsi g√©r√©s par un tel conteneur deviennent d√®s lors des <strong>services</strong> dans ton application.</p>
<blockquote>
<p>Mais √ßa signifie instancier un service √† chaque appel ?</p>
</blockquote>
<p>Pas n√©cessairement ! Il existe des m√©canismes permettant de conserver une m√™me instance pour la servir lors des appels suivants. Cela sort un peu du cadre de cet article, mais je t‚Äôinvite vivement √† jeter un oeil √† <a href="http://php-di.org/">PHP-DI</a>, qui est un conteneur d‚Äôinjection de d√©pendances tr√®s bien fichu que tu peux utiliser dans ton projet si tu le souhaites.</p>
<h2 id="epilogue">
      <a class="putainde-Title-anchor" href="#epilogue">#</a>
      √âpilogue
    </h2><p>Si tu d√©veloppes en PHP, j‚Äôesp√®re t‚Äôavoir montr√© qu‚Äôil est possible d‚Äô√©crire du code plus maintenable et plus √©l√©gant en utilisant l‚Äôinjection de d√©pendances. Dans le cas contraire, sache que ce concept est tr√®s r√©pandu dans les langages orient√©s objet d‚Äôune mani√®re g√©n√©rale - apr√®s tout, <a href="https://docs.angularjs.org/guide/di">on en retrouve m√™me dans Angular</a>.</p>
<p>Bon code, et n‚Äôoublie pas, on ne met pas en prod le vendredi, c‚Äôest mal. Allez, file !</p>
]]></description>
            <link>http://putaindecode.fr/posts/php/injection-dependances/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/php/injection-dependances/</guid>
            <pubDate>Wed, 05 Nov 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Laissez-vous pousser la barbe, apprenez √† √©crire des Makefiles]]></title>
            <description><![CDATA[<p>√Ä l‚Äôheure o√π tout le monde se rue sur des outils comme <a href="/posts/js/introduction-gulp/">Gulp</a>,
<a href="/posts/js/premiers-pas-avec-grunt/">Grunt</a> ou autres <a href="https://rubygems.org/gems/rake">Rake</a>, certains irr√©ductibles (dont je
fais partie) ont fait le choix d‚Äôemployer un des outils les plus standards et
embl√©matiques dont tout d√©veloppeur a entendu parler au moins une fois dans sa
vie : <em>Make</em>.</p>
<p>Si de prime abord on a l‚Äôimpression d‚Äôun syst√®me assez archa√Øque (ce qui n‚Äôest
pas toujours forc√©ment faux), on se rend rapidement compte que <em>Make</em>, coupl√© √†
une petite dose de scripting shell permet rapidement de mettre en place un moyen
de compiler ses fichiers et de lancer des t√¢ches.</p>
<p>Les fichiers de configuration de <em>Make</em> sont appell√©s <em>Makefiles</em> (oui, ce sont
eux qui ont donn√© leurs noms aux <code>(Gulp|Grunt|Rake)files</code>). Les instructions
qu‚Äôils contiennent sont ex√©cut√©es gr√¢ce √† la commande <code>make</code> dans votre
terminal.</p>
<h1 id="hello-world">
      <a class="putainde-Title-anchor" href="#hello-world">#</a>
      Hello World
    </h1><p>Je vous propose de commencer en douceur par un classique <em>Hello World</em>. On va
simplement d√©finir une t√¢che <code>hello-world</code> dont l‚Äôaction va √™tre d‚Äôafficher
<em>‚ÄúHello, world‚Äù</em> √† l‚Äô√©cran (boooring).</p>
<pre><code class="lang-make">hello-world:
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello, world"</span>
</code></pre>
<p>Premi√®re remarque importante, les indentations dans un <em>Makefile</em> <strong>doivent</strong>
√™tre faites avec des tabulations. Oui, je sais, c‚Äôest moche, on dirait du
Python, mais c‚Äôest comme √ßa.</p>
<p>Voil√† le genre d‚Äôerreurs qu‚Äôon se prend si on met des espaces √† la place des
tabulations :</p>
<pre><code>Makefile:2: <span class="hljs-keyword">*</span><span class="hljs-keyword">*</span><span class="hljs-keyword">*</span> s√©parateur manquant . Arr√™t.
</code></pre><p>Pour ex√©cuter notre commande, il nous suffit de lancer <code>make hello-world</code> dans
un terminal :</p>
<pre><code class="lang-console">$ <span class="hljs-keyword">make</span> hello-world
<span class="hljs-keyword">echo</span> <span class="hljs-string">"Hello, world"</span>
Hello, world
</code></pre>
<p>D√©cortiquons un peu cette ex√©cution. Pour chaque commande qu‚Äôil ex√©cute, <em>Make</em>
affiche la commande compl√®te avant d‚Äôafficher la sortie standard de ladite
commande. C‚Äôest souvent tr√®s pratique car toutes les variables (on va revenir l√† dessus)
qu‚Äôon met dans la commande sont r√©solues, et on voit clairement ce que <em>Make</em>
ex√©cute. Par contre, dans certains cas on s‚Äôen fout un peu, on peut alors
pr√©fixer la ligne √† rendre silencieuse par un <code>@</code>, comme √ßa :</p>
<pre><code class="lang-make">hello-world:
    @ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello, world"</span>
</code></pre>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>make hello-world
<span class="hljs-constant">Hello,</span> world
</code></pre>
<h1 id="regles-cibles-recettes-et-pre-requis">
      <a class="putainde-Title-anchor" href="#regles-cibles-recettes-et-pre-requis">#</a>
      R√®gles, cibles, recettes et pr√©-requis
    </h1><p>OK, jusque l√† c‚Äôest g√©nial, on a un super outil pour lancer des commandes qu‚Äôon
pourrait d√©j√† stocker dans un b√™te script shell. Pas super utile finalement.</p>
<p>Bon, on va corser un peu les choses et commencer par d√©finir un peu de
terminologie avant que vous soyez totalement largu√©s.</p>
<p>Un <em>Makefile</em> est une collection de <strong>r√®gles</strong>, chacune √©tant compos√©e d‚Äôune
<strong>cible</strong>, de <strong>pr√©-requis</strong> (ou pas) et d‚Äôune <strong>recette</strong>. Dans notre exemple
pr√©c√©dent, <code>hello-world</code> est la cible et <code>@ echo &quot;Hello, world&quot;</code> est la recette
de la r√®gle. Elle ne sp√©cifie par contre pas de pr√©-requis.</p>
<p>Relisez trois ou quatre fois le paragraphe pr√©c√©dent jusqu‚Äô√† ce que ce soit bien
imprim√©.</p>
<p>Vous l‚Äôaurez compris, on invoque une r√®gle depuis la ligne de commande en
sp√©cifiant le nom de sa cible apr√®s la commande <code>make</code>. Si on ne pr√©cise rien,
c‚Äôest la premi√®re r√®gle trouv√©e qui est ex√©cut√©e (donc dans notre cas,
<code>hello-world</code>).</p>
<p>Les pr√©-requis sont d√©clar√©s apr√®s la cible. On pourrait par exemple ajouter un
<code>sauter-une-ligne</code> comme pr√©-requis √† notre cible <code>hello-world</code> :</p>
<pre><code class="lang-make">hello-world: sauter-une-ligne
    @ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello, world"</span>

sauter-une-ligne:
    @ <span class="hljs-built_in">echo</span>
</code></pre>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>make hello-world

<span class="hljs-constant">Hello,</span> world
</code></pre>
<p>Facile, non ? Ok alors on peut <em>vraiment</em> attaquer les choses s√©rieuses.</p>
<h1 id="construire-des-fichiers">
      <a class="putainde-Title-anchor" href="#construire-des-fichiers">#</a>
      Construire des fichiers
    </h1><p>Les pr√©-requis sont particuli√®rement pratiques quand on veut construire un
fichier depuis un autre, ce qui est la principale action d‚Äô√† peu pr√®s tout
processus de compilation (para√Æt m√™me que c‚Äôest grosso modo la d√©finition de la
compilation).</p>
<p>On peut par exemple √©crire un <em>Makefile</em> nous permettant de compiler un fichier
<em>Markdown</em> en <em>HTML</em> :</p>
<pre><code class="lang-make"><span class="hljs-tag">article</span><span class="hljs-class">.html</span>: <span class="hljs-tag">article</span><span class="hljs-class">.md</span>
    marked <span class="hljs-tag">article</span><span class="hljs-class">.html</span> &gt; <span class="hljs-tag">article</span>.md
</code></pre>
<p>Cette r√®gle sp√©cifie simplement que pour construire le fichier <code>article.html</code>
j‚Äôai besoin du fichier <code>article.md</code> et que j‚Äôutilise la commande
<a href="https://www.npmjs.org/package/marked"><code>marked</code></a> pour construire le fichier. Essayez, vous verrez, c‚Äôest
magique.</p>
<p>L√† o√π √ßa devient int√©ressant, c‚Äôest que si je lance de nouveau <code>make
article.html</code>, rien ne se passe. Eh oui, <em>Make</em> v√©rifie les dates de
modification des pr√©-requis et les compare avec la date de modification de la
cible pour savoir s‚Äôil doit o√π non reconstruire la cible.</p>
<p>On peut bien s√ªr aller plus loin en ayant des fichiers qui d√©pendent de
fichiers, qui √† leur tour d√©pendent de fichiers, ‚Ä¶</p>
<p><a name="ref-phony-target"></a></p>
<p>On peut aussi avoir une cible factice qui ne repr√©sente pas un fichier et qui
elle-m√™me d√©pend de plusieurs fichiers (<code>website: index.html apropos.html
contact.html</code>).</p>
<h1 id="variables-et-substitutions">
      <a class="putainde-Title-anchor" href="#variables-et-substitutions">#</a>
      Variables et substitutions
    </h1><p>La syntaxe des variables dans un <em>Makefile</em> ressemblent beaucoup aux variables
de votre Shell, <em>mais pas tout √† fait</em>.</p>
<pre><code class="lang-make">SOURCE = <span class="hljs-keyword">index</span>.md
DESTINATION = <span class="hljs-keyword">index</span>.html

<span class="hljs-variable">${DESTINATION}</span>: <span class="hljs-variable">${SOURCE}</span>
  marked <span class="hljs-variable">${SOURCE}</span> &gt; <span class="hljs-variable">${DESTINATION}</span>
</code></pre>
<p>On peut aussi utiliser une substitution pour s‚Äô√©viter de tout retaper. La
syntaxe pour √ßa est assez simple et se passe d‚Äôexplications :</p>
<pre><code class="lang-make"><span class="hljs-variable">SOURCE =</span> index.md
<span class="hljs-variable">DESTINATION =</span> ${SOURCE:.<span class="hljs-variable">md=</span>.html}
</code></pre>
<p>L√† o√π √ßa devient beaucoup plus int√©ressant c‚Äôest qu‚Äôon peut stocker des listes
dans une variable. Pour √ßa, pas vraiment d‚Äôeffort √† faire, il suffit de rajouter
des noms √† la suite :</p>
<pre><code class="lang-make">SOURCE = index.<span class="hljs-built_in">md</span> article.<span class="hljs-built_in">md</span>
DESTINATION = ${SOURCE:.<span class="hljs-built_in">md</span>=.html}
</code></pre>
<p>Attention par contre ! En faisant √ßa si vous utilisez <code>${SOURCE}</code> comme cible
d‚Äôune r√®gle, vous allez d√©finir plusieurs r√®gles d‚Äôun coup, ce qui n‚Äôest peut
√™tre pas ce que vous voulez.</p>
<p>On peut contourner √ßa assez simplement en utilisant une substitution au niveau
de la r√®gle. La syntaxe est un poil diff√©rente :</p>
<pre><code class="lang-make"><span class="hljs-preprocessor">%</span>.html: <span class="hljs-preprocessor">%</span>.md
  [...]
</code></pre>
<p>Vous l‚Äôaurez compris, <code>%</code> est identique dans la cible et dans la d√©pendance,
donc avec cette r√®gle si vous faites un <code>make index.html</code>, <em>Make</em> va tenter de
construire la d√©pendance <code>index.md</code> avant tout.</p>
<p>Un probl√®me se pose √† nous avec cette syntaxe : ¬´ Bah merde, comment je r√©cup√®re
les noms de fichiers l√† ? ¬ª</p>
<h1 id="variables-speciales">
      <a class="putainde-Title-anchor" href="#variables-speciales">#</a>
      Variables sp√©ciales
    </h1><p>Superbe transition √©tant donn√© qu‚Äôon va parler ici de quelques variables
sp√©ciales bien pratiques !</p>
<ul>
<li><code>$@</code> contient le nom de la cible de la r√®gle en cours d‚Äôex√©cution ;</li>
<li><code>$^</code> contient la liste des d√©pendances de la r√®gle (la fl√®che pointe vers la
liste de d√©pendances) ;</li>
<li><code>$&lt;</code> contient la premi√®re d√©pendance de la r√®gle (la fl√®che pointe √† gauche,
l√† o√π est la d√©pendance).</li>
</ul>
<p>√Ä l‚Äôaide de celles-ci on peut du coup compl√©ter notre exemple pr√©c√©dent :</p>
<pre><code class="lang-make"><span class="hljs-variable">%.</span>html: <span class="hljs-variable">%.</span>md
  marked <span class="hljs-variable">$&lt;</span> &gt; <span class="hljs-variable">$@</span>
  [...]
</code></pre>
<h1 id="fonctions">
      <a class="putainde-Title-anchor" href="#fonctions">#</a>
      Fonctions
    </h1><p>Pour faciliter quelques op√©rations, <em>Make</em> fournit un ensemble de fonctions de
base. Appeler ces fonctions rappelle un peu la fa√ßon dont on lance une commande
dans un sous-shell en Bash : <code>$(fonction argument1 argument2)</code>.</p>
<p>Voici une petite d√©monstration de <code>wildcard</code>, <code>addsuffix</code> et <code>basename</code> dont
vous vous doutez sans doute les effets :</p>
<pre><code class="lang-make">SOURCES = <span class="hljs-variable">$(</span>wildcard <span class="hljs-variable">*.</span>md)
DESTINATIONS = <span class="hljs-variable">$(</span>addsuffix .html,<span class="hljs-variable">$(</span><span class="hljs-keyword">basename</span> <span class="hljs-variable">${SOURCES}</span>))

all: <span class="hljs-variable">${DESTINATIONS}</span>

<span class="hljs-variable">%.</span>html: <span class="hljs-variable">%.</span>md
  marked <span class="hljs-variable">$&lt;</span> &gt; <span class="hljs-variable">$@</span>
</code></pre>
<p>L‚Äôexemple construit dynamiquement la liste des fichiers HTML √† produire √† partir
de la liste des fichiers <em>Markdown</em> disponibles puis d√©finit une r√®gle <code>all</code>
permettant de tout construire d‚Äôun coup, et une r√®gle d√©finissant compiler
unitairement un fichier <em>Markdown</em> vers HTML.</p>
<p>Vous noterez qu‚Äô<code>addsuffix</code>/<code>basename</code> peut √™tre remplac√© par une substitution
simple comme on a vu pr√©c√©demment.</p>
<p>Je vous invite √† fouiller
<a href="https://www.gnu.org/software/make/manual/make.html#Functions">le chapitre sur les fonctions du manuel</a>.</p>
<h1 id="la-cible-phony">
      <a class="putainde-Title-anchor" href="#la-cible-phony">#</a>
      La cible <code>.PHONY</code>
    </h1><p>Dans certains cas la cible d‚Äôune r√®gle ne repr√©sente pas un fichier (c‚Äô√©tait le
cas de notre cible <code>website</code> <a href="#ref-phony-target">un peu plus haut</a>).</p>
<p>Dans ces cas-l√†, on va vouloir ex√©cuter la r√®gle quoi qu‚Äôil arrive, comme si la
cible √©tait tout le temps p√©rim√©e.</p>
<p>Une cible particuli√®re existe pour √ßa : <code>.PHONY</code>. Toutes les d√©pendances de
cette cible seront marqu√©es comme (traduction pourrie) imposteurs (<em>phony</em>
donc).</p>
<p>Pour reprendre l‚Äôexemple pr√©c√©dent, on d√©clarera donc :</p>
<pre><code class="lang-make"><span class="hljs-class">.PHONY</span>: website

website: index<span class="hljs-class">.html</span> apropos<span class="hljs-class">.html</span> contact<span class="hljs-class">.html</span>
  [...]
</code></pre>
<p>D√©sormais, chaque appel √† <code>make website</code> tentera de construire les d√©pendances
et ex√©cutera les commandes de la recette de la r√®gle.</p>
<h1 id="un-exemple-complet">
      <a class="putainde-Title-anchor" href="#un-exemple-complet">#</a>
      Un exemple complet
    </h1><p>L‚Äôexemple suivant permet de compiler un site Web depuis un ensemble de fichiers
<em>Markdown</em>.</p>
<pre><code class="lang-make"><span class="hljs-constant">SOURCES</span> = <span class="hljs-variable">$(</span>wildcard src/*.md)
<span class="hljs-constant">DESTINATIONS</span> = <span class="hljs-variable">${</span><span class="hljs-constant">SOURCES</span><span class="hljs-symbol">:src/%</span>.md=build/%.html}

<span class="hljs-symbol">all:</span> <span class="hljs-variable">${</span><span class="hljs-constant">DESTINATIONS</span>}

<span class="hljs-symbol">info:</span>
    @ echo <span class="hljs-constant">Will</span> build <span class="hljs-variable">${</span><span class="hljs-constant">DESTINATIONS</span>} from <span class="hljs-variable">${</span><span class="hljs-constant">SOURCES</span>}

<span class="hljs-symbol">clean:</span>
    rm -f <span class="hljs-variable">${</span><span class="hljs-constant">DESTINATIONS</span>}

build/%.<span class="hljs-symbol">html:</span> src/%.md
    mkdir -p build
    marked <span class="hljs-variable">$&lt;</span> &gt; <span class="hljs-variable">$@</span>

.<span class="hljs-constant">PHONY</span><span class="hljs-symbol">:</span> all info clean
</code></pre>
<p>Vous noterez que comme on stocke nos r√©sultats dans le dossier <code>build</code>, il faut
potentiellement le cr√©er quand on compile un fichier dedans.</p>
<h1 id="pour-aller-plus-loin">
      <a class="putainde-Title-anchor" href="#pour-aller-plus-loin">#</a>
      Pour aller plus loin
    </h1><p>Il existe bien d‚Äôautres fonctionnalit√©s dans <em>Make</em> (du moins dans <em>GNU Make</em>),
avec notamment :</p>
<ul>
<li>Les <a href="https://www.gnu.org/software/make/manual/make.html#Canned-Recipes"><em>canned recipes</em></a> (recettes en bo√Æte), permettant de
d√©finir un bout de r√®gle r√©utilisable √† plusieurs endroits.</li>
<li>Des <a href="https://www.gnu.org/software/make/manual/make.html#Functions">expressions conditionnelles</a> pour avoir des tests
dans votre <em>Makefile</em> et effectuer des traitements diff√©rents selon
l‚Äôenvironnement.</li>
<li>Les <a href="https://www.gnu.org/software/make/manual/make.html##Prerequisite-Types">r√®gles en <em>order only</em></a> qui permettent d‚Äôindiquer une
d√©pendance dont la date de modification ne doit pas √™tre prise en compte (on
peut s‚Äôen servir pour √©viter le <code>mkdir</code> dans l‚Äôexemple complet).</li>
<li>Et <a href="https://www.gnu.org/software/make/manual/make.html#Functions">plein d‚Äôautres fonctions</a> bien pratiques !</li>
</ul>
<p>Je vous invite aussi √† jeter un coup d‚Äô≈ìil au <a href="https://github.com/madx/veil/"><em>Makefile</em> de Veil</a>, un outil que
j‚Äôutilise pour g√©n√©rer des sites statiques √† partir de fichiers <em>Markdown</em>
(ah bah tiens, comme dans mes exemples, c‚Äôest rigolo). Il y a plein de
fonctionnalit√©s de <em>Make</em> utilis√©es dans ce projet et je pense que √ßa peut √™tre
source d‚Äôid√©es.</p>
<p>Voil√† pour cette premier introduction √† <em>Make</em>, j‚Äôesp√®re que √ßa vous a plu et
que vous √™tes fin pr√™ts √† affronter tous ces bouseux avec leur syst√®me de build
√† base de streams, de brocolis et autres r√¢teaux.</p>
]]></description>
            <link>http://putaindecode.fr/posts/shell/apprendre-les-makefiles/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/shell/apprendre-les-makefiles/</guid>
            <pubDate>Mon, 03 Nov 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[L'auto-entrepreneuriat : retour d'exp√©riences]]></title>
            <description><![CDATA[<figure>
  <img src="index.jpg" alt="Desktop">
  <small><a href="http://freebiesxpress.com/gallery/macbook-air-table-direct-stock-photo/">Credit photo</a></small>
</figure>

<p>L‚Äôauto-entreprenariat, voil√† la belle id√©e. Un statut facile qui permet √† n‚Äôimporte qui de cr√©er sa propre entreprise. Une belle opportunit√© pour se lancer facilement et sans trop de risque √† l‚Äôind√©pendance.</p>
<p>Ch√¥meur ? Cela vous permet de cr√©er votre propre travail et de toucher tout de m√™me vos aides sociales (en soustrayant certes vos gains).</p>
<p>En CDI ? Cela permet de vous aventurer en dehors de votre travail principal sur des t√¢ches que vous n‚Äôavez pas forc√©ment l‚Äôoccasion de faire comme g√©rer un client, effectuer des factures, √©changer avec l‚Äôadministration (ah quel plaisir, √ßa).</p>
<p>√âtudiant(e) ? Cela peut s√©rieusement vous aider √† financer (malheureusement ?) vos √©tudes ou √† √™tre plus ind√©pendant(e) de vos parents.</p>
<p>Tant de raisons qui peuvent vous pousser √† vous ouvrir √† l‚Äôauto-entreprise. Et pour √ßa, <a href="http://kud.io/">_kud</a> et <a href="http://moox.io/">MoOx</a> ont v√©cu cette exp√©rience et vous proposent de r√©pondre √† quelques questions pour vous faire une petite id√©e.</p>
<h2 id="pourquoi-avez-vous-cree-votre-entreprise">
      <a class="putainde-Title-anchor" href="#pourquoi-avez-vous-cree-votre-entreprise">#</a>
      Pourquoi avez-vous cr√©√© votre entreprise ?
    </h2><h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>√âtant d√©j√† en CDI et √©tant souvent sollicit√© pour cr√©er des petits sites √† droite √† gauche, je voulais m‚Äôinitier √† plusieurs choses comme la cr√©ation d‚Äôentreprise, l‚Äôind√©pendance, me confronter √† l‚Äôadministration et surtout g√©rer un client.</p>
<p>Et puis bon, cela me permettait aussi d‚Äôavoir un petit bonus non d√©sagr√©able en fin de mois.</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p><em>Travailler plus pour gagner plus</em>, au d√©part √ßa devait √™tre pour cette raison. Je n‚Äôavais pas de quoi frimer √† la sortie de l‚Äô√©cole, et je pouvais encore moins me payer de la blanche. Il me fallait donc une solution (rires). Plus s√©rieusement, dans le fond, tout comme Erwann, j‚Äôavais s√ªrement envie de tester un mod√®le plus ind√©pendant que le CDI, en attendant que <a href="http://revenudebase.info/comprendre-le-revenu-de-base/">le revenu de base</a> vienne bien d√©molir le mod√®le actuel.</p>
<h2 id="comment-s-inscrire">
      <a class="putainde-Title-anchor" href="#comment-s-inscrire">#</a>
      Comment s‚Äôinscrire ?
    </h2><p>C‚Äôest relativement simple. Il faut aller sur le <a href="http://www.lautoentrepreneur.fr/">site de l‚Äôauto-entrepreneur</a> et remplir le formulaire.</p>
<h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>En ce qui me concerne, j‚Äôai choisi ‚ÄúPrestations de services informatiques‚Äù, ce qui me permettait d‚Äô√™tre plut√¥t libre sur mes actions :</p>
<ul>
<li>donner des cours d‚Äôinformatique ;</li>
<li>cr√©er des sites web ;</li>
<li>faire de la r√©paration (m√™me si ce n‚Äôest pas vraiment un cas que je souhaitais envisager).</li>
</ul>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>Dans la pratique, l‚Äôinscription peut en effet √™tre tr√®s rapide. Cela dit, je me rappelle m‚Äô√™tre pris la t√™te avec le choix des mutuelles (choix qui, si tu as d√©j√† un CDI, ne sert pas vraiment √† grand-chose √† ce que j‚Äôai fini par comprendre).
Pour ce qui est du code, j‚Äôavais pris ‚ÄúProgrammation informatique‚Äù (6201Z)  car je ne regardais pas vraiment plus loin que le bout de mon nez √† l‚Äô√©poque (2010). Apr√®s, on n‚Äôira pas vous ennuyer avec √ßa, je pense.</p>
<h2 id="qu-avez-vous-fait-avec">
      <a class="putainde-Title-anchor" href="#qu-avez-vous-fait-avec">#</a>
      Qu‚Äôavez vous fait avec ?
    </h2><h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>C‚Äôest une bonne question.</p>
<p>J‚Äôai pass√© quelques soir√©es et week-end √† faire des sites en urgence, chose pas forc√©ment agr√©able car peu d‚Äôapprentissage c√¥t√© technologie‚Ä¶ Mais par contre g√©rer le client √©tait tr√®s passionnant.</p>
<p>J‚Äôai aussi, √† ma surprise, r√©ussi √† donner des cours. Deux fois. Une fois une semaine avec des licences sur le th√®me de la cr√©ation de sites mobiles en <em>single page</em> avec du <a href="http://backbonejs.org/">backbone.js</a> entre autres. Une autre fois √† des gens en reconversion. Le but √©tait de leur apprendre √† cr√©er leur propre site web (statique) ainsi qu‚Äô√† comprendre (bri√®vement) comment marchaient Internet et le Web. J‚Äôai tout bonnement <strong>ador√©</strong>.</p>
<p>(Je sens que MoOx va encore dire ‚Äúpareil qu‚ÄôErwann‚Äù‚Ä¶)</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>Pareil qu‚ÄôErwann (<strong>_kud</strong>: <em>bingo</em>), au d√©but c‚Äô√©tait forfait soir et week-end de temps en temps. J‚Äôai pris quelques petits projets sur mesure ou ‚Äúdu WordPress pour manger‚Äù (2 fois seulement je le jure).
Ensuite √ßa m‚Äôa fatigu√© mine de rien, puis j‚Äôavais d‚Äôautres priorit√©s m√™me si mon seul salaire en CDI pour nourrir 2 bouches √©tait juste. J‚Äôai donc arr√™t√© un moment, sans pour autant fermer l‚ÄôAE (√©tant donn√© qu‚Äôau d√©but, 0 CA = 0 charge).
Mais c‚Äôest l√† o√π mon exp√©rience avec l‚ÄôAE est int√©ressante. J‚Äôai laiss√© dormir le truc.</p>
<p>Puis par la suite, <a href="http://viserlalune.com/blog/et-si-le-cdi-etait-une-connerie/">le CDI √©tant ce qu‚Äôil est</a> avec ses bons et surtout ses mauvais c√¥t√©s, un jour apr√®s que le projet sur lequel j‚Äôai √©t√© embauch√© soit jet√© √† la poubelle et que je doive me rabattre sur d‚Äôautres t√¢ches qui ne m‚Äôamusaient plus du tout, j‚Äôai d√©cid√© de d√©missionner.
Mais bon, c‚Äô√©tait une situation un peu tendue, car je n‚Äôavais rien en plan B. Qui dit d√©mission, dit ‚Äúd√©merde-toi‚Äù. Et √† Toulouse, des boulots int√©ressants dans le web, si tu veux faire autre chose que du PHP, c‚Äôest un peu tendu du <code>string</code>.</p>
<p>En cherchant, j‚Äôai d√©couvert un truc sympa : la <a href="http://travail-emploi.gouv.fr/informations-pratiques,89/les-fiches-pratiques-du-droit-du,91/rupture-conventionnelle-du-contrat,1208/la-rupture-conventionnelle-du,8383.html">rupture conventionnelle</a>.
Pour faire simple, c‚Äôest une d√©mission √† l‚Äôamiable avec ton patron. Il faut son accord et tout le tralala administratif, mais √† partir du moment o√π tu es en bons termes avec ton patron (et s‚Äôil n‚Äôest pas assez stupide pour dire des choses du genre ‚Äúsi tu veux te barrer, barre-toi, je ne l√¢cherai pas un sou‚Äù), c‚Äôest une fa√ßon de partir et d‚Äôavoir droit aux indemnit√©s ch√¥mage (pour peu que tu aies assez cotis√©, bien entendu).
Avec cette solution, je pouvais partir, en sachant que mes cotisations pour P√¥le Emploi n‚Äô√©taient pas inutiles.
Clairement, mon but n‚Äô√©tait pas de vivre de √ßa (avec m√™me pas 60 % de mon salaire qui √©tait d√©j√† juste, je vous laisse imaginer la mis√®re) mais c‚Äô√©tait plus d‚Äôavoir un parachute, pour √©viter d‚Äôaller pleurer √† papa et maman pour pouvoir payer le loyer et le cr√©dit de mon A3 (sans quoi j‚Äôaurais √©t√© forc√© de ne manger que des p√¢tes achet√©es par sachet de 20 kg). Blague √† part, je partais en ayant une botte de paille en bas de ma chute, histoire de pas me casser toutes les c√¥tes si je ne trouvais rien o√π m‚Äôaccrocher au passage.</p>
<p>Je me lance donc dans une recherche effr√©n√©e, principalement pour du t√©l√©travail (car √ßa marchait pour moi depuis un moment, m√™me si en France faut s‚Äôaccrocher pour trouver des entreprises ouvertes √† ce mode de travail). Et cette fois-ci (car je d√©missionnais souvent, par ennui :/), j‚Äôai eu du mal √† trouver chaussure √† mon pied. Beaucoup de mal. Et j‚Äô√©tais mal.
Mais c‚Äô√©tait sans compter que l‚ÄôInternet, c‚Äôest un r√©seau mondial. Avec un peu de bonne volont√©, j‚Äôavais trouv√© de quoi b√©n√©ficier d‚Äôune visibilit√© mondiale (no shit). Une fois via <a href="http://gun.io">gun.io</a> et une fois via Twitter (pour trouver du boulot en fait c‚Äôest pas mal, via quelques tweets et retweets). Finalement, j‚Äôai rapidement pu bosser pour des entreprises situ√©es aux USA (no shit¬≤).</p>
<p>Le fait de ne pas avoir ferm√© l‚ÄôAE a simplifi√© beaucoup de choses : je pouvais faire des factures l√†, de suite. Puis aux √âtats-Unis, √ßa ne rigole pas, √ßa ne paye pas comme en France √† 30 ou 45 jours, √ßa payait tous les 15 jours, le jour o√π tu envoies la facture. BONHEUR.</p>
<p>Bon, par contre attention, quand tu bosses avec des gens qui consid√®rent bien ton travail, et qui te mettent sur un pi√©destal (tu es en position de force cher d√©veloppeur, je te laisse √† l‚Äô√©tymologie du nom de m√©tier) plut√¥t que de te prendre pour la derni√®re roue du carrosse, tu vas vite d√©passer le plafond impos√© par l‚ÄôAE (no shit¬≥).
<a href="https://gist.github.com/tibastral/8301072">Et il n‚Äôy a pas que mon exp√©rience qui vous le dira</a>.</p>
<p>Pour l‚Äôanecdote, je n‚Äôai demand√© les indemnit√©s de ch√¥mage que deux mois seulement sur pr√®s d‚Äôun an en situation freestyle (avant que je change pour un vrai statut).</p>
<p>Du coup, pour moi l‚ÄôAE aura √©t√© une bonne transition entre CDI, situation pr√©caire et ma situation actuelle de freelance. J‚Äôai bien entendu chang√© rapidement de statut depuis (pour passer simplement √† l‚ÄôAE Level 2, l‚Äô<a href="http://www.apce.com/pid1628/l-entreprise-individuelle.html?espace=1&amp;tp=1">entreprise individuelle</a>.</p>
<h2 id="que-deviez-vous-declarer">
      <a class="putainde-Title-anchor" href="#que-deviez-vous-declarer">#</a>
      Que deviez-vous d√©clarer ?
    </h2><p>Oui, parce que c‚Äôest bien beau tout √ßa mais qui dit statut administratif dit d√©claration.</p>
<h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>Tous les trimestres, je me devais de <a href="http://www.net-entreprises.fr/">d√©clarer</a> ce que je facturais √† mes clients et je payais directement mes imp√¥ts via le versement lib√©ratoire.</p>
<p>Bon, je vous avoue que j‚Äôai mis du temps √† comprendre o√π je devais d√©clarer car vous avez trois champs √† remplir, et quand vous ne comprenez rien au charabia administratif, c‚Äôest pas super facile.</p>
<p>Bref, une fois que vous avez d√©clar√© vos revenus, un imp√¥t se calcule automatiquement et vous √™tes d√©bit√©(e) √† la date indiqu√©e.</p>
<p>Plut√¥t simple dans l‚Äôid√©e.</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>J‚Äôavais choisi aussi le versement lib√©ratoire, m√™me constat. Il ne faut pas h√©siter √† prendre le t√©l√©phone pour obtenir une r√©ponse pertinente au plus vite sans perdre de temps. Se rendre sur place dans le lieu ad√©quat est encore une meilleure id√©e pour √™tre s√ªr de ne pas se tromper.</p>
<h2 id="avez-vous-eu-des-surprises">
      <a class="putainde-Title-anchor" href="#avez-vous-eu-des-surprises">#</a>
      Avez-vous eu des surprises ?
    </h2><h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>Tout d‚Äôabord, ce qui est quelque peu d√©stabilisant, c‚Äôest la quantit√© de courriers re√ßus. Pr√©voyances, mutuelles, maaaaaass papiers. En fait, c‚Äôest pas tant la quantit√© qui d√©stabilise, ce sont plut√¥t les propos. ‚ÄúVous avez cr√©√© une entreprise, c‚Äôest bien. Savez-vous que vous √™tes dans l‚Äôobligation de souscrire √† une mutuelle/pr√©voyance ?!‚Äù.</p>
<p>Si vous n‚Äô√™tes pas un tant soit peu renseign√©(e), vous tomberez dans le pi√®ge et vous souscrirez √† des choses dont vous n‚Äôavez pas du tout besoin.</p>
<p>En effet, lorsque vous vous inscrivez √† l‚ÄôURSSAF, celle-ci met par la suite √† disposition son fichier d‚Äôentreprises √† diff√©rents organismes et ces derniers n‚Äôh√©sitent pas √† vous mettre le grappin dessus afin que vous souscriviez √† leurs formules pour qu‚Äôils se fassent de la thune. Oui, car quand vous avez une entreprise, vous avez la plupart du temps des employ√©s et dans ce cas, vous devez souscrire √† certaines obligations pour couvrir vos employ√©s. Sauf que ce que ne pr√©cise pas l‚ÄôURSSAF dans son fichier, c‚Äôest que vous √™tes une entreprise d‚Äôauto-entrepreneur, et √ßa, √ßa change tout. Ouaip, vu que vous n‚Äôavez pas d‚Äôemploy√©(e), vous avez un statut diff√©rent des autres bo√Ætes et il n‚Äôest pas du tout question de souscrire √† quoi que ce soit. Surtout des mutuelles ou pr√©voyances qui couvrent des employ√©s inexistants. Vous avez tout √† fait le droit de souscrire √† une mutuelle pour vous mais nullement pour votre entreprise.</p>
<p>Pour ma part, une fois que j‚Äôeus compris ceci, j‚Äôai tout jet√© √† la poubelle. :) (bande de vautours va).</p>
<p>Passons √† un autre domaine en terme de surprise : l‚Äôimp√¥t sur votre revenu d‚Äôauto-entrepreneur.</p>
<p>Moi qui pensais √™tre tranquille en payant directement par versement lib√©ratoire, foutaise !</p>
<p>Alors oui, vous payez vos imp√¥ts directement d√®s que vous d√©clarez ce que vous avez factur√©. √áa, okay.</p>
<p>Cependant, la chose que je n‚Äôavais pas calcul√©e et dont personne ne m‚Äôavait pr√©venu : il n‚Äôest pas du tout pareil d‚Äô√™tre auto-entrepreneur sans et avec un travail √† c√¥t√©.</p>
<p>Certes, on vous demandera de d√©clarer vos revenus annexes sur les imp√¥ts sur le revenu seulement <strong>√† titre informatif</strong>. Oui, vous ne paierez pas d‚Äôimp√¥ts dessus en plus. Mais par contre cela fera augmenter votre quotient familial.</p>
<p>Explication. Si vous √©tiez de base √† 10 % sur le revenu en imp√¥ts sur votre CDI, le fait que vous soyez en auto-entrepreneur et que vous gagniez de l‚Äôargent fait que votre quotient familial sera plus important et donc vous augmenterez le taux d‚Äôimposition sur votre CDI qui sera par exemple √† 13,5 %, au lieu de 10 % initiaux. Ce qui ne vous fera finalement pas un imp√¥t √† 23,5 % sur votre activit√© d‚ÄôAE (que vous payez directement chaque trimestre) mais plut√¥t 30 % du fait d‚Äôavoir un travail √† c√¥t√©.</p>
<p>C‚Äôest tout √† fait normal me direz-vous vu qu‚Äôil doit bien y avoir une diff√©rence entre une personne qui n‚Äôa que l‚ÄôAE et une personne ayant d√©j√† un job. Mais c‚Äôest juste que ce n‚Äô√©tait pas du tout pr√©vu dans mes calculs et en connaissance de cause, j‚Äôaurais s√ªrement augment√© mes tarifs AE.</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>Ce qui m‚Äôa le plus surpris aussi c‚Äôest l‚Äôimpression de me transformer en fichier vendu : je me suis aussi retrouv√© √† recevoir plein de courriers d‚Äôentreprise en tout sens. C‚Äôest d‚Äôun p√©nible‚Ä¶</p>
<p>J‚Äôavais choisi aussi le versement lib√©ratoire, et mon faible revenu pour 2 parts √† l‚Äô√©poque n‚Äôavait pas eu d‚Äôimpact puisque je ne payais m√™me pas d‚Äôimp√¥ts.</p>
<h2 id="si-vous-l-avez-arrete-pourquoi">
      <a class="putainde-Title-anchor" href="#si-vous-l-avez-arrete-pourquoi">#</a>
      Si vous l‚Äôavez arr√™t√©, pourquoi ?
    </h2><h5 id="_kud">
      <a class="putainde-Title-anchor" href="#_kud">#</a>
      <strong>_kud</strong>
    </h5><p>Je n‚Äôavais plus assez de temps pour moi. Les d√©marches m‚Äôont un peu saoul√© (m√™me s‚Äôil y en avait vraiment pas beaucoup mais devoir constamment d√©clarer m√™me si vous √™tes √† 0 ‚Ç¨ sous peine d‚Äôavoir une amende, √ßa fait chier).</p>
<p>Je n‚Äôai pas non plus appr√©ci√© voir mon taux d‚Äôimp√¥ts sur le revenu augmenter, c‚Äô√©tait pas ce qui √©tait ‚Äúvendu‚Äù lorsque ce statut m‚Äôa √©t√© pr√©sent√©.</p>
<p>Et puis, je risquais de payer <a href="http://vosdroits.service-public.fr/professionnels-entreprises/F23547.xhtml">la taxe CFE</a> d‚Äôici l‚Äôann√©e prochaine. Chose d‚Äôailleurs qui n‚Äôest toujours pas claire d‚Äôapr√®s ce que je peux lire sur Internet : les AE ne savent toujours pas si la CFE va devoir √™tre pay√©e ou non.</p>
<p>J‚Äôai surtout constat√© que je souhaitais avant tout donner des cours et √† ce sujet, on m‚Äôa propos√© une offre plus avantageuse que le statut d‚ÄôAE, donc‚Ä¶</p>
<h5 id="moox">
      <a class="putainde-Title-anchor" href="#moox">#</a>
      <strong>MoOx</strong>
    </h5><p>Comme indiqu√© plus t√¥t, j‚Äôai √©t√© limit√© par le plafond, j‚Äôai donc pass√© la vitesse sup√©rieure via une EI !</p>
<h2 id="comment-arreter">
      <a class="putainde-Title-anchor" href="#comment-arreter">#</a>
      Comment arr√™ter
    </h2><p>Aller sur le site de l‚Äô<a href="https://www.cfe.urssaf.fr/autoentrepreneur/CFE_Bienvenue">AE</a> puis cliquer sur ‚ÄúCesser d√©finitivement votre activit√©‚Äù tout en bas. Un formulaire vous sera propos√© o√π vous rentrerez vos informations puis il vous sera demand√© de l‚Äôimprimer. Signez-le et envoyez-le √† l‚Äôadresse uniquement (avec accus√© de r√©ception vivement conseill√©).</p>
<p>Vous recevrez dans les jours suivants un courrier de l‚ÄôURSSAF vous indiquant que vous avez bien √©t√© radi√©(e).</p>
<p>Oh et vous recevrez aussi du courrier de mutuelles ou pr√©voyances, comme d‚Äôhabitude, √† jeter. Du d√©but √† la fin, ils vous feront chier.</p>
<h2 id="conclusion">
      <a class="putainde-Title-anchor" href="#conclusion">#</a>
      Conclusion
    </h2><p>L‚ÄôAE reste un tr√®s bon moyen de s‚Äôinitier au freelance, √† la cr√©ation d‚Äôentreprise sans trop de risque. Les d√©marches sont plut√¥t simples, vous n‚Äôavez pas besoin de comptable, et l‚Äôimp√¥t est de l‚Äôordre de 23 % √† 35 % en fonction de votre situation professionnelle initiale, ce qui est tout reste tout de m√™me bien moins important que freelance ou une ‚Äúvraie‚Äù entreprise.</p>
<p>N‚Äôh√©sitez pas √† vous en servir pour sortir de votre zone de confort !</p>
<p>Dans tous les cas, si vous souhaitez en savoir plus, n‚Äôh√©sitez pas √† aller sur <a href="http://www.economie.gouv.fr/cedef/auto-entrepreneur">le site du gouvernement</a>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/entreprendre/auto-entrepreneuriat-retour-experiences/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/entreprendre/auto-entrepreneuriat-retour-experiences/</guid>
            <pubDate>Thu, 30 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Premi√®re application Ember]]></title>
            <description><![CDATA[<p>Apr√®s l‚Äô<a href="/posts/js/debuter-avec-ember">article pr√©c√©dent</a> qui a d√©taill√© les principaux concepts d‚Äô<a href="http://emberjs.com">Ember</a>, il est grand temps de
se d√©gourdir les doigts. Comme on a peur de rien, on va m√™me construire progressivement ensemble une application
avec <a href="http://emberjs.com">Ember</a>.</p>
<p>Bon, faut pas non plus trop vous emballer, c‚Äôest juste une application bateau de gestion d‚Äôune collection de BD. 
√áa pourrait √™tre des clients, des l√©gumes ou des timbres mais l√†, c‚Äôest des BD.</p>
<h2 id="structure-d-une-application-ember">
      <a class="putainde-Title-anchor" href="#structure-d-une-application-ember">#</a>
      Structure d‚Äôune application Ember
    </h2><p>L‚Äô<a href="/posts/js/debuter-avec-ember">article pr√©c√©dent</a> a insist√© sur le fait qu‚Äô<a href="http://emberjs.com">Ember</a> √©tait un framework avec des partis pris forts et un mod√®le de d√©veloppement structurant. </p>
<p><em>Note : sur ce sujet, vu que <a href="/posts/js/debuter-avec-ember/#comment-1644383934">√ßa fait r√©agir</a>, je pr√©cise. Je ne dis pas que c‚Äôest bien ou que ce n‚Äôest pas bien.
Je dis juste que c‚Äôest une caract√©ristique importante d‚Äô<a href="http://emberjs.com">Ember</a>. Autant le savoir.</em></p>
<p>Eh bien, aussi √©tonnant que cela puisse para√Ætre, <a href="http://emberjs.com">Ember</a> <strong>nous laisse quand m√™me nous d√©brouiller tout seul comme des grands pour organiser nos applications</strong>.</p>
<p>Il existe donc diff√©rentes mani√®res de structurer une application <a href="http://emberjs.com">Ember</a>, de la plus basique √† la plus compl√®te et, sur ce point, chacun pourra trouver ce qui conviendra le mieux √† ses go√ªts, ses envies, ses contraintes, son contexte‚Ä¶ Que sais-je ? Ci-dessous, quelques exemples parmi d‚Äôautres.</p>
<h3 id="a-la-mano">
      <a class="putainde-Title-anchor" href="#a-la-mano">#</a>
      √Ä la mano
    </h3><p>De base, avec <a href="http://emberjs.com">Ember</a> on peut donc d√©clarer nos routes, contr√¥leurs, mod√®les, etc. dans un seul fichier JavaScript ou dans une balise <code>&lt;script&gt;</code>. On doit par contre imp√©rativement respecter les <a href="http://emberjs.com/guides/concepts/naming-conventions/">conventions de nommage</a> et enregistrer nos objets dans une variable globale : </p>
<pre><code class="lang-js">App = Ember.Application.create();

App.Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  ...
});

App.BookRoute = Ember.Route.extend({
  ...
});
</code></pre>
<p>De la m√™me mani√®re, on peut d√©clarer nos gabarits <a href="http://handlebarsjs.com/">Handlebars</a> via des balises <code>&lt;script&gt;</code> :</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/x-handlebars"</span>&gt;</span><span class="handlebars"><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
    </span><span class="hljs-expression">{{<span class="hljs-variable"><span class="hljs-keyword">outlet</span></span>}}</span><span class="xml">
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</span></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
<h3 id="outille">
      <a class="putainde-Title-anchor" href="#outille">#</a>
      Outill√©
    </h3><p>Comme on peut trouver √ßa un peu limit√© dans la vraie vie, on peut essayer d‚Äôorganiser nous-m√™me notre application, nos fichiers, g√©rer des modules, etc. Tout √ßa va passer par l‚Äôutilisation d‚Äôun outil de build javascript de type <a href="http://gruntjs.com/">Grunt</a>, <a href="http://gulpjs.com/">Gulp</a>, <a href="https://github.com/broccolijs/broccoli">Broccoli</a>. Ces outils vont nous permettre
de concat√©ner nos diff√©rents fichiers JavaScript en un seul, de sortir les gabarits dans des fichiers <code>.hbs</code> et de les pr√©compiler. On n‚Äôaura ensuite qu‚Äô√† importer ces fichiers dans notre index.html :</p>
<pre><code class="lang-html">...
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"dist/libs/handlebars.min.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"dist/libs/ember.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"dist/application.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"dist/templates.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
...
</code></pre>
<p>√áa peut convenir parfaitement et on peut se mitonner des phases de build aux petits oignons pour nos besoins sp√©cifiques. Mais on peut aussi rester un peu sur sa faim. Surtout si on a choisi <a href="http://emberjs.com">Ember</a> pour son c√¥t√© structurant.</p>
<p>Du coup, une partie des membres de l‚Äô√©quipe <a href="http://emberjs.com">Ember</a> a mis au point <a href="http://www.ember-cli.com/">Ember CLI</a>.</p>
<h3 id="ember-cli">
      <a class="putainde-Title-anchor" href="#ember-cli">#</a>
      Ember CLI
    </h3><p><a href="http://www.ember-cli.com/">Ember CLI</a> est une <strong>interface en ligne de commande</strong> pour <a href="http://emberjs.com">Ember</a>. Elle repose
sur l‚Äôoutil de build <a href="https://github.com/broccolijs/broccoli">Broccoli</a> et permet : </p>
<ul>
<li>d‚Äôinitialiser une application Ember avec, cette fois, une <a href="http://www.ember-cli.com/#folder-layout">structure de fichiers</a> et des
<a href="http://www.ember-cli.com/#naming-conventions">conventions de nommage</a></li>
<li>de g√©n√©rer diff√©rents objets en mode scaffolding via des <a href="http://www.ember-cli.com/#using-ember-cli">commandes</a>. Autant le dire tout de suite, je ne suis pas fan du scaffolding mais on va regarder quand m√™me pour ne pas mourir idiots.</li>
<li>d‚Äôutiliser des outils de build bas√©s sur <a href="https://github.com/broccolijs/broccoli">Broccoli</a> pour le pr√©traitement des pr√©-processeurs CSS par exemple</li>
<li>d‚Äôutiliser les <a href="https://people.mozilla.org/~jorendorff/es6-draft.html">modules ES6</a> plut√¥t 
qu‚Äô<a href="http://en.wikipedia.org/wiki/Asynchronous_module_definition">AMD</a> ou 
<a href="http://en.wikipedia.org/wiki/CommonJS">CommonJS</a> pour la modularisation. Cette question a √©t√©
largement d√©battue. Si √ßa vous int√©resse, je vous laisse d√©couvrir un 
<a href="http://tomdale.net/2012/01/amd-is-not-the-answer/">article tr√®s int√©ressant</a> √† ce sujet.</li>
<li>‚Ä¶</li>
</ul>
<p>Je ne vais pas vous d√©tailler davantage le truc, vous trouverez vous-m√™me la <a href="http://www.ember-cli.com/">doc officielle</a>. Et puis, on va tout de suite le mettre en pratique.</p>
<p><em>Note : l√† encore, <a href="http://www.ember-cli.com/">Ember CLI</a>, c‚Äôest un parti pris. Ce sera probablement tr√®s bien accueilli par certains pour qui cela offre un cadre de travail structur√© et structurant. Mais ce sera aussi rejet√© par d‚Äôautres qui le verront comme une grosse machine inutile.
Ici encore, question de go√ªt, question de contexte, question de besoins.</em></p>
<p>Tr√®ves de bavardages, on s‚Äôy met s√©rieusement :</p>
<p>On installe <a href="http://nodejs.org/">Node</a>, <a href="http://www.ember-cli.com/">Ember CLI</a>, <a href="http://bower.io/">Bower</a> :</p>
<pre><code class="lang-console">$ npm install -<span class="hljs-keyword">g</span> ember-<span class="hljs-keyword">cli</span>
$ npm install -<span class="hljs-keyword">g</span> bower
</code></pre>
<p>√áa y est, on peut maintenant demander gentiment √† <a href="http://www.ember-cli.com/">Ember CLI</a> de nous cr√©er notre application gr√¢ce √† la 
commande <code>ember</code> et voir ensuite une magnifique page de bienvenue sur <a href="http://localhost:4200/">http://localhost:4200/</a> :</p>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>ember new ember-articles
<span class="hljs-variable">$ </span>cd ember-articles
<span class="hljs-variable">$ </span>ember server
</code></pre>
<p>Je ne vous fais pas l‚Äôaffront de d√©tailler ici la structure de l‚Äôapplication, tout est d√©crit dans la 
<a href="http://www.ember-cli.com/#folder-layout">documentation</a>.</p>
<h3 id="styles-amp-fonts">
      <a class="putainde-Title-anchor" href="#styles-amp-fonts">#</a>
      Styles &amp; Fonts
    </h3><p>Pour que cela ne soit pas trop moche dans le cadre de cet exemple ou va ajouter un peu de CSS et des fonts mais comme c‚Äôest pas l‚Äôobjet de l‚Äôarticle,
on ne va pas passer de temps l√†-dessus. Ceci dit, comme il y a  quand m√™me un peu de conf <a href="http://www.ember-cli.com/">Ember CLI</a> qui peut vous int√©resser, vous avez les styles 
et la conf sur <a href="https://github.com/bmeurant/ember-articles/tree/premiere-app-ember">GitHub</a> et l‚Äôexplication dans ce <a href="https://gist.github.com/bmeurant/1bba49d8a12bf69a4cf0">gist</a>.</p>
<h2 id="et-maintenant-on-code">
      <a class="putainde-Title-anchor" href="#et-maintenant-on-code">#</a>
      Et maintenant, on code !
    </h2><p><em>Note: le code de l‚Äôexemple est dispo sur <a href="https://github.com/bmeurant/ember-articles/tree/premiere-app-ember">github</a>.</em></p>
<ul>
<li>Modification du gabarit g√©n√©ral de l‚Äôapplication <code>/app/templates/application.hbs</code> : </li>
</ul>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"app"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"sources"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"https://github.com/bmeurant/ember-articles"</span>&gt;</span>View source on GitHub<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Comic books library<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"main"</span>&gt;</span>
      {{outlet}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p><em>Note : on en profite pour remarquer le rechargement √† chaud via <code>ember server</code> lorsqu‚Äôon modifie un fichier.</em></p>
<ul>
<li>Cr√©ation de la premi√®re route <code>/series</code> via <code>ember</code> :</li>
</ul>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>ember generate route series
</code></pre>
<p><a href="http://www.ember-cli.com/">Ember CLI</a> met √† jour le routeur : </p>
<pre><code class="lang-js"><span class="hljs-comment">// routeur app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'series'</span>);
});
</code></pre>
<p>Il g√©n√®re aussi pour nous une route <code>app/routes/series.js</code> et un gabarit <code>app/templates/series.hbs</code>, vides.</p>
<p>Modifions tout de suite le gabarit <code>app/templates/series.hbs</code>, histoire de mieux visualiser les choses : </p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Comics Series<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>
</code></pre>
<p>L‚ÄôURL <code>/series</code> est d√©sormais accessible sur <a href="http://localhost:4200/series">http://localhost:4200/series</a> et on peut constater l‚Äôimbrication du gabarit <code>series.hbs</code> dans le gabarit
g√©n√©ral <code>application.hbs</code> gr√¢ce √† son <code>{{outlet}}</code>.</p>
<h3 id="outlet-et-routes-imbriquees">
      <a class="putainde-Title-anchor" href="#outlet-et-routes-imbriquees">#</a>
      <code>{{outlet}}</code> et routes imbriqu√©es
    </h3><p>Ces notions sont au c≈ìur d‚Äô<a href="http://emberjs.com">Ember</a>. Leur fonctionnement est assez simple. Lorsqu‚Äôune route est imbriqu√©e dans une autre,
<a href="http://emberjs.com">Ember</a> va rechercher les gabarits de ces deux routes et remplacer la zone <code>{{outlet}}</code> de la <em>route m√®re</em>
avec le rendu de la <em>route fille</em>. Ainsi de suite jusqu‚Äô√† r√©solution compl√®te de la route. Lors des transitions entre routes, les
zones des <code>{{outlet}}</code> concern√©es par le changement sont mises √† jour.</p>
<p>Toutes les routes de l‚Äôapplication sont imbriqu√©es dans la route <code>ApplicationRoute</code> g√©n√©r√©e par <a href="http://emberjs.com">Ember</a> et dont le gabarit est <code>application.hbs</code>. 
C‚Äôest ce qui explique que, dans le cas pr√©sent, le gabarit <code>series.hbs</code> ait √©t√© <em>inject√©</em> dans <code>application.hbs</code> pour construire l‚Äôapplication 
enti√®re.</p>
<h3 id="routes-et-controleurs-implicites">
      <a class="putainde-Title-anchor" href="#routes-et-controleurs-implicites">#</a>
      Routes et contr√¥leurs implicites
    </h3><p>Pour rappel, <a href="http://emberjs.com">Ember</a> d√©finit et utilise diff√©rents types d‚Äôobjets ayant chacun une responsabilit√© propre (voir <a href="/posts/js/debuter-avec-ember">article pr√©c√©dent</a>) et, pour ne pas
nous obliger √† fournir nous-m√™me une impl√©mentation par d√©faut de ces objets, les g√©n√®re pour nous (voir <a href="/posts/js/debuter-avec-ember/#generation-d-objets">article pr√©c√©dent - <em>G√©n√©ration d‚Äôobjets</em></a>).</p>
<p>Si nous n‚Äôavons eu ici qu‚Äô√† fournir le gabarit <code>application.hbs</code>, c‚Äôest qu‚Äô<a href="http://emberjs.com">Ember</a> a g√©n√©r√© pour nous la route implicite <code>ApplicationRoute</code> activ√©e au d√©marrage
de l‚Äôapplication et le contr√¥leur <code>ApplicationController</code>.</p>
<p>Mais <a href="http://emberjs.com">Ember</a> a √©galement g√©n√©r√© pour nous la route <code>IndexRoute</code> et le contr√¥leur <code>IndexController</code> en r√©ponse √† l‚ÄôURL <code>/</code>. Pour √™tre tout √†
fait complet, <a href="http://emberjs.com">Ember</a> a aussi g√©n√©r√© les √©l√©ments suivants <code>LoadingRoute</code>, <code>LoadingController</code>, <code>ErrorRoute</code> et <code>ErrorController</code> dont les
caract√©ristiques peuvent √™tre trouv√©es dans la <a href="http://emberjs.com/guides/routing/loading-and-error-substates/">documentation</a>.</p>
<p>Ces √©l√©ments implicites sont g√©n√©r√©s pour chaque route qui n‚Äôest pas une route de dernier niveau et peuvent √™tre surcharg√©s.</p>
<ul>
<li>L‚ÄôURL <code>/</code> ne nous int√©resse pas. Surchargeons la route <code>IndexRoute</code> pour rediriger vers <code>/series</code> :</li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">// /app/routes/index.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
    redirect: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">this</span>.transitionTo(<span class="hljs-string">'series'</span>);
    }
});
</code></pre>
<p>-&gt; Par-l√† la <a href="http://emberjs.com/guides/routing/redirection/">doc sur les redirections</a>.</p>
<p>Maintenant, on veut afficher la liste des s√©ries en allant sur <code>/series</code>. Encore faut-il avoir des s√©ries‚Ä¶ Pour √ßa, on va utiliser
la librairie <a href="https://github.com/emberjs/data">Ember Data</a> pour la gestion de nos mod√®les. Ce n‚Äôest pas obligatoire
et beaucoup font sans, mais nous on va l‚Äôutiliser quand m√™me. </p>
<h3 id="ember-data">
      <a class="putainde-Title-anchor" href="#ember-data">#</a>
      Ember Data
    </h3><p>Cette librairie qui est d√©velopp√©e en parall√®le d‚Äô<a href="http://emberjs.com">Ember</a> permet de g√©rer les mod√®les de donn√©es et les relations entre eux 
√† la mani√®re d‚Äôun <a href="http://fr.wikipedia.org/wiki/Mapping_objet-relationnel">ORM</a> (√† la <a href="http://en.wikipedia.org/wiki/Active_record_pattern">ActiveRecord</a>). 
Elle permet notamment de r√©cup√©rer les donn√©es depuis une interface REST HTTP 
(et est parfaitement adapt√©e √† <a href="http://jsonapi.org/">JSON API</a>) mais pas que.</p>
<p><a href="https://github.com/emberjs/data">Ember Data</a> s‚Äôappuie sur un <code>store</code> (cf. <a href="http://emberjs.com/api/data/classes/DS.Store.html">doc</a>) manipul√© par l‚Äôapplication
et qui contient des m√©thodes telles que <code>find</code>, <code>createRecord</code>, <code>update</code>, etc. qui permettent d‚Äôeffectuer des actions sur les diff√©rents mod√®les
du store. Au travers d‚Äô<code>Adapters</code>, le <code>store</code> transmet √† la couche de persistence (REST ou autre).</p>
<p>Le <code>RESTAdapter</code> (cf. <a href="http://emberjs.com/api/data/classes/DS.Store.html">doc</a>) et son jumeau mal√©fique le <code>RESTSerializer</code> 
(cf. <a href="http://emberjs.com/api/data/classes/DS.RESTSerializer.html">doc</a>) peuvent √™tre √©tendus facilement de mani√®re √† s‚Äôadapter √† une 
interface REST sp√©cifique.</p>
<p>Pour un <a href="http://en.wikipedia.org/wiki/Proof_of_concept">POC</a>, on peut utiliser le <code>FixtureAdapter</code> 
(cf. <a href="http://emberjs.com/api/data/classes/DS.FixtureAdapter.html">doc</a>) qui permet
de charger simplement les objets depuis la m√©moire. C‚Äôest ce que l‚Äôon utilise ici.</p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/adapters/application.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">'ember-data'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> DS.FixtureAdapter.extend({});
</code></pre>
<ul>
<li>On va donc cr√©er un mod√®le correspondant. Seulement, voil√†, comme j‚Äôai eu la bonne id√©e de prendre un des rares mots en anglais
o√π le pluriel et le singulier sont identiques (<em>serie</em> n‚Äôexiste pas), on va devoir cr√©er un mod√®le <em>seriesItem</em> :</li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">// /app/models/series-item.js</span>
<span class="hljs-keyword">import</span> DS <span class="hljs-keyword">from</span> <span class="hljs-string">'ember-data'</span>;

<span class="hljs-keyword">var</span> SeriesItem = DS.Model.extend({
    title               : DS.attr(<span class="hljs-string">'string'</span>, {defaultValue: <span class="hljs-string">'New Series'</span>}),
    scriptwriter        : DS.attr(<span class="hljs-string">'string'</span>),
    illustrator         : DS.attr(<span class="hljs-string">'string'</span>),
    publisher           : DS.attr(<span class="hljs-string">'string'</span>),
    coverName           : DS.attr(<span class="hljs-string">'string'</span>, {defaultValue: <span class="hljs-string">'default.jpg'</span>}),
    summary             : DS.attr(<span class="hljs-string">'string'</span>),
    coverUrl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'/assets/images/series/covers/'</span> + <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'coverName'</span>);
    }.property(<span class="hljs-string">'coverName'</span>)
});

SeriesItem.reopenClass({
    FIXTURES: [{
    id: <span class="hljs-number">1</span>,
    title: <span class="hljs-string">'BlackSad'</span>,
    scriptwriter: <span class="hljs-string">'Juan Diaz Canales'</span>,
    illustrator: <span class="hljs-string">'Juanjo Guarnido'</span>,
    publisher: <span class="hljs-string">'Dargaud'</span>,
    coverName: <span class="hljs-string">'blacksad.jpg'</span>,
    summary: <span class="hljs-string">'Private investigator John Blacksad is up to his feline ears in mystery, digging into the backstories behind murders, child abductions, and nuclear secrets. Guarnido\'s sumptuously painted pages and rich cinematic style bring the world of 1950s America to vibrant life, with Canales weaving in fascinating tales of conspiracy, racial tension, and the "red scare" Communist witch hunts of the time. Guarnido reinvents anthropomorphism in these pages, and industry colleagues no less than Will Eisner, Jim Steranko, and Tim Sale are fans! Whether John Blacksad is falling for dangerous women or getting beaten to within an inch of his life, his stories are, simply put, unforgettable'</span>
}, {
    id: <span class="hljs-number">2</span>,
    title: <span class="hljs-string">'The Killer'</span>,
    scriptwriter: <span class="hljs-string">'Luc Jacamon'</span>,
    illustrator: <span class="hljs-string">'Matz'</span>,
    publisher: <span class="hljs-string">'Casterman'</span>,
    coverName: <span class="hljs-string">'the-killer.jpg'</span>,
    summary: <span class="hljs-string">'A man solitary and cold, methodical and unencumbered by scruples or regrets, the killer waits in the shadows, watching for his next target. And yet the longer he waits, the more he thinks he\'s losing his mind, if not his cool. A brutal, bloody and stylish noir story of a professional assassin lost in a world without a moral compass, this is a case study of a man alone, armed to the teeth and slowly losing his mind.'</span>
}, ...
]});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> SeriesItem;
</code></pre>
<p>Au passage, on remarque les valeurs par d√©faut ainsi que la <a href="http://emberjs.com/guides/object-model/computed-properties/">propri√©t√© calcul√©e</a> <code>coverUrl</code>. On aura l‚Äôoccasion d‚Äôen reparler.</p>
<ul>
<li>On modifie donc notre application pour afficher, lors de l‚Äôactivation de <code>SeriesRoute</code>, la liste des s√©ries :</li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">// /app/routes/series.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.Route.extend({
    model: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.store.find(<span class="hljs-string">'seriesItem'</span>);
    }
});
</code></pre>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Comic Series<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-list"</span>&gt;</span>
      {{#each}}
          <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-item"</span>&gt;</span>
              {{title}}
          <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
      {{/each}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>Number of series: {{length}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

{{outlet}}
</code></pre>
<p>On remarque le <code>{{#each}}</code> sans arguments qui par convention retrouve l‚Äôobjet <code>model</code> du contr√¥leur. <code>{{#each model}}</code>, <code>{{#each controller}}</code> ou <code>{{#each controller.model}}</code> sont
des notations √©quivalentes.</p>
<ul>
<li>Maintenant, on va essayer de dynamiser un peu tout √ßa en ajoutant un bouton pour trier la liste :</li>
</ul>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
...
<span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Comic Series<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">button</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">sort</span>"}} {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">":sort sortAscending:asc:desc"</span><span class="hljs-value">}}</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-list"</span>&gt;</span>
...
</code></pre>
<p>Pour √ßa, il est n√©cessaire de d√©finir notre propre <code>SeriesController</code> :</p>
<pre><code class="lang-js"><span class="hljs-comment">// /app/controllers/series.js</span>
<span class="hljs-keyword">import</span> Ember <span class="hljs-keyword">from</span> <span class="hljs-string">'ember'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Ember.ArrayController.extend({
  sortAscending: <span class="hljs-literal">true</span>,

  actions: {
    sort: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.toggleProperty(<span class="hljs-string">'sortAscending'</span>);
    }
  }
});
</code></pre>
<p>Ce simple ajout demande de s‚Äôarr√™ter sur quelques points importants, histoire de bien comprendre ce qui se passe.</p>
<h3 id="types-de-controleurs">
      <a class="putainde-Title-anchor" href="#types-de-controleurs">#</a>
      Types de contr√¥leurs
    </h3><p>Nous avons d√ª remplacer le <code>SeriesController</code> implicite par notre propre contr√¥leur, histoire de proposer cette fonction de tri. <a href="http://emberjs.com">Ember</a>
dispose de deux types de contr√¥leurs : <a href="http://emberjs.com/api/classes/Ember.ObjectController.html">ObjectController</a> et <a href="http://emberjs.com/api/classes/Ember.ArrayController.html">ArrayController</a>.
Comme leur nom l‚Äôindique, ces contr√¥leurs permettent respectivement de g√©rer des mod√®les de type objet ou de type collection.</p>
<p>Dans notre cas, nous souhaitons manipuler la liste des s√©ries et utilisons donc un <code>ArrayController</code>. Il utilise notamment le <a href="http://emberjs.com/api/classes/Ember.SortableMixin.html">SortableMixin</a>
qui fournit des fonctions de tri natives. Il nous suffit donc d‚Äôinitialiser et de mettre √† jour la propri√©t√© <code>sortAscending</code> apport√©e par ce mixin pour b√©n√©ficier du tri sur notre
collection de s√©ries, sans avoir besoin d‚Äôautre chose.</p>
<h3 id="actions">
      <a class="putainde-Title-anchor" href="#actions">#</a>
      Actions
    </h3><p>La mise √† jour de cette propri√©t√© est effectu√©e gr√¢ce √† <code>{{action &quot;sort&quot;}}</code> qui nous permet de lier l‚Äôaction sur le bouton (le clic) √† une
fonction <code>sort</code> du contr√¥leur d√©finie dans <code>actions: { ... }</code>.</p>
<p>-&gt; Plus d‚Äôinfos sur les actions <a href="http://emberjs.com/guides/templates/actions/">ici</a>.</p>
<h3 id="bindings-de-classes-dynamiques">
      <a class="putainde-Title-anchor" href="#bindings-de-classes-dynamiques">#</a>
      <em>Bindings</em> de classes dynamiques
    </h3><p>On remarque aussi la mani√®re dont les classes de l‚Äô√©l√©ment <code>button</code> sont li√©es aux propri√©t√©s du contr√¥leur de mani√®re √† √™tre mises √†
jour dynamiquement gr√¢ce √† <code>{{bind-attr class=&quot;...&quot;}}</code>. Cette syntaxe permet de basculer la classe du bouton de <code>asc</code> √† <code>desc</code> automatiquement
lorsque la valeur de <code>sortAscending</code> change. On note la notation <code>:sort</code> qui permet d‚Äôajouter une classe de base, statique.</p>
<p>-&gt; Plus d‚Äôinfos sur les classes <a href="http://emberjs.com/guides/templates/binding-element-class-names/">ici</a>.</p>
<ul>
<li>Mais on ne va pas s‚Äôarr√™ter l√†. On va ajouter un petit filtre sur le titre des s√©ries :</li>
</ul>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Comic Series<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>

    {{input value=filter class="filter"}}
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">sort</span>"}} {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">":sort sortAscending:asc:desc"</span><span class="hljs-value">}}</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-list"</span>&gt;</span>
      {{#each filteredModel}}
          <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-item"</span>&gt;</span>
              {{title}}
          <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
      {{/each}}
    <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">span</span>&gt;</span>Number of series: {{filteredModel.length}}<span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

{{outlet}}
</code></pre>
<pre><code class="lang-js"><span class="hljs-comment">// /app/controllers/series.js</span>
...
filter: <span class="hljs-string">""</span>,
sortAscending: <span class="hljs-literal">true</span>,

filteredModel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">var</span> filter = <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'filter'</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'content'</span>).filter(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(item)</span></span>{
    <span class="hljs-keyword">if</span> (item.get(<span class="hljs-string">'title'</span>) === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> item.get(<span class="hljs-string">'title'</span>).toLowerCase().match(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(filter.toLowerCase()));
  }).sort(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(a, b)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'sortAscending'</span>) ? (b.get(<span class="hljs-string">'title'</span>) &lt; a.get(<span class="hljs-string">'title'</span>)) : (b.get(<span class="hljs-string">'title'</span>) &gt; a.get(<span class="hljs-string">'title'</span>));
  }.bind(<span class="hljs-keyword">this</span>));
}.property(<span class="hljs-string">'filter'</span>, <span class="hljs-string">'sortAscending'</span>, <span class="hljs-string">'model.@each.title'</span>),

actions: {
...
</code></pre>
<h3 id="proprietes-calculees">
      <a class="putainde-Title-anchor" href="#proprietes-calculees">#</a>
      Propri√©t√©s calcul√©es
    </h3><p>Je vous passe le contenu de la fonction <code>filteredModel</code> qui n‚Äôapporte rien au sujet. Examinons par contre la notation <code>.property(&#39;filter&#39;, &#39;sortAscending&#39;, &#39;model.@each.title&#39;)</code>. 
Cela constitue la d√©finition d‚Äôune <a href="http://emberjs.com/guides/object-model/computed-properties/">propri√©t√© calcul√©e</a> : propri√©t√©
accessible et manipulable comme n‚Äôimporte quelle propri√©t√© au sein des gabarits mais qui est le r√©sultat d‚Äôune fonction dont le retour d√©pend de l‚Äô√©tat d‚Äôautres propri√©t√©s. </p>
<p>La syntaxe <code>.property(&#39;filter&#39;, &#39;sortAscending&#39;, &#39;model.@each.title&#39;)</code> d√©finit les autres propri√©t√©s <em>observ√©es</em> par cette propri√©t√© calcul√©e et dont le changement provoquera
l‚Äôex√©cution de la fonction ainsi que le rafra√Æchissement du gabarit. Ici, on peut constater que l‚Äôaffichage est mis √† jour et la liste filtr√©e √† chaque changement du champ 
de formulaire <code>filter</code> et donc de la propri√©t√© <code>filter</code> associ√©e ou du sens du tri via la propri√©t√© <code>sortAscending</code>. </p>
<p>La syntaxe particuli√®re <code>model.@each.title</code> permet de mettre √† jour l‚Äôaffichage en cas de changement externe du titre de l‚Äôune (<code>@each</code>) des s√©ries. Vous pouvez facilement vous rendre compte de
√ßa en utilisant <strong>Ember Inspector</strong> (<a href="https://chrome.google.com/webstore/detail/ember-inspector/bmdblncegkenkacieihfhpjfppoconhi?hl=en">Chrome</a> et 
<a href="https://addons.mozilla.org/en-US/firefox/addon/ember-inspector/">Firefox</a>). Allez dans <code>Data &gt; MODEL TYPES / series-item</code>, s√©lectionnez-en une et modifiez son titre. Vous constaterez que 
la liste est mise √† jour automatiquement.</p>
<p>Les <em>bindings</em> et les <a href="http://emberjs.com/guides/object-model/computed-properties/">propri√©t√©s calcul√©es</a> constituent deux mani√®res d‚Äôobserver les changements et de <em>rafra√Æchir</em>
l‚Äôapplication en cons√©quence. Les <a href="http://emberjs.com/guides/object-model/observers">observeurs</a> en sont une troisi√®me. Si vous avez un doute sur ce qu‚Äôil faut utiliser, allez
voir <a href="http://emberjs.com/guides/object-model/what-do-i-use-when">ici</a>.</p>
<h3 id="bindings-et-mise-a-jour-des-gabarits">
      <a class="putainde-Title-anchor" href="#bindings-et-mise-a-jour-des-gabarits">#</a>
      <em>Bindings</em> et mise √† jour des gabarits
    </h3><p>Alors, comment √ßa marche ? Comment, concr√®tement, <a href="http://emberjs.com">Ember</a> se d√©brouille pour mettre √† jour le gabarit lors de la mise √† jour d‚Äôun mod√®le, d‚Äôune propri√©t√© ? En r√©alit√©, lorsqu‚Äôon
affiche dans un gabarit une propri√©t√© dynamique li√©e √† un mod√®le ou √† une propri√©t√©, <a href="http://emberjs.com">Ember</a> va l‚Äôencadrer par des √©l√©ments HTML sp√©ciaux, des marqueurs de type <code>&lt;script&gt;</code> d‚Äôid unique
appel√© <code>metamorph</code>. Attention, je pr√©f√®re vous pr√©venir, √ßa va piquer !</p>
<p>Ainsi,</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Blog de {{name}}<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
</code></pre>
<p>va se transformer en : </p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>
Blog de 
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"metamorph-0-start"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/x-placeholder"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
Baptiste Meurant
<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"metamorph-0-end"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/x-placeholder"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
</code></pre>
<p>Alors oui, il faut avouer que l√† on est tent√© de partir en courant. C‚Äôest le point qui m‚Äôa vraiment g√™n√© quand j‚Äôai d√©couvert <a href="http://emberjs.com">Ember</a> et √ßa me g√™ne encore. C‚Äô√©tait m√™me
√† la limite du r√©dhibitoire. √áa pollue vraiment le DOM et introduit m√™me quelques effets de bord en CSS lorsqu‚Äôon utilise les <code>:first-child</code> ou <code>:last-child</code>. Ceci √©tant,
c‚Äôest ce qui permet √† <a href="http://emberjs.com">Ember</a> de mettre √† jour non pas un gabarit mais uniquement ces zones dynamiques de mani√®re performante - j‚Äôai fini par voir √ßa comme un mal n√©cessaire.
Mais surtout, j‚Äôai compris que ces <code>metamorph</code> √©taient vou√©s √† dispara√Ætre assez rapidement avec l‚Äôutilisation du moteur <a href="https://github.com/tildeio/htmlbars">HTMLBars</a>. Vous pouvez
jeter un ≈ìil √† ce sujet √† la <a href="http://talks.erikbryn.com/htmlbars/">pr√©sentation d‚ÄôEric Bryn</a> (notamment slide 10). Ouf ! Le support d‚Äô<a href="https://github.com/tildeio/htmlbars">HTMLBars</a> est pr√©vu pour 
<a href="http://emberjs.com">Ember</a> 1.9 ou 1.10 (la release actuelle est 1.7) ‚Ä¶ On est impatients !</p>
<p><em>Bonus: l‚Äô√©l√©ment est un √©l√©ment <code>script</code> et pas un autre car c‚Äôest √† priori le seul √©l√©ment qui peut √™tre ins√©r√© partout sans rien casser.</em></p>
<p><em><strong>Edit</strong>: Aujourd‚Äôhui (28/10/2014) est sortie la <a href="http://emberjs.com/blog/2014/10/26/ember-1-8-0-released.html">version 1.8.0 d‚ÄôEmber</a>. Cette release ne contient pas encore
le support complet d‚Äô<a href="https://github.com/tildeio/htmlbars">HTMLBars</a> mais signe d√©j√† la fin des <code>metamorph</code> au profit de l‚Äôutilisation d‚Äô√©lements <code>Text</code> vides, non intrusifs ! √áa m√©ritait d‚Äô√™tre signal√©.</em> </p>
<h3 id="runloop">
      <a class="putainde-Title-anchor" href="#runloop">#</a>
      <em>RunLoop</em>
    </h3><p>Un autre m√©canisme important est impliqu√© tant dans le rendu des gabarits que dans le calcul et la synchronisation des propri√©t√©s entre elles : la <em>RunLoop</em>. Ce m√©canisme est
absolument central dans le fonctionnement d‚Äô<a href="http://emberjs.com">Ember</a> et s‚Äôappuie sur la lib <a href="https://github.com/ebryn/backburner.js/">Backburner</a>. Dans la plupart des cas, vous n‚Äôavez pas
√† vous en pr√©occuper et vous pouvez parfaitement mettre en place une application <a href="http://emberjs.com">Ember</a> compl√®te sans interagir directement avec la <em>RunLoop</em>, sauf lorsque
vous ajoutez vos propres <code>helpers</code> <a href="http://handlebarsjs.com/">Handlebars</a> ou vos propres composants avanc√©s. C‚Äôest par contre important d‚Äôen comprendre le fonctionnement.</p>
<p>Comme son nom ne l‚Äôindique pas, la <em>RunLoop</em> n‚Äôest pas une loop mais un ensemble de queues permettant √† <a href="http://emberjs.com">Ember</a> de diff√©rer un certain nombre d‚Äôop√©rations
qui seront ensuite ex√©cut√©es en d√©pilant ces queues dans un ordre de priorit√© donn√©. Les queues sont <code>sync</code>, <code>actions</code>, <code>routerTransitions</code>, <code>render</code>, <code>afterRender</code>, et <code>destroy</code>.
Je vous laisse d√©couvrir par vous-m√™me dans la <a href="http://emberjs.com/guides/understanding-ember/run-loop/">doc officielle</a> et dans cette 
<a href="http://talks.erikbryn.com/backburner.js-and-the-ember-run-loop">pr√©sentation d‚ÄôEric Bryn</a> le contenu de ces queues et la mani√®re dont est faite l‚Äôex√©cution.</p>
<p>Je voudrais juste insister sur un aspect particulier : c‚Äôest ce m√©canisme qui permet, en quelque sorte, d‚Äôempiler les calculs de propri√©t√©s calcul√©es lorsque les propri√©t√©s
<em>observ√©es</em> sont modifi√©es et surtout c‚Äôest gr√¢ce √† ce m√©canisme que le rendu n‚Äôest effectu√© qu‚Äôune seule fois lors de la modification d‚Äôun mod√®le.</p>
<p>Pour reprendre l‚Äôexemple de la <a href="http://emberjs.com/guides/understanding-ember/run-loop/">doc officielle</a>, si vous avez l‚Äôobjet suivant :</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> User = Ember.Object.extend({
  firstName: <span class="hljs-literal">null</span>,
  lastName: <span class="hljs-literal">null</span>,
  fullName: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'firstName'</span>) + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'lastName'</span>);
  }.property(<span class="hljs-string">'firstName'</span>, <span class="hljs-string">'lastName'</span>)
});
</code></pre>
<p>Et le gabarit :</p>
<pre><code class="lang-html">{{firstName}}
{{fullName}}
</code></pre>
<p>Tout √ßa, sans la <em>RunLoop</em>, ferait qu‚Äôon ex√©cuterait le rendu deux fois si l‚Äôon modifie successivement <code>firstname</code> puis <code>lastname</code>. La <em>RunLoop</em> met tout √ßa (et plein d‚Äôautres
choses) en queue et n‚Äôeffectue le rendu qu‚Äôune seule et unique fois, lorsque n√©cessaire.</p>
<ul>
<li>Apr√®s √ßa, on va finir en douceur en ajoutant simplement ou nouvelle route pour afficher la s√©rie qu‚Äôon a s√©lectionn√© :</li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">// /app/router.js</span>
Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'series'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'seriesItem'</span>, { path: <span class="hljs-string">'/:seriesItem_id'</span> });
  });
});
</code></pre>
<pre><code class="lang-html"><span class="hljs-comment">&lt;!-- /app/templates/series.hbs --&gt;</span>
...
  <span class="hljs-tag">&lt;<span class="hljs-title">ul</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-list"</span>&gt;</span>
    {{#each filteredModel}}
        <span class="hljs-tag">&lt;<span class="hljs-title">li</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-item"</span>&gt;</span>
          {{#link-to 'series.seriesItem' this title=title}}
            {{title}}
          {{/link-to}}
        <span class="hljs-tag">&lt;/<span class="hljs-title">li</span>&gt;</span>
    {{/each}}
  <span class="hljs-tag">&lt;/<span class="hljs-title">ul</span>&gt;</span>
...

<span class="hljs-comment">&lt;!-- /app/templates/series/series-item.hbs --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"series-details"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">h3</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-title">h3</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">img</span> {{<span class="hljs-attribute">bind-attr</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"coverUrl"</span><span class="hljs-value">}}</span> <span class="hljs-attribute">alt</span>=<span class="hljs-value">"Series's first album cover"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"cover"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">dl</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"description"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>scriptwriter<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{scriptwriter}} <span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>illustrator<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{illustrator}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dt</span>&gt;</span>publisher<span class="hljs-tag">&lt;/<span class="hljs-title">dt</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">dd</span>&gt;</span>{{publisher}}<span class="hljs-tag">&lt;/<span class="hljs-title">dd</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">dl</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">p</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"summary"</span>&gt;</span>
    {{summary}}
  <span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>Et voil√† ! Quelques remarques en passant : </p>
<ul>
<li>on peut maintenant s√©lectionner une s√©rie dans la liste gr√¢ce au <code>{{link-to}}</code>. On remarque au passage qu‚Äô<a href="http://emberjs.com">Ember</a> s√©lectionne automatiquement
(ajoute une classe <code>active</code>) la s√©rie de la liste dont la route est activ√©e. On note √©galement l‚Äôutilisation de <code>this</code> pour r√©f√©rencer l‚Äôobjet courant
(ici l‚Äôinstance courante de <code>SeriesItem</code>). -&gt; <a href="http://emberjs.com/guides/templates/links/">doc officielle</a>.</li>
<li>on a transform√© la route <code>series</code> en <em>Resource</em> qui permet de grouper les routes sous un m√™me espace de nommage. Notez que si la route <code>seriesItem</code>
avait √©t√© une ressource, on aurait d√ª fournir le template <code>/app/templates/series-item.hbs</code> au lieu de <code>/app/templates/series/series-item.hbs</code> car
une ressource r√©initialise l‚Äôespace de nommage et permet ainsi de simplifier les URL. -&gt; <a href="http://emberjs.com/guides/routing/defining-your-routes/#toc_resources">doc officielle</a></li>
<li>on a ajout√© un <em>segment dynamique</em> <code>{path: &#39;/:seriesItem_id&#39;}</code> √† la route <code>seriesItem</code> pour l‚ÄôID de la s√©rie. -&gt; <a href="http://emberjs.com/guides/routing/defining-your-routes/#toc_dynamic-segments">doc officielle</a>.</li>
</ul>
<h2 id="conclusions">
      <a class="putainde-Title-anchor" href="#conclusions">#</a>
      Conclusions
    </h2><p>Cet article est un peu plus long que ce que j‚Äôavais pr√©vu et je n‚Äôai pas abord√© tous les sujets que je voulais traiter. Mais, plut√¥t que de d√©rouler simplement du code pour montrer que √ßa marche, j‚Äôai
pr√©f√©r√© m‚Äôarr√™ter sur les points importants pour en expliquer le fonctionnement. √áa me paraissait important. J‚Äôesp√®re que ce n‚Äô√©tait pas trop p√©nible √† lire. Les points que je n‚Äôai pas eu le temps
de traiter (API REST avec un backend, tests, helpers, partials, composants, relations avec ember-data, etc.) feront peut-√™tre l‚Äôobjet d‚Äôun autre post mais un peu plus tard parce que je suis fatigu√© l√† et 
je sens que vous aussi.</p>
<p>Concernant <a href="http://emberjs.com">Ember</a>, j‚Äôappr√©cie vraiment le mod√®le de d√©veloppement, la structure et j‚Äôaime vraiment d√©velopper avec cet outil. La discussion framework / lib d√©j√† √©voqu√©e fera sans doute toujours rage.
En ce qui me concerne, quand j‚Äôai besoin d‚Äôun framework, ma pr√©f√©rence va √† <a href="http://emberjs.com">Ember</a>.</p>
<p>Concernant <a href="http://www.ember-cli.com/">Ember CLI</a>, je suis plus partag√©. J‚Äôappr√©cie l‚Äôaspect normalisation de la structure de l‚Äôappli ainsi que l‚Äôoutillage assez fourni qu‚Äôil embarque, le transpileur ES6. Je ne suis, par contre, pas fan
du scaffolding en g√©n√©ral mais, au d√©marrage, √ßa peut donner une id√©e de la mani√®re de faire. J‚Äôesp√®re cependant vous avoir donn√© suffisamment de clefs pour que vous vous fassiez une id√©e.</p>
<p>Pour finir, je souhaite remercier l‚Äô√©quipe de <em>Putain de code !</em> qui ne partage pas mes opinions sur les frameworks en g√©n√©ral mais qui m‚Äôaccueille quand m√™me. Cet article a vraiment d√ª
vous piquer les yeux. D√©sol√© :-)</p>
<p><em>Note: les sources de l‚Äôapplication exemple sont <a href="https://github.com/bmeurant/ember-articles/tree/premiere-app-ember">disponibles sur github</a>.</em></p>
]]></description>
            <link>http://putaindecode.fr/posts/js/premiere-app-ember/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/premiere-app-ember/</guid>
            <pubDate>Mon, 27 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Flux, qu'est-ce que c'est ?]]></title>
            <description><![CDATA[<p>Allez, tant pis, on saute l‚Äôintro et on entre directement dans le vif du sujet (on n‚Äôa pas que √ßa √† foutre, apr√®s tout).</p>
<h2 id="la-petite-histoire">
      <a class="putainde-Title-anchor" href="#la-petite-histoire">#</a>
      La petite histoire
    </h2><p>Il √©tait une fois un gros site web <em>que s‚Äôapelorio</em> Facebook. Qui dit Facebook, dit webapp plus grosse que la plus grosse de tes copines (<em>no offense</em> <sup><a href="#foonote-1">1</a></sup>) ; et du coup, propension √† se retrouver submerg√© de bugs plus √©lev√©e.</p>
<p>Les ing√©nieurs front-end de Facebook, confront√©s √† une codebase de plus en plus bord√©lique (personne ne voulant toucher certaines parties de celle-ci) ont d√ª repenser la structure des composants les plus cruciaux.</p>
<p>Face √† ce besoin, ces d√©veloppeurs sont donc parvenus √† deux solutions :</p>
<ul>
<li><a href="http://putaindecode.fr/posts/js/introduction-a-reactjs/">ReactJS</a></li>
<li>Flux</li>
</ul>
<p>Flux n‚Äôest pas un framework, mais simplement une architecture, une sorte de <em>guideline</em> qui r√©sout pas mal de probl√®mes ayant pu appara√Ætre avec les divers biblioth√®ques et frameworks MV* apparus lors des derni√®res ann√©es.</p>
<h2 id="flux-l-explication-claire">
      <a class="putainde-Title-anchor" href="#flux-l-explication-claire">#</a>
      Flux, l‚Äôexplication claire
    </h2><p>Flux comporte 4 concepts :</p>
<ul>
<li>les <strong>actions</strong>, qu‚Äôelles proviennent du serveur ou d‚Äôune interaction utilisateur ;</li>
<li>le <strong>dispatcher</strong> dans lequel sont envoy√©es les actions que ce dernier transmet <em>√† qui veut</em>, un peu comme un <code>EventEmitter</code> global ;</li>
<li>les <strong>stores</strong>, qui sont l‚Äô√©quivalent du <code>model</code> de l‚Äôarchitecture MVC, ils contiennent les donn√©es, et r√©agissent aux actions que le dispatcher leur transmet ;</li>
<li>les <strong>views</strong>, qui s‚Äôoccupent du rendu des donn√©es dans le DOM, et de lancer des actions lorsque l‚Äôutilisateur effectue certaines actions.</li>
</ul>
<p>Jusque-l√†, rien de bien fou. C‚Äôest dans leur mani√®re d‚Äôinteragir que la particularit√© se dessine :</p>
<figure>
  <img src="http://cl.ly/YENt/flux.png" alt="">
  <figcaption>Oh bah dis donc, √ßa va toujours dans le m√™me sens</figcaption>
</figure>

<p>En effet, le <em>flux</em> en question est unidirectionnel. Pour faire simple, on proc√®de ainsi :</p>
<p>On d√©finit une action via un <strong>action creator</strong> (on passera toujours par ces action-creators pour signaler une action) :</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// actions/BasketActions.js</span>
<span class="hljs-keyword">var</span> AppDispatcher = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../AppDispacher"</span>)
<span class="hljs-comment">/*
  On garde un dictionnaire des types d'actions
  afin d'avoir un fichier donnant une vision
  globale de toutes les interactions de l'app.
 */</span>
<span class="hljs-keyword">var</span> ActionTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../constants"</span>).ActionTypes

<span class="hljs-built_in">module</span>.exports = {
  addToBasket : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(productId)</span></span>{
    AppDispatcher.handleViewAction({
      type : ActionTypes.ADD_TO_BASKET,
      productId : productId
    })
  }
}
</code></pre>
<p>On lancera par la suite cette action lorsque l‚Äôutilisateur aura cliqu√© sur un certain bouton, dans la vue concern√©e.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// components/Product.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react/addons"</span>)
<span class="hljs-keyword">var</span> BasketActions = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../actions/BasketActions"</span>)

<span class="hljs-keyword">var</span> Button = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./common/Button.jsx"</span>)

<span class="hljs-keyword">var</span> Product = React.createClass({
  addToBasket : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(productId)</span></span>{
    BasketActions.addToBasket(productId)
  },
  render : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"Product"</span>&gt;</span>
        {/* rest of the component*/}
        <span class="hljs-tag">&lt;<span class="hljs-title">Button</span>
          <span class="hljs-attribute">onClick</span>=<span class="hljs-value">{this.addToBasket.bind(this.props.productId)}</span>
          <span class="hljs-attribute">label</span>=<span class="hljs-value">"Add to basket"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    )</span>
  }
})

<span class="hljs-built_in">module</span>.exports = Product
</code></pre>
<p>D√®s lors, √† chaque clic sur le bouton en question, l‚Äôaction <code>ADD_TO_BASKET</code> sera pass√©e au dispatcher, qui le signalera aux stores.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// stores/BasketStore.js</span>
<span class="hljs-keyword">var</span> AppDispatcher = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../AppDispatcher"</span>)
<span class="hljs-keyword">var</span> ActionTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../constants"</span>).ActionTypes
<span class="hljs-keyword">var</span> API = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../api"</span>)

<span class="hljs-keyword">var</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../utils/merge"</span>)
<span class="hljs-keyword">var</span> Store = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../utils/store"</span>)

<span class="hljs-keyword">var</span> _store = {
  products : []
}

<span class="hljs-keyword">var</span> BasketStore = merge(Store, {
  <span class="hljs-comment">/*
    Ici, on `register` un callback sur l'AppDispatcher,
    ce qui signifie qu'on verra passer toutes les actions
    de l'app.
   */</span>
  dispatchToken : AppDispatcher.register(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(payload)</span></span>{
    <span class="hljs-keyword">var</span> action = payload.action
    <span class="hljs-keyword">switch</span>(action.type) {
      <span class="hljs-keyword">case</span> ActionTypes.ADD_TO_BASKET:
          <span class="hljs-comment">/*
             L'API va ajouter le produit et lancer une
             action `BASKET_UPDATED` d√®s que le serveur a r√©pondu.
          */</span>
        API.addToBasket(action.productId)
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">case</span> ActionTypes.BASKET_UPDATED:
          <span class="hljs-comment">/*
            L'API a r√©pondu, on peut stocker la r√©ponse
            et signaler le changement
            aux vues r√©cup√©rant ces donn√©es.
          */</span>
          _store = action.reponse
          BasketStore.emitChange()
        <span class="hljs-keyword">break</span>
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">break</span>
    }
  })
})

<span class="hljs-built_in">module</span>.exports = BasketStore
</code></pre>
<p>La vue, quant √† elle, sera notifi√©e du changement, et effectuera un <code>render()</code> :</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// components/Basket.jsx</span>
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react/addons"</span>)
<span class="hljs-keyword">var</span> BasketActions = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../actions/BasketActions"</span>)
<span class="hljs-keyword">var</span> BasketStore = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../stores/BasketStore"</span>)

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getState</span><span class="hljs-params">()</span></span>{
  <span class="hljs-keyword">return</span> BasketStore.getStore()
}

<span class="hljs-keyword">var</span> Product = React.createClass({
  getInitialState : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">return</span> getState()
  },
  _onStoreChange : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">/*
      √Ä chaque changement du store, on update na√Øvement
      le component et on laisse le virtual DOM faire son job.
    */</span>
    <span class="hljs-keyword">this</span>.setState(getState())
  },
  componentDidMount : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">/*
      On √©coute le store uniquement lorsque le
      component est mont√©.
     */</span>
    BasketStore.addChangeListener(<span class="hljs-keyword">this</span>._onStoreChange)
  },
  componentWillUnmount : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">/*
      Et on arr√™te d'√©couter quand il ne l'est plus.
     */</span>
    BasketStore.removeChangeListener(<span class="hljs-keyword">this</span>._onStoreChange)
  },
  render : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"Basket"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">"Basket-count"</span>&gt;</span>
          {this.state.products.length + " products"}
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
        {/* rest of the component */}
      <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    )</span>
  }
})

<span class="hljs-built_in">module</span>.exports = Product
</code></pre>
<p>Tout cela peut sembler relativement verbeux, mais il faut pr√©ciser deux choses :</p>
<ul>
<li>les exemples ici le sont volontairement pour la d√©monstration, et il est ais√©ment faisable d‚Äôutiliser un <code>StoreMixin</code> simplifier la d√©claration des <code>class</code> React ;</li>
<li>pour ce qui est du reste, notamment stocker les noms d‚Äôactions dans un objet partag√© dans l‚Äôapp, c‚Äôest pour rendre plus idiomatique et coh√©rente la fa√ßon dont on code l‚Äôapp, et pour simplifier ses <em>refactoring</em>.</li>
</ul>
<h2 id="ce-qu-il-faut-savoir-sur-l-alliance-flux-react">
      <a class="putainde-Title-anchor" href="#ce-qu-il-faut-savoir-sur-l-alliance-flux-react">#</a>
      Ce qu‚Äôil faut savoir sur l‚Äôalliance Flux + React
    </h2><p>Si React et Flux vont si bien ensemble, c‚Äôest que l‚Äôapproche de rendu ‚Äúna√Øf‚Äù de React (comprendre ‚ÄúReact s‚Äôen fout de ce qui change, il appelle <code>render</code> √† chaque changement‚Äù) permet de r√©duire la logique √† √©crire dans les Stores, et donc de simplifier tr√®s fortement la codebase de l‚Äôapp.</p>
<p>Lorsque qu‚Äôun ou plusieurs stores composent l‚Äô√©tat d‚Äôun state React, alors √† chaque changement de l‚Äôun de ces stores, tous les composants React concern√©s et leurs enfants vont appeler leur m√©thode <code>render()</code>. Afin d‚Äô√©viter des appels superflus √† ces m√©thodes, React donne la possibilit√© de tester soi-m√™me s‚Äôil est n√©cessaire de mettre √† jour le component en d√©clarant une m√©thode <code>shouldComponentUpdate</code> retournant un <code>boolean</code> qui stipulera si oui ou non il est n√©cessaire d‚Äôappeler <code>render()</code>.</p>
<h2 id="tl-dr">
      <a class="putainde-Title-anchor" href="#tl-dr">#</a>
      tl;dr
    </h2><ul>
<li>Flux, c‚Äôest comme du MVC en plus simple, et avec moins de bugs</li>
<li>L‚Äôarchitecture est unidirectionnelle</li>
<li>On raisonne en actions, qui sont d√©clench√©es par la vue ou le serveur</li>
<li>Toutes les actions passent par le dispatcher</li>
<li>Seuls les stores signalent aux vues qu‚Äôil faut se mettre √† jour</li>
</ul>
<p>Bisous bisous.</p>
<p><img src="http://media.giphy.com/media/lxd2cZ2BkM4IE/giphy.gif" alt="angulol"></p>
<p>Pour aller un peu plus loin :</p>
<ul>
<li><a href="https://gist.github.com/bloodyowl/b41532cf3627c560b57e">Les sources des exemples</a> contenant le dispatcher et les constants ;</li>
<li><a href="http://facebook.github.io/flux/docs/overview.html#content">La doc de Flux</a> ;</li>
<li><a href="https://github.com/facebook/flux">Le repository Flux</a> et ses diff√©rents exemples.</li>
</ul>
<p><small>
  <a id="foonote-1"></a>1: <a href="https://www.youtube.com/watch?v=jRzv9gep5Ng&amp;t=4m">R√©f√©rence utile (<code>ntm install reference</code>)</a>
</small></p>
]]></description>
            <link>http://putaindecode.fr/posts/js/flux-qu-est-ce-c-est/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/flux-qu-est-ce-c-est/</guid>
            <pubDate>Mon, 27 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[√Ä la conqu√™te des bugs]]></title>
            <description><![CDATA[<p>Le Web, depuis sa cr√©ation est un vaste champ de bataille. Que ce soit les probl√®mes de compatibilit√©s, les formats ou les langages propri√©taires, la volont√© de faire du Web un monde ouvert ne date pas d‚Äôhier.</p>
<h2 id="au-depart">
      <a class="putainde-Title-anchor" href="#au-depart">#</a>
      Au d√©part
    </h2><p>Les d√©buts du Web furent compliqu√©s. On assista √† une guerre entre Netscape et Microsoft. Chacun voulant dominer le march√©, en tentant d‚Äôimposer ses propres technologies. En 1996, Netscape propose au W3C JSSS (JavaScript-Based Style Sheets). Ce n‚Äôest d‚Äôailleurs que depuis novembre 2000 que Netscape, bas√© sur le moteur Gecko (moteur de Mozilla Firefox), prend v√©ritablement en charge le CSS. Microsoft pour sa part ne supportait par JavaScript √† ses d√©buts et avait d√©velopp√© son propre langage JScript.</p>
<p>Ces probl√®mes de compatibilit√©s, de technologies et de respect des normes vont consid√©rablement ralentir l‚Äô√©volution du Web.</p>
<h2 id="les-petits-nouveaux">
      <a class="putainde-Title-anchor" href="#les-petits-nouveaux">#</a>
      Les petits nouveaux
    </h2><p>L‚Äôarriv√©e des nouveaux navigateurs tels que Firefox, Chrome ou m√™me Opera va inverser cette tendance. Les parts de march√©s d‚ÄôInternet Explorer baissant, les d√©veloppeurs prenant conscience du potentiel du Web, vont d√©clencher une mont√©e en puissance du Web.</p>
<p>On pourrait croire que cette concurrence ne va apporter que des points positifs, mais pas tant que √ßa. Les parts de march√©s vont pousser les navigateurs (ou les d√©veloppeurs) √† supporter des propri√©t√©s non standardis√©es, √† mettre en place des pr√©fixes et √† d√©velopper une monoculture.</p>
<h2 id="le-debut-des-problemes">
      <a class="putainde-Title-anchor" href="#le-debut-des-problemes">#</a>
      Le d√©but des probl√®mes
    </h2><p>Les pr√©fixes bien que partis d‚Äôune bonne id√©e, avaient pour objectif d‚Äôintroduire les nouvelles propri√©t√©s CSS  toujours √† l‚Äô√©tat de proposition/discussion/standardisation. Cela a permis de pouvoir utiliser des propri√©t√©s telles que  <code>border-radius</code>, <code>transform</code>, <code>box-shadow</code> bien avant leurs finalisations. Le risque bien entendu, √©tant d‚Äôutiliser des propri√©t√©s qui pouvaient changer de sp√©cification, comme ce fut le cas par exemple pour <code>flexbox</code>.</p>
<p>L‚Äôeffet pervers a √©t√© aussi de ne pas utiliser tous les pr√©fixes d‚Äôune propri√©t√©. Cela a eu pour cons√©quence de cr√©er un Web (notamment sur le mobile) √† deux facettes. Nous avions d‚Äôun cot√© les sites <code>-webkit</code> compatibles iPhone/iPad et le reste du monde.</p>
<p>Opera a d‚Äôailleurs <a href="http://thenextweb.com/insider/2013/02/13/opera-300-million-users-webkit/">abandonn√©</a> son moteur Presto en f√©vrier 2013 au profit du moteur WebKit.</p>
<p>Plusieurs discussions houleuses ont d‚Äôailleurs eu lieu sur l‚Äôimpl√©mentation des propri√©t√©s <code>-webkit</code> dans les moteurs Gecko ou Presto. Id√©e abandonn√©e en cours de route.</p>
<p>Coup de th√©atre <a href="http://blogs.msdn.com/b/ie/archive/2014/07/31/the-mobile-web-should-just-work-for-everyone.aspx">r√©cemment</a>, Microsoft a int√©gr√© dans son moteur certaines propri√©t√©s <code>-webkit</code> pour obtenir des sites Web mobiles (trop bas√©s sur <code>-webkit</code>) compatibles avec Windows Phone 8.1.</p>
<h2 id="un-debut-de-solution">
      <a class="putainde-Title-anchor" href="#un-debut-de-solution">#</a>
      Un d√©but de solution ?
    </h2><p>C‚Äôest dans ce contexte qu‚Äôest n√©e l‚Äôinitiative <a href="http://webcompat.com">webcompat.com</a>. Lanc√©e initialement par des d√©veloppeurs de chez <a href="https://hacks.mozilla.org/2014/06/introducing-webcompat-com/">Mozilla</a> et quelques autres <a href="https://github.com/webcompat/webcompat.com/graphs/contributors">contributeurs</a> en juin 2014.</p>
<p>Le site a un double objectif : rendre le Web le plus compatible possible et √©liminer les bugs.</p>
<p>Le site accepte toutes sortes de bugs, que ce soit un probl√®me de compatibilit√© entre navigateurs (<code>prefixe</code>, <code>sniffing UA</code>, etc), ou tout simplement un bug d‚Äôaffichage, que vous soyez propri√©taires ou simple utilisateurs du site.</p>
<p>Une fois le bug soumis, quiconque a la possibilit√© de proposer un diagnostic, de corriger le bug, voir de transmettre la solution aux √©quipes techniques du site en question (par Twitter, e-mail, GitHub, etc).</p>
<p>Le projet est libre et appartient √† sa communaut√©.</p>
<p>Tout contributeur peut intervenir sur le site webcompat.com pour le <a href="https://github.com/webcompat/webcompat.com/issues?q=is%3Aopen+is%3Aissue+label%3Ahelp-wanted">d√©veloppement</a>, ou m√™me le <a href="https://github.com/webcompat/webcompat.com/issues?q=is%3Aopen+is%3Aissue+label%3Adesign">design</a>.  Mais bien s√ªr et surtout sur la correction de <a href="https://github.com/webcompat/web-bugs/issues?q=is%3Aopen+is%3Aissue">bugs</a>.</p>
<p>Microsoft vient d‚Äôailleurs de <a href="http://blogs.msdn.com/b/ie/archive/2014/07/31/the-mobile-web-should-just-work-for-everyone.aspx">rejoindre</a> Mozilla sur l‚Äôinitiative webcompat.com. En lan√ßant leur derni√®re version de Window Phone 8.1 ils ont constat√© les <a href="https://github.com/webcompat/web-bugs/issues?q=is%3Aissue+is%3Aopen+is%3Aclosed+label%3Aie">d√©g√¢ts</a> de la monoculture des sites mobile.</p>
<p>Si comme eux, vous souhaitez rendre le Web plus compatible, n‚Äôh√©sitez pas √† proposer votre aide. En effet, il est de notre responsabilit√© d‚Äô√©viter tout monopole ou monoculture. Car m√™me si les navigateurs ont leur part de responsabilit√©, nous, d√©veloppeurs en avons une aussi.</p>
]]></description>
            <link>http://putaindecode.fr/posts/bug-webcompat/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/bug-webcompat/</guid>
            <pubDate>Tue, 21 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[D√©buter avec Ember]]></title>
            <description><![CDATA[<p>D√©marrer une <a href="http://en.wikipedia.org/wiki/Single-page_application">Single Page Application</a> aujourd‚Äôhui √ßa commence souvent par : ‚Äúmais quel putain de framework il 
faut que je prenne ?‚Äù Et, vu que c‚Äôest pas √ßa qui manque, √ßa se complique !</p>
<p>Parmi les multiples <a href="/posts/js/introduction-a-reactjs">technos disponibles</a> il y a <a href="http://emberjs.com">Ember</a>. Pour que le choix 
ne se r√©sume pas √† prendre celui qui a le plus joli logo ou qui g√©n√®re le plus de spam sur votre Twitter, on vous propose de d√©couvrir 
<a href="http://emberjs.com">Ember</a>. Dans les posts √† venir on verra comment construire concr√®tement une application avec ce framework.</p>
<h2 id="les-fondamentaux">
      <a class="putainde-Title-anchor" href="#les-fondamentaux">#</a>
      Les fondamentaux
    </h2><p>Parce que l‚Äôapproche ‚Äút√™te la premi√®re‚Äù c‚Äôest bien mais que comprendre un minimum ce qu‚Äôon fait c‚Äôest encore mieux, il me para√Æt sage de commencer
par expliquer la philosophie et les principaux √©l√©ments du framework, sous peine de se prendre un bon vieux <a href="http://en.wikipedia.org/wiki/RTFM">RTFM</a> 
sur le coin du pif, comme √ßa, en passant.</p>
<p><a href="http://emberjs.com">Ember</a> se d√©finit comme : ‚ÄúA framework for creating <strong>ambitious</strong> web applications‚Äù et √ßa, √ßa claque !
Mais je vois bien que √ßa ne suffit pas √† vous convaincre alors je vais d√©tailler un peu. Bon alors, bien que ce soit le mot ‚Äúambitious‚Äù
qui soit mis en gras, deux autres trucs me paraissent encore plus importants :</p>
<ul>
<li><p><strong>web</strong> : l‚Äôune des caract√©ristiques majeures d‚Äô<a href="http://emberjs.com">Ember</a> est son attachement au web et aux URL en particulier. <strong>Les URL
et donc le routeur sont au c≈ìur d‚ÄôEmber</strong> l√† ou bien d‚Äôautres frameworks les consid√®rent au mieux comme un addon important. </p>
</li>
<li><p><strong>framework</strong> : <a href="http://emberjs.com">Ember</a> est r√©ellement un framework. Pas une lib, pas une colonne vert√©brale, pas une bo√Æte √† outils : 
un framework ! <a href="http://emberjs.com">Ember</a> propose un v√©ritable mod√®le de d√©veloppement que vous allez tout de suite adopter ‚Ä¶ ou rejeter
(au moins √ßa aura le m√©rite d‚Äô√™tre clair).</p>
</li>
</ul>
<h3 id="conventions-de-nommage">
      <a class="putainde-Title-anchor" href="#conventions-de-nommage">#</a>
      Conventions de nommage
    </h3><p>Ce mod√®le de d√©veloppement commence par les conventions de nommage. <a href="http://emberjs.com">Ember</a>
applique en effet le principe de ‚Äú<em>conventions over configuration</em>‚Äú et repose sur un nommage coh√©rent des diff√©rents composants 
de votre application. Et finalement, quand on y r√©flechit bien, la coh√©rence, √ßa n‚Äôa pas que des mauvais c√¥t√©s. </p>
<p>Typiquement pour une URL <code>test</code>, <a href="http://emberjs.com">Ember</a> s‚Äôattend √† trouver une <code>TestRoute</code>, un <code>TestController</code>, un gabarit <code>test</code>.
Jusqu‚Äôici, tout va bien.</p>
<p>Curieux ? -&gt; <a href="http://emberjs.com/guides/concepts/naming-conventions/">doc officielle</a>.</p>
<h3 id="modeles">
      <a class="putainde-Title-anchor" href="#modeles">#</a>
      Mod√®les
    </h3><p>Un mod√®le est un objet avec des propri√©t√©s contenant des donn√©es m√©tier. Le mod√®le est ensuite pass√© au gabarit pour √™tre rendu par lui
en HTML. Typiquement, les mod√®les peuvent √™tre r√©cup√©r√©s d‚Äôun back end via une API REST JSON via <a href="https://github.com/emberjs/data">Ember Data</a>
mais pas que.</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> Book = DS.Model.extend({
    title               : DS.attr(<span class="hljs-string">'string'</span>),
    publicationDate     : DS.attr(<span class="hljs-string">'date'</span>),
    author              : DS.attr(<span class="hljs-string">'string'</span>),
    publisher           : DS.attr(<span class="hljs-string">'string'</span>),
    summary             : DS.attr(<span class="hljs-string">'string'</span>)
});
</code></pre>
<p>Assoif√© de connaissances ? -&gt; <a href="http://emberjs.com/guides/models/">doc officielle</a>.</p>
<h3 id="routeur">
      <a class="putainde-Title-anchor" href="#routeur">#</a>
      Routeur
    </h3><p>Le routeur permet de faire correspondre √† une URL un ensemble de gabarits imbriqu√©s permettant le rendu des mod√®les associ√©s √† 
chacun de ces gabarits.</p>
<p>L‚Äôexemple suivant permet le rendu des URLs : </p>
<ul>
<li><code>/books</code></li>
<li><code>/books/:book_id</code></li>
<li><code>/books/:book_id/edit</code></li>
<li><code>/books/create</code></li>
</ul>
<pre><code class="lang-js">App.Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'books'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">this</span>.resource(<span class="hljs-string">'book'</span>, { path: <span class="hljs-string">'/:book_id'</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
          <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'edit'</span>);
      });
      <span class="hljs-keyword">this</span>.route(<span class="hljs-string">'create'</span>);
  });
});
</code></pre>
<h3 id="routes">
      <a class="putainde-Title-anchor" href="#routes">#</a>
      Routes
    </h3><p>Les routes associent un mod√®le √† un gabarit et sont √©galement impliqu√©es dans les transitions entre les diff√©rentes URL (et donc les diff√©rents
√©tats) de l‚Äôapplication. Elles g√®rent notamment un certain nombre d‚Äôop√©rations sur un mod√®le lors de ces transitions.</p>
<pre><code class="lang-js">App.BooksRoute = Ember.Route.extend({
    model: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.store.find(<span class="hljs-string">'book'</span>);
    }
});
</code></pre>
<p>Intrigu√© ? -&gt; <a href="http://emberjs.com/guides/routing/">doc officielle</a>.</p>
<h3 id="controleurs">
      <a class="putainde-Title-anchor" href="#controleurs">#</a>
      Contr√¥leurs
    </h3><p>Le contr√¥leur g√®re l‚Äô√©tat de l‚Äôapplication. Il est situ√© entre la route dont il r√©cup√®re le mod√®le et le gabarit dont il r√©pond aux appels.
Les donn√©es du contr√¥leur sont accessibles au gabarit au m√™me titre que le mod√®le.</p>
<p>Le contr√¥leur est par exemple responsable du traitement des actions effectu√©es par l‚Äôutilisateur sur l‚Äôinterface rendue par le gabarit : </p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">button</span> {{<span class="hljs-attribute">action</span> "<span class="hljs-attribute">sort</span>"}}&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
</code></pre>
<pre><code class="lang-js">App.BooksController = Ember.ArrayController.extend({
  actions: {
    <span class="hljs-comment">// appel√© lors du clic sur le bouton</span>
    sort: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        ...
    }
  }
});
</code></pre>
<p>Perdu ? -&gt; <a href="http://emberjs.com/guides/controllers/">doc officielle</a>.</p>
<h3 id="vues">
      <a class="putainde-Title-anchor" href="#vues">#</a>
      Vues
    </h3><p>Il est tr√®s rare d‚Äôavoir √† d√©finir des vues en <a href="http://emberjs.com">Ember</a> parce que les gabarits <a href="http://handlebarsjs.com/">Handlebars</a>
sont surpuissants et que les contr√¥leurs se chargent de la gestion de l‚Äô√©tat de l‚Äôapplication.</p>
<p>Vous en voulez quand m√™me ? -&gt; <a href="http://emberjs.com/guides/views/">doc officielle</a>.</p>
<h3 id="gabarits">
      <a class="putainde-Title-anchor" href="#gabarits">#</a>
      Gabarits
    </h3><p>Un gabarit est un fragment de code HTML permettant, via des expressions, d‚Äôafficher les donn√©es du mod√®le associ√©. Les gabarits d‚Äô<a href="http://emberjs.com">Ember</a>
sont des gabarits <a href="http://handlebarsjs.com/">Handlebars</a>. Les expressions Handlebars sont d√©limit√©es par <code>{{</code> et <code>}}</code>.</p>
<p>L‚Äôexemple suivant permet d‚Äôafficher le titre d‚Äôune app compos√© d‚Äôun pr√©nom et d‚Äôun nom pour peu que l‚Äôon ait pass√© au gabarit un
mod√®le contenant les deux propri√©t√©s <code>firstname</code> et <code>lastname</code>.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>{{firstname}} {{lastname}} Library<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
</code></pre>
<p><a href="http://handlebarsjs.com/">Handlebars</a> vient avec de nombreux outils (helpers) permettant de dynamiser nos gabarits : <code>{{#if isActive}} ... {{/if}}</code>,
<code>{{#each users}} ... {{/each}}</code>, etc.</p>
<p>Dans <a href="http://emberjs.com">Ember</a>, les gabarits peuvent contenir un √©l√©ment tr√®s important : <code>{{outlet}}</code>. Cet outlet d√©finit un emplacement
pour un autre gabarit permettant ainsi de multiples imbrications √† mesure que les routes de l‚Äôapplication sont activ√©es.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>{{firstname}} {{lastname}} Library<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
  {{outlet}}
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>Tout √©l√©ment de mod√®le inject√© dans un gabarit sera <strong>automatiquement mis √† jour</strong> (binding) par <a href="http://emberjs.com">Ember</a> lorsque le mod√®le
associ√© au gabarit sera modifi√©. √âvidemment, seul cet √©l√©ment sera rafra√Æchit et non le gabarit entier sinon c‚Äôest tricher.</p>
<p>Envie de tester ? -&gt; <a href="http://emberjs.com/guides/templates/the-application-template/">doc officielle</a>.</p>
<h3 id="composants">
      <a class="putainde-Title-anchor" href="#composants">#</a>
      Composants
    </h3><p>Un composant <a href="http://emberjs.com">Ember</a> permet de d√©finir une balise HTML personnalis√©e, permettant ainsi de partager de puissants 
√©l√©ments r√©utilisables au sein de votre application.</p>
<p>Vous en avez toujours r√™v√© ? -&gt; <a href="http://emberjs.com/guides/components/">doc officielle</a>.</p>
<h3 id="generation-d-objets">
      <a class="putainde-Title-anchor" href="#generation-d-objets">#</a>
      G√©neration d‚Äôobjets
    </h3><p>Pour qu‚Äôun gabarit soit rendu lorsqu‚Äôune URL est demand√©e, il faut donc que le routeur d√©finisse cette URL, qu‚Äôelle soit impl√©ment√©e par 
une route qui r√©cup√®rera un mod√®le qu‚Äôelle mettra √† disposition du contr√¥leur et du gabarit. Le contr√¥leur √©coutera les 
√©v√®nements en provenance du gabarit et y apportera la r√©ponse adapt√©e. √Ä noter que l‚Äô√©v√®nement peut √©galement remonter jusqu‚Äô√† la route.
Le gabarit est quant √† lui encapsul√© dans une vue g√©r√©e par Ember tout seul comme un grand.</p>
<p>Il n‚Äôest cependant <strong>pas n√©cessaire de cr√©er syst√©matiquement tous ces objets</strong> si aucune logique sp√©cifique n‚Äôa besoin d‚Äôy √™tre d√©finie.
En effet, <a href="http://emberjs.com">Ember</a> s‚Äôappuie sur les <a href="#conventions-de-nommage">conventions de nommage</a> pour retrouver successivement,
√† partir d‚Äôune URL, la route, le contr√¥leur, la vue et le gabarit associ√©s. Si l‚Äôun de ces objet n‚Äôest pas trouv√©, <a href="http://emberjs.com">Ember</a>
va en g√©n√©rer un par d√©faut. </p>
<p>Donc si l‚Äôon cr√©e dans le routeur la route suivante sans cr√©er aucun autre objet : </p>
<pre><code class="lang-js">App.Router.map(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">this</span>.route(<span class="hljs-string">"about"</span>, { path: <span class="hljs-string">"/about"</span> });
});
</code></pre>
<p><a href="http://emberjs.com">Ember</a> va g√©n√©rer les objets suivants :</p>
<ul>
<li><strong>route</strong> : <code>AboutRoute</code></li>
<li><strong>contr√¥leur</strong> : <code>AboutController</code></li>
<li><strong>gabarit</strong> : <code>about</code></li>
</ul>
<p>Dans une application <a href="http://emberjs.com">Ember</a>, <strong>il est donc n√©cessaire de ne d√©finir que ce dont on a besoin !</strong>. Et c‚Äôest bien connu, 
moins il y a de boilerplate, plus il y a de plaisir !</p>
<p>Envie d‚Äôen savoir plus ? -&gt; <a href="http://emberjs.com/guides/routing/generated-objects/">doc officielle</a>.</p>
<p>Un bon moyen de se rendre compte de √ßa consiste √† installer le debugger Ember sur votre navigateur pr√©f√©r√© (donc pas IE). Vous aurez, entre
autres, la liste de l‚Äôensemble des objets impliqu√©s dans le rendu d‚Äôune URL donn√©e. Cette liste distingue de mani√®re claire les objets
cr√©√©s par vous et ceux g√©n√©r√©s par Ember. </p>
<p>Ce module s‚Äôappelle <strong>Ember Inspector</strong> et est disponible pour <a href="https://chrome.google.com/webstore/detail/ember-inspector/bmdblncegkenkacieihfhpjfppoconhi?hl=en">Chrome</a> 
et <a href="https://addons.mozilla.org/en-US/firefox/addon/ember-inspector/">Firefox</a>. C‚Äôest absolument indispensable lorsqu‚Äôon d√©veloppe en Ember.</p>
<h2 id="conclusion-et-next-steps">
      <a class="putainde-Title-anchor" href="#conclusion-et-next-steps">#</a>
      Conclusion et next steps
    </h2><p><a href="http://emberjs.com">Ember</a> est donc un framework tr√®s riche et extr√™mement plaisant √† pratiquer. 
<strong>Un vrai framework avec un vrai parti pris et des vrais choix structurants.</strong>
Il est r√©solument tourn√© vers le web et les URL. Ses cr√©ateurs sont √©galement ceux de son moteur de gabarit <a href="http://handlebarsjs.com/">Handlebars</a>
et sont tr√®s impliqu√©s dans diverses initiatives autour de la standardisation et de l‚Äô√©volution du web. Pour n‚Äôen citer que deux :
<a href="http://jsonapi.org/">JSON API</a> et <a href="https://gist.github.com/wycats/9144666b0c606d1838be">Web Components</a>, notamment au travers du moteur
de gabarits <a href="https://github.com/tildeio/htmlbars">HTMLBars</a>. 
Ils embrassent tr√®s rapidement les nouveaux standards tels que <a href="https://people.mozilla.org/~jorendorff/es6-draft.html">ES6 Harmony</a> √† l‚Äôimage des travaux
effectu√©s autour d‚Äô<a href="http://www.ember-cli.com/">ember-cli</a> qui sera abord√© dans un prochain article.</p>
<p>Enfin, contrairement aux <em>a priori</em>, la courbe d‚Äôapprentissage d‚Äô<a href="http://emberjs.com">Ember</a>
est progressive et il est tr√®s simple √† prendre en main une fois les concepts de base appr√©hend√©s - c‚Äôest justement le but de cet
article. Au prochain √©pisode, nous verrons justement - par la pratique cette fois, <strong>comment d√©marrer et construire progressivement une
application <a href="http://emberjs.com">Ember</a></strong>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/js/debuter-avec-ember/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/js/debuter-avec-ember/</guid>
            <pubDate>Mon, 20 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Comment essayer de coder √† peu pr√®s comme un chef (rat√©) sous Windows]]></title>
            <description><![CDATA[<figure>
  <img src="index.jpg" alt="Keyboard">
  <small><a href="http://www.customity.com/content/wallpaper/windows-key-wallpaper">Credit photo</a></small>
</figure>

<p>Oh oui, en voil√† une belle question.</p>
<p>Il n‚Äôest pas toujours √©vident d‚Äôavoir un Linux, Unix, BSD ou autre avec un petit shell bien sympa sous la main. Et parfois coder sous Windows est une n√©cessit√© voire un d√©sir. (Ouais, je ne vous parlerai pas ici de changer de boulot si Windows vous est impos√©(e). Je ne vous expliquerai pas non plus votre masochisme d‚Äôappr√©cier cet OS pour d√©velopper, ce n‚Äôest pas le sujet).</p>
<p>√âtant un homme de challenge, j‚Äôaime me mettre dans des contextes limit√©s et voir comment je me d√©brouille pour sortir d‚Äôune situation p√©nible √† une situation acceptable voire agr√©able. Je me suis alors lanc√© pour vous dans cette aventure.</p>
<p>Oh mais pourquoi j‚Äôai d√ª faire √ßa √† la base ?</p>
<p>Apr√®s avoir cr√©√© <a href="https://github.com/kud/my">mon propre syst√®me de synchronisation de machines sous Mac OS X</a> (plus souvent commun√©ment appel√© dotfiles mais faisant un peu plus), j‚Äôai voulu faire de m√™me sous Windows au cas o√π mon syst√®me crasherait et o√π je devrais tout r√©installer. On n‚Äôest jamais √† l‚Äôabri.</p>
<p>Pour cela, plusieurs outils vont vous √™tre n√©cessaires. Un chef sans bons outils, c‚Äôest dr√¥lement handicapant. (D√©j√† que l‚ÄôOS en question n‚Äôaide pas).</p>
<h2 id="chocolatey-la-base">
      <a class="putainde-Title-anchor" href="#chocolatey-la-base">#</a>
      Chocolatey : la base
    </h2><p><a href="http://chocolatey.org/">Chocolatey</a>. Ouais, chocolatey, ce petit script vous permettra de t√©l√©charger tout et n‚Äôimporte quoi en CLI (ligne de commandes). Pour ceux qui ont l‚Äôhabitude de Mac ou Linux, c‚Äôest le brew / apt-get de Windows.</p>
<p>Comment l‚Äôinstaller ?</p>
<p>Lancez <code>cmd.exe</code> en mode administrateur (touche windows puis ‚Äúcmd‚Äù puis shift+ctrl+enter) et ex√©cutez ce code :</p>
<pre><code class="lang-console">$ <span class="hljs-variable">@powershell</span> -NoProfile -ExecutionPolicy unrestricted -Command <span class="hljs-string">"iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1'))"</span> &amp;&amp; SET PATH=<span class="hljs-variable">%PATH</span><span class="hljs-variable">%;</span><span class="hljs-variable">%ALLUSERSPROFILE</span><span class="hljs-variable">%\</span>chocolatey\bin
</code></pre>
<p>Ou <code>PowerShell</code> en mode administrateur (touche windows puis ‚Äúpowershell‚Äù puis shift+ctrl+enter) et √©xecutez :</p>
<pre><code class="lang-console">$ iex ((new-<span class="hljs-tag">object</span> net.webclient).<span class="hljs-function"><span class="hljs-title">DownloadString</span><span class="hljs-params">(<span class="hljs-string">'https://chocolatey.org/install.ps1'</span>)</span></span>)
</code></pre>
<p>Une fois install√©, vous pourrez installer n‚Äôimporte quel logiciel list√© sur <a href="http://chocolatey.org/packages">leur site</a>.</p>
<p>Passons √† la suite.</p>
<h2 id="logiciels-de-developpement">
      <a class="putainde-Title-anchor" href="#logiciels-de-developpement">#</a>
      Logiciels de d√©veloppement
    </h2><p>Yes, on a donc Chocolatey qui va nous simplifier grandement l‚Äôinstallation de logiciels. Passons maintenant aux outils pour bien d√©velopper.</p>
<h3 id="git">
      <a class="putainde-Title-anchor" href="#git">#</a>
      Git
    </h3><p>Lorsque tu joues √† un jeu vid√©o, tu sauvegardes r√©guli√®rement ton avancement non ? Bah l√†, c‚Äôest pareil mais pour le code.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> git.<span class="hljs-keyword">install</span>
</code></pre>
<ul>
<li><a href="http://git-scm.com/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/git.install">lien du package</a></li>
</ul>
<h3 id="node-js">
      <a class="putainde-Title-anchor" href="#node-js">#</a>
      Node.js
    </h3><p>Faire du JavaScript c√¥t√© serveur ou en shell, le pied. Surtout pour faire des scripts Windows, plut√¥t que de passer par Batch.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> nodejs.<span class="hljs-keyword">install</span>
</code></pre>
<ul>
<li><a href="http://nodejs.org/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/nodejs.install">lien du package</a></li>
</ul>
<h3 id="editeur-de-texte">
      <a class="putainde-Title-anchor" href="#editeur-de-texte">#</a>
      √âditeur de texte
    </h3><p>Sublime Text, l‚Äô√©diteur pr√©f√©r√© des Fran√ß‚Ä¶ je m‚Äô√©gare. Bref, un bon √©diteur.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> sublimetext3
</code></pre>
<ul>
<li><a href="http://www.sublimetext.com/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/sublimetext3">lien du package</a></li>
</ul>
<p>Vous pouvez aussi installer <a href="https://atom.io/">Atom</a> si vous pr√©f√©rez.</p>
<h3 id="gestion-d-une-base-de-donnees">
      <a class="putainde-Title-anchor" href="#gestion-d-une-base-de-donnees">#</a>
      Gestion d‚Äôune base de donn√©es
    </h3><p>HeidiSQL, un logiciel avec une interface qui se rapproche de phpMyAdmin.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> HeidiSQL
</code></pre>
<ul>
<li><a href="http://www.heidisql.com/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/HeidiSQL">lien du package</a></li>
</ul>
<p>Ou encore MySQL Workbench un excellent soft pour g√©rer une base de donn√©es:</p>
<ul>
<li>Mod√©lisation</li>
<li>√âdition</li>
<li>Migration
Par contre, il est un peu plus complexe √† utiliser.</li>
</ul>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> mysql.workbench
</code></pre>
<ul>
<li><a href="http://dev.mysql.com/downloads/workbench/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/mysql.workbench">lien du package</a></li>
</ul>
<h3 id="un-meilleur-shell">
      <a class="putainde-Title-anchor" href="#un-meilleur-shell">#</a>
      Un meilleur shell
    </h3><p>Cmder va vous permettre quelques fonctionnalit√©s int√©ressantes que le shell de Windows n‚Äôa pas de base, comme taper <code>&lt;tab&gt;</code> pour l‚Äôautocompl√©tion, avoir un historique persistant entre 2 sessions, des onglets, le split de console, l‚Äôint√©gration de PuTTY et d‚Äôautres choses venu de la banquise. (le lieu de vie des pinguins)</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> Cmder
</code></pre>
<ul>
<li><a href="https://bliker.github.io/cmder/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/Cmder">lien du package</a></li>
</ul>
<h3 id="si-vous-avez-besoin-de-ssh">
      <a class="putainde-Title-anchor" href="#si-vous-avez-besoin-de-ssh">#</a>
      Si vous avez besoin de SSH
    </h3><p>Pour le SSH sous Windows c‚Äôest assez complexe, il faut quelques outils dont le principal, putty (un terminal et +).</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> putty
</code></pre>
<ul>
<li><a href="http://chocolatey.org/packages/putty">site officiel</a></li>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/">lien du package</a></li>
</ul>
<p>Putty vient avec une suite de logiciels :</p>
<ul>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">PuTTYgen</a> pour g√©n√©rer une cl√© SSH sous Windows</li>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">Plink</a> pour permettre √† HeidiSQL de se connecter √† une base de donn√©es via SSH.</li>
<li><a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">Pageant</a> pour charger votre cl√© SSH dans Windows pour √©viter qu‚Äôil demande sans cesse la cl√© ou le mot de passe.</li>
</ul>
<blockquote>
<p>Pour que le ssh soit agr√©able, je vous recommande pageant et ensuite un terminal comme <em>Clink</em> ou encore <em>git bash</em> qui s‚Äôinstalle via <em>git</em>.</p>
</blockquote>
<h3 id="une-machine-virtuelle-pour-tester-ie-ou-meme-gnu-linux">
      <a class="putainde-Title-anchor" href="#une-machine-virtuelle-pour-tester-ie-ou-meme-gnu-linux">#</a>
      Une machine virtuelle pour tester IE ou m√™me GNU/Linux
    </h3><p>On a toujours une int√©gration √† tester sous IE pour √ßa Microsoft nous donne acc√®s √† des machines virtuelles gratuitement sur <a href="https://www.modern.ie/fr-fr">ModernIE</a>. Il nous faut donc Virtualbox pour les lancer.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> virtualbox
$ choco <span class="hljs-keyword">install</span> VirtualBox.ExtensionPack
</code></pre>
<blockquote>
<p>l‚ÄôExtension Pack est utile pour une int√©gration parfaite avec votre machine si vous installez votre propre VM GNU/Linux ou Windows.</p>
</blockquote>
<ul>
<li><a href="hhttps://www.virtualbox.org/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/virtualbox">lien du package</a></li>
</ul>
<h3 id="compresser-decompresser-comme-vous-le-voulez">
      <a class="putainde-Title-anchor" href="#compresser-decompresser-comme-vous-le-voulez">#</a>
      Compresser / d√©compresser comme vous le voulez
    </h3><p>7zip, le logiciel de r√©f√©rence pour ce genre de pratique.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> <span class="hljs-number">7</span>zip.<span class="hljs-keyword">install</span>
</code></pre>
<ul>
<li><a href="http://www.7-zip.org/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/7zip.install">lien du package</a></li>
</ul>
<h3 id="gerer-les-pdf">
      <a class="putainde-Title-anchor" href="#gerer-les-pdf">#</a>
      G√©rer les pdf
    </h3><p>Sumatra pour les lire. PDFCreator pour faire une imprimante virtuelle sortant des PDFs.</p>
<h4 id="sumatra">
      <a class="putainde-Title-anchor" href="#sumatra">#</a>
      Sumatra
    </h4><ul>
<li><a href="http://blog.kowalczyk.info/software/sumatrapdf/free-pdf-reader.html">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/sumatrapdf.install">lien du package</a></li>
</ul>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> sumatrapdf.<span class="hljs-keyword">install</span>
</code></pre>
<h4 id="pdfcreator">
      <a class="putainde-Title-anchor" href="#pdfcreator">#</a>
      PDFCreator
    </h4><ul>
<li><a href="http://www.pdfforge.org/pdfcreator">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/pdfcreator">lien du package</a></li>
</ul>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> pdfcreator
</code></pre>
<h3 id="mettre-des-onglets-dans-l-explorateur-de-fichiers">
      <a class="putainde-Title-anchor" href="#mettre-des-onglets-dans-l-explorateur-de-fichiers">#</a>
      Mettre des onglets dans l‚Äôexplorateur de fichiers
    </h3><p>Nous sommes en 2014 √ßa fait des ann√©es que Microsoft sait mais, ce n‚Äôest toujours pas disponible. C‚Äôest l√† que Clover rentre en jeu.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> Clover
</code></pre>
<ul>
<li><a href="http://ejie.me/">site officiel</a></li>
<li><a href="http://chocolatey.org/packages/Clover">lien du package</a></li>
</ul>
<h3 id="spaaaaaaaces">
      <a class="putainde-Title-anchor" href="#spaaaaaaaces">#</a>
      Spaaaaaaaces
    </h3><p>Parce qu‚Äôavoir plusieurs bureaux / espaces, c‚Äôest plus pratique pour g√©rer ses fen√™tres, je vous propose VirtuaWin. Cela vous permettra de garder en plein √©cran vos logiciels et de zapper d‚Äôun logiciel √† un autre sans passer par <code>alt+tab</code> mais en allant d‚Äôun bureau √† un autre.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> virtuawin
</code></pre>
<ul>
<li><a href="http://virtuawin.sourceforge.net/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/virtuawin">lien du package</a></li>
</ul>
<h3 id="launchy-le-alfred-like-sous-windows">
      <a class="putainde-Title-anchor" href="#launchy-le-alfred-like-sous-windows">#</a>
      Launchy, le Alfred-like sous Windows
    </h3><p>Je sais pas vous mais moi, les raccourcis qui me g√¢chent mon beau wallpaper choisi avec go√ªt, √ßa m‚Äô√©nerve. Et puis le clickodrome, c‚Äôest lent et chiant. Du coup, lancer ses logiciels √† partir d‚Äôun moteur de recherche, c‚Äôest quand m√™me vachement bien. Ca permet aussi de faire des recherches de fichier, des calculs, et tout un tas d‚Äôautres choses. Voici alors Launchy.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> launchy-beta
</code></pre>
<ul>
<li><a href="http://www.launchy.net/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/launchy-beta">lien du package</a></li>
</ul>
<h3 id="pipette-et-retouche">
      <a class="putainde-Title-anchor" href="#pipette-et-retouche">#</a>
      Pipette et retouche
    </h3><p>L‚Äôindispensable <a href="http://photofiltre.free.fr/frames.htm">PhotoFiltre</a> qui, bien qu‚Äôil ne soit plus mis √† jour depuis 2012, est tr√®s stable et efficace. Il fait peu mais, le fait bien.</p>
<ul>
<li>√âdition rapide d‚Äôimages</li>
<li>Pipette</li>
<li>etc.</li>
</ul>
<p>Et surtout, il est ultra l√©ger et d√©marre en moins d‚Äôune seconde.</p>
<h3 id="et-enfin-comment-ne-pas-se-niquer-les-yeux-toute-la-journee">
      <a class="putainde-Title-anchor" href="#et-enfin-comment-ne-pas-se-niquer-les-yeux-toute-la-journee">#</a>
      Et enfin, comment ne pas se niquer les yeux toute la journ√©e
    </h3><h4 id="f-lux">
      <a class="putainde-Title-anchor" href="#f-lux">#</a>
      f.lux
    </h4><p>On va commencer par f.lux. Ce petit logiciel permettant de g√©rer la colorim√©trie de votre √©cran en fonction de l‚Äôheure. Typiquement, les √©crans rendent un blanc digne d‚Äôun soleil √† midi. Sauf que le soir, on allume la lumi√®re et celle-ci n‚Äôa pas du coup une couleur blanche mais souvent plut√¥t rouge. f.lux permet alors d‚Äôajuster votre √©cran afin que la couleur soit identique √† la lumi√®re ambiante pour r√©duire les diff√©rences de couleurs et √©viter de vous abimer les yeux. En plus, √ßa permet au cerveau de se pr√©parer √† aller se coucher. :D</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> f.lux
</code></pre>
<ul>
<li><a href="https://justgetflux.com/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/f.lux">lien du package</a></li>
</ul>
<h4 id="mactype">
      <a class="putainde-Title-anchor" href="#mactype">#</a>
      MacType
    </h4><p>Et surtout, MacType. Oh oui MacType. Je pense que seule une personne venant de Mac OS X peut comprendre. Dieu sait que le font rendering sous Windows est vraiment pourri et que Steve Jobs depuis le d√©part de Mac a fait en sorte sur le rendering des fonts sous son OS soit de qualit√©.</p>
<p>Pour r√©duire cette diff√©rence entre un Windows et un Mac OS X, je vous propose MacType qui permet de remplacer le font rendering de Windows et d‚Äôappr√©cier lire √† nouveau sur cet OS.</p>
<pre><code class="lang-console">$ choco <span class="hljs-keyword">install</span> mactype
</code></pre>
<p>Je vous conseille le profil <code>XMac.LCD.Default</code>.</p>
<ul>
<li><a href="https://code.google.com/p/mactype/">site officiel</a></li>
<li><a href="https://chocolatey.org/packages/mactype">lien du package</a></li>
</ul>
<h2 id="vous-voila-pare-e">
      <a class="putainde-Title-anchor" href="#vous-voila-pare-e">#</a>
      Vous voil√† par√©(e) !
    </h2><p>On est bon, on a tous les outils n√©cessaires pour pouvoir coder correctement sur Windows.</p>
<p>Si vous souhaitez en savoir plus et surtout vous tenir √† jour d‚Äô√©ventuels logiciels que je pourrais installer, n‚Äôh√©sitez pas √† vous rendre sur mon projet <a href="https://github.com/kud/my-unfortunately">my-unfortunately</a> qui est le <em>synchroniser</em> dont je vous ai parl√© tout √† l‚Äôheure.</p>
<p>Bon code !</p>
]]></description>
            <link>http://putaindecode.fr/posts/windows/comment-coder-sous-windows/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/windows/comment-coder-sous-windows/</guid>
            <pubDate>Wed, 15 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[D√©pendances et premier projet en Ruby]]></title>
            <description><![CDATA[<p><a href="#tl-dr">tl;dr</a></p>
<p>Dans l‚Äô<a href="/posts/backend/premiers-pas-avec-ruby">article pr√©c√©dent</a>
nous avons install√© Ruby. D√©sormais nous allons aborder les gems,
les d√©pendances et commencer notre web service.</p>
<p>Un gem en Ruby c‚Äôest une lib, comme un paquet NPM pour NodeJS. C‚Äôest
d‚Äôailleurs le syst√®me de rubygems qui a inspir√© le syst√®me de NPM.
Pour installer un gem, rien de plus simple que <code>gem install sass</code>,
qui ici va installer la biblioth√®que <code>sass</code>.</p>
<p>Un projet Ruby n√©cessite la plupart du temps des biblioth√®ques afin
de ne pas tout faire soi-m√™me, il est donc n√©cessaire d‚Äôavoir une
gestion des d√©pendances pour le projet.</p>
<h2 id="bundler-le-gem-qui-gere-les-gems">
      <a class="putainde-Title-anchor" href="#bundler-le-gem-qui-gere-les-gems">#</a>
      Bundler, le gem qui g√®re les gems
    </h2><p><a href="http://bundler.io">Bundler</a> est un gem qui va vous permettre de cr√©er un fichier Gemfile
contenant vos d√©pendances, et qui vous installera les gems
n√©cessaires avec la gestion des versions et de leurs propres
d√©pendances. Un fichier Gemfile se pr√©sente comme ceci :</p>
<pre><code class="lang-ruby">source <span class="hljs-string">'https://rubygems.org'</span>
ruby <span class="hljs-string">'2.1.2'</span>
gem <span class="hljs-string">'sinatra'</span>
</code></pre>
<p>L‚Äôinstruction <code>source</code> permet de pr√©ciser l‚Äôurl des d√©p√¥ts de gems.
La version de ruby n‚Äôest pas obligatoire mais j‚Äôaime la pr√©ciser pour
ne pas me m√©langer dans mes projets avec diff√©rentes versions de Ruby
(voir le
<a href="/posts/backend/premiers-pas-avec-ruby">pr√©c√©dent article pour les versions du Ruby</a>
et <a href="https://github.com/sstephenson/rbenv">rbenv</a>). Et enfin, la
d√©claration de notre premi√®re biblioth√®que de d√©pendance :
<a href="http://www.sinatrarb.com">Sinatra</a>.</p>
<p>Il est possible d‚Äô√™tre bien plus pr√©cis dans le Gemfile, comme‚Ä¶</p>
<p>Pr√©ciser dans quel environnement charger les gems :</p>
<pre><code class="lang-ruby">gem <span class="hljs-string">'sqlite3'</span>, <span class="hljs-symbol">group:</span> [<span class="hljs-symbol">:development</span>, <span class="hljs-symbol">:test</span>]
</code></pre>
<p>Une num√©ro de version :</p>
<pre><code class="lang-ruby">gem <span class="hljs-string">'rails'</span>, <span class="hljs-string">'4.1.6'</span>         <span class="hljs-comment"># version 4.1.6</span>
gem <span class="hljs-string">'sass-rails'</span>, <span class="hljs-string">'~&gt; 4.0.3'</span> <span class="hljs-comment"># &gt;= 4.0.3 mais &lt; 4.1.0</span>
</code></pre>
<p>Pr√©ciser la classe √† charger :</p>
<pre><code class="lang-ruby">gem <span class="hljs-string">'valid_email'</span>, <span class="hljs-symbol">require:</span> <span class="hljs-string">'valid_email/email_validator'</span>
</code></pre>
<p>Aller chercher directement sur Github :</p>
<pre><code class="lang-ruby">gem <span class="hljs-string">'nokogiri'</span>, <span class="hljs-symbol">github:</span> <span class="hljs-string">'sparklemotion/nokogiri'</span>
<span class="hljs-comment"># https://github.com/sparklemotion/nokogiri.git</span>

gem <span class="hljs-string">'rails'</span>, <span class="hljs-symbol">github:</span> <span class="hljs-string">'rails'</span>
<span class="hljs-comment"># https://github.com/rails/rails.git</span>

gem <span class="hljs-string">'rails'</span>, <span class="hljs-symbol">github:</span> <span class="hljs-string">'rails'</span>, <span class="hljs-symbol">branch:</span> <span class="hljs-string">'4-1-stable'</span>
<span class="hljs-comment"># https://github.com/rails/rails.git sur la branche 4-1-stable</span>
</code></pre>
<p>Il existe encore d‚Äôautres instructions, de quoi rendre sa gestion des
d√©pendances vraiment fine et pr√©cise.</p>
<p>Une fois le Gemfile pr√™t, bundler a plusieurs commandes de
disponibles pour pouvoir les t√©l√©charger et utiliser.</p>
<ul>
<li><code>$ bundle install</code> installera les gems requis</li>
<li><code>$ bundle update</code> mettra √† jour vers les versions les plus r√©centes si possible les gems requis</li>
<li><code>$ bundle exec</code> permettra de pr√©c√©der une commande ruby afin de l‚Äôex√©cuter dans le contexte du Gemfile, tr√®s utile lorsque l‚Äôon a diff√©rentes versions de Ruby qui se baladent dans le terminal</li>
</ul>
<p>Bundler va g√©n√©rer un fichier <code>Gemfile.lock</code> qui est la description
exhaustive des d√©pendances de votre application, chaque gem avec le
num√©ro de sa version install√©e, chaque d√©pendance pour chaque gem,
une jolie arborescence plus que pr√©cise.</p>
<h2 id="commencons-notre-web-service">
      <a class="putainde-Title-anchor" href="#commencons-notre-web-service">#</a>
      Commen√ßons notre web service
    </h2><p>Assez parl√© des outils qui existent, utilisons-les. Tout d‚Äôabord
installons Bundler, sans oublier le <code>$ rbenv rehash</code> n√©cessaire si vous
utilisez rbenv pour vos versions de Ruby afin de mettre √† jour les
commandes disponibles dans le terminal :</p>
<pre><code><span class="hljs-variable">$ </span>gem install bundler
<span class="hljs-variable">$ </span>rbenv rehash
</code></pre><p>Pour notre premi√®re application, nous allons faire un web service
avec Sinatra qui est un micro-framework web, ayant d‚Äôailleurs
clairement inspir√© Express (‚ÄúSinatra inspired web development
framework for node.js‚Äù). Notre Gemfile va donc √™tre exactement
comme notre premier exemple :</p>
<pre><code class="lang-ruby">source <span class="hljs-string">'https://rubygems.org'</span>
ruby <span class="hljs-string">'2.1.2'</span>
gem <span class="hljs-string">'sinatra'</span>
</code></pre>
<p>Un petit <code>bundle install</code> et nous sommes pr√™ts √† d√©marrer !</p>
<p>Pour ne pas brusquer les choses, nous allons faire la version la plus
simple d‚Äôun web service avec Sinatra, ce qui nous permettra de
constater la simplicit√© extr√™me de Ruby et du framework :</p>
<pre><code class="lang-ruby"><span class="hljs-comment">########</span>
<span class="hljs-comment"># app.rb</span>
<span class="hljs-comment">#</span>

<span class="hljs-keyword">require</span> <span class="hljs-string">'sinatra'</span>

get <span class="hljs-string">'/'</span> <span class="hljs-keyword">do</span>
  <span class="hljs-string">'Hello World!'</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Qu‚Äôavons-nous fait l√† ? Pas grand chose, et en m√™me temps tout juste
ce qu‚Äôil faut. Nous avons inclus le gem √† notre script et utilis√© la
m√©thode Sinatra <code>get</code> nous permettant de d√©clarer un point d‚Äôentr√©e
en <code>GET</code> sur la route ‚Äò/‚Äò. Cette m√©thode prend √©galement comme
argument un <code>block</code> caract√©ris√© par le <code>do</code> et le <code>end</code>. La derni√®re
valeur du block √©tant la valeur de retour, nous renvoyons la seule
cha√Æne de caract√®res ‚ÄúHello World!‚Äù.</p>
<p>Et maintenant : lancement ! <code>$ bundle exec ruby app.rb</code> va lancer
l‚Äôapplication (mais <code>ruby app.rb</code> suffit), par d√©faut sur le port
<code>4567</code>. Regardez vite <a href="http://localhost:4567">http://localhost:4567</a>
et l√† magie, ‚ÄúHello World!‚Äù sur une magnifique page blanche, notre
tout premier web service est fonctionnel.</p>
<p>Alors oui, ce n‚Äôest pas une r√©volution. Mais tout de m√™me, en
r√©duisant la syntaxe du block on se retrouve avec un script de deux
lignes qui cr√©e un vrai web service web. Et vous allez vite voir
qu‚Äôen quelques lignes de plus on peut vite complexifier le bousin.</p>
<h2 id="au-prochain-episode">
      <a class="putainde-Title-anchor" href="#au-prochain-episode">#</a>
      Au prochain √©pisode
    </h2><p>Dans l‚Äôarticle suivant nous allons ajouter des fonctionnalit√©s √†
notre toute nouvelle application, de nouvelles routes, de la
persistence et aussi des vues dans un format un peu plus utile.</p>
<p>Stay tuned!</p>
<h2 id="tl-dr">
      <a class="putainde-Title-anchor" href="#tl-dr">#</a>
      tl;dr
    </h2><p>Voici la version abr√©g√©e de cet article :</p>
<pre><code class="lang-ruby"><span class="hljs-comment"># Gemfile</span>
source <span class="hljs-string">'https://rubygems.org'</span>
ruby <span class="hljs-string">'2.1.2'</span>
gem <span class="hljs-string">'sinatra'</span>
</code></pre>
<pre><code class="lang-ruby"><span class="hljs-comment"># app.rb</span>
<span class="hljs-keyword">require</span> <span class="hljs-string">'sinatra'</span>
get <span class="hljs-string">'/'</span> <span class="hljs-keyword">do</span>
  <span class="hljs-string">'Hello World!'</span>
<span class="hljs-keyword">end</span>
</code></pre>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>gem install bundler
<span class="hljs-variable">$ </span>rbenv rehash
<span class="hljs-variable">$ </span>bundle install
<span class="hljs-variable">$ </span>ruby app.rb
</code></pre>
<h2 id="sources">
      <a class="putainde-Title-anchor" href="#sources">#</a>
      Sources
    </h2><ul>
<li><a href="https://rubygems.org">RubyGems</a></li>
<li><a href="http://bundler.io">Bundler</a></li>
<li><a href="https://github.com/sstephenson/rbenv">rbenv</a></li>
<li><a href="http://www.sinatrarb.com">Sinatra</a> et surtout son <a href="http://www.sinatrarb.com/intro.html">README</a></li>
</ul>
]]></description>
            <link>http://putaindecode.fr/posts/backend/ruby-dependances-et-projet/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/backend/ruby-dependances-et-projet/</guid>
            <pubDate>Tue, 14 Oct 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Le guide complet pour centrer en css]]></title>
            <description><![CDATA[<p>Centrer en css, c‚Äôest la base, et parfois, ce n‚Äôest pas si simple. Ce guide vous servira donc pour vous lister les techniques les plus connues pour r√©aliser ce fameux effet centr√©.</p>
<p>Les principales techniques de centrage en css seront expliqu√©es pendant les premi√®res d√©clarations, et r√©utilis√©es par la suite dans tout le guide, vous pouvez donc avoir un int√©r√™t √† lire le guide dans le sens normal de la lecture.</p>
<p>Cependant, si vous souhaitez juste avoir le code correspondant √† votre probl√®me, vous pouvez utiliser le menu compos√© d‚Äôancres ci-dessous.</p>
<h2 id="sommaire">
      <a class="putainde-Title-anchor" href="#sommaire">#</a>
      Sommaire
    </h2><ul>
<li><a href="#tl-dr-mes-techniques-preferees">tl;dr - mes techniques pr√©f√©r√©es</a></li>
<li><a href="#techniques-traditionnelles">Techniques tradtionnelles</a><ul>
<li><a href="#un-bloc-dans-un-bloc">Un bloc dans un bloc</a></li>
<li><a href="#des-blocs-dans-un-bloc">Des blocs dans un bloc</a></li>
<li><a href="#des-elements-inlines-dans-un-bloc">Des √©l√©ments inlines dans un bloc</a></li>
</ul>
</li>
<li><a href="#techniques-avancees-flexbox-ie11-">Techniques avanc√©es : flexbox (ie11+)</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<h2 id="tl-dr-mes-techniques-preferees">
      <a class="putainde-Title-anchor" href="#tl-dr-mes-techniques-preferees">#</a>
      tl;dr - mes techniques pr√©f√©r√©es
    </h2><h3 id="un-bloc-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#un-bloc-dans-un-bloc">#</a>
      Un bloc dans un bloc
    </h3><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;

  <span class="hljs-comment">/* facultatif : r√©soud un bug non syst√©matique de blur sur IE */</span>
  <span class="hljs-rule"><span class="hljs-attribute">transform-style</span>:<span class="hljs-value"> preserve-<span class="hljs-number">3</span>d</span></span>; 
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform</span>:<span class="hljs-value"> <span class="hljs-function">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>)</span></span>; <span class="hljs-comment">/* compatibilit√© : ie9+ */</span>
}</span>
</code></pre>
<p><em>Note : le d√©tail de la technique est expliqu√© plus loin dans le post</em></p>
<h3 id="des-blocs-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#des-blocs-dans-un-bloc">#</a>
      Des blocs dans un bloc
    </h3><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  content: <span class="hljs-string">''</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-right</span>:<span class="hljs-value"> -<span class="hljs-number">0.25em</span></span></span>; <span class="hljs-comment">/* space width */</span>
}

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<p><em>Note : le d√©tail de la technique est expliqu√© plus loin dans le post</em></p>
<h3 id="des-elements-inline-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#des-elements-inline-dans-un-bloc">#</a>
      Des √©l√©ments inline dans un bloc
    </h3><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<p><em>Note : le d√©tail de la technique est expliqu√© plus loin dans le post</em></p>
<h2 id="techniques-traditionnelles">
      <a class="putainde-Title-anchor" href="#techniques-traditionnelles">#</a>
      Techniques traditionnelles
    </h2><h3 id="un-bloc-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#un-bloc-dans-un-bloc">#</a>
      Un bloc dans un bloc
    </h3><h4 id="centrage-horizontal">
      <a class="putainde-Title-anchor" href="#centrage-horizontal">#</a>
      Centrage horizontal
    </h4><p>La technique du <code>margin: 0 auto;</code> consiste √† dire au browser que les marges de gauche et droite seront identiques et que leur valeur sera <code>auto</code>. Le browser calcule donc des marges de m√™me taille de chaque c√¥t√© et centre le bloc naturellement.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">margin</span>:<span class="hljs-value"> <span class="hljs-number">0</span> auto</span></span>;
}</span>
</code></pre>
<p>La technique du <code>left: 50%; + margin n√©gative en unit√©s</code> est √† utiliser sur les blocs dont vous connaissez la taille √† l‚Äôavance. Le principe consiste √† expliquer au navigateur qu‚Äôon place un bloc en <code>position: absolute;</code>. Celui-ci va donc chercher √† se placer par rapport √† son √©l√©ment parent le plus proche qui est en <code>position: relative;</code>. Il faut donc ne pas oublier d‚Äôattribuer cette propri√©t√© sur le <code>.parent</code>. Il suffit ensuite d‚Äôindiquer qu‚Äôon place le bloc √† <code>left: 50%;</code>. Le bloc se place donc √† 50% vers la gauche par rapport √† la taille totale du bloc conteneur. Il ne nous reste plus qu‚Äô√† d√©caler vers la droite le bloc <code>.child</code> en lui donnant une valeur de margin n√©gative vers la gauche. Celle-ci doit √™tre √©gale √† la moiti√© de la <code>width</code>(en pixels, em, rems, pourcentages, ‚Ä¶).</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> {X}em</span></span>; <span class="hljs-comment">/* remplacer {X} par votre valeur */</span>
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-left</span>:<span class="hljs-value"> -{X/<span class="hljs-number">2</span>}em</span></span>; <span class="hljs-comment">/* remplacer {X/2} par la moiti√© de votre width */</span>
}</span>
</code></pre>
<p>En combinant la technique pr√©c√©dente et des propri√©t√©s css modernes, on arrive √† la technique du <code>transform: translate; n√©gatif</code>. M√™me principe que la technique pr√©c√©dente, sauf qu‚Äô√† la fin, on indique au bloc enfant d‚Äôeffectuer une translation sur lui-m√™me, en suivant l‚Äôaxe X (l‚Äôaxe horizontal) de -50%, donc 50% vers la droite. Sauf que ce 50% s‚Äôapplique sur le bloc enfant directement. Vous n‚Äôavez donc pas besoin de connaitre la <code>width</code> de l‚Äô√©l√©ment enfant √† l‚Äôavance. Le <code>transform-style: preserve-3d;</code> sur le bloc <code>.parent</code> est l√† pour r√©gler des probl√®mes de flou sur certains navigateurs lors de transitions.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;

  <span class="hljs-comment">/* facultatif : r√©soud un bug non syst√©matique de blur sur IE */</span>
  <span class="hljs-rule"><span class="hljs-attribute">transform-style</span>:<span class="hljs-value"> preserve-<span class="hljs-number">3</span>d</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform</span>:<span class="hljs-value"> <span class="hljs-function">translateX</span>(-<span class="hljs-number">50%</span>)</span></span>;
}</span>
</code></pre>
<h4 id="centrage-vertical">
      <a class="putainde-Title-anchor" href="#centrage-vertical">#</a>
      Centrage vertical
    </h4><p>M√™me principe que la technique <code>left: 50%; + margin n√©gative en unit√©s</code>, sauf qu‚Äôon applique le principe aux propri√©t√©s css relatives √† la hauteur. Vous avez donc besoin de connaitre √† l‚Äôavance la hauteur de votre bloc.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> {Y}em</span></span>; <span class="hljs-comment">/* remplacer {Y} par votre valeur */</span>
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-top</span>:<span class="hljs-value"> -{Y/<span class="hljs-number">2</span>}em</span></span>; <span class="hljs-comment">/* remplacer {Y/2} par la moiti√© de votre height */</span>
}</span>
</code></pre>
<p>Ici on r√©utilise le principe expliqu√© dans la technique <code>transform: translate; n√©gatif</code>, mais appliqu√© √† la hauteur. Notez que le nom de la <a href="http://apps.workflower.fi/vocabs/css/fr">valeur de la propri√©t√©</a> css passe de <code>translateX</code> √† <code>translateY</code>.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;

  <span class="hljs-comment">/* facultatif : r√©soud un bug non syst√©matique de blur sur IE */</span>
  <span class="hljs-rule"><span class="hljs-attribute">transform-style</span>:<span class="hljs-value"> preserve-<span class="hljs-number">3</span>d</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform</span>:<span class="hljs-value"> <span class="hljs-function">translateY</span>(-<span class="hljs-number">50%</span>)</span></span>;
}</span>
</code></pre>
<h4 id="les-deux">
      <a class="putainde-Title-anchor" href="#les-deux">#</a>
      Les deux
    </h4><p>En r√©utilisant toutes les techniques expliqu√©es pr√©c√©demment, on peut arriver √† plusieurs solutions, √† choisir selon votre contexte et vos pr√©f√©rences.</p>
<p>M√©thode √† base de <code>display: inline-block</code></p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  content: <span class="hljs-string">''</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-right</span>:<span class="hljs-value"> -<span class="hljs-number">0.25em</span></span></span>;
}

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<p>Technique des <code>position: absolute; + marges n√©gatives</code> avec tailles connues √† l‚Äôavance</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> {X}em</span></span>; <span class="hljs-comment">/* remplacer {X} par votre valeur */</span>
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> {Y}em</span></span>; <span class="hljs-comment">/* remplacer {Y} par votre valeur */</span>
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-left</span>:<span class="hljs-value"> -{X/<span class="hljs-number">2</span>}em</span></span>; <span class="hljs-comment">/* remplacer {X/2} par la moiti√© de votre height */</span>
  <span class="hljs-rule"><span class="hljs-attribute">margin-top</span>:<span class="hljs-value"> -{Y/<span class="hljs-number">2</span>}em</span></span>; <span class="hljs-comment">/* remplacer {Y/2} par la moiti√© de votre height */</span>
}</span>
</code></pre>
<p>Technique des <code>position: absolute; + marges n√©gatives</code> avec tailles inconnues</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> relative</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform-style</span>:<span class="hljs-value"> preserve-<span class="hljs-number">3</span>d</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">position</span>:<span class="hljs-value"> absolute</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">top</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">left</span>:<span class="hljs-value"> <span class="hljs-number">50%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">transform</span>:<span class="hljs-value"> <span class="hljs-function">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>)</span></span>;
}</span>
</code></pre>
<h3 id="des-blocs-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#des-blocs-dans-un-bloc">#</a>
      Des blocs dans un bloc
    </h3><h4 id="centrage-horizontal">
      <a class="putainde-Title-anchor" href="#centrage-horizontal">#</a>
      Centrage horizontal
    </h4><p>On utilise la propri√©t√© <code>display: inline-block;</code> qui permet d‚Äôavoir des propri√©t√©s d‚Äôaffichage relatives aux √©l√©ments de type <code>block</code> et de type <code>inline</code>. Le c√¥t√© <code>inline</code> nous permet d‚Äôutiliser tout simplement un <code>text-align: center;</code></p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;  
}</span>
</code></pre>
<h4 id="centrage-vertical">
      <a class="putainde-Title-anchor" href="#centrage-vertical">#</a>
      Centrage vertical
    </h4><p>De la m√™me fa√ßon que pour le centrage horizontal, on utilise le c√¥t√© <code>inline</code> de la propri√©t√© <code>display: inline-block;</code> pour aligner verticalement les √©l√©ments enfants par rapport √† leur conteneur parent.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>; 
}</span>
</code></pre>
<p>Une autre technique consiste √† utiliser les propri√©t√©s css de <code>mise en tableaux</code>. On est oblig√© de cr√©er un <a href="https://developer.mozilla.org/fr/docs/Web/CSS/Pseudo-%C3%A9l%C3%A9ments">pseudo-√©l√©ment</a> pour g√©rer la mise en page par tableau. On cr√©√©e tout simplement un tableau, puis une cellule de tableau, qu‚Äôon positionne gr√¢ce √† un <code>vertical-align: middle;</code>. Les √©l√©ments <code>.child</code> s‚Äôalignent automatiquement dans leur conteneur.</p>
<pre><code class="lang-css"><span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  display: table</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
}

<span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> table-cell</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>; <span class="hljs-comment">/* √† enlever si vous ne souhaitez pas avoir vos blocs enfants align√©s sur la m√™me ligne, mais juste centr√©s verticalement sur la hauteur */</span>
}</span>
</code></pre>
<h4 id="les-deux">
      <a class="putainde-Title-anchor" href="#les-deux">#</a>
      Les deux
    </h4><p>On peut combiner les deux solutions bas√©es sur le <code>display: inline-block;</code> pour avoir le r√©sultat souhait√©.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<p>On peut aussir r√©utiliser la m√©thode √† base de <code>display: table-cell</code> et l‚Äôadapter pour qu‚Äôelle centre horizontalement et verticalement.</p>
<pre><code class="lang-css"><span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  display: table</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">width</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
}

<span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> table-cell</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> left</span></span>;
}</span>
</code></pre>
<p>On peut r√©utiliser la technique pr√©c√©dente en √©tant un peu imaginatif pour fonctionner avec des <code>display: inline-block;</code>. Pour d√©tailler, on cr√©e un pseudo-√©l√©ment, qui aura un <code>content: &#39;&#39;;</code> pour faire qu‚Äôil existe et soit affich√©, puis on annule son affichage via un <code>margin-right n√©gatif</code> qui a pour valeur magique <code>-0.25em</code> ce qui correspond √† la largeur d‚Äôun espace. On lui applique ensuite un <code>display: inline-block + height: 100% + vertical-align: middle</code> pour cr√©er le conteneur √† la taille souhait√©e et on termine en calant l‚Äô√©l√©ment enfant <code>.child</code> avec un centrage vertical.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-rule"><span class="hljs-attribute">.parent</span>:<span class="hljs-value">before {
  content: <span class="hljs-string">''</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">height</span>:<span class="hljs-value"> <span class="hljs-number">100%</span></span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">margin-right</span>:<span class="hljs-value"> -<span class="hljs-number">0.25em</span></span></span>;
}

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> inline-block</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<h3 id="des-elements-inlines-dans-un-bloc">
      <a class="putainde-Title-anchor" href="#des-elements-inlines-dans-un-bloc">#</a>
      Des √©l√©ments inlines dans un bloc
    </h3><p>Ces √©l√©ments <code>inline</code> peuvent √™tre par exemple des liens <code>&lt;a&gt;</code> ou des <code>&lt;span&gt;</code> tout simples. Ces techniques sont souvent tr√®s connues et ne devraient pas vous poser beaucoup de probl√®mes, elles ne seront pas comment√©es. Veuillez vous r√©f√©rer <a href="https://developer.mozilla.org/fr/docs/Web/CSS/text-align">text-align</a> et <a href="https://developer.mozilla.org/fr/docs/Web/CSS/vertical-align">vertical-align</a> si vous souhaitez plus d‚Äôinformations.</p>
<h4 id="centrage-horizontal">
      <a class="putainde-Title-anchor" href="#centrage-horizontal">#</a>
      Centrage horizontal
    </h4><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{}</span>
</code></pre>
<h4 id="centrage-vertical">
      <a class="putainde-Title-anchor" href="#centrage-vertical">#</a>
      Centrage vertical
    </h4><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<h4 id="les-deux">
      <a class="putainde-Title-anchor" href="#les-deux">#</a>
      Les deux
    </h4><pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">text-align</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">vertical-align</span>:<span class="hljs-value"> middle</span></span>;
}</span>
</code></pre>
<h2 id="techniques-avancees-flexbox-ie11">
      <a class="putainde-Title-anchor" href="#techniques-avancees-flexbox-ie11">#</a>
      Techniques avanc√©es : flexbox (<a href="http://caniuse.com/#feat=flexbox">ie11+</a>)
    </h2><p>Flexbox est un outil tr√®s puissant quand il s‚Äôagit de g√©rer le position de blocs flex. Son seul d√©faut consiste en son faible support navigateur, mais il vous faudra maitriser ces techniques si vous comptez faire du d√©veloppement web dans les ann√©es √† venir, d‚Äôautant plus qu‚Äôelles sont tr√®s simples √† r√©diger et comprendre.</p>
<h3 id="centrage-horizontal">
      <a class="putainde-Title-anchor" href="#centrage-horizontal">#</a>
      Centrage horizontal
    </h3><p>On d√©clare le conteneur en bloc flex, et on lui applique la propri√©t√© <a href="https://developer.mozilla.org/fr/docs/Web/CSS/justify-content">justify-content</a>.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> flex</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">justify-content</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{}</span>
</code></pre>
<h3 id="centrage-vertical">
      <a class="putainde-Title-anchor" href="#centrage-vertical">#</a>
      Centrage vertical
    </h3><p>Idem, on d√©clare le conteneur en bloc flex, et cette fois, on lui applique la propri√©t√© <a href="https://developer.mozilla.org/fr/docs/Web/CSS/align-items">align-items</a>.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> flex</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">align-items</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{}</span>
</code></pre>
<h3 id="les-deux">
      <a class="putainde-Title-anchor" href="#les-deux">#</a>
      Les deux
    </h3><p>On combine le tout pour un r√©sultat g√©nial et simpliste.</p>
<pre><code class="lang-css"><span class="hljs-class">.parent</span> <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">display</span>:<span class="hljs-value"> flex</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">justify-content</span>:<span class="hljs-value"> center</span></span>;
  <span class="hljs-rule"><span class="hljs-attribute">align-items</span>:<span class="hljs-value"> center</span></span>;
}</span>

<span class="hljs-class">.child</span> <span class="hljs-rules">{}</span>
</code></pre>
<h2 id="conclusion">
      <a class="putainde-Title-anchor" href="#conclusion">#</a>
      Conclusion
    </h2><p>Essayez de toujours utiliser la solution la plus avanc√©e techniquement par rapport √† votre scope navigateur : si vous devez ne supporter que les IE r√©cents, utilisez flexbox ; si vous devez ne supporter que IE9+, utilisez les transform: translate() ; sinon utilisez des techniques de plus en plus <em>anciennes</em>.</p>
<p>Ce guide n‚Äôa volontairement pas parl√© des pr√©fixes navigateurs, car ce genre de chose doit √™tre pris en charge automatiquement dans votre workflow par un autoprefixer (<a href="https://www.npmjs.org/package/gulp-autoprefixer">gulp-autoprefixer</a>, <a href="https://www.npmjs.org/package/grunt-autoprefixer">grunt-autoprefixer</a>, <a href="http://www.myth.io/">inclus dans myth</a>, ‚Ä¶). Pour apprendre √† l‚Äôinstaller ou √† en apprendre plus sur le sujet, je vous renvoie <a href="http://localhost:4242/posts/css/mise-en-place-autoprefixer/">√† l‚Äôarticle de MoOx</a>. Si vous souhaitez quand m√™me vous passez d‚Äôautoprefixer, vous pourrez v√©rifier la compatibilit√© des propri√©t√©s sur <a href="http://caniuse.com/">caniuse</a>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/css/le-guide-complet-pour-centrer-en-css/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/css/le-guide-complet-pour-centrer-en-css/</guid>
            <pubDate>Tue, 23 Sep 2014 00:00:00 GMT</pubDate>
        </item>
        <item>
            <title><![CDATA[Ma√Ætriser les redirections shell]]></title>
            <description><![CDATA[<p>Le shell (ou ligne de commande) est l‚Äôoutil de pr√©dilection pour bon nombre
d‚Äôentre nous qui utilisons un OS de la famille UNIX. Nous sommes persuad√©s que
bien utilis√©, il remplace avantageusement un IDE complexe et gourmand.</p>
<p>Chez <em>Putain de code !</em>, on a une certaine tendance √† utiliser <a href="http://fr.wikipedia.org/wiki/Z_Shell">Zsh</a>, mais
pour ma part, j‚Äôutilise encore et toujours le v√©n√©rable <a href="http://fr.wikipedia.org/wiki/Bourne-Again_shell">Bash</a>, non pas
pour faire mon barbu mais simplement car il me suffit amplement.</p>
<p>La suite de l‚Äôarticle est donc bas√©e sur celui-ci mais tout devrait fonctionner
√† l‚Äôidentique sur Zsh.</p>
<p>Venons en au sujet m√™me de cet article, l‚Äôun des √©l√©ments essentiels de
l‚Äôutilisation du shell : l‚Äôutilisation des redirections d‚Äôentr√©e/sortie de
base.</p>
<p>Si √ßa vous para√Æt barbare, tenez-vous bien, on attaque tout de suite !</p>
<h2 id="une-entree-deux-sorties">
      <a class="putainde-Title-anchor" href="#une-entree-deux-sorties">#</a>
      Une entr√©e, deux sorties
    </h2><p>Un des principes de base sous UNIX est que tout est fichier et que l‚Äôactivit√© du
syst√®me est rendue par l‚Äôinteraction de programmes (ou processus) √† l‚Äôaide
des dits fichiers.</p>
<p>Pour pouvoir collaborer avec ses cong√©n√®res, chaque processus peut acc√©der par
d√©faut √† trois fichiers bien particuliers : l‚Äôentr√©e, la sortie, et la sortie
d‚Äôerreur standards.</p>
<ul>
<li>L‚Äôentr√©e standard (<code>stdin</code>)</li>
<li>La sortie standard (<code>stdout</code>)</li>
<li>La sortie d‚Äôerreur (<code>stderr</code>)</li>
</ul>
<p>Habituellement, l‚Äôentr√©e standard est li√©e au clavier de l‚Äôutilisateur <em>via</em> son
√©mulateur de terminal, et les deux sorties sont li√©es √† l‚Äôaffichage dans ce m√™me
√©mulateur.</p>
<p>L‚Äôid√©e pour pouvoir faire collaborer les processus est donc de <em>brancher</em> les
entr√©es et sorties de diff√©rents programmes afin d‚Äôobtenir un r√©sultat.</p>
<h2 id="les-redirections-de-base">
      <a class="putainde-Title-anchor" href="#les-redirections-de-base">#</a>
      Les redirections de base
    </h2><p>Commen√ßons par quelques redirections de base, celles qu‚Äôil faut conna√Ætre et qui
sont employ√©es syst√©matiquement.</p>
<p>Pour nous exercer, nous allons utiliser principalement deux commandes :</p>
<ul>
<li><code>echo</code> : permet d‚Äô√©crire un message sp√©cifi√© en tant qu‚Äôargument sur sa sortie
standard.</li>
<li><code>cat</code> : permet d‚Äôafficher le contenu d‚Äôun fichier pass√© en argument sur sa
sortie standard ou de r√©p√©ter son entr√©e standard sur sa sortie standard.</li>
</ul>
<p>Rappelez vous que par d√©faut, la sortie standard est affich√©e dans le terminal
et l‚Äôentr√©e standard est le clavier de l‚Äôutilisateur.</p>
<h3 id="redirection-de-sortie-gt">
      <a class="putainde-Title-anchor" href="#redirection-de-sortie-gt">#</a>
      Redirection de sortie : <code>&gt;</code>
    </h3><p>Ce type de redirection permet d‚Äôindiquer √† un processus que tout ce qui devrait
aller sur la sortie standard (par d√©faut, le terminal), doit plut√¥t √™tre stock√©
dans un fichier.</p>
<p>Pour √ßa, on utilise la syntaxe <code>&gt; [fichier]</code> :</p>
<pre><code class="lang-console">$ echo <span class="hljs-string">"Hello"</span> &gt; <span class="hljs-keyword">message</span>
$ cat <span class="hljs-keyword">message</span>
Hello
</code></pre>
<h3 id="redirection-d-entree-lt">
      <a class="putainde-Title-anchor" href="#redirection-d-entree-lt">#</a>
      Redirection d‚Äôentr√©e : <code>&lt;</code>
    </h3><p>√Ä l‚Äôinverse, on peut aussi sp√©cifier √† un programme qu‚Äôil doit utiliser un
fichier comme son entr√©e standard, √† la place du clavier de l‚Äôutilisateur.</p>
<p>En r√©utilisant notre fichier <code>message</code>, on peut par exemple faire :</p>
<pre><code class="lang-console">$ cat &lt; <span class="hljs-keyword">message</span>
Hello
</code></pre>
<p>Notez qu‚Äôon utilise bien <code>cat</code> <em>sans argument</em>, il utilise donc l‚Äôentr√©e
standard.</p>
<h3 id="connecter-deux-processus">
      <a class="putainde-Title-anchor" href="#connecter-deux-processus">#</a>
      Connecter deux processus : <code>|</code>
    </h3><p>Dernier des connecteurs de base, l‚Äôop√©rateur <code>|</code>, aussi appel√© <em>pipe</em> (et qui se
prononce <em>paillepe</em>, av√© l‚Äôaccent).</p>
<p>Il permet tout simplement d‚Äôutiliser la sortie d‚Äôun programme comme entr√©e d‚Äôun
autre.</p>
<p>Pour montrer √ßa, introduisons la commande <code>tr</code>, qui permet de remplacer des
caract√®res dans l‚Äôentr√©e par d‚Äôautres.</p>
<pre><code class="lang-console">$ <span class="hljs-keyword">echo</span> <span class="hljs-string">"Hello!"</span> | <span class="hljs-built_in">tr</span> <span class="hljs-string">"[:lower:]"</span> <span class="hljs-string">"[:upper:]"</span>
HELLO!
</code></pre>
<h2 id="descripteurs-de-fichiers-et-redirections-avancees">
      <a class="putainde-Title-anchor" href="#descripteurs-de-fichiers-et-redirections-avancees">#</a>
      Descripteurs de fichiers et redirections avanc√©es
    </h2><p>Pour aller plus loin, on va maintenant voir que chaque descripteur de fichier
poss√®de son propre identifiant num√©rique.</p>
<p>Pour <code>stdin</code>, <code>stdout</code> et <code>stderr</code> ce sera respectivement 0, 1 et 2.</p>
<p>On peut se servir de ces identifiants pour faire des redirections plus
pouss√©es !</p>
<h3 id="rediriger-les-autres-descripteur">
      <a class="putainde-Title-anchor" href="#rediriger-les-autres-descripteur">#</a>
      Rediriger les autres descripteur
    </h3><p>Par d√©faut, <code>&gt;</code> ne redirige que la sortie standard vers un fichier. Pour
rediriger un autre descripteur vers un fichier on emploiera la notation <code>X&gt;</code> o√π
<em>X</em> prendra la valeur de l‚Äôidentifiant du descripteur.</p>
<p>Si vous avez bien suivi, on redirigera donc la sortie d‚Äôerreur vers un fichier √†
l‚Äôaide de la syntaxe <code>2&gt;</code>.</p>
<h3 id="rediriger-vers-un-autre-descripteur-gt-amp">
      <a class="putainde-Title-anchor" href="#rediriger-vers-un-autre-descripteur-gt-amp">#</a>
      Rediriger vers un autre descripteur : <code>&gt;&amp;</code>
    </h3><p>On peut connecter les descripteurs d‚Äôun processus entre eux. C‚Äôest un m√©canisme
que l‚Äôon utilise tr√®s souvent quand on √©crit des scripts Shell, notamment pour
√©crire sur la sortie d‚Äôerreur.</p>
<p>Pour cel√†, on utilise la redirection <code>X&gt;&amp;Y</code> avec <em>X</em> √©tant l‚Äôidentifiant
descripteur source et <em>Y</em> l‚Äôidentifiant du descripteur sur lequel on veut
rediriger.</p>
<p>L‚Äôexemple suivant montre comment rediriger la sortie standard sur la sortie
d‚Äôerreur (c‚Äôest comme √ßa qu‚Äôon √©crit sur la sortie d‚Äôerreur dans un script).</p>
<pre><code class="lang-console">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Error"</span> <span class="hljs-number">1</span>&gt;&amp;<span class="hljs-number">2</span>
</code></pre>
<p>Plus g√©n√©ralement, on peut omettre la partie avant le <code>&gt;&amp;</code>, elle prendra la
valeur 1 par d√©faut. On aura donc le script suivant :</p>
<pre><code class="lang-console">$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"Error"</span> &gt;&amp;<span class="hljs-number">2</span>
</code></pre>
<h3 id="ajouter-en-fin-de-fichier-gt-gt">
      <a class="putainde-Title-anchor" href="#ajouter-en-fin-de-fichier-gt-gt">#</a>
      Ajouter en fin de fichier : <code>&gt;&gt;</code>
    </h3><p>Par d√©faut, <code>&gt;</code> √©crase le fichier dans lequel la redirection va s‚Äôeffectuer.
Pour √©viter ce probl√®me, on peut utiliser √† la place <code>&gt;&gt;</code> qui va ajouter en fin
de fichier.</p>
<pre><code class="lang-console"># Sans &gt;&gt;
$ <span class="hljs-keyword">echo</span> <span class="hljs-string">"1"</span> &gt; <span class="hljs-keyword">file</span>
$ <span class="hljs-keyword">echo</span> <span class="hljs-string">"2"</span> &gt; <span class="hljs-keyword">file</span>
$ <span class="hljs-keyword">cat</span> <span class="hljs-keyword">file</span>
<span class="hljs-number">2</span>
</code></pre>
<pre><code class="lang-console"><span class="hljs-comment"># Avec &gt;&gt;</span>
<span class="hljs-variable">$ </span>echo <span class="hljs-string">"1"</span> &gt; file
<span class="hljs-variable">$ </span>echo <span class="hljs-string">"2"</span> <span class="hljs-prompt">&gt;&gt; </span>file
<span class="hljs-variable">$ </span>cat file
<span class="hljs-number">1</span>
<span class="hljs-number">2</span>
</code></pre>
<h3 id="dev-null-le-trou-noir">
      <a class="putainde-Title-anchor" href="#dev-null-le-trou-noir">#</a>
      <code>/dev/null</code>, le trou noir
    </h3><p>Il existe un fichier un peu particulier sur tout bon UNIX qui se respecte :
<code>/dev/null</code>.</p>
<p>Ce dernier est en fait une sorte de trou noir : Si on affiche son contenu on
n‚Äôobtient rien, et si on √©crit quelque chose dedans elle disparait.</p>
<p>On se sert souvent de ce fichier pour supprimer la sortie d‚Äôun programme :</p>
<pre><code class="lang-console">$ echo <span class="hljs-string">"Hello"</span> &gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span>
$ cat <span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span>
$
</code></pre>
<h3 id="ordre-des-redirections">
      <a class="putainde-Title-anchor" href="#ordre-des-redirections">#</a>
      Ordre des redirections
    </h3><p>Un dernier mot avant la fin, l‚Äôordre des redirections est tr√®s important !</p>
<p>Imaginez la fonction suivante qui affiche un message sur la sortie standard et
un sur la sortie d‚Äôerreur :</p>
<pre><code class="lang-console"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">programme</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">echo</span> <span class="hljs-string">"Message"</span>
  <span class="hljs-keyword">echo</span> <span class="hljs-string">"Error"</span> &gt;&amp;<span class="hljs-number">2</span>
}
</code></pre>
<p>Si on veut rediriger toutes les sorties vers <code>/dev/null</code> on peut utiliser la
syntaxe suivante :</p>
<pre><code class="lang-console">$ programme <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span> &gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span>
</code></pre>
<p>Vous remarquerez que c‚Äôest assez verbeux, et qu‚Äôon pourrait simplifier cel√† en
utilisant <code>&gt;&amp;</code> comme vu pr√©c√©demment.</p>
<p>On essaie donc na√Øvement :</p>
<pre><code class="lang-console">$ programme <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> &gt;<span class="hljs-regexp">/dev/</span><span class="hljs-literal">null</span>
<span class="hljs-built_in">Error</span>
</code></pre>
<p>Hmm, pourtant on a tout branch√© ensemble non ? En fait non, on a redirig√© la
sortie sur le fichier point√© par <code>1</code> au moment o√π on √©crit la redirection, donc
avant qu‚Äôil soit redirig√© sur <code>/dev/null</code>.</p>
<p>Pour bien faire, il faut √©crire les redirections dans l‚Äôautre ordre :</p>
<pre><code class="lang-console"><span class="hljs-variable">$ </span>programme &gt;<span class="hljs-regexp">/dev/null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>
</code></pre>
<p>On lira ceci : Rediriger la sortie standard vers <code>/dev/null</code>, puis rediriger la
sortie d‚Äôerreur vers la sortie standard.</p>
<h3 id="pour-resumer">
      <a class="putainde-Title-anchor" href="#pour-resumer">#</a>
      Pour r√©sumer
    </h3><p>On a en fait que deux redirections de sortie, <code>&gt;</code> et <code>&gt;&gt;</code>, les symboles qui les
entourent sont souvent optionnels.</p>
<p>Si on veut sp√©cifier un fichier on donnera son nom, si on veut sp√©cifier un
descripteur on donnera son identifiant pr√©fix√© de <code>&amp;</code>.</p>
<h2 id="pour-aller-plus-loin">
      <a class="putainde-Title-anchor" href="#pour-aller-plus-loin">#</a>
      Pour aller plus loin
    </h2><p>Le manuel de bash contient <a href="http://www.gnu.org/software/bash/manual/bashref.html#Redirections">une section compl√®te sur les
redirections</a>. Elle va beaucoup plus loin que cet article et je vous
invite √† la lire pour voir tout ce qu‚Äôil est possible de faire.</p>
<p>Il y a aussi une section d√©di√©e √† ce sujet dans l‚Äô<a href="http://tldp.org/LDP/abs/html/io-redirection.html">Advanced Bash-Scripting Guide</a>.</p>
]]></description>
            <link>http://putaindecode.fr/posts/shell/maitriser-les-redirections-shell/</link>
            <guid isPermaLink="true">http://putaindecode.fr/posts/shell/maitriser-les-redirections-shell/</guid>
            <pubDate>Wed, 16 Jul 2014 00:00:00 GMT</pubDate>
        </item>
    </channel>
</rss>